(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1418626,      33875]
NotebookOptionsPosition[   1330856,      32823]
NotebookOutlinePosition[   1331291,      32840]
CellTagsIndexPosition[   1331248,      32837]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["The Little EMF Notebook", "Title",
 CellChangeTimes->{{3.874023881962307*^9, 3.874023886521015*^9}, {
  3.8740239246531363`*^9, 3.874023946577847*^9}, {3.874477589693343*^9, 
  3.874477594438311*^9}, {3.877964418704362*^9, 3.8779644198034573`*^9}, {
  3.878631358255678*^9, 
  3.878631372329137*^9}},ExpressionUUID->"2878dbbf-9640-4527-9e35-\
8bc6fde02b26"],

Cell[TextData[{
 StyleBox["Version 0.1",
  FontFamily->"Andale Mono",
  FontSize->14],
 "\nUnpublished Draft \[Copyright] 2023 Yu Yifan\[LineSeparator]",
 StyleBox["yifan.yu@aalto.fi",
  FontFamily->"Avenir",
  FontSize->16,
  FontColor->RGBColor[
   0.5000076295109483, 0.000045777065690089265`, 0.5000076295109483]]
}], "Subtitle",
 CellChangeTimes->{{3.8740240051049147`*^9, 3.874024023216158*^9}, {
  3.87402415367202*^9, 3.874024174753405*^9}, {3.874456922872011*^9, 
  3.8744569306679707`*^9}, {3.876302674355294*^9, 3.876302684821782*^9}, {
  3.8829727705733423`*^9, 3.882972770742416*^9}, {3.882973593806877*^9, 
  3.882973601593507*^9}},ExpressionUUID->"78aff8d8-2178-427f-a7a0-\
bd3d3ee35f36"],

Cell[TextData[StyleBox["If people do not believe that mathematics is simple, \
it is only because they do not realize how complicated life is.\n- John von \
Neumann",
 FontFamily->"Academy Engraved LET",
 FontSize->18]], "Text",
 CellChangeTimes->{{3.8740241988744907`*^9, 3.874024205183008*^9}},
 TextAlignment->Right,ExpressionUUID->"a5e3caac-1336-4654-b112-a8b35ab9f9c7"],

Cell[CellGroupData[{

Cell["Introduction", "Chapter",
 CellChangeTimes->{{3.874025080966816*^9, 
  3.874025082265353*^9}},ExpressionUUID->"aa379228-55fd-46b6-8d0d-\
f977d9933e42"],

Cell[TextData[{
 "The goal of this notebook is to make the study of electromagnetic fields as \
visual and interactive as possible. In other words, it aims to facilitate \
understanding and help build ",
 StyleBox["intuition",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 " with Mathematica illustrations. I highlighted the word intuition because I \
think its importance has often been overlooked when approaching a subject \
that is quite mathematical. I still remember myself nodding in agreement upon \
reading this paragraph from The Feynman Lectures on Physics:\n\n",
 StyleBox["What it means really to understand an equation\[LongDash]that is, \
in more than a strictly mathematical sense\[LongDash]was described by Dirac. \
He said: \[OpenCurlyDoubleQuote]I understand what an equation means if I have \
a way of figuring out the characteristics of its solution without actually \
solving it.\[CloseCurlyDoubleQuote] So if we have a way of knowing what \
should happen in given circumstances without actually solving the equations, \
then we \[OpenCurlyDoubleQuote]understand\[CloseCurlyDoubleQuote] the \
equations, as applied to these circumstances. A physical understanding is a \
completely unmathematical, imprecise, and inexact thing, but absolutely \
necessary for a physicist.",
  FontSlant->"Italic",
  FontColor->RGBColor[0., 0., 0.]],
 "\n    \nWhat this notebook will not contain: it will not contain rigorous \
derivations of math. For that, I will assume you already have a good textbook \
by your side. Instead, I will focus on illustrating the ideas with the help \
of plots and animations, many of which interactive. To make things even more \
\[OpenCurlyDoubleQuote]interactive\[CloseCurlyDoubleQuote],  a Q&A \
conversational has been adopted. This is inspired by the wonderful book The \
Little Schemer.\n\nHow to read or use this notebook? First of all,  note that \
you do not need to know the Mathematica programming language in order to read \
it. It is recommended that you read each section in a linear order and \
evaluate each cell with Shift-Enter to see the results. The cells that have a \
grey background are the so-called Initialization Cells and they are evaluated \
automatically, so you don\[CloseCurlyQuote]t have to Shift-Enter on them. It \
is not recommended to run the entire notebook all at once, since that will \
just take forever and possibly fry your computer. In addition, while I do \
think it will be smoother and more satisfying to run this notebook on a \
relatively fast computer (as most of the visualizations are run in \
real-time), it is not strictly required. For computationally expensive \
animations, some sacrifices have to be made to ensure good reading \
experience. This could be: 1) less frames rendered 2) lower rendering \
quality. Option 1 is always preferred unless the situation calls for option \
2.\n\nThroughout this notebook you will see lots of plots wrapped with \
Manipulate or Animate. This means you can interact with them. So, please:\n\n\
1. Run each cell (Shift-Enter) yourself and see the results\n2. Change some \
parameters or variables, re-run the cell, and see the effects\n3. Play with \
the values in the plots wrapped with Manipulate\n4. Pause the animations and \
slide back and forth to observe things more closely\n5. Rotate a 3D plot to \
see things from a different angle\n\n",
 StyleBox["If you run into problems, try to reset the notebook by clicking \
\[OpenCurlyDoubleQuote]Cell -> Delete All Output\[CloseCurlyDoubleQuote], \
then run the initialization cell in gray background below.",
  FontColor->RGBColor[0.6, 0.4000152590218967, 0.2]],
 "\n\n",
 StyleBox["Bon",
  IgnoreSpellCheck->True],
 " App\[EAcute]tit!"
}], "Text",
 CellChangeTimes->{{3.874025100269681*^9, 3.874025394214346*^9}, {
   3.874025432078903*^9, 3.874025567387974*^9}, {3.874025738414076*^9, 
   3.8740258133724937`*^9}, {3.874025896544825*^9, 3.874025908483244*^9}, {
   3.874446370036927*^9, 3.874446426396254*^9}, {3.874762174282422*^9, 
   3.874762244504863*^9}, {3.874762285445897*^9, 3.874762507031128*^9}, {
   3.8747625825230703`*^9, 3.874762592490233*^9}, {3.874762634570425*^9, 
   3.874762667267392*^9}, {3.874762718274571*^9, 3.874762835432624*^9}, {
   3.8768774481454487`*^9, 3.8768774801062403`*^9}, {3.876877533121051*^9, 
   3.87687754078469*^9}, {3.876877601065631*^9, 3.876877785416573*^9}, 
   3.882972951695438*^9, {3.8829732004162207`*^9, 3.8829732338040733`*^9}, {
   3.882973271733885*^9, 3.88297336072927*^9}, {3.882973409865466*^9, 
   3.882973586605198*^9}, {3.88297364739564*^9, 3.882973673445059*^9}, {
   3.882973738558712*^9, 3.882973794316997*^9}, {3.8829738612471046`*^9, 
   3.882973883140473*^9}, {3.882973935617635*^9, 3.8829739410069227`*^9}, {
   3.882973987808342*^9, 3.882973993275042*^9}, {3.8829740537503157`*^9, 
   3.882974182334866*^9}, {3.882974293811823*^9, 3.882974421763476*^9}, {
   3.882974503254908*^9, 3.8829745433932047`*^9}, {3.8829746093455887`*^9, 
   3.8829746788426113`*^9}, {3.8829747526807957`*^9, 3.882974843143811*^9}, {
   3.8829748878906317`*^9, 3.882974945998258*^9}, {3.882975522450018*^9, 
   3.882975532480855*^9}, {3.882977684066307*^9, 3.882977725515254*^9}, {
   3.88297776409629*^9, 3.882977769730338*^9}, {3.8829778238557253`*^9, 
   3.882977824531558*^9}, {3.882977859817181*^9, 3.882977921239847*^9}, {
   3.882977968581081*^9, 3.8829780329285507`*^9}, {3.882978089320692*^9, 
   3.882978261317513*^9}, {3.882978379877215*^9, 3.8829784498600197`*^9}, {
   3.882978645094376*^9, 3.882978650328676*^9}, {3.882978691433434*^9, 
   3.882978911430435*^9}, {3.882979013658484*^9, 3.8829793209887867`*^9}, {
   3.882979369928925*^9, 3.882979477704042*^9}, {3.882979557531917*^9, 
   3.882979585056995*^9}, {3.88304394321801*^9, 3.883043943558853*^9}, {
   3.883188831711297*^9, 3.88318885895087*^9}, {3.883189138293942*^9, 
   3.883189239919335*^9}, {3.883189928173231*^9, 3.883189929561369*^9}, {
   3.8832884176146727`*^9, 3.883288437355383*^9}, {3.883288825984991*^9, 
   3.883288950556431*^9}, {3.883288982323496*^9, 3.883288983940805*^9}, {
   3.883289401883478*^9, 3.883289402380213*^9}, {3.883289466285104*^9, 
   3.883289502193533*^9}, {3.883380321825313*^9, 3.8833803912749233`*^9}, {
   3.883390996223361*^9, 3.8833910083265123`*^9}, {3.883391066650625*^9, 
   3.883391067344832*^9}, {3.888474825884943*^9, 3.888474835789043*^9}, {
   3.889453156947875*^9, 3.889453203366341*^9}, 
   3.8894539619061117`*^9},ExpressionUUID->"51923026-0b43-485c-95e1-\
05a315ea3b5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "initialization", " ", "cell"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "//", "Quiet"}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "Notation`"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"A"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SuperscriptBox["V", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["V", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       OverscriptBox["V", "~"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       OverscriptBox[
        SubscriptBox["V", "_"], "~"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       OverscriptBox["J", "~"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["E", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubsuperscriptBox["E", "_", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], " ", 
   RowBox[{"(*", " ", "Subsuperscript", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"B"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["B", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"H"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["H", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Epsilon]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SuperscriptBox["\[Epsilon]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Mu]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Eta]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Phi]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Theta]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[CapitalGamma]"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[CapitalGamma]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Tau]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["\[Sigma]", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["k", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"T"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["I", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"I", " ", "is", " ", "locked", " ", "and", " ", "protected"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{"R"},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["z", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["Z", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["r", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["x", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["g", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["b", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SubscriptBox["Y", "_"]},
      "NotationTemplateTag"], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "0"], "=", 
     RowBox[{"8.854", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Mu]", "0"], "=", 
     RowBox[{"4", "\[Pi]", " ", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Eta]", "0"], "=", 
     SqrtBox[
      FractionBox[
       SubscriptBox["\[Mu]", "0"], 
       SubscriptBox["\[Epsilon]", "0"]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", "299792458"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzX0s1HEcB/Cbh5/M1TzdH5WmthyZsHswT+E7Y9zUmg4XoTGWupUhTVup
dEjt/rgurFEc4mSVh2RN0lFJxak/us2Rp2Pqt45GNYfr8/n+8d7rj/feex/I
upCYY8PhcAQQVMlMxvUaWRLbmC9BL0+sK41TLPlrF6VCs8raOtG9/tzn6Mqs
+xDtXVTUUTfPz2hw2osvqL2l/p8F5Cb/pNZoM8sdp1nS7jhCFeSJNwVgfcMg
VahT26SBzrUBtihvpECM8t81EXRRUZiAtt+ZlKLSq5HjfjMs0XzVUk8t71g6
McuSoY7jy2igRJouBSu6NzJQTa/Zgh7zydpEu/Yl+5aCHmMOgWjcarwY1cn1
waidj2/QNVDwtIbqaaiWoXqPsHRUMdiTjf5xkOei3aLD1utgwQCfcwNsu81z
8ZpjyW8rzxU9s54f7gOG3muhOraW9SvBqkj/ATRIxQzFz8M+0UT1M/DGzaDe
KqI2KYLm0UxLJ1X9oM7OAkbpQ+zR4l/e4U4LLPlgekLtq5a/5oIP1w4NonLD
442j4CUX8Rb6TX1RWgSevTKRhEZ93Kh9CSYuZdehhTmFjWjGTTcNKnsV0IYm
9DRp0TnONj/VxJIUptgbPRhiJqir7ZsYVDaTV/J+kSV1QgU14tFI8xTIhOa2
oD9smA50S1FOrXRwWkX7FmrW0E9VXrumwdiYAme0QqdlvoPG4WfUSgnPEG1m
Scf5c9T7/cHCk2CrsYrKLw0LR/d3FVFvDUfrFSvw1zBGTWtmhOXg6bs7RWiK
kC0+ssqS7aQ9Jah4d6p7BDj6Vk39D+dlx6k=
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"f2c4fa37-e85a-47ee-bfba-da4ffaba1b30"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Waves and Phasors", "Chapter",
 CellChangeTimes->{{3.874023990228744*^9, 3.874023998138241*^9}, {
  3.874024474539536*^9, 
  3.874024478180771*^9}},ExpressionUUID->"1e49a833-782e-4eca-bd18-\
0091e6b81df2"],

Cell[CellGroupData[{

Cell["Waves that Travel", "Section",
 CellChangeTimes->{{3.8744841371820087`*^9, 3.874484173463159*^9}, {
  3.874484256734419*^9, 3.874484260170744*^9}, {3.8745689387081547`*^9, 
  3.874568945490149*^9}, {3.874763239171048*^9, 3.874763275038459*^9}, {
  3.8829827086543903`*^9, 
  3.8829827184337263`*^9}},ExpressionUUID->"2fd1ce77-1c86-4d42-8330-\
a3d25a9a4d68"],

Cell[TextData[{
 "Is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", "cos", 
         RowBox[{"(", 
           RowBox[{"0.6", "\[Pi]", 
             StyleBox["t", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "5 \\cos(0.6 \\pi t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2396a11a-9cc0-4b2e-865c-aec7e799df8f"],
 " a wave?"
}], "Text",
 CellChangeTimes->{{3.882979783813614*^9, 3.882979822543701*^9}, {
  3.882981836734733*^9, 
  3.882981836734768*^9}},ExpressionUUID->"0d6041fd-c0ff-4021-a4b5-\
117f83b9f77c"],

Cell["Yes, it\[CloseCurlyQuote]s a cosine wave.", "CodeText",
 CellChangeTimes->{{3.882980131596202*^9, 3.88298017620125*^9}, {
  3.882980405210524*^9, 3.882980414243829*^9}, {3.8829818471320133`*^9, 
  3.8829818472626762`*^9}, {3.883188437419018*^9, 
  3.8831884405092363`*^9}},ExpressionUUID->"aa6515c1-c8e9-40c5-a8b6-\
18c23f65bdae"],

Cell["What can it represent?", "Text",
 CellChangeTimes->{{3.883327545513319*^9, 
  3.883327551843202*^9}},ExpressionUUID->"1cdda761-cac6-4891-9fc4-\
68e957a73b81"],

Cell[TextData[{
 "It can represent things like voltage or current in a circuit over time \
since it has one time variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "188697f0-cbcf-438c-8c79-d76a06b10db5"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.8833275978059587`*^9, 3.883327657985772*^9}, {
  3.883327862302*^9, 
  3.883327870913987*^9}},ExpressionUUID->"cf3090f2-c06c-49ed-b8ab-\
48748f41557b"],

Cell[TextData[{
 "Is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", "cos", 
         RowBox[{"(", 
           RowBox[{"0.6", "\[Pi]", 
             StyleBox["t", "TI"], "-", 
             StyleBox["x", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "5 \\cos(0.6 \\pi t - x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d6771839-378a-4d1a-90cd-169e22eaf5e8"],
 " a wave?"
}], "Text",
 CellChangeTimes->{
  3.88298016302315*^9, {3.8831893067983294`*^9, 
   3.883189312397258*^9}},ExpressionUUID->"a53e5c6d-0e98-479c-9ebe-\
104fb685db6f"],

Cell[TextData[StyleBox["Tip: Note that you don\[CloseCurlyQuote]t have to \
evaluate the cells with grey background which usually contain function \
definitions. These so-called Initialization Cells are evaluated \
automatically. Try to press Shift-Enter on the cell below the next one, \
Mathematica will ask you \[OpenCurlyDoubleQuote]Do you want to automatically \
evaluate all the initialization cells in the notebook \[OpenCurlyQuote]EMF.nb\
\[CloseCurlyQuote]?\[CloseCurlyDoubleQuote]. Click \[OpenCurlyDoubleQuote]Yes\
\[CloseCurlyDoubleQuote].",
 FontFamily->"Source Sans Pro",
 FontColor->RGBColor[
  0.0746013580529488, 0.4695963988708324, 0.22800030518043793`]]], "CodeText",\

 CellChangeTimes->{{3.883189319168993*^9, 3.883189384109385*^9}, {
   3.88318943190854*^9, 3.8831895041460333`*^9}, {3.8831895918836823`*^9, 
   3.88318962225568*^9}, 3.8831898356388283`*^9, {3.883249828351783*^9, 
   3.883249829046864*^9}},ExpressionUUID->"6ce16a1b-14ac-4b48-abf3-\
0dc1e12e85c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimpleWave", "[", "f_", "]"}], " ", ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882980322950068*^9, 3.882980323753416*^9}, {
   3.883188157762698*^9, 3.8831881816724358`*^9}, {3.883188957748452*^9, 
   3.8831890095614023`*^9}, {3.883189041425498*^9, 3.883189067600827*^9}, {
   3.883250115672565*^9, 3.883250116081098*^9}, {3.883250162376696*^9, 
   3.883250190330246*^9}, {3.8833279420290537`*^9, 3.8833279558252783`*^9}, 
   3.88333231987064*^9, {3.88339218500801*^9, 3.8833921861699743`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"3b6d0ad0-0962-43b0-ab6e-ab1d482c1b04"],

Cell[BoxData[
 RowBox[{"SimpleWave", "[", 
  RowBox[{"5", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", "x"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.883272998558248*^9, 3.883272998891007*^9}},
 CellLabel->
  "In[826]:=",ExpressionUUID->"7a227a9d-afb0-44e9-8495-4d7fdd132e36"],

Cell[TextData[{
 "Yes, the animation shows that it\[CloseCurlyQuote]s a wave traveling \
towards the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a2e065a-f556-4826-8b93-750d92acc17e"],
 " direction."
}], "CodeText",
 CellChangeTimes->{
  3.8830167614639874`*^9, {3.88318846760886*^9, 3.883188484681799*^9}, {
   3.883328409656353*^9, 
   3.883328412168818*^9}},ExpressionUUID->"8df2a08d-8adf-4811-a3fe-\
8d262fa96caf"],

Cell["What can it represent?", "Text",
 CellChangeTimes->{{3.8833276975280457`*^9, 
  3.883327708023176*^9}},ExpressionUUID->"c43bc8f9-226b-4aba-9f3d-\
0cc4ba07ec88"],

Cell[TextData[{
 "One could think of the displacement of a guitar string. The displacement ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fe5979fc-253f-4ed8-a152-77f5655693a9"],
 " varies with time ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "39a17d13-b505-4bbe-b4ad-e0093502906d"],
 " as well as the location ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5c85e14c-8929-4391-9323-6a142d87eaac"],
 " along the string."
}], "CodeText",
 CellChangeTimes->{
  3.883327711252989*^9, {3.883327743625671*^9, 3.883327743932898*^9}, {
   3.8833277932027073`*^9, 3.883327797887577*^9}, {3.8833278411602583`*^9, 
   3.883327847309368*^9}},ExpressionUUID->"5f9dfa15-c683-45b5-8e43-\
4a2ee72e90a5"],

Cell["What\[CloseCurlyQuote]s the difference between the first and the second \
wave?", "Text",
 CellChangeTimes->{{3.882981892580716*^9, 3.882981918010545*^9}, {
  3.8829820170089903`*^9, 3.882982018036592*^9}, {3.883044133259637*^9, 
  3.883044162445092*^9}, {3.883327827193283*^9, 3.883327835314247*^9}, {
  3.8833280029039*^9, 
  3.883328006976389*^9}},ExpressionUUID->"a8d8d063-92de-4a18-9374-\
b401528ea241"],

Cell[TextData[{
 "The first wave only has a time variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f84c1541-95b3-465d-93ca-bf0394c972f3"],
 ". The second wave, on the other hand, has a spatial variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c9442043-8b60-43c9-8267-5ddf07f50450"],
 ". It is therefore a one-dimensional spatial wave."
}], "CodeText",
 CellChangeTimes->{{3.882981925220446*^9, 3.882981979186781*^9}, {
   3.8829820306609097`*^9, 3.882982036326387*^9}, {3.883044173345171*^9, 
   3.883044184299102*^9}, 3.883249865655086*^9, {3.883249897220459*^9, 
   3.883249918170004*^9}, {3.883327729171055*^9, 3.883327732576542*^9}, {
   3.883327997068181*^9, 
   3.8833280390253563`*^9}},ExpressionUUID->"943d347d-0041-42b4-bc52-\
2e3164604a26"],

Cell[TextData[{
 "I noticed that you call the second wave ",
 StyleBox["one-dimensional",
  FontSlant->"Italic"],
 " even though the guitar string clearly vibrates into a second dimension ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46f1d82f-ce55-49f0-90a1-5479427d7d23"],
 "? "
}], "Text",
 CellChangeTimes->{{3.874477498379746*^9, 3.8744775648488503`*^9}, {
  3.874477627357243*^9, 3.87447762829524*^9}, {3.874763371077083*^9, 
  3.8747633751613493`*^9}, {3.874763736572158*^9, 3.874763823704315*^9}, {
  3.883328225083192*^9, 
  3.883328226216544*^9}},ExpressionUUID->"add48133-1051-4775-9b9e-\
9d82e2a61a48"],

Cell["\<\
Yes, I guess it\[CloseCurlyQuote]s because there is only one spatial \
variable, so it would be neat to call the wave one-dimensional. I like to \
think of the dimension of the wave when the it is not \
\[OpenCurlyDoubleQuote]vibrating\[CloseCurlyDoubleQuote] \[LongDash] a string \
is just a one-dimensional line.\
\>", "CodeText",
 CellChangeTimes->{{3.8744775731959457`*^9, 3.874477574090705*^9}, {
   3.874477635793038*^9, 3.874477698870685*^9}, {3.874477779613302*^9, 
   3.8744778093415728`*^9}, {3.874478213471965*^9, 3.8744782147314043`*^9}, 
   3.874763221808638*^9, {3.8747633997580137`*^9, 3.8747634063391323`*^9}, {
   3.8756224531446037`*^9, 3.8756224555186367`*^9}, {3.875622605624003*^9, 
   3.8756226442449493`*^9}, {3.883328258371266*^9, 
   3.8833282587761917`*^9}},ExpressionUUID->"bd9477f9-b05d-429a-955c-\
ee5eaaa97dcc"],

Cell[TextData[{
 "Sounds reasonable. How about ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", "cos", 
         RowBox[{"(", 
           RowBox[{"0.6", "\[Pi]", 
             StyleBox["t", "TI"], "-", 
             StyleBox["x", "TI"], "-", 
             StyleBox["y", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "5 \\cos(0.6 \\pi t - x - y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9b7f628b-b483-481a-816e-cdd92ac83e47"],
 ", is it a wave?"
}], "Text",
 CellChangeTimes->{
  3.88298016302315*^9, {3.8833283250900803`*^9, 3.88332839087283*^9}, {
   3.8833284508912573`*^9, 
   3.8833284587692957`*^9}},ExpressionUUID->"48abe503-349c-4070-aff7-\
565a17c30f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simple2DWave", "[", "f_", "]"}], " ", ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot3D", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
      RowBox[{"MaxRecursion", "->", "4"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "3.33"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883249951096154*^9, 3.883249975248145*^9}, {
   3.883250026996092*^9, 3.883250039079227*^9}, {3.883250069700452*^9, 
   3.8832500784305353`*^9}, {3.88328400208429*^9, 3.883284125692271*^9}, {
   3.883284177455429*^9, 3.883284219072097*^9}, {3.883284313698615*^9, 
   3.883284314131317*^9}, {3.883285776067872*^9, 3.883285828109208*^9}, 
   3.8832858583374043`*^9, {3.883289566963985*^9, 3.883289638968295*^9}, {
   3.8833274107223063`*^9, 3.883327430650837*^9}, 3.88333232798538*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"5abbc522-573d-4cf1-80ee-f8c01adee85e"],

Cell[BoxData[
 RowBox[{"Simple2DWave", "[", 
  RowBox[{"5", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", "x", " ", "-", "y"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883250002400881*^9, 3.883250008532069*^9}, {
   3.883250051341446*^9, 3.883250052496975*^9}, 3.883273016613434*^9, {
   3.8832862102160788`*^9, 3.883286211669052*^9}, {3.883289647322064*^9, 
   3.883289648308159*^9}},
 CellLabel->
  "In[828]:=",ExpressionUUID->"7fd8aef9-e7bf-41dd-a5a0-e736f4c7df13"],

Cell[TextData[{
 "Yes, it\[CloseCurlyQuote]s a two-dimensional traveling spatial wave. \
Compared with the previous wave, one additional spatial variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b82d31cf-8219-4f99-9643-4117a2de4cfe"],
 " has been introduced."
}], "CodeText",
 CellChangeTimes->{{3.883104697732276*^9, 3.883104712900158*^9}, {
  3.883104745032505*^9, 
  3.883104782152673*^9}},ExpressionUUID->"d0e6f9c0-362f-44cd-b6b2-\
fcd3f9f56ebc"],

Cell["What can it represent?", "Text",
 CellChangeTimes->{{3.8833281657486*^9, 
  3.883328168362818*^9}},ExpressionUUID->"703255bd-7c27-47a1-8256-\
e364ffb8f30f"],

Cell["\<\
One could think of ripples on a pond since the pond surface is \
two-dimensional.\
\>", "CodeText",
 CellChangeTimes->{{3.8833285114651337`*^9, 
  3.883328513858624*^9}},ExpressionUUID->"dcaa41d5-fffe-4a4f-9ba2-\
1d9da30b3514"],

Cell[TextData[{
 "Is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"25", "-", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["x", "TI"]}], ")"}], "2"]}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sqrt{25 - (t - x)^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8a6ab583-55ac-4d4d-b5c8-f600104f7c64"],
 " a wave?"
}], "Text",
 CellChangeTimes->{{3.882982425577568*^9, 
  3.882982456962534*^9}},ExpressionUUID->"9dda3cc0-6a1b-45c0-90d9-\
9f87981bed6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonperiodicWave", "[", "f_", "]"}], ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "->", "Automatic"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8829821108355827`*^9, 3.882982130245948*^9}, {
   3.882982204912532*^9, 3.882982306159026*^9}, {3.882982349049419*^9, 
   3.882982416442438*^9}, {3.882982469186618*^9, 3.8829824726294327`*^9}, {
   3.8831049341483603`*^9, 3.883104939734166*^9}, {3.883105050260148*^9, 
   3.883105089641313*^9}, 3.8831051403891582`*^9, {3.8832502172854757`*^9, 
   3.883250219258828*^9}, 3.8832712895694532`*^9, {3.8832713705176287`*^9, 
   3.8832713782995043`*^9}, {3.883271410392304*^9, 3.883271435115635*^9}, {
   3.883271524378559*^9, 3.883271552971458*^9}, 3.8833323359578247`*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"7cbd9fd3-f13b-4ee0-888c-ba8105aff35b"],

Cell[BoxData[
 RowBox[{"NonperiodicWave", "[", 
  SqrtBox[
   RowBox[{"25", "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"t", "-", "x"}], ")"}], "2"]}]], "]"}]], "Input",
 CellChangeTimes->{{3.883250140361459*^9, 3.883250148864038*^9}, {
  3.8832502252696857`*^9, 3.883250228395175*^9}},
 CellLabel->
  "In[830]:=",ExpressionUUID->"d667b6e1-8bd9-4f1c-a3da-f495de106d73"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s a semicircle wave traveling in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b7217bd3-86ba-4a90-8db5-a6f6d5f0ba3d"],
 " direction. Wikipedia defines wave as \[OpenCurlyDoubleQuote]a propagating \
dynamic disturbance (change from equilibrium) of one or more quantities\
\[CloseCurlyDoubleQuote], so yes, this is a (nonperiodic) wave."
}], "CodeText",
 CellChangeTimes->{{3.882982490151441*^9, 3.882982512749463*^9}, {
  3.882982632671505*^9, 3.882982645389802*^9}, {3.8832504357949467`*^9, 
  3.883250435886167*^9}, {3.883272662875484*^9, 3.883272666436365*^9}, {
  3.883272717946302*^9, 
  3.883272764436458*^9}},ExpressionUUID->"a6c223b6-c7b2-4d87-9510-\
5a0a4ecd1778"],

Cell[TextData[{
 "Compared ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"25", "-", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "-", 
               StyleBox["x", "TI"]}], ")"}], "2"]}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sqrt{25 - (t - x)^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "633886f6-e985-4b5b-8ff7-2d192371df2d"],
 ", in which direction do these waves ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"25", "-", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{
               StyleBox["t", "TI"], "+", 
               StyleBox["x", "TI"]}], ")"}], "2"]}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sqrt{25 - (t + x)^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fd52e423-b41c-4712-aa33-433c7fceeb7f"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"25", "-", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{"-", 
               StyleBox["t", "TI"], "+", 
               StyleBox["x", "TI"]}], ")"}], "2"]}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sqrt{25 - (-t + x)^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0d12495b-4284-4723-b2b6-986e9d86f35c"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SqrtBox[
        RowBox[{"25", "-", 
          SuperscriptBox[
           RowBox[{"(", 
             RowBox[{"-", 
               StyleBox["t", "TI"], "-", 
               StyleBox["x", "TI"]}], ")"}], "2"]}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sqrt{25 - (-t - x)^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84f4ac9b-fc81-42ab-a75a-0c16a1a4c21c"],
 " travel, and what conclusions can be drawn?"
}], "Text",
 CellChangeTimes->{{3.882982425577568*^9, 3.882982456962534*^9}, {
  3.88325034383858*^9, 3.883250355786714*^9}, {3.8832504396070538`*^9, 
  3.8832504414097137`*^9}, {3.883250496782816*^9, 3.883250497025174*^9}, {
  3.883250537781644*^9, 3.8832505714635878`*^9}, {3.883291497077868*^9, 
  3.883291512951836*^9}, {3.8832936268796988`*^9, 
  3.8832936312650843`*^9}},ExpressionUUID->"9f6c8290-ce5e-4462-9597-\
cdc0e58ca280"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"NonperiodicWave", "[", 
    SqrtBox[
     RowBox[{"25", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"t", "+", "x"}], ")"}], "2"]}]], "]"}], ",", 
   RowBox[{"NonperiodicWave", "[", 
    SqrtBox[
     RowBox[{"25", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "t"}], "+", "x"}], ")"}], "2"]}]], "]"}], ",", 
   RowBox[{"NonperiodicWave", "[", 
    SqrtBox[
     RowBox[{"25", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "t"}], "-", "x"}], ")"}], "2"]}]], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.8832723988306007`*^9, 3.883272464876501*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"e9b976d2-f44c-4517-9c52-1a1645ec3929"],

Cell[TextData[{
 "These three animations show that, when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "131e4ad4-1b1f-4dbd-9615-acd1bfc75924"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "737d1fb0-dcdc-4f6b-b896-bf340d83885d"],
 " are of the same sign, the wave travels in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "-x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cf14944f-966e-4fe7-8f75-bc3253587c8d"],
 " direction; when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a9246bc-150c-4ff7-92be-459175297bfa"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1ddd765b-a163-4cf0-a7b5-d8d9b1abd277"],
 " are of different signs, the wave travels in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "933ef835-bbfb-4712-9776-963dce936719"],
 " direction."
}], "CodeText",
 CellChangeTimes->{{3.88325119222546*^9, 3.883251273475222*^9}, {
  3.8832916500259113`*^9, 
  3.883291650161171*^9}},ExpressionUUID->"327e5488-60aa-4ee7-9253-\
df2cc911cff2"],

Cell[TextData[{
 " Indeed... (write about general rule). Now, test yourself: before running \
the animation, can you tell in which direction does ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        SuperscriptBox[
         StyleBox["e", "TI"], 
         RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                StyleBox["t", "TI"], "-", 
                StyleBox["x", "TI"]}], ")"}], "2"], "/", "2"}]], 
        SqrtBox[
         RowBox[{"2", "\[Pi]"}]]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{e^{-(t-x)^2 / 2}}{\\sqrt{2 \\pi}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7dfa0b7e-161b-4e8b-88f9-5fa94f0b35cb"],
 " travel?"
}], "Text",
 CellChangeTimes->{{3.883272257350122*^9, 3.883272264067555*^9}, {
  3.883272354496904*^9, 3.8832723780913687`*^9}, {3.883272523324225*^9, 
  3.883272609081224*^9}, {3.8832916623942337`*^9, 3.8832916918165073`*^9}, {
  3.8832936551710243`*^9, 
  3.883293669520515*^9}},ExpressionUUID->"94f84df5-72ce-4d03-b720-\
a24191d7a5b8"],

Cell[TextData[{
 StyleBox[" Since ", "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "bde541eb-1236-44d2-8ddc-1212927cf13f"], "CodeText"],
 StyleBox[" and ", "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "32315e6d-a300-4128-a64c-fe7f55d03d71"], "CodeText"],
 StyleBox[" are of different signs, the wave will travels in the ", 
  "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "8c567528-92a0-44b4-bf5c-d583b5a2f19d"], "CodeText"],
 StyleBox[" direction.", "CodeText"]
}], "Text",
 CellChangeTimes->{{3.883272627771563*^9, 3.883272631629867*^9}, {
  3.88327281779294*^9, 
  3.8832728509981956`*^9}},ExpressionUUID->"6e62e98f-2f34-4aa1-86c8-\
e8edc8eb2aaa"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"t", "-", "x"}], ")"}], "2"]}], "/", "2"}]], 
      SqrtBox[
       RowBox[{"2", "\[Pi]"}]]], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
     RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8832710551767797`*^9, 3.883271199905439*^9}, {
   3.883271469394185*^9, 3.883271509960067*^9}, {3.883273123238145*^9, 
   3.88327312561232*^9}, 3.883332343234693*^9},
 CellLabel->
  "In[832]:=",ExpressionUUID->"3172d5b9-0799-44f0-bc41-955fd961dd4d"],

Cell["\<\
It\[CloseCurlyQuote]s a nonperiodic traveling wave in the shape of a standard \
normal distribution.\
\>", "CodeText",
 CellChangeTimes->{{3.883272861588807*^9, 3.88327291018893*^9}, {
  3.883289689341133*^9, 3.883289701047792*^9}, {3.883291708778125*^9, 
  3.883291708933609*^9}},ExpressionUUID->"f2748720-68c4-4740-bf99-\
11c9eb9635e5"],

Cell[TextData[{
 "What happens if we introduce a new spatial variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2988990e-5941-49d5-a5f6-1cc6bb40d014"],
 "?"
}], "Text",
 CellChangeTimes->{{3.8832898369376707`*^9, 
  3.883289856239596*^9}},ExpressionUUID->"1419d4ca-6af9-44a4-8741-\
9a0528c4c918"],

Cell[BoxData[
 RowBox[{"Simple2DWave", "[", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"t", "-", "x", "-", "y"}], ")"}], "2"]}], "/", "2"}]], 
   SqrtBox[
    RowBox[{"2", "\[Pi]"}]]], "]"}]], "Input",
 CellChangeTimes->{{3.883273111654804*^9, 3.883273130348153*^9}},
 CellLabel->
  "In[833]:=",ExpressionUUID->"ca5352dc-e9cd-4576-bbfd-12cefd22e985"],

Cell[TextData[{
 "Is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{"0", ",", 
           OverscriptBox[
            StyleBox["y", "TI"], "^"], "10", "cos", 
           RowBox[{"(", 
             RowBox[{"0.6", "\[Pi]", 
               StyleBox["t", "TI"], "-", 
               StyleBox["x", "TI"]}], ")"}], ",", "0"}], ")"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "(0, \\hat{y} 10 \\cos(0.6 \\pi t - x), 0)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "defd56e4-d866-47be-9d17-de47e1a383b7"],
 " a wave?"
}], "Text",
 CellChangeTimes->{
  3.8831879972762423`*^9, {3.8832918854902267`*^9, 
   3.883291886383395*^9}},ExpressionUUID->"9a0377b0-1f30-4886-8e62-\
4c1b5250bf76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlaneWaveX", "[", "f_", "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "points", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xPoints", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "10", ",", "0.2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
               "RGBColorSwatchTemplate"], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "f"}], "}"}]}], "}"}], "/.", 
                RowBox[{"x", "->", "#"}]}], "]"}]}], "}"}], "&"}], "/@", 
           "xPoints"}], ",", 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87481312841113*^9, 3.874813187576598*^9}, {
   3.8748133742802677`*^9, 3.874813400136211*^9}, {3.874813624832747*^9, 
   3.874813626137238*^9}, {3.8748138220736723`*^9, 3.8748138282984133`*^9}, {
   3.874814542863482*^9, 3.8748145453422737`*^9}, {3.874817304386138*^9, 
   3.8748173065307407`*^9}, {3.874853062480942*^9, 3.874853099585367*^9}, {
   3.883272990564343*^9, 3.883272990790944*^9}, {3.883291914694256*^9, 
   3.883291931500575*^9}, {3.883293893424951*^9, 3.883293894298936*^9}, {
   3.883293944760756*^9, 3.883293965714501*^9}, {3.8832940679151297`*^9, 
   3.88329407148061*^9}, {3.88329517593246*^9, 3.88329520969704*^9}, {
   3.883296912537973*^9, 3.883296992654972*^9}, {3.883297023094643*^9, 
   3.883297024856845*^9}, {3.883297939171979*^9, 3.883297957591247*^9}, 
   3.8833323516884003`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"c608cd63-402e-4884-956c-d57a91918349"],

Cell[BoxData[
 RowBox[{"PlaneWaveX", "[", 
  RowBox[{"5", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", "x"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8832952158330717`*^9, 3.883295219023737*^9}, {
  3.8832969150190372`*^9, 3.8832969443579817`*^9}, {3.883297027660276*^9, 
  3.883297029164961*^9}, {3.883297941581305*^9, 3.883297962400099*^9}},
 CellLabel->
  "In[835]:=",ExpressionUUID->"50e8a2f7-3acb-484c-98b9-454a17bcefc8"],

Cell[TextData[{
 "Yes, this is a wave which propagates in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f9092f7d-1e0b-4ecd-970e-196dfa7c67c0"],
 " direction. What makes it different from the previous waves is that the \
propagating dynamic disturbance is a vector quantity. It is therefore a \
vector field with time dependency. Note that since this is a vector field, \
there is a vector associated with ",
 StyleBox["every point",
  FontSlant->"Italic"],
 " in space and the animation above only illustrations vectors along the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4e880896-2ea0-40eb-b199-09bd805f0d51"],
 " axis."
}], "CodeText",
 CellChangeTimes->{{3.883297046652607*^9, 3.8832970661283703`*^9}, {
  3.8832976721815863`*^9, 3.883297848432645*^9}, {3.883297911180582*^9, 
  3.883297927968878*^9}, {3.883297986720202*^9, 3.8832979912740726`*^9}, {
  3.8833009667507343`*^9, 3.8833009681763144`*^9}, {3.8833014348232613`*^9, 
  3.883301482675454*^9}, {3.88330167715501*^9, 3.88330172680389*^9}, {
  3.883301781807867*^9, 
  3.883301811755176*^9}},ExpressionUUID->"0ab0756c-493e-4644-931b-\
a62999f513c0"],

Cell["TODO: draw planes for the plane wave", "Text",
 CellChangeTimes->{{3.883301868976797*^9, 
  3.883301877950676*^9}},ExpressionUUID->"62ef9b03-c330-4253-8e78-\
ae081769f315"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wave Parameters and Phase Velocity", "Section",
 CellChangeTimes->{{3.8829826892772093`*^9, 3.882982720028886*^9}, {
   3.883016997117691*^9, 3.8830170190747833`*^9}, {3.8832508646015253`*^9, 
   3.883250865341786*^9}, 3.883327516748516*^9, {3.883373631278615*^9, 
   3.883373631611641*^9}, {3.883387970965898*^9, 3.883387982503338*^9}, {
   3.883390765180138*^9, 
   3.883390769496044*^9}},ExpressionUUID->"48b90859-e10d-42ef-bcc4-\
0a05bd152cb5"],

Cell[TextData[{
 "Play with the plot of the three functions ",
 Cell[BoxData[
  StyleBox[
   RowBox[{" ", 
    RowBox[{
     FormBox[
      TemplateBox[<|"boxes" -> FormBox[
          RowBox[{
            StyleBox["A", "TI"], "cos", 
            RowBox[{"(", 
              RowBox[{"\[Omega]", 
                StyleBox["t", "TI"], "-", "\[Phi]"}], ")"}]}], 
          TraditionalForm], "errors" -> {}, "input" -> 
        "A \\cos(\\omega t - \\phi)", "state" -> "Boxes"|>,
       "TeXAssistantTemplate"],
      TraditionalForm], ",", " ", 
     FormBox[
      TemplateBox[<|"boxes" -> FormBox[
          RowBox[{
            StyleBox["A", "TI"], "cos", 
            RowBox[{"(", 
              RowBox[{"\[Omega]", 
                StyleBox["t", "TI"]}], ")"}]}], TraditionalForm], 
        "errors" -> {}, "input" -> "A \\cos(\\omega t)", "state" -> "Boxes"|>,
       
       "TeXAssistantTemplate"],
      TraditionalForm], ",", " ", 
     FormBox[
      TemplateBox[<|"boxes" -> FormBox[
          RowBox[{
            StyleBox["A", "TI"], "cos", 
            RowBox[{"(", 
              RowBox[{"\[Omega]", 
                StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], 
          TraditionalForm], "errors" -> {}, "input" -> 
        "A \\cos(\\omega t + \\phi)", "state" -> "Boxes"|>,
       "TeXAssistantTemplate"],
      TraditionalForm], " "}]}],
   FontFamily->"Source Sans Pro"]],
  CellChangeTimes->{{3.874446492867127*^9, 3.874446542243617*^9}, {
    3.874475280266975*^9, 3.874475393864541*^9}, {3.874475427462351*^9, 
    3.874475465277158*^9}, {3.8744755287369957`*^9, 3.8744755307670403`*^9}, {
    3.874475747345578*^9, 3.8744757651380453`*^9}, 3.874475826559538*^9, 
    3.874476180988099*^9, {3.874476308876853*^9, 3.874476344513056*^9}, {
    3.874476427740789*^9, 3.874476466495263*^9}, {3.874476578982285*^9, 
    3.874476587921468*^9}, {3.874479784841647*^9, 3.8744797881267767`*^9}, {
    3.874479957001397*^9, 3.8744799632629137`*^9}, {3.874480012804679*^9, 
    3.874480045868064*^9}, {3.874503130335743*^9, 3.874503132321733*^9}, 
    3.874762907888976*^9, 3.874762942562207*^9},ExpressionUUID->
  "343a6ab8-6296-4a95-9c8d-710a35183142"],
 " below. What are the effects of changing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f9b8107-28ac-4856-b391-49e0fa4da0f6"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04554b67-3da5-4d46-8b8f-27d2c081c981"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c64711e9-dc60-4596-856f-9341b99bed81"],
 "?"
}], "Text",
 CellChangeTimes->{{3.8744514664902678`*^9, 3.8744515051215982`*^9}, {
   3.8744527056946077`*^9, 3.874452714734004*^9}, {3.874503106771893*^9, 
   3.874503116220725*^9}, {3.874503163600727*^9, 3.8745031966450853`*^9}, {
   3.8747628955345783`*^9, 3.874763063449749*^9}, 3.882979868377232*^9, {
   3.8832513959962587`*^9, 3.883251396599358*^9}, {3.8833262815449533`*^9, 
   3.88332628249481*^9}},ExpressionUUID->"2ab4306e-8430-45a3-a8b0-\
0b9c72b1573f"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Omega]", " ", "t"}], "-", "\[Phi]"}], "]"}]}], ",", 
       RowBox[{"A", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", 
       RowBox[{"A", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"-", "2"}], ",", "8"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "6"}], ",", "6"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"A\", \"TI\"], \"cos\", 
RowBox[{\"(\", 
RowBox[{\"\[Omega]\", 
StyleBox[\"t\", \"TI\"], \"-\", \"\[Phi]\"}], \")\"}]}], TraditionalForm], \
\"errors\" -> {}, \"input\" -> \"A \\\\cos(\\\\omega t - \\\\phi)\", \
\"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"A\", \"TI\"], \"cos\", 
RowBox[{\"(\", 
RowBox[{\"\[Omega]\", 
StyleBox[\"t\", \"TI\"]}], \")\"}]}], TraditionalForm], \"errors\" -> {}, \
\"input\" -> \"A \\\\cos(\\\\omega t)\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", ",", 
        "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"A\", \"TI\"], \"cos\", 
RowBox[{\"(\", 
RowBox[{\"\[Omega]\", 
StyleBox[\"t\", \"TI\"], \"+\", \"\[Phi]\"}], \")\"}]}], TraditionalForm], \
\"errors\" -> {}, \"input\" -> \"A \\\\cos(\\\\omega t + \\\\phi)\", \
\"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\""}], "}"}]}]}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "3"}], "}"}], ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "\[Pi]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.874296105541418*^9, 3.874296110938409*^9}, {
  3.87429834557596*^9, 3.874298381694831*^9}, {3.874298446099306*^9, 
  3.8742984727590103`*^9}, {3.874298548523573*^9, 3.87429862601134*^9}, {
  3.8742986793855963`*^9, 3.874298795937989*^9}, {3.874306285634481*^9, 
  3.874306287909874*^9}, {3.8744800537940407`*^9, 3.874480095123083*^9}, {
  3.875618517167951*^9, 3.875618554131749*^9}, {3.875621101469151*^9, 
  3.875621114534425*^9}, {3.8756214653588667`*^9, 3.8756214798304243`*^9}, {
  3.883375047554947*^9, 3.8833751039142714`*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"17e4eb15-9735-4cd6-bb5c-3699dcea82b8"],

Cell[TextData[{
 "1. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "41e4e38f-a722-4553-829d-2bb28620fd68"],
 ", or the amplitude, is the maximum absolute value of the signal. Since the \
signal is symmetric, it is also half of the peak-to-peak magnitude.\n2. The \
angular frequency ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Omega]", "\[LongEqual]", "2", "\[Pi]", 
         StyleBox["f", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega = 2 \\pi f", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75f82b4e-f248-43a2-b3e7-1e7d9a1dfc11"],
 " it determines how fast a wave oscillates. It has unit radians per second \
(rad/s).\n3. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6ed416bf-d779-47ca-b8c8-2948df10028c"],
 " represents a phase shift, called the ",
 StyleBox["reference phase",
  FontSlant->"Italic"],
 ": if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", ">", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi > 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7b515a78-63fd-431d-9318-0de61065c718"],
 ",  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cos", "(", 
         RowBox[{"\[Omega]", 
           StyleBox["t", "TI"], "-", "\[Phi]"}], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\cos(\\omega t - \\phi)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c7dbdc89-5a70-4e76-8c52-c05b79279166"],
 " is  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cos", "(", 
         RowBox[{"\[Omega]", 
           StyleBox["t", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\cos(\\omega t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce07b771-93fd-49ae-9712-c33d8d6f333f"],
 " shifted to the right by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fc4dfdc7-6132-4bbb-9702-2cc8aa79b798"],
 " radians and vice versa."
}], "CodeText",
 CellChangeTimes->{{3.874476618555208*^9, 3.8744767178161507`*^9}, {
   3.8744767632365*^9, 3.874476874322548*^9}, {3.874480127553218*^9, 
   3.874480200960617*^9}, {3.874815381216408*^9, 3.874815414936586*^9}, {
   3.87562125544847*^9, 3.875621287004374*^9}, {3.87562138088516*^9, 
   3.875621429582876*^9}, {3.875621501737405*^9, 3.8756215920881767`*^9}, {
   3.875621632956218*^9, 3.8756219916498537`*^9}, {3.875622069552206*^9, 
   3.8756220907215023`*^9}, {3.875622255659849*^9, 3.875622311318955*^9}, {
   3.8756225522439823`*^9, 3.875622555032977*^9}, {3.8829799146199303`*^9, 
   3.882979915890522*^9}, {3.883044221369688*^9, 3.883044222294217*^9}, {
   3.883250712375209*^9, 3.883250730684168*^9}, 3.883250831159321*^9, {
   3.883375283692443*^9, 3.883375287819745*^9}, {3.883377799131276*^9, 
   3.883377824635306*^9}, {3.88337839547928*^9, 3.8833784056249857`*^9}, {
   3.8833789516672163`*^9, 3.883378968149769*^9}, {3.883379327031539*^9, 
   3.8833793375034513`*^9}, {3.883379912884428*^9, 
   3.883379974785825*^9}},ExpressionUUID->"c1a9b28a-0011-427c-ba79-\
c550fe29ed5e"],

Cell["Do these waves have spatial variables?", "Text",
 CellChangeTimes->{{3.874476890354199*^9, 3.874476916761825*^9}, {
   3.874477001197687*^9, 3.8744770119537897`*^9}, {3.874477105602996*^9, 
   3.874477112841242*^9}, {3.87476316439222*^9, 3.874763191065771*^9}, {
   3.875623011946967*^9, 3.875623072703582*^9}, {3.88325084180101*^9, 
   3.8832508441213913`*^9}, 3.8833276720026484`*^9, {3.883328701255707*^9, 
   3.8833287049777412`*^9}, {3.883331273099354*^9, 3.883331387686892*^9}, {
   3.883331436901792*^9, 3.883331507834697*^9}, {3.883331694505512*^9, 
   3.883331795666078*^9}, {3.883332017487809*^9, 3.883332020079843*^9}, {
   3.883378008160924*^9, 3.88337801020348*^9}, {3.8833783392623997`*^9, 
   3.883378348472474*^9}, {3.883378383878866*^9, 3.883378410623436*^9}, {
   3.883378487631297*^9, 3.883378495688802*^9}, {3.883378535446259*^9, 
   3.883378540447874*^9}},ExpressionUUID->"5f789e45-013b-4377-aec2-\
6d651a5b36b4"],

Cell[TextData[{
 "No, they only have a time variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ad657d0d-9b13-4402-a091-60d003e1b4c3"],
 ". However, when we plot them statically instead of animations, we treat ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "93f5f468-ead0-4dea-bef1-0a2b0d18d8c1"],
 " as if it\[CloseCurlyQuote]s a spatial variable. "
}], "CodeText",
 CellChangeTimes->{{3.88337835423011*^9, 3.8833783604285*^9}, {
  3.883378503872491*^9, 3.883378544219741*^9}, {3.883378580102879*^9, 
  3.883378616471819*^9}},ExpressionUUID->"343a164e-67d7-4b65-a23a-\
7e9172d0544a"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s introduce one spatial variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3028b89a-2faf-4e6b-8d5d-8d93c9bd531d"],
 " with a multiplier ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "35b76630-e175-47ce-b801-686a2b020cd1"],
 "  to  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "f(t) = A \\cos(\\omega t + \\phi_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "164867a7-7c34-4d38-855e-9f5267994f23"],
 ". We get ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", 
             StyleBox["x", "TI"]}], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "-", "\[Beta]", 
             StyleBox["x", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "f(t, x) = A \\cos(\\omega t - \\beta x + \\phi_0)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "720fec6b-ad88-4e07-a7a5-509c2bab9794"],
 " (with a minus sign for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2c628316-b2f4-4679-a8fb-a3a083bb0787"],
 " to make the wave travel in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cd5e7ce3-0557-4a02-8094-f8be094876a2"],
 " direction). The angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{"\[Phi]", 
          RowBox[{"(", 
            RowBox[{
              StyleBox["x", "TI"], ",", 
              StyleBox["t", "TI"]}], ")"}], "\[LongEqual]", "\[Omega]", 
          StyleBox["t", "TI"], "-", "\[Beta]", 
          StyleBox["x", "TI"], "+", 
          SubscriptBox["\[Phi]", "0"]}], TraditionalForm], "errors" -> {}, 
      "input" -> "\\phi(x,t) = \\omega t - \\beta x + \\phi_0", "state" -> 
      "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "fa6fa7e4-a188-438e-b3cd-bf670ed1d9dd"],
 "is called the ",
 StyleBox["phase ",
  FontSlant->"Italic"],
 "of the wave (not to be confused with the ",
 StyleBox["reference phase",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Phi]", "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eafb964c-4769-4f60-976d-3b3a467d2858"],
 "), and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a469c34b-d955-4929-8acb-c8c8711ba64d"],
 " the ",
 StyleBox["phase constant. ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4c128882-2ca7-4347-a814-59f9591302d9"],
 " has unit radians per meter (rad/m).",
 StyleBox[" ",
  FontSlant->"Italic"],
 "Now, we have seen the effects of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bbffbfe1-9225-43a0-82cc-9e311064db8e"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9feb95e6-caf4-4fee-a93b-22d956d3d59b"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ecdeabd4-7046-4329-8601-2ea573963358"],
 ", what about ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b68df450-e7a0-415b-a6cb-6281dc2059b4"],
 "?"
}], "Text",
 CellChangeTimes->{
  3.8833316986372747`*^9, 3.883369140817649*^9, {3.883378337498892*^9, 
   3.883378344860856*^9}, {3.883378728322575*^9, 3.883378828425658*^9}, {
   3.8833788937612133`*^9, 3.883378896942308*^9}, 3.8833793641233873`*^9, {
   3.883379404012026*^9, 3.883379419824101*^9}, {3.883380182886042*^9, 
   3.883380244940332*^9}, {3.883380439848413*^9, 3.88338046612057*^9}, 
   3.883380609696959*^9, {3.883380655218143*^9, 3.883380668245503*^9}, {
   3.883380756437541*^9, 3.883380789170186*^9}, {3.883381597098844*^9, 
   3.8833815993786077`*^9}},ExpressionUUID->"38788031-89a8-41a5-9fda-\
162d4cae9d3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimpleWaveManipulateBeta", "[", "f_", "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
        RowBox[{"PointLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
            "RGBColorSwatchTemplate"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Beta]\>\"", ",", "\[Beta]"}], "}"}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8833321480650253`*^9, 3.883332199807687*^9}, 
   3.88333229782815*^9, {3.883332471288444*^9, 3.8833325118502274`*^9}, {
   3.8833325458067093`*^9, 3.883332704339673*^9}, {3.883332749448697*^9, 
   3.883332780177116*^9}, {3.883332895101746*^9, 3.883332938144738*^9}, {
   3.883332982428741*^9, 3.883332995951787*^9}, {3.883333044862423*^9, 
   3.883333047111722*^9}, {3.883333097679298*^9, 3.8833332912383432`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"cf06eb8f-7fb5-43d9-8aa4-0e3f2d8315cb"],

Cell[BoxData[
 RowBox[{"SimpleWaveManipulateBeta", "[", 
  RowBox[{"5", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", 
     RowBox[{"\[Beta]", " ", "x"}], "+", 
     FractionBox["\[Pi]", "4"]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883332210743622*^9, 3.8833322398974857`*^9}, {
  3.88338184677415*^9, 3.883381847018984*^9}},
 CellLabel->
  "In[838]:=",ExpressionUUID->"bb896f47-ffbb-413b-971a-69a71db74428"],

Cell[TextData[{
 "We can also see that as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dcd7e596-9b97-4f71-9b22-e4adca71476f"],
 " gets larger, the wavelength decreases."
}], "CodeText",
 CellChangeTimes->{{3.883333341805834*^9, 3.883333367910462*^9}, {
   3.883333399007551*^9, 3.883333473998796*^9}, {3.8833737295636053`*^9, 
   3.883373750822653*^9}, 3.883379643387027*^9, 
   3.883379884821266*^9},ExpressionUUID->"0c4542ec-b72a-43ec-9943-\
38febaf2ca89"],

Cell[TextData[{
 "Indeed, recall that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "57e69215-f63e-454c-99ab-25723e6908aa"],
 " has unit rad/m: rad represents the number of cycles, 1/m represents \
\[OpenCurlyDoubleQuote]per unit distance\[CloseCurlyDoubleQuote]. Together, \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "67531585-4bc0-48d8-86b9-2e9b7c1960de"],
 " represents the number of wave cycles per unit distance. We are all \
familiar with the angular frequency ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2fc62c63-5211-4b3c-9a43-1843babb1d9c"],
 " of a wave, then ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "28a6e76e-b11b-4be1-bad6-b4682c619e70"],
 " can be thought of as the angular frequency of the wave in space, i.e. \
spatial frequency."
}], "Text",
 CellChangeTimes->{{3.8833808182180233`*^9, 3.88338084460102*^9}, {
  3.883380952497093*^9, 3.88338101850583*^9}, {3.883381059815345*^9, 
  3.883381061784087*^9}, {3.88338113415285*^9, 3.883381276368022*^9}, {
  3.883381360975416*^9, 
  3.883381411479444*^9}},ExpressionUUID->"6ed171e5-e1a9-41af-8cf4-\
3ef0fc42149a"],

Cell[TextData[{
 "In other words, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4c92e2bf-65af-44ed-bb24-ece9e0982ad2"],
 " determines how fast the wave oscillates in time, while ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2cf319db-f458-443f-9c80-05b4ec5719f3"],
 " determines how fast the wave oscillates in space."
}], "CodeText",
 CellChangeTimes->{{3.8833814329288607`*^9, 
  3.8833814689913607`*^9}},ExpressionUUID->"f040d2c1-10d3-43af-b797-\
c09322282600"],

Cell["Exactly. (TODO: introduce wavenumber k).", "Text",
 CellChangeTimes->{{3.8833815064480543`*^9, 3.8833815095489273`*^9}, {
  3.883381541955621*^9, 
  3.883381549677908*^9}},ExpressionUUID->"c5695533-4e79-468b-b926-\
321fb56441ba"],

Cell[TextData[{
 "What else can you observe as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "585b9c15-8b8a-4a6a-a2bc-22451e992c4a"],
 " increases?"
}], "Text",
 CellChangeTimes->{{3.8833797421011047`*^9, 
  3.883379758393629*^9}},ExpressionUUID->"e114d69b-90d6-4303-b036-\
3b7898630fd4"],

Cell[TextData[{
 "The wave appears to travel a bit slower as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ef5146de-d6d9-4472-bd8a-fce15356e73e"],
 " increases. If we focus on a point of \[OpenCurlyDoubleQuote]fixed height\
\[CloseCurlyDoubleQuote] on the wave, we can see that it travels at a \
constant velocity for a given ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfa0ed97-fedc-4202-a563-3d721d7ad987"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.883379648078953*^9, 3.883379668259959*^9}, {
  3.8833797610789137`*^9, 3.883379762120726*^9}, {3.8833822142988987`*^9, 
  3.883382267060117*^9}},ExpressionUUID->"e5f46611-d3dd-4ea6-bc0f-\
a6f4dcaabbe9"],

Cell[TextData[{
 "Yes, recall that the angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Phi]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["t", "TI"]}], ")"}], "\[LongEqual]", "\[Omega]", 
         StyleBox["t", "TI"], "-", "\[Beta]", 
         StyleBox["x", "TI"], "+", 
         SubscriptBox["\[Phi]", "0"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\phi(x,t) = \\omega t - \\beta x + \\phi_0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba014fe0-8042-4cb9-a7aa-e2c9ae2c769a"],
 " is referred to as the ",
 StyleBox["phase",
  FontSlant->"Italic"],
 " of the wave",
 " and a fixed phase corresponds to a \[OpenCurlyDoubleQuote]fixed height\
\[CloseCurlyDoubleQuote] of the wave, we call this velocity the ",
 StyleBox["phase velocity",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["u", "TI"], 
        StyleBox["p", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "u_p", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69a8233e-6503-454e-b080-e8d3be3cd3e7"],
 ". Now, the phase velocity ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["u", "TI"], 
        StyleBox["p", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "u_p", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "19443749-bbc2-4e71-b70f-dba9c94909be"],
 " does not only depend on the phase constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c1817f11-25e4-4edb-8a75-2e35f8952146"],
 ", it also depends on the angular frequency ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c1f22c2b-0f65-45e4-86d0-ae682994deb1"],
 ". In fact, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["u", "TI"], 
          StyleBox["p", "TI"]], "\[LongEqual]", 
         FractionBox["\[Omega]", "\[Beta]"]}], TraditionalForm], 
     "errors" -> {}, "input" -> "u_p = \\frac{\\omega}{\\beta}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51775a90-0056-4d51-9adf-a1f95e4e32e8"],
 ". Let\[CloseCurlyQuote]s verify this:"
}], "Text",
 CellChangeTimes->{{3.874503892685173*^9, 3.874503956392056*^9}, 
   3.874503994162491*^9, {3.874504073884304*^9, 3.8745040807007217`*^9}, 
   3.874815065115641*^9, 3.874815290144812*^9, {3.8748154651094027`*^9, 
   3.8748155399877443`*^9}, {3.874815600169527*^9, 3.8748157548728743`*^9}, {
   3.8748161629648943`*^9, 3.874816205217824*^9}, {3.874816275797491*^9, 
   3.874816305914501*^9}, {3.874817556251886*^9, 3.874817640854251*^9}, {
   3.874817947510789*^9, 3.8748179623686743`*^9}, 3.874818134974421*^9, {
   3.874818251499357*^9, 3.874818282361335*^9}, {3.8748184119342327`*^9, 
   3.874818499887829*^9}, {3.874818536534737*^9, 3.874818583904952*^9}, {
   3.883373816620007*^9, 3.883373817625112*^9}, {3.8833781095584927`*^9, 
   3.883378141617078*^9}, {3.883381564870387*^9, 3.883381667796583*^9}, {
   3.88338235221844*^9, 
   3.883382443344434*^9}},ExpressionUUID->"987b511a-7f52-4692-a4e4-\
517a3f793de4"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Animate", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"5", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Omega]", " ", "t"}], "-", 
          RowBox[{"\[Beta]", " ", "x"}], "+", 
          FractionBox["\[Pi]", "4"]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "11"}], ",", "11"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"0.2", "\[Pi]"}], ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "1"}], "}"}], ",", 
     RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8744169864423313`*^9, 3.8744170515298023`*^9}, {
  3.87450212541355*^9, 3.874502136082315*^9}, {3.874502167734356*^9, 
  3.8745022249999523`*^9}, {3.874502318419477*^9, 3.8745023392741203`*^9}, {
  3.874502400585403*^9, 3.874502429821273*^9}, {3.874502579219803*^9, 
  3.8745026805132637`*^9}, {3.874503612905961*^9, 3.8745036383342457`*^9}, {
  3.8748139437146997`*^9, 3.874813956790719*^9}, {3.874814608331728*^9, 
  3.874814643755045*^9}, {3.874815781798077*^9, 3.874815803278479*^9}, {
  3.874817649054998*^9, 3.874817649420911*^9}, {3.874817704012143*^9, 
  3.874817709382051*^9}, {3.8756261909276342`*^9, 3.875626194495529*^9}, {
  3.883373347772562*^9, 3.883373348400075*^9}, {3.883373514690654*^9, 
  3.883373516936599*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"af823c6a-feb9-4be3-addd-e73d1e11c8bc"],

Cell[TextData[{
 "Indeed ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "efabb42e-7bd0-47ba-88b6-50d39fbe0e2d"],
 " controls time frequency (i.e. period ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["T", "TI"], TraditionalForm], "errors" -> {}, "input" -> "T", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa038ffb-42ba-4ba0-92b1-e199885004de"],
 ") while ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7ab17adc-fa35-4a04-8b0b-2deb79dfe1b5"],
 " controls the spatial frequency (i.e. wavelength ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Lambda]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\lambda", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f46270d5-f1e2-45c5-8e1d-3633a73f2c88"],
 ")."
}], "CodeText",
 CellChangeTimes->{{3.883388019572795*^9, 3.8833880682031107`*^9}, {
  3.8833885694148607`*^9, 
  3.883388634019206*^9}},ExpressionUUID->"9dfe774a-15b8-4ea4-b080-\
29466cb7c3a3"],

Cell[TextData[{
 "Recall that when plotting  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "f(t) = A \\cos(\\omega t + \\phi_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "082b2170-c047-4975-b412-1ef52dc60245"],
 ", we treated ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bb1c952-c17a-49f3-a8e5-8b61efef0111"],
 " as a spatial variable. We can do the same to  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["t", "TI"], ",", 
             StyleBox["x", "TI"]}], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "-", "\[Beta]", 
             StyleBox["x", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "f(t, x) = A \\cos(\\omega t - \\beta x + \\phi_0)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "682457ab-0b9b-4231-b586-429f5c04f347"],
 ". Try it out."
}], "Text",
 CellChangeTimes->{{3.883388666043961*^9, 3.8833886755102177`*^9}, {
  3.883388853884103*^9, 
  3.883388892416613*^9}},ExpressionUUID->"7f47d148-4537-489e-a293-\
3645d5245c54"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], "(", 
         RowBox[{
           StyleBox["t", "TI"], ",", 
           StyleBox["x", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "f(t, x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "22bbf54e-4820-4468-b371-a3e4b96b06cf"],
 " is a function of two real variables, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ca4bd5bd-932c-4a91-90fd-3d40f5dd56c0"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b8d0736d-d20a-41e7-981f-4fa4d0f3253a"],
 ". The output ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce30baa8-9446-48bd-a845-c82d40b5d495"],
 " is also real. You could say it\[CloseCurlyQuote]s a mapping from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["R", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "R^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "62bedb76-d84e-4b21-862f-3ccadae04beb"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["R", "TI"], TraditionalForm], "errors" -> {}, "input" -> "R", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "628d8855-a2b0-4f55-966f-4d40ce658097"],
 ", therefore it can be thought of a two dimensional scalar field. The \
typical way is to visualize ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["R", "TI"], "2"], "\[Rule]", 
         StyleBox["R", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "R^2 \\rightarrow R", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "284f04a9-d810-4eeb-91fa-0748dba33f67"],
 " as some kind of surface, such that the output ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["R", "TI"], TraditionalForm], "errors" -> {}, "input" -> "R", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e89ae5f4-7a0b-4c2d-bd88-e20d92f5e8e8"],
 " represents the \[OpenCurlyDoubleQuote]altitude\[CloseCurlyDoubleQuote] \
above the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["R", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "R^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0524e7b6-d9f6-4ded-b416-b8f364d8b490"],
 " plane (the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "xt", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "11ebadf6-b95e-47a0-8b80-b15cd9d679ae"],
 " plane)."
}], "CodeText",
 CellChangeTimes->{{3.874486380842909*^9, 3.874486403203927*^9}, {
  3.874486697617486*^9, 3.8744867768123426`*^9}, {3.883331534740933*^9, 
  3.8833315742414427`*^9}, {3.88338258014091*^9, 3.883382585454514*^9}, {
  3.883388907175302*^9, 
  3.8833889487907343`*^9}},ExpressionUUID->"0f80dc87-83ff-4850-9d54-\
74633838ae82"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"5", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Omega]", " ", "t"}], "-", 
        RowBox[{"\[Beta]", " ", "x"}], "+", 
        FractionBox["\[Pi]", "4"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", ",", "\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], 
     ",", 
     RowBox[{"MaxRecursion", "->", "4"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"0.2", "\[Pi]"}], ",", 
     RowBox[{"0.6", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874493672227848*^9, 3.874493674939864*^9}, {
  3.87450142394312*^9, 3.874501439854319*^9}, {3.874800545461685*^9, 
  3.874800565892709*^9}, {3.874800615271649*^9, 3.874800615444273*^9}, {
  3.874800647605526*^9, 3.874800647760219*^9}, {3.8748007694256163`*^9, 
  3.8748007859857607`*^9}, {3.874812502971732*^9, 3.874812503565909*^9}, {
  3.874812650358098*^9, 3.874812680391945*^9}, {3.874814219678915*^9, 
  3.874814234461999*^9}, {3.87481434091535*^9, 3.874814344828392*^9}, {
  3.8748166859907827`*^9, 3.87481668617208*^9}, {3.874817225270361*^9, 
  3.8748172261128483`*^9}, {3.8748529584539022`*^9, 3.874852962758491*^9}, {
  3.874853004079072*^9, 3.874853023043528*^9}, {3.8833826344215593`*^9, 
  3.8833826353768682`*^9}, {3.88338670874507*^9, 3.8833867200480633`*^9}, {
  3.883388984178097*^9, 3.883388991559209*^9}, {3.883462085111642*^9, 
  3.883462087784803*^9}},
 CellLabel->
  "In[840]:=",ExpressionUUID->"b6bf1ff5-8e97-4b9a-a1c2-53308bf4f726"],

Cell[TextData[{
 StyleBox["Think of the wave along the ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "Text",ExpressionUUID->
  "6369a316-6931-40fb-ba6b-527376b9ab3e"], "Text"],
 StyleBox[" axis at a given time by holding ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "Text",ExpressionUUID->
  "5fd748f0-f405-4bf9-91b1-eb34a55862d9"], "Text"],
 StyleBox[" constant and \[OpenCurlyDoubleQuote]slice through\
\[CloseCurlyDoubleQuote] the surface at a right angle. Moving the slice \
back-and-forth along ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "Text",ExpressionUUID->
  "13a2b4b6-7dc8-4ac0-9492-a24abafba140"], "Text"],
 StyleBox[" allows the wave to travel. How does ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "Text",ExpressionUUID->
  "d7fde219-f13d-4cb1-b960-02fd6a76b743"], "Text"],
 StyleBox[" and ", "Text"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "Text",ExpressionUUID->
  "889591e9-73c2-4d4f-ad2c-9916128ce836"], "Text"],
 StyleBox[" control this surface?", "Text"]
}], "Text",
 CellChangeTimes->{{3.883389719041875*^9, 
  3.883389735428195*^9}},ExpressionUUID->"a4720737-47d6-4c67-87bc-\
a4ea6793f5fa"],

Cell[TextData[{
 "A larger ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8becca06-3b24-40c8-a7b1-292d2a2558ea"],
 " corresponds to a smaller wavelength along  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "98baf7a5-fee0-4610-ac69-c10da78c7261"],
 " (and hence higher spatial frequency), and a larger ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4105f25b-a04b-4eb8-a160-cf161ee1fcd0"],
 " corresponds to a smaller wavelength along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e2e51f7a-5ac2-417b-980f-0ac587925684"],
 " (and hence higher time frequency). The wavelength along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3cd34a9e-8fd7-4188-a53e-fe044bda8efa"],
 " is known as the period ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["T", "TI"], TraditionalForm], "errors" -> {}, "input" -> "T", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ebe21e92-a54a-4e7b-b1b9-dd5489bc000c"],
 "."
}], "CodeText",
 CellChangeTimes->{
  3.883389653531217*^9, {3.883389765727797*^9, 
   3.883389830196265*^9}},ExpressionUUID->"4c824393-ddd3-4802-8b8a-\
c2158f8a8bc2"],

Cell[TextData[{
 "Now, as we discussed, the phase velocity is the velocity of a point on the \
wave with a constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7dd75d08-68fa-4183-af63-f79a1aa6cd76"],
 ". In the 3D plot, a constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3e53e379-290c-4c9c-a0c9-20c59a7838a6"],
 " is a plane \[OpenCurlyDoubleQuote]slicing through\[CloseCurlyDoubleQuote] \
this surface. If we take multiple constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f42df93-f44c-471a-89fa-dd0a67d5e39f"],
 " values, we get a contour plot:"
}], "Text",
 CellChangeTimes->{{3.883150393175465*^9, 3.883150433769279*^9}, {
  3.883389902900085*^9, 
  3.883389969948675*^9}},ExpressionUUID->"c2e29fa9-3eb8-49b3-a59d-\
1a537462807c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{"5", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"\[Omega]", " ", "t"}], "-", 
        RowBox[{"\[Beta]", " ", "x"}], "+", 
        FractionBox["\[Pi]", "4"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
     RowBox[{"Frame", "->", "False"}], ",", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"0.2", "\[Pi]"}], ",", 
     RowBox[{"0.6", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.88314784169133*^9, 3.883147863763198*^9}, {
   3.8831479300983143`*^9, 3.883147945574952*^9}, {3.883148100939547*^9, 
   3.88314810495826*^9}, {3.883382679643242*^9, 3.883382710557425*^9}, 
   3.883382773605867*^9, {3.8833867010347023`*^9, 3.883386729782919*^9}, {
   3.8833868148863564`*^9, 3.883386829813725*^9}, {3.8834619512595787`*^9, 
   3.883461955553588*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"e3f55493-5e70-4cc6-a8e1-8017d3172838"],

Cell[TextData[{
 "Here the horizontal axis is time ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["t", "TI"], TraditionalForm], "errors" -> {}, "input" -> "t", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cce46ec7-35ac-48f1-af2d-4f2bbf5a0d94"],
 " and the vertical axis is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f4c0e4f2-b2e8-43c8-8210-1717c3915a26"],
 ". What does the slope of the straight contour lines represent?"
}], "Text",
 CellChangeTimes->{{3.88339009119237*^9, 
  3.883390165433631*^9}},ExpressionUUID->"93724d59-e7a3-4281-b676-\
c81ca4645a4b"],

Cell[TextData[{
 "The slope is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          StyleBox["d", "TI"], 
          StyleBox["x", "TI"]}], 
        RowBox[{
          StyleBox["d", "TI"], 
          StyleBox["t", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{dx}{dt}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e5ec0094-d41c-4f6f-964b-e127263aa12b"],
 ", which is just the phase velocity. It\[CloseCurlyQuote]s now obvious that \
every point on this wave has the same phase velocity."
}], "CodeText",
 CellChangeTimes->{{3.883390172395406*^9, 3.883390174400021*^9}, {
  3.8833902257233973`*^9, 
  3.883390305976749*^9}},ExpressionUUID->"5bdd1c7c-e5bd-4e92-b637-\
810bfd12e7bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Waves and Phasors", "Section",
 CellChangeTimes->{{3.874484202912545*^9, 3.874484203804782*^9}, {
   3.8829827326811733`*^9, 3.882982734241892*^9}, 
   3.883017026237199*^9},ExpressionUUID->"241ce77d-e96a-463f-ada8-\
f1f5425c879f"],

Cell[TextData[{
 "Convert an ",
 StyleBox["instantaneous function",
  FontSlant->"Italic"],
 "  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A \\cos(\\omega t + \\phi)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d90018db-e844-43b1-8dab-1728eb31f011"],
 " into its phasor form."
}], "Text",
 CellChangeTimes->{{3.883016964791295*^9, 3.88301697372587*^9}, {
  3.883017042313344*^9, 3.883017065979363*^9}, {3.883326355457707*^9, 
  3.883326356916368*^9}},ExpressionUUID->"cbd87819-9958-44d5-b0ff-\
74b35bcbbad7"],

Cell[TextData[{
 "We drop the time dependency ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Omega]", 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega t", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "92394085-f3bc-4e4e-be6b-264fca32a8fd"],
 " and write ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "\[Phi]"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A e^{j \\phi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a29174d-c870-4982-9563-d5a05e730eeb"],
 " \[LongDash] the amplitude ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "735874d9-3d2e-42e6-bdf8-b396d87fc1e2"],
 " and the reference phase ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95c4774a-444b-4abc-956e-9b598cb6d00e"],
 " are preserved."
}], "CodeText",
 CellChangeTimes->{{3.874478758970319*^9, 3.8744787729626417`*^9}, {
   3.874478976625461*^9, 3.8744791046541767`*^9}, {3.875622828879924*^9, 
   3.875622856421069*^9}, 3.882982747232793*^9, {3.883016981063938*^9, 
   3.883016981064073*^9}, {3.883017056065982*^9, 3.8830170701641417`*^9}, {
   3.8832509476302643`*^9, 
   3.8832509678158827`*^9}},ExpressionUUID->"1ad9b6dd-55ac-4558-b57e-\
be4f6a956cd0"],

Cell["\<\
Indeed the time dependency is dropped \[LongDash] the phasor is a \
time-invariant entity. Now, convert the phasor back into an instantaneous \
function.\
\>", "Text",
 CellChangeTimes->{{3.8744509820811167`*^9, 3.8744510043454933`*^9}, {
  3.874479112952684*^9, 3.874479170056922*^9}, {3.8744792950086727`*^9, 
  3.874479381101026*^9}, {3.874479641834714*^9, 3.8744796435323544`*^9}, {
  3.875623794464369*^9, 3.875623795146646*^9}, {3.882982783588773*^9, 
  3.8829827934603233`*^9}, {3.8833263373833723`*^9, 3.883326338666925*^9}, {
  3.883326369132058*^9, 3.8833263718660507`*^9}, {3.883391649594541*^9, 
  3.88339166266886*^9}},ExpressionUUID->"c4cf1078-9013-410d-9c2d-\
a8d06f086384"],

Cell[TextData[{
 "We multiple by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "\[Omega]", 
          StyleBox["t", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{j \\omega t{", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "53825e25-4768-42a0-8084-64261f2db96e"],
 " and take the real part, as in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[GothicCapitalR]", 
         RowBox[{"[", 
           RowBox[{
             StyleBox["A", "TI"], 
             SuperscriptBox[
              StyleBox["e", "TI"], 
              RowBox[{
                StyleBox["j", "TI"], "\[Phi]"}]], 
             SuperscriptBox[
              StyleBox["e", "TI"], 
              RowBox[{
                StyleBox["j", "TI"], "\[Omega]", 
                StyleBox["t", "TI"]}]]}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Re[A e^{j \\phi} e^{j \\omega t]", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "58d9665d-89bf-4ae7-ac43-d1c4ac6dabaa"],
 ". For example:"
}], "CodeText",
 CellChangeTimes->{{3.8744510357296247`*^9, 3.8744510595320168`*^9}, {
  3.874451182183465*^9, 3.874451184912477*^9}, {3.874451368753702*^9, 
  3.874451372590032*^9}, {3.874479415054448*^9, 3.8744794491611423`*^9}, {
  3.874479537128873*^9, 3.874479543332239*^9}, {3.874480294723444*^9, 
  3.8744802952798767`*^9}, {3.8833264146424513`*^9, 
  3.8833264166622066`*^9}},ExpressionUUID->"2148ea88-7fbf-42fb-a8b0-\
03dd8a41fb3f"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{"5", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "\[Phi]"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8744146073457747`*^9, 3.87441461018643*^9}, {
   3.8744147720240183`*^9, 3.874414776535624*^9}, {3.8744149084718237`*^9, 
   3.874414914213512*^9}, {3.8744151653594513`*^9, 3.874415169399619*^9}, 
   3.874451070041679*^9, {3.874560589688505*^9, 3.8745605951518803`*^9}, {
   3.8833263924093323`*^9, 3.8833263928396177`*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"2c2b1f13-4da3-4dc7-8eef-a5c03660d541"],

Cell[TextData[{
 "Convert a sine function like ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "sin", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A \\sin(\\omega t + \\phi)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ee43989a-35e0-4776-879c-f4e27a65d7ff"],
 "  into a phasor."
}], "Text",
 CellChangeTimes->{{3.874480329293923*^9, 3.874480389180028*^9}, {
  3.874560619679675*^9, 3.8745606679428663`*^9}, {3.883391677393615*^9, 
  3.88339170340446*^9}},ExpressionUUID->"5ab47651-6ca3-4cd7-9722-\
ef9f092f791a"],

Cell[TextData[{
 "First, convert it to cosine. If we didn\[CloseCurlyQuote]t do so, since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], 
            StyleBox["x", "TI"]}]], "\[LongEqual]", "cos", 
         StyleBox["x", "TI"], "+", 
         StyleBox["i", "TI"], "sin", 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{i x} = \\cos{x} + i \\sin{x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "89abb1f4-5fdd-458d-9e6f-12deeeac46cd"],
 ", it would just vanish when you convert the phasor back by taking the real \
part! So we should use the property ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         StyleBox["x", "TI"], "\[LongEqual]", "cos", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], "-", "\[Pi]", "/", "2"}], ")"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\sin{x} = \\cos(x - \\pi/2)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6b444684-73e5-463f-bc34-c1b6a588437c"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.874480867974098*^9, 3.874480919900957*^9}, {
  3.8744809591436253`*^9, 3.874481007782174*^9}, {3.874481173137609*^9, 
  3.8744811901992407`*^9}, {3.8744815766082897`*^9, 3.8744815815779543`*^9}, {
  3.8833264302612343`*^9, 3.883326430942734*^9}, {3.8833917150580807`*^9, 
  3.883391715546173*^9}},ExpressionUUID->"961b1f88-7c3c-4ec9-a0d4-\
e519bbd71ee5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   RowBox[{
    RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], "==", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]", "-", 
    FractionBox["\[Pi]", "2"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.874481584945665*^9, 3.8744816942214317`*^9}, 
   3.875628581764629*^9},
 CellLabel->
  "In[843]:=",ExpressionUUID->"194883a7-eb77-4e39-8efd-920cf3c6c1f3"],

Cell[TextData[{
 "The phasor of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "sin", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A \\sin(\\omega t + \\phi)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2c61edd2-a72c-4f49-8408-127e67e2c353"],
 " is  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"\[Phi]", "-", "\[Pi]", "/", "2"}], ")"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> "A e^{j (\\phi-\\pi/2)}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "064e4435-b070-4f97-83db-a514891f7e78"],
 ". To verify:"
}], "CodeText",
 CellChangeTimes->{{3.874481869970044*^9, 3.8744819038639107`*^9}, {
  3.883391737353053*^9, 
  3.883391791053389*^9}},ExpressionUUID->"7e70a0ac-595d-4366-af0b-\
6579691ea073"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{
    SubscriptBox["V", "0"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      RowBox[{"(", 
       RowBox[{"\[Phi]", "-", 
        FractionBox["\[Pi]", "2"]}], ")"}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.874481719148574*^9, 3.874481759463056*^9}, {
  3.8744818035528708`*^9, 3.874481815584543*^9}, {3.874560680008806*^9, 
  3.8745606844068813`*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"885f41f5-0586-45f6-b32a-6a218677192b"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s worth remembering this result, that the phasor of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "sin", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A \\sin(\\omega t + \\phi)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "58ebed02-6dd4-4534-9ae6-60d2e73bbc5d"],
 "  is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"\[Phi]", "-", "\[Pi]", "/", "2"}], ")"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> "A e^{j (\\phi-\\pi/2)}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e5cd52d0-303c-4d4d-b6ff-a3924e010c13"],
 ". When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Phi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\phi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3f2fbd4e-4310-4145-8a99-a4b23afc750e"],
 " is 0, the phasor of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "sin", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"]}], ")"}]}], TraditionalForm], "errors" -> {},
      "input" -> "A \\sin(\\omega t)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f1e02820-425a-4247-9d93-b0a8a902a7b7"],
 "  is just ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], "\[Pi]", "/", "2"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A e^{- j \\pi/2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "479422bc-07f1-4f57-87b2-ac7b6fa20de8"],
 ". Now, the phasor can be very handy for many reasons. For example, taking \
the derivative of a sinusoidal instantaneous function against time is \
equivalent to multiplying its phasor by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["j", "TI"], "\[Omega]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "j \\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a1934424-578f-483e-a871-fffeeed457ae"],
 ", while doing integration of a sinusoidal instantaneous function against \
time is equivalent to dividing its phasor by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["j", "TI"], "\[Omega]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "j \\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "89e66882-1e83-4d36-89b2-fffbe4067312"],
 ". In other words, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          StyleBox["d", "TI"], 
          RowBox[{
            StyleBox["d", "TI"], 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "(", 
             StyleBox["t", "TI"], ")"}], ")"}], "\[LongEqual]", 
         StyleBox["j", "TI"], "\[Omega]", 
         OverscriptBox[
          StyleBox["Z", "TI"], "~"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{d}{dt}(z(t)) = j \\omega \\tilde{Z}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "08e12208-63fa-4ce4-a99b-db35cdaed134"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Integral]", 
         RowBox[{
           StyleBox["z", "TI"], "(", 
           StyleBox["t", "TI"], ")"}], 
         StyleBox["d", "TI"], 
         StyleBox["t", "TI"], "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["j", "TI"], "\[Omega]"}]], 
         OverscriptBox[
          StyleBox["Z", "TI"], "~"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\int{z(t)}dt = \\frac{1}{j \\omega}\\tilde{Z}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "310de780-1e7b-4aa0-b219-cf0f0a2a71de"],
 ". Verify this."
}], "Text",
 CellChangeTimes->{{3.874482519486471*^9, 3.874482623774472*^9}, {
   3.8744826592593603`*^9, 3.874482684492635*^9}, 3.874482840888274*^9, {
   3.8744828850015917`*^9, 3.8744831436015*^9}, {3.874483331779489*^9, 
   3.874483336718642*^9}, {3.8744833793180313`*^9, 3.874483384103839*^9}, {
   3.8745691094792557`*^9, 3.874569136050087*^9}, {3.8756269728654203`*^9, 
   3.875626991925034*^9}, {3.883017138686976*^9, 3.8830171393355093`*^9}, {
   3.883326478724283*^9, 3.883326482589922*^9}, {3.883391832039009*^9, 
   3.88339184394582*^9}},ExpressionUUID->"2886fb01-e2d4-49d7-9a4f-\
a591820e5117"],

Cell[TextData[{
 "I guess we could work backwards, i.e. start with a phasor, then convert it \
to the  instantaneous function after multiplying or dividing by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["j", "TI"], "\[Omega]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "j \\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d5c2e2e2-341a-473a-809f-fdde09eee57f"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.8744850747540483`*^9, 
  3.874485176189282*^9}},ExpressionUUID->"933ab843-fc91-4764-a36a-\
66258dd4a5e3"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "A", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      RowBox[{"(", 
       RowBox[{"\[Phi]", "-", 
        FractionBox["\[Pi]", "2"]}], ")"}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8744852127332907`*^9, 3.874485220468986*^9}, {
  3.874560705901924*^9, 3.874560710214574*^9}, {3.883391857809819*^9, 
  3.883391859379937*^9}},
 CellLabel->
  "In[845]:=",ExpressionUUID->"c610964f-67aa-4fac-8704-f3e14be434ea"],

Cell[TextData[{
 "since we know ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          StyleBox["d", "TI"], 
          RowBox[{
            StyleBox["d", "TI"], 
            StyleBox["t", "TI"]}]], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["A", "TI"], "sin", 
             RowBox[{"(", 
               RowBox[{"\[Omega]", 
                 StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], ")"}], 
         "\[LongEqual]", 
         StyleBox["A", "TI"], "\[Omega]", "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{d}{dt}(A \\sin(\\omega t + \\phi)) = A \\omega \\cos(\\omega t + \
\\phi)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b4ec5b78-07c2-469b-917f-dc99b8573f94"],
 ". Likewise:"
}], "CodeText",
 CellChangeTimes->{{3.8756235444287977`*^9, 3.875623550295849*^9}, {
  3.875623630278739*^9, 
  3.875623633422955*^9}},ExpressionUUID->"bab3e504-c82a-4ee4-ac8a-\
bc562a0b5553"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"A", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Phi]", "-", 
          FractionBox["\[Pi]", "2"]}], ")"}]}]]}], 
     RowBox[{"\[ImaginaryJ]", " ", "\[Omega]"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.874485260181138*^9, 3.874485272292535*^9}, {
  3.874485324252627*^9, 3.8744853290753736`*^9}, {3.874485389147255*^9, 
  3.8744854056424*^9}, {3.8744854363713493`*^9, 3.87448545040939*^9}, {
  3.874560715307679*^9, 3.874560720127191*^9}, {3.883391875035108*^9, 
  3.8833918763325367`*^9}},
 CellLabel->
  "In[846]:=",ExpressionUUID->"8f135b83-5d90-4bbd-afa9-77c67dbb5a49"],

Cell[TextData[{
 "To convert spatial waves into phasors, the same procedure is used. Try to \
convert ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", "cos", 
         RowBox[{"(", 
           RowBox[{"0.6", "\[Pi]", 
             StyleBox["t", "TI"], "-", "2", 
             StyleBox["x", "TI"], "+", 
             FractionBox["\[Pi]", "4"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "5 \\cos(0.6 \\pi t - 2x + \\frac{\\pi}{4})", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3d363c76-ddf1-4ae6-9bd0-3f210d822711"],
 " into a phasor and plot it."
}], "Text",
 CellChangeTimes->{{3.883392062516767*^9, 
  3.8833921424274263`*^9}},ExpressionUUID->"02f4a5fc-186c-40f9-b9f2-\
3aa62215eef9"],

Cell[TextData[{
 "We simply drop the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Omega]", 
         StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega t", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fc7b655c-d91f-44e7-b6e8-d3197d8d6cff"],
 " and write ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "5 e^{j(-2x + \\frac{\\pi}{4})}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "920c2df6-089b-4c37-9435-4cabc968d686"],
 ".  To convert the phasor back to its instantaneous counterpart, we bring \
the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{"\[Omega]", 
          StyleBox["t", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
      "\\omega t", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "e3c5029e-fb7d-4c69-8535-f24e3e074f1e"],
 " back by multiplying it with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "\[Omega]", 
          StyleBox["t", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{j \\omega t}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "16c0a52d-87d4-4a3d-a96b-a6bd39627473"],
 ".  Here, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Omega]", "\[LongEqual]", "0.6", "\[Pi]"}], TraditionalForm],
      "errors" -> {}, "input" -> "\\omega = 0.6 \\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "32fdf5e3-2f43-4ccd-9357-43f37599c607"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.874504098433182*^9, 3.874504117013356*^9}, {
   3.874504197329474*^9, 3.874504212764469*^9}, 3.874504263027815*^9, {
   3.8745045495945187`*^9, 3.874504565921783*^9}, {3.874537786560248*^9, 
   3.8745378966745043`*^9}, {3.874814098607792*^9, 3.874814099912374*^9}, {
   3.875626670516047*^9, 3.875626723352508*^9}, {3.875627122133273*^9, 
   3.875627122652227*^9}, 
   3.883373888075275*^9},ExpressionUUID->"14c0d235-cd0c-4d5b-8b66-\
63ce348861d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimpleWavePhasor", "[", "p_", "]"}], ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"p", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
       RowBox[{"\[Omega]", "->", 
        RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883392252952663*^9, 3.8833923227592793`*^9}, {
  3.883392366504965*^9, 3.88339236929501*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"c9160027-a7b6-4b0a-868d-a4520f963e63"],

Cell[BoxData[
 RowBox[{"SimpleWavePhasor", "[", 
  RowBox[{"5", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryJ]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "x"}], "+", 
       FractionBox["\[Pi]", "4"]}], ")"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.883392343632587*^9, 3.883392353858551*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"58ca25b5-22aa-4d7a-8608-771249d9f536"],

Cell["\<\
TODO: write the point of view that \[OpenCurlyDoubleQuote]a better notation \
for complex numbers\[CloseCurlyDoubleQuote]. Plot it.\
\>", "Text",
 CellChangeTimes->{{3.883326879193255*^9, 3.8833269001013803`*^9}, 
   3.8833921718166637`*^9},ExpressionUUID->"6857e0cc-0ff6-46e7-9364-\
4d31ee64f599"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Attenuation", "Section",
 CellChangeTimes->{{3.883390615064343*^9, 
  3.883390616602394*^9}},ExpressionUUID->"cacf83d6-5a68-4dd3-b6ee-\
8a0b21bde768"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s talk more about the amplitude. So far, it has been a \
constant. What if it\[CloseCurlyQuote]s a value that changes with time? In \
electromagnetics, we are especially interested in changes of the form ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", "\[Alpha]", 
          StyleBox["x", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-\\alpha x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "45fb1480-c544-4575-ac44-cf5757e58167"],
 ", for example:"
}], "Text",
 CellChangeTimes->{
  3.875627160414782*^9, {3.8762313017389517`*^9, 3.876231325114709*^9}, {
   3.8762313636019382`*^9, 
   3.876231364711522*^9}},ExpressionUUID->"9785bf66-db7d-40c1-8806-\
977cf6142e64"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "0.2"}], " ", "x"}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87450520452708*^9, 3.874505234292938*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"1df4b078-0e7c-4f80-921f-7018405f95ac"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", "\[Alpha]", 
          StyleBox["x", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-\\alpha x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db39eba4-c421-41ca-b6ab-edaee1a325e1"],
 " represents exponential decay, I can see why it\[CloseCurlyQuote]s \
interesting since many things in nature decay exponentially."
}], "CodeText",
 CellChangeTimes->{{3.874505150861739*^9, 3.874505194236751*^9}, {
  3.874505296393629*^9, 
  3.8745053068767242`*^9}},ExpressionUUID->"85aad354-c1bf-40be-a4e6-\
3fddf9af3062"],

Cell["How would a traveling wave with exponential decay look like?", "Text",
 CellChangeTimes->{{3.87450528797299*^9, 3.874505344557356*^9}, 
   3.883390583276148*^9},ExpressionUUID->"1b08ad1b-6e27-4776-9a3a-\
998e06372a3d"],

Cell[TextData[{
 "We can add ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", "\[Alpha]", 
          StyleBox["x", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-\\alpha x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9d9ecffc-6708-4968-8650-30fb457e686b"],
 " as a multiplier to the previous wave phasor ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "5 e^{j(-2x+\\frac{\\pi}{4})}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c1d569ba-7320-4d3b-b729-db78c77df973"],
 ", from which we get ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", "\[Alpha]", 
            StyleBox["x", "TI"]}]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "5 e^{-\\alpha x} e^{j(-2x+\\frac{\\pi}{4})}",
      "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba2c3322-ba6a-407a-b66f-fe9c1ae4cfd4"],
 ", and animate the instantaneous function."
}], "CodeText",
 CellChangeTimes->{{3.8745053516468153`*^9, 3.8745053978588552`*^9}, {
  3.874505561506229*^9, 3.8745055663407*^9}, {3.874505597724566*^9, 
  3.8745057104463863`*^9}, {3.883392431543825*^9, 
  3.8833924323706627`*^9}},ExpressionUUID->"04766e45-c5dc-4364-9b2a-\
7255262f3288"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveWithAttenuation", "[", "p_", "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"p", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
           "/.", 
           RowBox[{"\[Omega]", "->", 
            RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "10"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "6"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"PointLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
            "RGBColorSwatchTemplate"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Alpha]\>\"", ",", "\[Alpha]"}], "}"}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "0.1", ",", "0.5"}], "}"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.87450542441273*^9, 3.874505457873034*^9}, {
  3.8745066016108007`*^9, 3.874506603406108*^9}, {3.874506694529107*^9, 
  3.874506697296976*^9}, {3.8748178287172337`*^9, 3.8748178509258347`*^9}, {
  3.876231480487977*^9, 3.876231525611794*^9}, {3.876231560096077*^9, 
  3.876231565249003*^9}, {3.876231619513812*^9, 3.876231645397709*^9}, {
  3.883392472530047*^9, 3.883392481002944*^9}, {3.883392513258952*^9, 
  3.883392549887714*^9}, {3.88339263149282*^9, 3.8833926366887627`*^9}, {
  3.8833926744499397`*^9, 3.883392727454885*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"220effbe-d603-46c0-b55b-2bfa8dfe0b1e"],

Cell[BoxData[
 RowBox[{"WaveWithAttenuation", "[", 
  RowBox[{"5", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], " ", "x"}]], 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryJ]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "x"}], "+", 
       FractionBox["\[Pi]", "4"]}], ")"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.8833925164163446`*^9, 3.883392528777618*^9}, {
  3.883392669285954*^9, 3.883392669684814*^9}},
 CellLabel->
  "In[851]:=",ExpressionUUID->"761174dc-76b1-43f9-b80a-84c14679b472"],

Cell[TextData[{
 "The wave attenuates aggressively as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "85779515-4004-40c9-bd6d-ca9b8dec2abc"],
 " gets larger."
}], "CodeText",
 CellChangeTimes->{{3.874505488978023*^9, 3.874505512585285*^9}, {
  3.874505636374797*^9, 3.874505638806808*^9}, {3.8762315835641727`*^9, 
  3.876231608978595*^9}},ExpressionUUID->"a96826e5-d0f0-4dc5-8353-\
e0531a6defa7"],

Cell[TextData[{
 "Indeed. We call the multiplier ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", "\[Alpha]", 
          StyleBox["x", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-\\alpha x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b872b210-eb6e-449b-b50c-6c817bbd8969"],
 " the attenuation factor and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "91362f1e-3453-4bac-8cce-31d62efefda6"],
 " the attenuation constant. This occurs for example when a plane wave \
propagates in a ",
 StyleBox["lossy",
  FontSlant->"Italic"],
 " medium."
}], "Text",
 CellChangeTimes->{{3.874505728262925*^9, 3.874505798209515*^9}, {
  3.874505865811253*^9, 3.874505875680854*^9}, {3.88339277582029*^9, 
  3.8833927950790033`*^9}},ExpressionUUID->"bf675e34-433a-473a-9e84-\
d2f9d34ebd77"],

Cell["Like water?", "CodeText",
 CellChangeTimes->{{3.87450590810046*^9, 
  3.874505910656329*^9}},ExpressionUUID->"f521f3ce-60e8-401c-9448-\
24189d2924d0"],

Cell[TextData[{
 "Yes. We have much more to say about mediums later. But for now, you have \
seen both the attenuation constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "109e0682-27cd-4444-9bf7-5e66c93e16ab"],
 " and the phase constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Beta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2ac8d567-a306-4795-9574-4a2d41ad632d"],
 ". You have understood the effects of both constants. Together these \
constants form the ",
 StyleBox["propagation constant",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "967b04cd-8886-45de-bdf2-a859e8fe7cc2"],
 ". It is not defined directly, but defined in the expression ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"\[Gamma]", 
          StyleBox["x", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{\\gamma x}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0362093e-fdb8-4be1-96aa-4a667a9c3824"],
 " which equals \[OpenCurlyDoubleQuote]",
 "the ratio of the phasor at the source of the wave to the phasor at some \
distance ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->
  "35f03b25-0cf1-4c27-bd93-8e89c729cddb"],
 "\[CloseCurlyDoubleQuote]. Can you find an expression for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d1ebf421-f684-4cf7-a95d-138ca6cdcfb1"],
 "?"
}], "Text",
 CellChangeTimes->{{3.874505921382029*^9, 3.87450594390012*^9}, {
   3.874506007292317*^9, 3.8745061350810137`*^9}, 3.8762322016952343`*^9, {
   3.876232538943264*^9, 3.876232726176421*^9}, {3.8762331358509808`*^9, 
   3.876233142794847*^9}, {3.8762331756652308`*^9, 3.876233197015051*^9}, {
   3.8762333458874197`*^9, 
   3.8762333765800447`*^9}},ExpressionUUID->"3290d1be-0cb7-4738-9806-\
e8bb282e7762"],

Cell[TextData[{
 "I suppose \[OpenCurlyDoubleQuote]the source of the wave\
\[CloseCurlyDoubleQuote] means at location ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "x = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3197d033-2248-430f-a12f-b22407c3150f"],
 ". If I have a general phasor ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", "\[Alpha]", 
            StyleBox["x", "TI"]}]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-", "\[Beta]", 
              StyleBox["x", "TI"], "+", 
              SubscriptBox["\[Phi]", "0"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "A e^{-\\alpha x} e^{j (- \\beta x + \\phi_0)}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "49e0a214-b557-4b12-b0d8-0676ba63ed7a"],
 ", we know that at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "x = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f68e66d-c517-438b-980f-d7f1afcd5587"],
 " it is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            SubscriptBox["\[Phi]", "0"]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A e^{j \\phi_0}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f66db838-824b-4a53-9a0b-e84c70e9e39e"],
 ". So, according to the definition above:"
}], "CodeText",
 CellChangeTimes->{{3.876232601543787*^9, 3.876232607937961*^9}, {
  3.876232756547254*^9, 3.876232787458268*^9}, {3.876232925840588*^9, 
  3.876232989416994*^9}, {3.876233326737136*^9, 
  3.876233331263152*^9}},ExpressionUUID->"a338b428-8d5a-42dc-8f50-\
ec70074ae5ea"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"A", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      SubscriptBox["\[Phi]", "0"]}]]}], 
   RowBox[{"A", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Alpha]"}], " ", "x"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Beta]"}], " ", "x"}], "+", 
        SubscriptBox["\[Phi]", "0"]}], ")"}]}]]}]], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.876232996172205*^9, 3.876233009060376*^9}, {
  3.876233040726305*^9, 3.8762331065601063`*^9}},
 CellLabel->
  "In[852]:=",ExpressionUUID->"d353d042-9023-407a-a1a3-14a6089576a0"],

Cell[TextData[{
 "Looks like ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[LongEqual]", "\[Alpha]", "+", 
         StyleBox["j", "TI"], "\[Beta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\gamma = \\alpha + j \\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "193cd344-af18-4aa5-b2ac-bd1b9c0c51d2"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.876233260243074*^9, 
  3.876233311526435*^9}},ExpressionUUID->"2d00e754-7056-46d2-978c-\
3ae96ca574f9"],

Cell["Exactly.", "Text",
 CellChangeTimes->{{3.876233298841374*^9, 3.876233303057597*^9}, {
  3.883392910966353*^9, 
  3.8833929120116253`*^9}},ExpressionUUID->"7a1bbb81-e55c-47ab-b2a4-\
48fa2524b653"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Superposition and Standing Waves", "Section",
 CellChangeTimes->{{3.8762322504490767`*^9, 3.8762322620609617`*^9}, {
  3.883390875264338*^9, 3.883390881208005*^9}, {3.883393122424539*^9, 
  3.883393128194686*^9}},ExpressionUUID->"a8270ee5-8180-4ba8-8f47-\
260db419cc4a"],

Cell[TextData[{
 "Many waves are ",
 StyleBox["linear",
  FontSlant->"Italic"],
 ": two waves can pass right through each other and the total wave is just \
the sum of both.\n\nStart by superpositioning two waves with the same \
frequency traveling in the same direction. Play with the amplitude and \
reference phase of the second wave, what conclusions can you draw?"
}], "Text",
 CellChangeTimes->{{3.883395629181151*^9, 3.8833956748752604`*^9}, {
  3.8833998183306017`*^9, 3.883399862422546*^9}, {3.883400045358766*^9, 
  3.883400091688417*^9}, {3.883400270141527*^9, 3.88340029987257*^9}, {
  3.883401758359803*^9, 3.883401793248474*^9}, {3.8834109745727873`*^9, 
  3.883411008161951*^9}, {3.883411045794404*^9, 
  3.883411054277639*^9}},ExpressionUUID->"3c8e7629-f94a-4107-85a1-\
ec4625294769"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SuperpositionWaves", "[", 
   RowBox[{"f1_", ",", "f2_"}], "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"f1", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
              "]"}], "/.", 
             RowBox[{"\[Omega]", "->", 
              RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"f2", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
              "]"}], "/.", 
             RowBox[{"\[Omega]", "->", 
              RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"f1", "+", "f2"}], ")"}], 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
              "]"}], "/.", 
             RowBox[{"\[Omega]", "->", 
              RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "5"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "12"}], ",", "12"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
        RowBox[{"PointLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            
            TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
             
             "RGBColorSwatchTemplate"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<A\>\"", ",", "A"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Phi]\>\"", ",", "\[Phi]"}], "}"}]}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", "5"}], "}"}], ",", 
      RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0"}], "}"}], ",", 
      RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8833958799347773`*^9, 3.883395919428301*^9}, {
  3.883395962438818*^9, 3.883396006830567*^9}, {3.883399726992785*^9, 
  3.883399754958105*^9}, {3.883399789122908*^9, 3.883399790795849*^9}, {
  3.8834005413909607`*^9, 3.883400542339983*^9}, {3.8834017955941353`*^9, 
  3.8834017974154263`*^9}, {3.883401878283589*^9, 3.883401926122069*^9}, {
  3.883410255632989*^9, 3.8834103361793213`*^9}, {3.883410717503027*^9, 
  3.883410763383676*^9}, {3.883410841553602*^9, 3.8834108638189096`*^9}, {
  3.88341119658445*^9, 3.883411197835359*^9}, {3.883573442911346*^9, 
  3.8835734560377483`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"607c7f7d-86e6-451a-84f6-32ea1fd42b7b"],

Cell[BoxData[
 RowBox[{"SuperpositionWaves", "[", 
  RowBox[{
   RowBox[{"5", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], ",", 
   RowBox[{"A", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", "2"}], "x"}], "+", "\[Phi]"}], ")"}]}]]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8833959233114347`*^9, 3.8833959531019487`*^9}, {
  3.8833959960221357`*^9, 3.883395998210169*^9}, {3.8834018306067753`*^9, 
  3.883401860006537*^9}},
 CellLabel->
  "In[854]:=",ExpressionUUID->"a52daad2-f8a4-42f2-ba17-9b27e7b7845c"],

Cell["\<\
Superposition two waves with the same frequency traveling in opposite \
directions. Play with the amplitude and reference phase of the second wave, \
what conclusions can you draw?\
\>", "Text",
 CellChangeTimes->{{3.874506198246913*^9, 3.87450623388552*^9}, 
   3.883395600046389*^9, {3.883399892045031*^9, 3.8833998937383423`*^9}, {
   3.883400139547209*^9, 3.883400141395309*^9}, {3.883400315073786*^9, 
   3.883400334005187*^9}, 3.8834109716118307`*^9, {3.883411024955277*^9, 
   3.883411041934815*^9}},ExpressionUUID->"da99c75d-206f-4615-82ab-\
444f8fb7fbbd"],

Cell[BoxData[
 RowBox[{"SuperpositionWaves", "[", 
  RowBox[{
   RowBox[{"5", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], ",", 
   RowBox[{"A", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "x"}], "+", "\[Phi]"}], ")"}]}]]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883400340670597*^9, 3.8834003450729427`*^9}, {
  3.883411063681817*^9, 3.883411082183683*^9}},
 CellLabel->
  "In[855]:=",ExpressionUUID->"091b0216-db54-4093-86d1-5694718e9355"],

Cell[TextData[{
 "To sum them up, I get ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]], "+", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            RowBox[{"(", 
              RowBox[{"2", 
                StyleBox["x", "TI"], "+", 
                FractionBox["\[Pi]", "4"]}], ")"}], ")"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "10 e^{j(-2x+\\frac{\\pi}{4})}+10 e^{j(2x+\\frac{\\pi}{4}))", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "02a0217c-13c4-4b1d-866c-657b9982993f"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.874506242375588*^9, 3.874506388557378*^9}, {
   3.8748260564719048`*^9, 3.87482607633855*^9}, 
   3.883395698867025*^9},ExpressionUUID->"d767b38b-0fc4-4ec0-b393-\
38eff279b82e"],

Cell["\<\
We get a standing wave that has the same wavelength but twice the amplitude.\
\>", "CodeText",
 CellChangeTimes->{{3.874506755439663*^9, 3.8745068594484253`*^9}, {
  3.883395723696259*^9, 
  3.883395737181081*^9}},ExpressionUUID->"77f76a64-386d-4cf9-9637-\
b6445c015ff1"],

Cell["\<\
It occurs when some ratio of a wave gets reflected at the interface between \
two mediums and the reflected wave is superpositioned onto the incident wave.\
\
\>", "Text",
 CellChangeTimes->{{3.874506863418664*^9, 3.874506904397053*^9}, {
  3.874506941838895*^9, 3.87450703335959*^9}, {3.874826160620674*^9, 
  3.874826212460688*^9}, {3.8833957607434607`*^9, 
  3.883395762392124*^9}},ExpressionUUID->"411e6366-a788-4303-8974-\
b6784b1d551a"],

Cell["\<\
I guess in the previous example the reflection ratio is 100%.\
\>", "CodeText",
 CellChangeTimes->{{3.8748260252344503`*^9, 3.8748260435404997`*^9}, {
  3.874826139604911*^9, 3.874826141989916*^9}, {3.8748262194998627`*^9, 
  3.874826226898342*^9}},ExpressionUUID->"ec221523-fc3f-43e0-8316-\
5c5caf50b4aa"],

Cell[TextData[{
 "Correct. Therefore we can define a reflection coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "55b642ef-51f4-45b4-899b-b5f1ff4255e3"],
 " (gamma) which is the ratio of the reflected wave ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["V", "TI"], "-"], TraditionalForm], "errors" -> {}, "input" -> 
     "V^-", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c7ab2e84-e992-4c7b-9454-25106bd56b57"],
 " and the incident wave ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["V", "TI"], "+"], TraditionalForm], "errors" -> {}, "input" -> 
     "V^+", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7190381a-b22a-43b8-b6de-82b72e31ec60"],
 ". (TODO: is it the full phasor, or just the amplitude?)"
}], "Text",
 CellChangeTimes->{{3.874826233911148*^9, 3.874826252220433*^9}, {
  3.874826781471183*^9, 3.8748268016334667`*^9}, {3.87623394110273*^9, 
  3.876233950853376*^9}, {3.8762340860931787`*^9, 3.8762341101002417`*^9}, {
  3.883412236164603*^9, 
  3.883412248633484*^9}},ExpressionUUID->"aeffb8f1-4db6-47fa-ba2c-\
a0dc8d3559ed"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["V", "TI"], "-"], "\[LongEqual]", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "V^- = 10 e^{j(2x+\\frac{\\pi}{4})}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1fb87f68-bb72-4fe4-948e-ee11f8b30d4d"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["V", "TI"], "+"], "\[LongEqual]", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "V^+ = 10 e^{j(-2x+\\frac{\\pi}{4})}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d4f9c543-858a-48ae-8086-8b9a20275876"],
 ", we have"
}], "CodeText",
 CellChangeTimes->{{3.876234127589366*^9, 
  3.876234186775853*^9}},ExpressionUUID->"16c522ba-57b8-429f-9dca-\
d1a575b11a7e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "x"}], "+", 
        FractionBox["\[Pi]", "4"]}], ")"}]}]]}], 
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "x"}], "+", 
        FractionBox["\[Pi]", "4"]}], ")"}]}]]}]], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.876234189937199*^9, 3.876234290375641*^9}},
 CellLabel->
  "In[856]:=",ExpressionUUID->"aa901677-3a81-4391-b424-fc7ed1d9da9e"],

Cell[TextData[{
 "Therefore ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "12be08b3-4ac7-420c-80d3-88e795eea6eb"],
 " in the previous case"
}], "CodeText",
 CellChangeTimes->{{3.874827118468997*^9, 3.8748271332647753`*^9}, 
   3.876234310965232*^9},ExpressionUUID->"58cde102-5e77-4561-a318-\
b604cf699663"],

Cell[TextData[{
 "Correct. Now, since we will be spending lots of time dealing with wave \
reflections, we will plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], "<", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "x < 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a018e86d-5756-4139-9dc1-53df2bb529d0"],
 " by default from now on. Now, I want you to plot some different values of \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2b0938c1-2071-45a9-852b-cd7f4b950681"],
 " showing the incident wave, the reflected wave, as well as the total wave."
}], "Text",
 CellChangeTimes->{{3.8745073887750874`*^9, 3.87450739912411*^9}, {
   3.874818875154797*^9, 3.8748188808705072`*^9}, 3.874826895807034*^9, {
   3.8748271360413513`*^9, 3.874827156876738*^9}, {3.874827201076153*^9, 
   3.874827254398673*^9}, {3.874827284482835*^9, 3.874827309521491*^9}, {
   3.874851239643106*^9, 3.8748513004319153`*^9}, {3.883412214823044*^9, 
   3.883412216576211*^9}},ExpressionUUID->"6093c120-0c02-436a-889c-\
5bd1a1849e2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveReflection", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "reflected", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"incident", " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"\[CapitalGamma]", " ", "reflected", " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "reflected"}]}], ")"}], 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
              RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "12"}], ",", "12"}], "}"}]}], ",", 
              RowBox[{"PlotLegends", "->", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Incident\>\"", ",", "\"\<Reflected\>\"", ",", 
                 "\"\<Total\>\""}], "}"}]}], ",", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
            RowBox[{"PointLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               
               TemplateBox[<|
                "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                "RGBColorSwatchTemplate"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<\[CapitalGamma]\>\"", ",", "\[CapitalGamma]"}], 
                "}"}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalGamma]", ",", "1"}], "}"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883411459978264*^9, 3.8834115155987597`*^9}, {
  3.883411588949235*^9, 3.883411600577442*^9}, {3.8834116807852507`*^9, 
  3.883411692005144*^9}, {3.8834117262321253`*^9, 3.8834117909425373`*^9}, {
  3.883411847742275*^9, 3.883411866435506*^9}, {3.883411903175561*^9, 
  3.883411903304167*^9}, {3.8834119412311172`*^9, 3.883411953613593*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"e2d0a19c-9769-447e-85c5-7c17b3ccc35e"],

Cell[BoxData[
 RowBox[{"WaveReflection", "[", 
  RowBox[{"5", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.883411872300612*^9, 3.883411900208379*^9}},
 CellLabel->
  "In[858]:=",ExpressionUUID->"509514ff-38aa-4b72-a60b-dff90d44a030"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StandingWaveEnvelope", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "reflected", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "reflected"}]}], ")"}], 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                RowBox[{"Abs", "[", 
                 RowBox[{"incident", "+", 
                  RowBox[{"\[CapitalGamma]", " ", "reflected"}]}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
              RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "12"}], ",", "12"}], "}"}]}], ",", 
              RowBox[{"PlotLegends", "->", 
               RowBox[{"{", "\"\<Standing Wave\>\"", "}"}]}], ",", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
            RowBox[{"PointLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               
               TemplateBox[<|
                "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                "RGBColorSwatchTemplate"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<\[CapitalGamma]\>\"", ",", "\[CapitalGamma]"}], 
                "}"}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalGamma]", ",", "1"}], "}"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883411459978264*^9, 3.8834115155987597`*^9}, {
  3.883411588949235*^9, 3.883411600577442*^9}, {3.8834116807852507`*^9, 
  3.883411692005144*^9}, {3.8834117262321253`*^9, 3.8834117909425373`*^9}, {
  3.883411847742275*^9, 3.883411866435506*^9}, {3.883411903175561*^9, 
  3.883411903304167*^9}, {3.8834119412311172`*^9, 3.883411953613593*^9}, {
  3.883573703402421*^9, 3.8835737403184223`*^9}, {3.883573807340103*^9, 
  3.88357383318931*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"966dd25f-9acc-4d31-a17c-84e884143d9c"],

Cell[BoxData[
 RowBox[{"StandingWaveEnvelope", "[", 
  RowBox[{"5", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.883573755420582*^9, 3.8835737590219*^9}},
 CellLabel->
  "In[1121]:=",ExpressionUUID->"45f430d5-e83a-498e-80c1-225935b4a5a3"],

Cell["What\[CloseCurlyQuote]s the wavelength of the envelope curve?", "Text",
 CellChangeTimes->{{3.883707499300126*^9, 
  3.883707510737134*^9}},ExpressionUUID->"2b602a06-0cee-4ebb-b1b0-\
33985e61c3de"],

Cell[TextData[Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      FractionBox["\[Lambda]", "2"], TraditionalForm], "errors" -> {}, 
    "input" -> "\\frac{\\lambda}{2}", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], 
  TraditionalForm]],ExpressionUUID->"292b5d1d-1111-417c-a7eb-b3d217a460ee"]], \
"CodeText",
 CellChangeTimes->{{3.8837076032829447`*^9, 
  3.883707614332869*^9}},ExpressionUUID->"010536d6-dbe1-48a9-ae54-\
02c22c7898ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveComplexReflection", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "reflected", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"Legended", "[", 
           RowBox[{
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"incident", " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"a", "+", 
                    RowBox[{"\[ImaginaryJ]", " ", "b"}]}], ")"}], " ", 
                   "reflected", " ", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"a", "+", 
                    RowBox[{"\[ImaginaryJ]", " ", "b"}]}], ")"}], " ", 
                    "reflected"}]}], ")"}], 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", 
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
              RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
              RowBox[{"PlotRange", "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "12"}], ",", "12"}], "}"}]}], ",", 
              RowBox[{"PlotLegends", "->", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Incident\>\"", ",", "\"\<Reflected\>\"", ",", 
                 "\"\<Total\>\""}], "}"}]}], ",", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
            RowBox[{"PointLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               
               TemplateBox[<|
                "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                "RGBColorSwatchTemplate"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<a + \[ImaginaryJ]b\>\"", ",", 
                 RowBox[{"a", "+", 
                  RowBox[{"\[ImaginaryJ]", " ", "b"}]}]}], "}"}], "}"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "6.66"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883411459978264*^9, 3.8834115155987597`*^9}, {
  3.883411588949235*^9, 3.883411600577442*^9}, {3.8834116807852507`*^9, 
  3.883411692005144*^9}, {3.8834117262321253`*^9, 3.8834117909425373`*^9}, {
  3.883411847742275*^9, 3.883411866435506*^9}, {3.883411903175561*^9, 
  3.883411903304167*^9}, {3.8834119412311172`*^9, 3.883411953613593*^9}, {
  3.883412463450252*^9, 3.883412537099642*^9}, {3.883412741094462*^9, 
  3.88341274140242*^9}, {3.883412787883127*^9, 3.883412788604391*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"a83a58f4-46c7-4a43-93b9-7af5d72188b6"],

Cell[BoxData[
 RowBox[{"WaveComplexReflection", "[", 
  RowBox[{"5", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.883412715663686*^9, 3.883412722219562*^9}},
 CellLabel->
  "In[1122]:=",ExpressionUUID->"55ac0bda-d0e0-4e4b-9bbe-be56e00c3a18"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], "+", 
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], "-", 
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "22"}], ",", "22"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<Total1\>\"", ",", "\"\<Total2\>\""}], "}"}]}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8748274706093483`*^9, 3.874827516977171*^9}, {
  3.8748518222898197`*^9, 3.87485187933755*^9}},
 CellLabel->
  "In[863]:=",ExpressionUUID->"675a8095-f3bd-4157-a965-0db5d82b3495"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"10", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{"5", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], "+", 
           RowBox[{"5", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "18"}], ",", "18"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Incident\>\"", ",", "\"\<Reflected\>\"", ",", "\"\<Total\>\""}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87482691845402*^9, 3.874827076918475*^9}, {
  3.8748513740880537`*^9, 3.874851375210095*^9}, {3.874851576635268*^9, 
  3.874851607718072*^9}, {3.883105697850878*^9, 3.883105704816958*^9}},
 CellLabel->
  "In[864]:=",ExpressionUUID->"128a5eee-38d1-4140-b1f6-07da746651eb"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"5", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"5", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], "+", 
           RowBox[{"5", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]]}], "+", 
           RowBox[{"5", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", "2", "x"}]]}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "18"}], ",", "18"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Incident\>\"", ",", "\"\<Pure Standing Wave\>\"", ",", 
        "\"\<Partial Standing Wave\>\""}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883105871399984*^9, 3.883105887550315*^9}, {
  3.883106039449706*^9, 3.8831060854806757`*^9}, {3.8831061164763117`*^9, 
  3.88310612774025*^9}, {3.883106274888751*^9, 3.8831062879546432`*^9}},
 CellLabel->
  "In[865]:=",ExpressionUUID->"0b6ac101-1fbb-4cd6-ac07-4b314eeb8509"],

Cell[TextData[{
 "What about ",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Lambda]", "2"], TraditionalForm]],ExpressionUUID->
  "a7d3a2a8-15ac-48d9-a9f6-24face694fcc"],
 " mentioned in class? i.e. ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"+", "\[ImaginaryJ]"}], " ", "2", " ", "\[Beta]", " ", "z"}]], 
   TraditionalForm]],ExpressionUUID->"5db00973-6438-40ba-b7b9-335d3ebcdc91"]
}], "Text",
 CellChangeTimes->{{3.8831080921408997`*^9, 
  3.8831081318761578`*^9}},ExpressionUUID->"40169f83-8bbe-4497-8a5c-\
d09635d3ba60"],

Cell["Standing Wave Ratio (SWR)", "Text",
 CellChangeTimes->{{3.874827557297164*^9, 
  3.874827563440771*^9}},ExpressionUUID->"047a1b71-7355-4e44-8c0f-\
3b98c4aba694"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Pi]"}]], "]"}]], "Input",
 CellChangeTimes->{{3.883109079965969*^9, 3.883109093294135*^9}},
 CellLabel->
  "In[866]:=",ExpressionUUID->"7a74d009-b729-4f0e-942f-e432382f7d6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complex Amplitude", "Section",
 CellChangeTimes->{{3.87623194542432*^9, 3.876231960792884*^9}, {
  3.883393116217339*^9, 
  3.883393117271905*^9}},ExpressionUUID->"cedc51d1-069e-426f-b8f0-\
404840da5083"],

Cell[TextData[{
 "Now that we are dealing with phasors and complex numbers, we can extend the \
amplitude ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["A", "TI"], TraditionalForm], "errors" -> {}, "input" -> "A", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4323cf28-d38e-45e3-9782-c6b80cca1863"],
 " from a real number to the complex domain. Start with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "5 e^{j(-2x + \\frac{\\pi}{4})}", "state" -> 
     "TeX"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c82bde21-ebae-4952-9517-9777c756797c"],
 ", what happens when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["5", TraditionalForm], "errors" -> {}, "input" -> "5", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a7eedc91-8f2b-4352-96b3-0efc97c91754"],
 " is replaced with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"5", "+", 
         StyleBox["j", "TI"], "5"}], TraditionalForm], "errors" -> {}, 
     "input" -> "5 + j 5", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6371a45d-7b6d-4c67-bd10-6275f16fa262"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"10", "-", 
         StyleBox["j", "TI"], "5"}], TraditionalForm], "errors" -> {}, 
     "input" -> "10 - j 5", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "61d7b8d5-23cd-4679-8f68-0bca39266649"],
 ", as in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"(", 
           RowBox[{"10", "+", 
             StyleBox["j", "TI"], "5"}], ")"}], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "(10 + j 5)e^{j(-2x + \\frac{\\pi}{4})}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5aab9650-ed6d-441b-bc30-faf01c955a02"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         RowBox[{"(", 
           RowBox[{"10", "-", 
             StyleBox["j", "TI"], "5"}], ")"}], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "(", 
            RowBox[{"-2", 
              StyleBox["x", "TI"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "(10 - j 5)e^{j(-2x + \\frac{\\pi}{4})}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7cb11e47-8767-4b56-8887-ebf11fa9b7d8"],
 "?"
}], "Text",
 CellChangeTimes->{{3.8745046902027893`*^9, 3.8745047701715097`*^9}, {
   3.874504831742543*^9, 3.8745048589607*^9}, {3.874505093806025*^9, 
   3.874505137904224*^9}, {3.874505196470415*^9, 3.8745052027698307`*^9}, {
   3.8756271577251797`*^9, 3.875627179876952*^9}, {3.875627213381988*^9, 
   3.875627216071666*^9}, 3.87623345125191*^9, {3.8833929827167473`*^9, 
   3.883393033544366*^9}},ExpressionUUID->"828b3739-839e-4269-b008-\
cb52a8d697cc"],

Cell["", "Text",
 CellChangeTimes->{{3.875627301199197*^9, 3.875627387615284*^9}, {
   3.875627647805668*^9, 3.875627651227666*^9}, 3.8756287098659782`*^9, {
   3.876228373414072*^9, 3.876228407551916*^9}, {3.883251075116331*^9, 
   3.883251080212203*^9}, {3.883393029133515*^9, 
   3.8833930312812653`*^9}},ExpressionUUID->"a8e7ad28-e941-4bdd-8a1e-\
c067649877d1"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"\[ImaginaryJ]", " ", "5"}]}], ")"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      RowBox[{"(", 
       RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.875627451010243*^9, 3.8756274565410843`*^9}, 
   3.875627492398676*^9, {3.8833952066274633`*^9, 3.883395228240864*^9}},
 CellLabel->
  "In[867]:=",ExpressionUUID->"d5e2a5be-162c-471f-bac9-eef46adf1ff3"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"5", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"1.88496", " ", "t"}], "-", 
          RowBox[{"2", " ", "x"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "5"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"1.88496", " ", "t"}], "-", 
          RowBox[{"2", " ", "x"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"5", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"1.88496", " ", "t"}], "-", 
           RowBox[{"2", " ", "x"}]}], "]"}]}], "-", 
        RowBox[{"5", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"1.88496", " ", "t"}], "-", 
           RowBox[{"2", " ", "x"}]}], "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.883395260614045*^9, 3.883395265966489*^9}, {
  3.883395346459673*^9, 3.8833953660245934`*^9}, {3.883395451567737*^9, 
  3.883395458514584*^9}},
 CellLabel->
  "In[868]:=",ExpressionUUID->"70245152-177a-4e11-bbf1-41629828d593"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{"Re", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"5", "-", 
      RowBox[{"\[ImaginaryJ]", " ", "5"}]}], ")"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", 
      RowBox[{"(", 
       RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.876228360046256*^9, 3.876228360327599*^9}, {
  3.8833952106503963`*^9, 3.883395234149811*^9}},
 CellLabel->
  "In[869]:=",ExpressionUUID->"cf8df578-d45a-428d-b760-61499d32332f"],

Cell[TextData[{
 "I can see that a sine term with amplitude ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["5", TraditionalForm], "errors" -> {}, "input" -> "5", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "89d0bdd7-294b-4d08-8890-272cbbd51b62"],
 " is introduced with the opposite sign of the imaginary part. The sine term \
has the same phase as the cosine term. I think this can be viewed as a sum of \
two waves. Let\[CloseCurlyQuote]s see how it looks like:"
}], "CodeText",
 CellChangeTimes->{{3.875627522513912*^9, 3.875627608654336*^9}, {
  3.875627725648707*^9, 3.8756277352077227`*^9}, {3.8762300810933523`*^9, 
  3.876230107440391*^9}},ExpressionUUID->"a501d663-5d7f-4dc4-9066-\
0a787b91b2c5"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"5", "+", 
           RowBox[{"5", "\[ImaginaryJ]"}]}], ")"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{"5", 
         SqrtBox["2"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "x"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", 
           RowBox[{"(", 
            RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.875230043539208*^9, {3.875627507917348*^9, 3.8756275095513153`*^9}, {
   3.8756276379429007`*^9, 3.8756276406218233`*^9}, {3.8756277397196407`*^9, 
   3.8756277611013927`*^9}, {3.88339308148997*^9, 3.883393082292062*^9}, {
   3.8833939004829397`*^9, 3.8833939016580973`*^9}, {3.883394410630155*^9, 
   3.883394418487062*^9}, {3.8833949670261497`*^9, 3.883394982458824*^9}, {
   3.883395174802368*^9, 3.8833951754261513`*^9}},
 CellLabel->
  "In[870]:=",ExpressionUUID->"2404f500-5bdc-46da-a640-d29e665cc7e8"],

Cell["What effect does the sine term bring?", "Text",
 CellChangeTimes->{{3.8756278481126003`*^9, 
  3.8756278578007717`*^9}},ExpressionUUID->"94f5aa81-6035-4f10-9cf8-\
3f1686f89a11"],

Cell["\<\
It\[CloseCurlyQuote]s not easy to see from the animation above. But it should \
help if we use Manipulate and plot it together next to the one with real \
amplitude:\
\>", "CodeText",
 CellChangeTimes->{{3.875627868093769*^9, 3.87562789516072*^9}, {
   3.875628322458971*^9, 3.87562835673105*^9}, {3.875628413239543*^9, 
   3.875628489730872*^9}, 3.8762266627842503`*^9, {3.876230152064345*^9, 
   3.87623016925209*^9}, {3.8762302008735447`*^9, 
   3.876230271150298*^9}},ExpressionUUID->"6a471b88-2f4e-4f2e-a383-\
1ea988b55415"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Animate", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"10", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "x"}], "+", 
               FractionBox["\[Pi]", "4"]}], ")"}]}]], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", 
             RowBox[{"(", 
              RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}], ",", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"10", "+", 
             RowBox[{"B", " ", "\[ImaginaryJ]"}]}], ")"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "x"}], "+", 
               FractionBox["\[Pi]", "4"]}], ")"}]}]], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", 
             RowBox[{"(", 
              RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<10\>\"", ",", "\"\<10 + B \[ImaginaryJ]\>\""}], "}"}]}],
        ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "15"}], ",", "15"}], "}"}]}], "}"}]}]}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"B", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.875628113116646*^9, 3.875628126741544*^9}, {
   3.8756295340859337`*^9, 3.875629553027935*^9}, {3.875629627122332*^9, 
   3.875629632482306*^9}, {3.87622873422859*^9, 3.876228753225637*^9}, {
   3.8762287998157873`*^9, 3.876228861684476*^9}, {3.876228973020569*^9, 
   3.876229016786619*^9}, 3.8841486561814213`*^9},
 CellLabel->
  "In[871]:=",ExpressionUUID->"8bacc7ce-6eef-4cc6-aaa1-9e828b876653"],

Cell["\<\
It seems that the sine terms changes the overall amplitude as well as phase.\
\>", "CodeText",
 CellChangeTimes->{{3.8762302976421413`*^9, 3.876230334798997*^9}, {
  3.876231391291547*^9, 
  3.876231418542288*^9}},ExpressionUUID->"49eb4a03-fd00-43f7-a8d7-\
e6148b682c0d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"10", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", 
          RowBox[{"2", "x"}]}], "]"}]}], "-", 
       RowBox[{"5", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"3", "\[Pi]", " ", "t"}], " ", "-", " ", 
          RowBox[{"2", "x"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "20"}], ",", "20"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.875665203331395*^9, 3.8756652918690443`*^9}, {
  3.8762310576094418`*^9, 3.87623111606094*^9}},
 CellLabel->
  "In[872]:=",ExpressionUUID->"f21e3321-6867-43ad-81e8-a1c75c337818"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-dimensional and Three-dimensional Waves", "Section",
 CellChangeTimes->{{3.874819104221805*^9, 3.87481913178463*^9}, 
   3.8748277156074133`*^9},ExpressionUUID->"2e59b6e5-1f97-46bd-b33a-\
287fe288890c"],

Cell["\<\
Now that we\[CloseCurlyQuote]ve visualized a one-dimensional wave like a \
vibrating guitar string, let\[CloseCurlyQuote]s also try to visualize \
two-dimensional waves like ripples on a pond.\
\>", "Text",
 CellChangeTimes->{{3.874827598973366*^9, 3.874827709974204*^9}, {
  3.87482829119735*^9, 3.874828291885683*^9}, {3.8748519691749077`*^9, 
  3.874851977247197*^9}},ExpressionUUID->"092f51e9-038f-4581-b38c-\
3943342be095"],

Cell[TextData[{
 "I recall that one-dimensional wave was introduced by adding ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         SubscriptBox["\[Beta]", "1"], 
         StyleBox["x", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "-\\beta_1 x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95de3dca-4476-473f-9db7-c256a4cc987d"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "f(t) = A \\cos(\\omega t + \\phi_0)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95988164-ef3b-46bb-abd7-0654cc8767fe"],
 " and getting ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "-", 
             SubscriptBox["\[Beta]", "1"], 
             StyleBox["x", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "f(t) = A \\cos(\\omega t - \\beta_1 x + \\phi_0)", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6da44800-6656-4404-94c7-6d27cd97e5f3"],
 ". Naturally, two-dimensional waves can be constructed by adding ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         SubscriptBox["\[Beta]", "2"], 
         StyleBox["y", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "-\\beta_2 y", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a5682358-29ff-4e7b-801f-2115d074241a"],
 ". This results in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         StyleBox["A", "TI"], "cos", 
         RowBox[{"(", 
           RowBox[{"\[Omega]", 
             StyleBox["t", "TI"], "-", 
             SubscriptBox["\[Beta]", "1"], 
             StyleBox["x", "TI"], "-", 
             SubscriptBox["\[Beta]", "2"], 
             StyleBox["y", "TI"], "+", 
             SubscriptBox["\[Phi]", "0"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "f(t) = A \\cos(\\omega t - \\beta_1 x - \\beta_2 y + \\phi_0)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "453833cf-d64d-4955-b7ef-9c2a9df4b6ad"],
 ", or, in phasor form, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            SubscriptBox["\[Beta]", "1"], 
            StyleBox["x", "TI"], "-", 
            SubscriptBox["\[Beta]", "2"], 
            StyleBox["y", "TI"], "+", 
            SubscriptBox["\[Phi]", "0"]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "A e^{-\\beta_1 x - \\beta_2 y + \\phi_0}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bcb94d46-af6d-4e39-a737-7935c779231c"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.874537553932575*^9, 3.874537671133449*^9}, {
  3.874827723965658*^9, 3.874827757983988*^9}, {3.874828081470633*^9, 
  3.874828214537817*^9}, {3.874828269576378*^9, 3.874828298666534*^9}, {
  3.8748283670278254`*^9, 3.8748283782129087`*^9}, {3.8748284153958883`*^9, 
  3.874828496902615*^9}},ExpressionUUID->"55b58299-89d5-4c19-b50d-\
c63beb42f6b2"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Plot3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"10", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "x"}], "-", "y", "+", 
               FractionBox["\[Pi]", "4"]}], ")"}]}]], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "#"}]]}], "]"}], "/.", 
         RowBox[{"\[Omega]", "->", 
          RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"AxesLabel", "->", "Automatic"}]}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], "]"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8745363657964582`*^9, 3.874536389382021*^9}, {
   3.874536421478586*^9, 3.874536455677421*^9}, {3.874536535819697*^9, 
   3.874536541638921*^9}, {3.874537461855527*^9, 3.87453751073213*^9}, {
   3.874828506516417*^9, 3.874828515549034*^9}, 3.874828551941222*^9, {
   3.87482858590829*^9, 3.874828650632156*^9}, {3.874828727102453*^9, 
   3.874828818958928*^9}, {3.87482884971167*^9, 3.874828883269266*^9}, {
   3.874828933633119*^9, 3.8748289563664083`*^9}, {3.874829029748638*^9, 
   3.874829041835865*^9}, {3.874829429507712*^9, 3.8748294328161077`*^9}, {
   3.8748297096183653`*^9, 3.874829773222762*^9}, {3.874830236403948*^9, 
   3.874830240159471*^9}, {3.8748304538669167`*^9, 3.874830454608255*^9}, {
   3.874830539225544*^9, 3.874830588702696*^9}, {3.874830667863605*^9, 
   3.87483069803259*^9}, 3.874830730098675*^9, {3.874830761920534*^9, 
   3.8748307662381897`*^9}, {3.874830825935904*^9, 3.874830830163292*^9}, {
   3.874842967107012*^9, 3.874842970623639*^9}, {3.8762348639409657`*^9, 
   3.876234872774703*^9}},
 CellLabel->
  "In[1119]:=",ExpressionUUID->"0d624177-fef2-4268-85fd-517d2f58ef10"],

Cell["\<\
I\[CloseCurlyQuote]m using ListAnimate to generate an animation frame by \
frame beforehand since Animate will run too slowly if there is lots of \
computation to do for each frame. This makes the animation smoother, but it \
will take a lot longer to run.\
\>", "CodeText",
 CellChangeTimes->{
  3.874827729031803*^9, {3.8748520006999683`*^9, 
   3.874852005264957*^9}},ExpressionUUID->"cc5fcb7d-e621-466a-a8a8-\
5d5dc06139a1"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Plot3D", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["x", "2"]}], "-", 
              SuperscriptBox["y", "2"], "+", 
              FractionBox["\[Pi]", "4"]}], ")"}]}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", 
            RowBox[{"(", 
             RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "#"}]]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
        RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
        RowBox[{"MaxRecursion", "->", "5"}]}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "2", ",", "0.4"}], "]"}]}], "]"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874852082951395*^9, 3.874852090093075*^9}, {
  3.874852124109953*^9, 3.874852187868567*^9}, {3.874852299434299*^9, 
  3.8748523303762693`*^9}, {3.874852455569162*^9, 3.87485251070918*^9}, {
  3.87485329037694*^9, 3.874853340270226*^9}, {3.874853378660242*^9, 
  3.874853382740484*^9}, {3.874853450557056*^9, 3.874853482875736*^9}, {
  3.874853514138266*^9, 3.8748535144335613`*^9}, {3.874853569733984*^9, 
  3.874853571460495*^9}, {3.874853628556148*^9, 3.874853630265892*^9}},
 CellLabel->
  "In[1120]:=",ExpressionUUID->"2d61d806-3a75-4d78-88a6-f7004e0dad02"],

Cell["Circular wavefront vs linear wavefront.", "Text",
 CellChangeTimes->{{3.874853705297572*^9, 
  3.874853728973236*^9}},ExpressionUUID->"d6952d8b-e03d-4fa0-899c-\
b08b2bc39883"],

Cell["Vector field waves.", "Text",
 CellChangeTimes->{{3.874853733960737*^9, 
  3.8748537425763493`*^9}},ExpressionUUID->"a9aada7a-df8b-428d-b176-\
2bf30e341b95"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"10", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "+", 
         FractionBox["\[Pi]", "4"]}], ")"}]}]]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
   RowBox[{"MaxRecursion", "->", "5"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874852553054237*^9, 3.874852564526848*^9}, {
  3.874852622570538*^9, 3.8748526242217083`*^9}, {3.874852765007457*^9, 
  3.8748528413445597`*^9}, {3.874853139435927*^9, 3.874853139702029*^9}, {
  3.8748531710429487`*^9, 3.8748532151178637`*^9}},
 CellLabel->
  "In[875]:=",ExpressionUUID->"3acb1efb-0dc6-40d4-8786-b1d879859cd0"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Plot3D", "[", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "x"}], "-", "y", "+", 
                FractionBox["\[Pi]", "4"]}], ")"}]}]], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", 
              RowBox[{"(", 
               RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "#"}]]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", "Automatic"}]}], "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Green", ",", "Thick", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "10"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", "10"}], "}"}]}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], "]"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8745363657964582`*^9, 3.874536389382021*^9}, {
   3.874536421478586*^9, 3.874536455677421*^9}, {3.874536535819697*^9, 
   3.874536541638921*^9}, {3.874537461855527*^9, 3.87453751073213*^9}, {
   3.874828506516417*^9, 3.874828515549034*^9}, 3.874828551941222*^9, {
   3.87482858590829*^9, 3.874828650632156*^9}, {3.874828727102453*^9, 
   3.874828818958928*^9}, {3.87482884971167*^9, 3.874828883269266*^9}, {
   3.874828933633119*^9, 3.8748289563664083`*^9}, {3.874829029748638*^9, 
   3.874829041835865*^9}, {3.874829429507712*^9, 3.8748294328161077`*^9}, {
   3.8748297096183653`*^9, 3.874829773222762*^9}, {3.874830236403948*^9, 
   3.874830240159471*^9}, {3.8748304538669167`*^9, 3.874830454608255*^9}, {
   3.874830539225544*^9, 3.874830588702696*^9}, {3.874830667863605*^9, 
   3.87483069803259*^9}, 3.874830730098675*^9, {3.874830761920534*^9, 
   3.8748307662381897`*^9}, {3.87483087882998*^9, 3.8748309176365643`*^9}, {
   3.87483096164364*^9, 3.874830963418885*^9}, {3.874842997444607*^9, 
   3.8748430012907667`*^9}},
 CellLabel->
  "In[876]:=",ExpressionUUID->"5bb6aa40-702a-4dbb-b619-0472797efad6"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"SliceDensityPlot3D", "[", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"10", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "x"}], "-", "y", "-", 
                RowBox[{"3", "z"}], "+", 
                FractionBox["\[Pi]", "4"]}], ")"}]}]], 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryJ]", " ", 
              RowBox[{"(", 
               RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "#"}]]}], "]"}], ",", 
          "\"\<ZStackedPlanes\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", "Automatic"}]}], "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Green", ",", "Thick", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"1.2", "*", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1", ",", "3"}], "}"}]}]}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], "]"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87453667700734*^9, 3.874536800578806*^9}, {
   3.874536853193144*^9, 3.874536853478139*^9}, {3.8748310230360727`*^9, 
   3.874831183127246*^9}, 3.874831214297822*^9, {3.8748312458723717`*^9, 
   3.8748312471329193`*^9}, {3.8748318679180813`*^9, 3.874831939099883*^9}, {
   3.874843020382752*^9, 3.8748430233243313`*^9}},
 CellLabel->
  "In[877]:=",ExpressionUUID->"693d01a7-fe5d-49f8-889a-5d70ade55bfb"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"SliceVectorPlot3D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "*", 
           RowBox[{"Re", "[", 
            RowBox[{"10", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], "x"}], "-", "y", "-", 
                 RowBox[{"3", "z"}], "+", 
                 FractionBox["\[Pi]", "4"]}], ")"}]}]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", 
               RowBox[{"(", 
                RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "#"}]]}], "]"}]}], ",", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "x"}], "-", "y", "-", 
             RowBox[{"3", "z"}]}], "==", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}], ",", 
          RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
          RowBox[{"VectorPoints", "->", "Coarse"}], ",", 
          RowBox[{"VectorRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", "20"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"{", 
          RowBox[{"Green", ",", "Thick", ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"1.2", "*", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1", ",", "3"}], "}"}]}]}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.1"}], "]"}]}], "]"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874832092606585*^9, 3.874832095783661*^9}, {
   3.874832804167107*^9, 3.874832817686247*^9}, {3.874832856618739*^9, 
   3.87483285861863*^9}, {3.874832950722807*^9, 3.874832958503049*^9}, {
   3.874833014380929*^9, 3.874833014717203*^9}, {3.874833077597261*^9, 
   3.874833117645699*^9}, {3.874833194157343*^9, 3.8748332241244593`*^9}, 
   3.874833268543592*^9, 3.874833303985808*^9, 3.87483341187407*^9, {
   3.874841672988515*^9, 3.8748416731955347`*^9}, {3.8748430446513443`*^9, 
   3.874843049308576*^9}, {3.8748509580688677`*^9, 3.87485098896982*^9}, {
   3.874885652815494*^9, 3.874885674737793*^9}},
 CellLabel->
  "In[878]:=",ExpressionUUID->"35353915-e72a-4585-9012-c710803d6eee"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Why", " ", "some", " ", "vectors", " ", "are", " ", "smaller", " ", 
    "than", " ", "others"}], ",", " ", 
   RowBox[{
    RowBox[{"shouldn", "'"}], "t", " ", "they", " ", "all", " ", "be", " ", 
    "the", " ", 
    RowBox[{"same", "?"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.874833540400921*^9, 3.8748335541039343`*^9}},
 CellLabel->
  "In[879]:=",ExpressionUUID->"4dd91082-4aba-4c78-b309-fbbffe627965"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], "x"}], "-", "y"}], "3"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "x"}], "-", "y"}], "3"]}], "}"}], "+", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "*", 
                 RowBox[{"Re", "[", 
                  RowBox[{"10", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    FractionBox["\[Pi]", "4"]}]], 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", 
                    RowBox[{"(", 
                    RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], 
                  "]"}]}]}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "5"}], ",", "5", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5", ",", "3"}], "}"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"Green", ",", "Thick", ",", 
         RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"3", "*", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "3"}], "}"}]}]}], "}"}], "]"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8748488139736443`*^9, 3.874848815328301*^9}, 
   3.874848890896844*^9, {3.874848925691476*^9, 3.87484892586388*^9}, {
   3.874848959629909*^9, 3.874849019061419*^9}, {3.8748490513967953`*^9, 
   3.8748491454405212`*^9}, {3.8748504210388203`*^9, 
   3.8748504788009033`*^9}, {3.8748505330384197`*^9, 3.874850615520439*^9}, {
   3.874850685923387*^9, 3.874850718311688*^9}, {3.8748507719906473`*^9, 
   3.87485078163277*^9}},
 CellLabel->
  "In[880]:=",ExpressionUUID->"823ca253-2c67-4d77-8ba8-05e098f01d0a"],

Cell["What else can be said about these one-dimensional waves?", "CodeText",
 CellChangeTimes->{{3.874487071654645*^9, 
  3.874487094352242*^9}},ExpressionUUID->"0ebedcb7-078e-4b96-92b1-\
95d99bb9ca15"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s assume y(x,t) = A cos ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "t"}], "T"], "-", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "x"}], "\[Lambda]"], "+", "\[Phi]"}], "]"}], 
   TraditionalForm]],ExpressionUUID->"78e3f4f2-1545-420c-990e-21afb3c49104"],
 ". Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]"}], "T"], "=", 
    RowBox[{
     RowBox[{"2", "\[Pi]", " ", "f"}], "=", "\[Omega]"}]}], TraditionalForm]],
  ExpressionUUID->"f44c05b5-c1c3-4f72-b952-5f64b334828d"],
 ", let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]", " "}], "\[Lambda]"], "=", "\[Beta]"}], 
   TraditionalForm]],ExpressionUUID->"639481c9-41f0-409e-90fd-a903581270bc"],
 ", this is just ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "(", 
     RowBox[{"x", ",", "t"}], ")"}], "=", 
    RowBox[{"A", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Omega]", " ", "t"}], "-", 
       RowBox[{"\[Beta]", " ", "x"}], "+", "\[Phi]"}], "]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"11a65d85-8c07-4a3d-af3a-510238c9228f"],
 "."
}], "Text",
 CellChangeTimes->{{3.8744166531959457`*^9, 3.874416863390373*^9}, {
   3.8744169096529503`*^9, 3.874416944839458*^9}, 
   3.874416975005764*^9},ExpressionUUID->"ded6d09e-c996-40cd-b0dc-\
05f79f975d0f"],

Cell["\<\
Complex numbers
2D & 3D waves, the k vector\
\>", "Text",
 CellChangeTimes->{{3.874068415392549*^9, 3.874068419794859*^9}, {
  3.8740684780548353`*^9, 3.8740685136730747`*^9}, {3.874068655871993*^9, 
  3.874068668609437*^9}, {3.8740688136949873`*^9, 3.8740688182777357`*^9}, {
  3.874069055280898*^9, 3.874069061262795*^9}, {3.874072693051085*^9, 
  3.874072695593099*^9}, {3.8741056003823957`*^9, 3.874105603029805*^9}, {
  3.874106026341138*^9, 3.8741060592346487`*^9}, {3.874133280355913*^9, 
  3.874133299045999*^9}, {3.8745074367693367`*^9, 3.874507463284871*^9}, {
  3.874536048412417*^9, 3.874536063225441*^9}, {3.8745368822586946`*^9, 
  3.874536892557002*^9}, {3.874842015018105*^9, 
  3.874842025290792*^9}},ExpressionUUID->"1db6a7a7-b937-4478-bec4-\
67a58dd1d2d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wave Equations", "Section",
 CellChangeTimes->{{3.879256370404935*^9, 
  3.879256374206091*^9}},ExpressionUUID->"c7928850-f322-483b-a86e-\
3bbec69a9e04"],

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"y", "''"}], "[", "t", "]"}], "+", 
     RowBox[{
      FractionBox["k", "m"], " ", 
      RowBox[{"y", "[", "t", "]"}]}]}], "==", "0"}], ",", 
   RowBox[{"y", "[", "t", "]"}], ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.8792563787235203`*^9, 3.879256429024663*^9}, {
  3.879256481026873*^9, 3.879256506764732*^9}},
 CellLabel->
  "In[881]:=",ExpressionUUID->"aaecb0a5-1c29-4b2a-9324-6d9bf2d92539"],

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  SuperscriptBox["\[ImaginaryJ]", "\[ImaginaryJ]"], "]"}]], "Input",
 CellChangeTimes->{{3.879257581100328*^9, 3.879257586618968*^9}},
 CellLabel->
  "In[882]:=",ExpressionUUID->"b9a15f9a-8f2a-4d95-84b6-b618d83e2c60"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   FractionBox["\[Pi]", "2"], "\[ImaginaryJ]", " ", 
   "\[ImaginaryJ]"}]]], "Input",
 CellChangeTimes->{{3.879257630199024*^9, 3.8792576643614073`*^9}},
 CellLabel->
  "In[883]:=",ExpressionUUID->"7d4a9298-2f75-4bcd-a392-b83f1e0b6c5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tmp", "Section",
 CellChangeTimes->{{3.883390514442354*^9, 
  3.883390517363635*^9}},ExpressionUUID->"52e9c100-b83e-484d-8061-\
1653eddb26ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "0"}], "}"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "10"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VectorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"10", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", "x", "+", 
          FractionBox["\[Pi]", "4"]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"Frame", "->", "False"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
     RowBox[{"VectorPoints", "->", "points"}], ",", 
     RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
     RowBox[{"VectorSizes", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.874760655743361*^9, 3.874760691395143*^9}, {
  3.874811793091303*^9, 3.874811839451764*^9}, {3.8748127313258467`*^9, 
  3.874812771079089*^9}, {3.8748145239237127`*^9, 3.87481452535867*^9}, {
  3.874817288457047*^9, 3.874817294061058*^9}},
 CellLabel->
  "In[884]:=",ExpressionUUID->"1df1953c-5fe4-48f0-8f13-35935d36a1f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"0.2", "x"}]], 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], "x"}], "+", 
                  FractionBox["\[Pi]", "4"]}], ")"}]}]]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"0.1", "x"}]], 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "x"}], "+", 
                  FractionBox["\[Pi]", "4"]}], ")"}]}]]}]}], ")"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", "\[Pi]", " ", "t"}]]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
         RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", "5"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], " ", "for", " ", 
     "waves", " ", "with", " ", "attenuation"}], ",", " ", 
    RowBox[{
    "it", " ", "gets", " ", "more", " ", "complex", " ", "and", " ", "we", 
     " ", "might", " ", "just", " ", "skip", " ", "it"}], ",", " ", 
    RowBox[{
     RowBox[{"or", " ", "put", " ", "this", " ", "in", " ", "multi"}], "-", 
     "layer"}]}], " ", "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.874507071293673*^9, 3.874507103451215*^9}, {
  3.874507167399686*^9, 3.8745071974024973`*^9}, {3.874507256382135*^9, 
  3.8745072695453377`*^9}, {3.874507307730732*^9, 3.8745073726376*^9}, {
  3.87623388481993*^9, 3.876233916676971*^9}, {3.8833957866170597`*^9, 
  3.883395795742322*^9}},
 CellLabel->
  "In[886]:=",ExpressionUUID->"a6422097-32c2-42e3-b3d4-a6c606a7f561"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transmission Lines", "Chapter",
 CellChangeTimes->{{3.876327765241503*^9, 
  3.876327811274897*^9}},ExpressionUUID->"93173e8b-127d-4099-89ca-\
73d59c67b73c"],

Cell["\<\
In many ways, the study of transmission line is a continuation of the study \
of wave behavior.\
\>", "Text",
 CellChangeTimes->{{3.8894540065908937`*^9, 
  3.889454023621441*^9}},ExpressionUUID->"e34cd0ed-32ab-4efd-9104-\
b793b190ffda"],

Cell[CellGroupData[{

Cell["Lossless lines", "Section",
 CellChangeTimes->{{3.883017205392343*^9, 
  3.883017208236817*^9}},ExpressionUUID->"0a67eeef-cc07-45cf-b4e3-\
ad3f56a8ff1c"],

Cell["We know that ", "Text",
 CellChangeTimes->{{3.883390920930385*^9, 3.883390923681596*^9}, {
  3.883391127924019*^9, 
  3.8833911294146757`*^9}},ExpressionUUID->"ad41c022-49ff-4c7d-8510-\
831739ff86cb"],

Cell[BoxData[
 RowBox[{"ComplexPlot", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8833911336696453`*^9, 
  3.88339113726822*^9}},ExpressionUUID->"f5d3d390-6526-4180-aaa3-\
e69ec0573983"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Smith Chart from Scratch", "Section",
 CellChangeTimes->{{3.883017205392343*^9, 3.883017208236817*^9}, {
  3.883390934903667*^9, 3.8833909364653273`*^9}, {3.8835383050487337`*^9, 
  3.8835383072597313`*^9}},ExpressionUUID->"379970fd-80a4-4dd5-b1c5-\
c8d569a0c3be"],

Cell[TextData[{
 "What\[CloseCurlyQuote]s the range of the magnitude of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8315b53d-a2a1-4b1b-96af-482cd28ca494"],
 " for any passive load?"
}], "Text",
 CellChangeTimes->{{3.8835403373923807`*^9, 3.883540365486041*^9}, {
  3.883540641285624*^9, 
  3.8835406463680363`*^9}},ExpressionUUID->"129b5462-56cb-4838-9be7-\
9b3d14ef9587"],

Cell[TextData[Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
       "0", "\[LessEqual]", "|", "\[CapitalGamma]", "|", "\[LessEqual]", 
        "1"}], TraditionalForm], "errors" -> {}, "input" -> 
    "0 \\leq \\lvert \\Gamma \\rvert \\leq 1", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], 
  TraditionalForm]],ExpressionUUID->"51b009b2-449a-47f4-9f1f-456759d7bdff"]], \
"CodeText",
 CellChangeTimes->{
  3.883540433652588*^9},ExpressionUUID->"e36b234a-6504-400b-bb30-\
972129c0c55e"],

Cell[TextData[{
 "If we plot an arbitrary  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84de4bd8-24b9-49fe-bda4-b1dd6ab16814"],
 " in the complex plane, in which area does it fall?"
}], "Text",
 CellChangeTimes->{{3.883540635051261*^9, 3.883540651103847*^9}, {
  3.883540713940083*^9, 3.883540746605441*^9}, {3.883541131287423*^9, 
  3.883541131633998*^9}, {3.8836346222459917`*^9, 
  3.883634624284379*^9}},ExpressionUUID->"43349a23-af05-4c66-a34c-\
8b8cca380bb2"],

Cell[TextData[{
 "It falls within a unit circle. The distance from the point to the origin \
would be the magnitude of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f6c32560-3008-45b6-94aa-18f80ed88597"],
 " and the angle it forms with the real axis is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8a7ff97-3c3e-4431-8395-b2e831fc3d13"],
 ". In other words, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac96c07f-072f-42b8-ae82-d1bc0e58603f"],
 " can be written as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"|", "\[CapitalGamma]", "|", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "\[Theta]"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\lvert \\Gamma \\rvert e^{j \\theta}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "300700de-2f30-4f25-8e3e-c48f6ec94a6b"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.883540763045991*^9, 3.883540921207478*^9}, {
  3.883540987753071*^9, 3.883540988651389*^9}, {3.883541019359541*^9, 
  3.883541026147743*^9}, {3.883541061164657*^9, 
  3.883541072601963*^9}},ExpressionUUID->"8f576446-7fd7-412f-9547-\
ae0ff55798b6"],

Cell[TextData[{
 "Which variables does ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "40b744a6-fad1-4d85-adeb-fcfef71170ee"],
 " depend on?"
}], "Text",
 CellChangeTimes->{{3.883541394985614*^9, 3.883541405421606*^9}, {
  3.883541587517407*^9, 3.8835415903296013`*^9}, {3.88363459742764*^9, 
  3.883634606875436*^9}},ExpressionUUID->"b1e36c97-06c7-4b56-a79a-\
686eddb81007"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["Z", "TI"], 
             StyleBox["L", "TI"]], "-", 
            SubscriptBox[
             StyleBox["Z", "TI"], "0"]}], 
          RowBox[{
            SubscriptBox[
             StyleBox["Z", "TI"], 
             StyleBox["L", "TI"]], "+", 
            SubscriptBox[
             StyleBox["Z", "TI"], "0"]}]]}], TraditionalForm], "errors" -> {},
      "input" -> "\\Gamma = \\frac{Z_L - Z_0}{Z_L + Z_0}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "248a9fe7-bfb9-4628-aeb4-f9243f432812"],
 ", we know that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "880deb7f-6e01-4737-a1fb-74d7b67d6d66"],
 " depends on two complex variables: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3d1a5d17-2c42-4d0c-a75d-e8a4fadd9d68"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "92c046c0-4bbe-4fff-867f-3d34d9f51c90"],
 "."
}], "CodeText",
 CellChangeTimes->{
  3.883541409822803*^9, {3.883541445357071*^9, 3.883541471647563*^9}, {
   3.8835417653550463`*^9, 
   3.883541773522395*^9}},ExpressionUUID->"62b1f168-4af6-4624-8c9b-\
18802b11a256"],

Cell[TextData[{
 "The key idea of a Smith Chart is to reduce that dependency to just one \
complex variable ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["Z", "TI"], 
          StyleBox["L", "TI"]], "/", 
         SubscriptBox[
          StyleBox["Z", "TI"], "0"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "z_L = Z_L / Z_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cad266eb-5b0b-4f0f-94bb-95fd98c254b7"],
 ", which we call the normalized load impedance. Express ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "90d96d03-265f-45b2-aa2c-b941889c0e89"],
 " in terms of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "z_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04a3dba7-a9ea-4e0f-b552-e6ecd143e628"],
 "."
}], "Text",
 CellChangeTimes->{{3.8835414862748127`*^9, 3.883541494371088*^9}, {
  3.883541549268626*^9, 3.883541571746539*^9}, {3.883541616353561*^9, 
  3.883541692188129*^9}, {3.883541777121909*^9, 
  3.883541777919998*^9}},ExpressionUUID->"9f142271-50f7-4325-acdf-\
632eb068d6a5"],

Cell[TextData[{
 "Divide the numerator and denominator of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          SubscriptBox[
           StyleBox["Z", "TI"], 
           StyleBox["L", "TI"]], "-", 
          SubscriptBox[
           StyleBox["Z", "TI"], "0"]}], 
        RowBox[{
          SubscriptBox[
           StyleBox["Z", "TI"], 
           StyleBox["L", "TI"]], "+", 
          SubscriptBox[
           StyleBox["Z", "TI"], "0"]}]], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{Z_L - Z_0}{Z_L + Z_0}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5924206a-713a-4804-b13d-b20dec4891cf"],
 " by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1fd6f6d2-1409-4261-81d4-f8d42834c4a5"],
 ", we get ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["z", "TI"], 
             StyleBox["L", "TI"]], "-", "1"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["z", "TI"], 
             StyleBox["L", "TI"]], "+", "1"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = \\frac{z_L - 1}{z_L + 1}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "338a05ed-38e4-412c-b22f-dc5bb57680fc"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.883541699039093*^9, 
  3.883541751511043*^9}},ExpressionUUID->"8a4465e6-9499-4561-8d63-\
f495f75a9301"],

Cell[TextData[{
 "Once we write ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["z", "TI"], 
             StyleBox["L", "TI"]], "-", "1"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["z", "TI"], 
             StyleBox["L", "TI"]], "+", "1"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = \\frac{z_L - 1}{z_L + 1}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f5ce669-c8a3-4dc9-9932-cf76bc1ebd39"],
 ", we know that for each ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "z_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "da7446f4-6618-4566-9ed7-38984cfcf7d4"],
 " there exists a ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c809d376-d918-490c-ae6f-2d3d74e822a7"],
 ". Of course, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "z_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88c7778b-7246-4723-8b35-45c7a35c6786"],
 " has a real (resistive) part  and an imaginary (reactive) part, i.e. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["r", "TI"], 
          StyleBox["L", "TI"]], "+", 
         StyleBox["j", "TI"], 
         SubscriptBox[
          StyleBox["x", "TI"], 
          StyleBox["L", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "z_L = r_L + j x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "787309a3-3319-495d-bd37-1f883539185f"],
 ". Thus ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["r", "TI"], 
             StyleBox["L", "TI"]], "+", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["L", "TI"]], "-", "1"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["r", "TI"], 
             StyleBox["L", "TI"]], "+", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["L", "TI"]], "+", "1"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\Gamma = \\frac{r_L + j x_L - 1}{r_L + j x_L + 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "944a9505-2164-452c-99d3-f537052af7d8"],
 ".  What have we achieved so far with load impedance normalization?"
}], "Text",
 CellChangeTimes->{{3.883586888131823*^9, 3.88358693258692*^9}, {
  3.8835870668619757`*^9, 3.883587113804204*^9}, {3.883587153159536*^9, 
  3.883587232205346*^9}, {3.8835873575141277`*^9, 3.88358753119309*^9}, {
  3.883587568685403*^9, 3.883587804030348*^9}, {3.883634664442486*^9, 
  3.883634665373995*^9}},ExpressionUUID->"68fcaa1a-de69-4d5c-94cf-\
a5e7cc9593d0"],

Cell[TextData[{
 "What we have done through normalization is that we effectively reduced the \
dependency of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "996113ca-e9ad-4fc3-8628-827925a3623b"],
 " from two complex numbers ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0bd19509-2f42-4c2f-8bdb-9b7c5cddaca5"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "200e4725-b77a-47ed-bf98-f11297f581c9"],
 " to two real numbers ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "affe0b90-32a0-44de-b353-53d59f2a6e3a"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9a74c0a0-3be6-43c2-90d4-14ef890f8664"],
 " which only concern the load."
}], "CodeText",
 CellChangeTimes->{
  3.883587762639207*^9},ExpressionUUID->"4226448d-4a66-4a28-ad8a-\
4f31dc65bd26"],

Cell[TextData[{
 "In the following plot, the red dot represents ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d06ae2e2-e0c8-49b0-8f97-08f53c45f6f1"],
 " in the complex plane, and its value is controlled by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d4212b7b-8293-4288-96bd-fd621dd3629f"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8bf6d8f6-53bd-40ae-b38b-5e51d6ea806d"],
 ". Manipulate both values: what conclusions can be draw?"
}], "Text",
 CellChangeTimes->{
  3.8835877761635847`*^9},ExpressionUUID->"0e708261-46ea-4265-93b0-\
23004e9212a9"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"ComplexListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "-", "1"}], 
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "+", "1"}]], "}"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1.1"}], "-", 
           RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
          RowBox[{"1.1", "+", 
           RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
           "RGBColorSwatchTemplate"], ",", 
          RowBox[{"PointSize", "[", "0.05", "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
     RowBox[{"PointLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(r\), \(L\)]\)\>\"", ",", 
           SubscriptBox["r", "L"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(x\), \(L\)]\)\>\"", ",", 
           SubscriptBox["x", "L"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
           FractionBox[
            RowBox[{
             SubscriptBox["r", "L"], "+", 
             RowBox[{"\[ImaginaryJ]", " ", 
              SubscriptBox["x", "L"]}], "-", "1"}], 
            RowBox[{
             SubscriptBox["r", "L"], "+", 
             RowBox[{"\[ImaginaryJ]", " ", 
              SubscriptBox["x", "L"]}], "+", "1"}]]}], "}"}]}], "}"}]}], 
      "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["r", "L"], ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "L"], ",", "0"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8835838431479397`*^9, 3.883583888261489*^9}, {
  3.88358395116439*^9, 3.883583964848763*^9}, {3.883583997252028*^9, 
  3.88358430551501*^9}, {3.883584359460429*^9, 3.883584393567864*^9}, {
  3.883584512310132*^9, 3.8835845703090057`*^9}, {3.8835856832925243`*^9, 
  3.883585689672811*^9}, {3.8835865062087812`*^9, 3.883586508522575*^9}, {
  3.8836209797466917`*^9, 3.8836209831370287`*^9}, {3.884572693593276*^9, 
  3.884572719576839*^9}, {3.8845734542271833`*^9, 3.884573494274701*^9}, {
  3.884573550006476*^9, 3.8845735749464483`*^9}},
 CellLabel->
  "In[1117]:=",ExpressionUUID->"a99aa70a-3c00-4c6c-9d87-fd28eb9cdc04"],

Cell[TextData[{
 "1. When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["x", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "x_L = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a48f04b8-d052-48cd-b3f2-f002fd99a8b4"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dcbc72f9-31cd-43d3-adc5-fc68efb34f16"],
 " moves only on the real axis: when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "de527c02-a618-4754-a656-fa4ca760cf4c"],
 " is also ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["0", TraditionalForm], "errors" -> {}, "input" -> "0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04af7daf-ceac-4899-965c-9149a56ab05f"],
 ", the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|
     "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
      "input" -> "\\Gamma", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], " "}], TraditionalForm]],ExpressionUUID->
  "18374af3-1417-4a83-9d4d-c5b8c6a5e23b"],
 " dot is at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-1", TraditionalForm], "errors" -> {}, "input" -> 
     "-1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d03d3385-bcd2-4442-ad47-bf60b93da115"],
 "; the dot moves to the right as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5a81c2c9-9b8b-4f5c-adc7-9a9862e8e95d"],
 " increases.\n2. When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "641051ca-32dc-489c-9b2d-8006ca1b3d15"],
 " is fixed, changing  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5dcae741-2056-4ab3-859d-c465b18d265b"],
 " moves ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eb60fed8-fddf-449f-a5e5-d1cfc5e2db63"],
 " along a circle. When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["x", "TI"], 
          StyleBox["L", "TI"]], ">", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "x_L > 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bcd16cb2-db91-4134-84cd-ee0452a8ef58"],
 " (inductive), the dot is above the real axis; when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["x", "TI"], 
          StyleBox["L", "TI"]], "<", "0"}], TraditionalForm], "errors" -> {}, 
     "input" -> "x_L < 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "310bfad1-f25d-4f9d-8781-e7ee116a2925"],
 " (capacitive), the dot is below the real axis.\n3. When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2e11ec26-9401-4fc5-b0a7-f02b6f90edd1"],
 " is fixed, changing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "32ed1613-0530-47f5-b697-b9fa21cd3675"],
 " also seems to move ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c902c0b9-43b5-4e54-a2aa-b6cddf6321a3"],
 " along a circle, although the radius of the circle is much larger when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       TemplateBox[{
         RowBox[{
           SubscriptBox[
            StyleBox["x", "TI"], 
            StyleBox["L", "TI"]]}]}, "Abs"], TraditionalForm], "errors" -> {},
      "input" -> "\\lvert x_L \\rvert", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5395a08e-a120-4985-9b3d-5ddad7c072be"],
 " is small.\n4. Overall, we can already see the pattern of a Smith Chart!"
}], "CodeText",
 CellChangeTimes->{{3.8835878401228323`*^9, 3.8835879164162273`*^9}, {
  3.883587947396928*^9, 3.883588246844964*^9}, {3.883588282996035*^9, 
  3.883588340237075*^9}, {3.883620605129262*^9, 
  3.883620621424255*^9}},ExpressionUUID->"fe810e6d-bbf3-40dd-8a4d-\
203f787d76e7"],

Cell[TextData[{
 "Also note that the traces of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dcb12c47-c122-4467-b1a4-eb77e46e88e5"],
 " are more sparse on the left side of the plot when the values of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "557b1a19-8f30-4f65-997c-3d95b3597bb1"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d463e6df-112b-4c4a-8e65-9f361f570983"],
 " are small. As ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9f03892e-16e3-4f4c-8eeb-5c19e4222055"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d0d94b79-a660-471a-a7ee-426eda291aec"],
 " grow larger, the red dot moves aggressively to the right side and the \
traces get much denser. We have limited the range of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "009d731d-7ccc-4739-9c76-03cf2645320f"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"0", ",", "10"}], "]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "[0, 10]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "897b4c21-93bb-4410-ae9e-e3f31c0967d5"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d4bb763-8dfd-427b-99cc-2df1cef16f25"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"-5", ",", "5"}], "]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "[-5, 5]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e4133b00-0dd9-4d2b-a587-f994f2019b78"],
 ". What load impedance does it represent when the red dot is at a position \
where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["r", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", "10"}], TraditionalForm], 
     "errors" -> {}, "input" -> "r_L = 10", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cf00e30b-cc28-47d5-841f-3be229a302b4"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["x", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", "5"}], TraditionalForm], 
     "errors" -> {}, "input" -> "x_L = 5", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5957ffac-509f-499e-a849-f71ce865d360"],
 " if the characteristic impedance ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "089d1470-f82d-4b24-bbec-07c14b542dc7"],
 " of the transmission line is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"50", "\[CapitalOmega]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "50 \\Omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "be782af9-6482-41e7-9a29-680313d03cf5"],
 "?"
}], "Text",
 CellChangeTimes->{{3.883620999372699*^9, 3.883621115853299*^9}, {
  3.883621156136972*^9, 3.883621212525174*^9}, {3.883621250648424*^9, 
  3.883621256210558*^9}, {3.8836212985672626`*^9, 
  3.883621473418092*^9}},ExpressionUUID->"69fae9dc-8a06-4ee1-a666-\
b341e3ac6c04"],

Cell[TextData[{
 "If we have ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", "10", "+", 
         StyleBox["j", "TI"], "5", "\[CapitalOmega]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z_L = 10 + j 5 \\Omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "736f55e0-72e9-4912-8aed-b0207c5dc09c"],
 ", then the actual load impedance is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"500", "+", 
         StyleBox["j", "TI"], "250", "\[CapitalOmega]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "500 + j 250 \\Omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8553b843-48a7-42c9-a0cb-839fd7964d77"],
 " when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["Z", "TI"], "0"], "\[LongEqual]", "50", 
         "\[CapitalOmega]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_0 = 50 \\Omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51f795db-42fb-4638-8f70-f792af90aff5"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.883621502861061*^9, 3.883621540408345*^9}, {
  3.883621576878489*^9, 
  3.883621642032433*^9}},ExpressionUUID->"a930a868-956e-4b89-b650-\
43348a92ba9e"],

Cell[TextData[{
 "And what happens when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["r", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "r_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3a1ef89c-e6d6-48ae-b4c0-cbef4e38503f"],
 " or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       TemplateBox[{
         RowBox[{
           SubscriptBox[
            StyleBox["x", "TI"], 
            StyleBox["L", "TI"]]}]}, "Abs"], TraditionalForm], "errors" -> {},
      "input" -> "\\lvert x_L \\rvert", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b29f0e33-0429-4280-85fd-5533ee364bc5"],
 " goes to infinity?"
}], "Text",
 CellChangeTimes->{{3.8836216603633204`*^9, 3.883621703753249*^9}, {
  3.8836256923842373`*^9, 3.883625697639325*^9}, {3.883626196992704*^9, 
  3.883626197598098*^9}},ExpressionUUID->"94985e90-d522-4f77-b002-\
36c4f07b0626"],

Cell[TextData[{
 "The red dot moves infinitely close to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba7ae7e9-1ba5-4188-ac19-4db54341e2b5"],
 " on the real axis."
}], "CodeText",
 CellChangeTimes->{{3.8836262035101748`*^9, 
  3.8836262437354593`*^9}},ExpressionUUID->"be92e71f-8b8f-4a30-a70f-\
ff98e7e5a8ad"],

Cell["\<\
Now that you know how this works, try to plot a baby version of a Smith Chart.\
\>", "Text",
 CellChangeTimes->{{3.88362628321877*^9, 
  3.88362629791962*^9}},ExpressionUUID->"4b7a9f2e-651c-4ffc-bbca-\
5af2c31524ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BabySmith", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ComplexListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "-", "1"}], 
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "+", "1"}]], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["r", "L"], ",", "0", ",", "10", ",", "0.5"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "L"], ",", 
          RowBox[{"-", "5"}], ",", "5", ",", "0.05"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.1"}], "-", 
          RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
         RowBox[{"1.1", "+", 
          RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
    RowBox[{"ComplexListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "-", "1"}], 
         RowBox[{
          SubscriptBox["r", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["x", "L"]}], "+", "1"}]], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "L"], ",", 
          RowBox[{"-", "5"}], ",", "5", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["r", "L"], ",", "0", ",", "10", ",", "0.05"}], "}"}]}],
        "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.1"}], "-", 
          RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
         RowBox[{"1.1", "+", 
          RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.884572493154955*^9, 3.884572510873027*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"12ab6136-ab3d-4243-835f-43a04099003c"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"BabySmith", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.883634886733191*^9, 3.88363491047299*^9}, {
  3.883635082483574*^9, 3.883635095520343*^9}, {3.883635137304674*^9, 
  3.883635178617199*^9}, {3.883636348535067*^9, 3.883636366280826*^9}, {
  3.883636656335216*^9, 3.8836366617215033`*^9}, {3.883636715916379*^9, 
  3.883636717907072*^9}, {3.8836367656306543`*^9, 3.88363677067978*^9}, {
  3.884572321822097*^9, 3.884572324540637*^9}, {3.8845724877925797`*^9, 
  3.8845725193425426`*^9}},
 CellLabel->
  "In[1118]:=",ExpressionUUID->"3366e5dd-d24e-4218-93c8-7a6939330332"],

Cell[CellGroupData[{

Cell["Admittance", "Subsection",
 CellChangeTimes->{{3.883705647573168*^9, 
  3.8837056513174257`*^9}},ExpressionUUID->"fe9336a1-9852-46a3-9e8f-\
5b68476bb411"],

Cell["\<\
We know that admittance is the inverse of impedance. How is the reflection \
coefficient defined in terms of admittance instead of impedance?\
\>", "Text",
 CellChangeTimes->{{3.883705661579587*^9, 3.883705670913547*^9}, {
  3.88370959086019*^9, 3.883709603471485*^9}, {3.883709661022629*^9, 
  3.883709676865183*^9}, {3.8841995347368097`*^9, 
  3.884199534914899*^9}},ExpressionUUID->"d6e9b008-5e82-449c-8e0b-\
0192d9b89328"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  FractionBox[
   RowBox[{
    FractionBox["1", 
     SubscriptBox["Y", "L"]], "-", 
    FractionBox["1", 
     SubscriptBox["Y", "0"]]}], 
   RowBox[{
    FractionBox["1", 
     SubscriptBox["Y", "L"]], "+", 
    FractionBox["1", 
     SubscriptBox["Y", "0"]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.883709609317906*^9, 3.883709648396896*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"f2ce0633-3136-49d6-8fc2-aca78550c25a"],

Cell[TextData[{
 "We can similarly normalize ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Y", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "Y_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8c0cb0c-e18b-4375-b1b2-96be63650ada"],
 " against ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Y", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "Y_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9cf1ce55-1f8b-4079-984d-91b868a1cc8d"],
 " and get ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{"1", "-", 
            SubscriptBox[
             StyleBox["y", "TI"], 
             StyleBox["L", "TI"]]}], 
          RowBox[{"1", "+", 
            SubscriptBox[
             StyleBox["y", "TI"], 
             StyleBox["L", "TI"]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma = \\frac{1 - y_L}{1 + y_L}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c5336790-f8cf-4ac8-b167-2e76b0f0a5b1"],
 ". Again, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["y", "TI"], 
          StyleBox["L", "TI"]], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["g", "TI"], 
          StyleBox["L", "TI"]], "+", 
         StyleBox["j", "TI"], 
         SubscriptBox[
          StyleBox["b", "TI"], 
          StyleBox["L", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "y_L = g_L + j b_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "71ad1683-e574-4ae5-9a63-0233485c1554"],
 ", where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "g_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fc4cd3e7-a490-4c7e-9ef2-eb2159c19bc2"],
 " is the normalized conductance and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "b_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8bd5d5bf-6cd4-432c-a152-0f7b8747a642"],
 " is the normalized susceptance. Thus ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{"1", "-", 
            SubscriptBox[
             StyleBox["g", "TI"], 
             StyleBox["L", "TI"]], "-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["b", "TI"], 
             StyleBox["L", "TI"]]}], 
          RowBox[{"1", "+", 
            SubscriptBox[
             StyleBox["g", "TI"], 
             StyleBox["L", "TI"]], "+", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["b", "TI"], 
             StyleBox["L", "TI"]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma = \\frac{1 - g_L - j b_L}{1 + g_L + j b_L}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8dc1213f-1a5c-4882-b8ef-4849fbb4c04f"],
 ". Let us also plot a red dot representing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7a19a6f0-073f-4b34-ae69-2aff0e7c6ccc"],
 " in the complex plane, and its value is controlled by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "g_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "df895d59-948a-47a2-ab1e-8aee91cb0425"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["L", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "b_L", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5da12bcd-d12c-43ad-8de1-1fd1a6cb28ec"],
 ". Manipulate both values: what conclusions can be draw?"
}], "Text",
 CellChangeTimes->{{3.884199945180937*^9, 3.884199992848653*^9}, 
   3.884200039770844*^9, {3.8842001092777357`*^9, 3.884200182206779*^9}, {
   3.884200225320057*^9, 
   3.884200304359643*^9}},ExpressionUUID->"0937dd53-77e0-4738-9828-\
1b7e97f1020c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"ComplexListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        FractionBox[
         RowBox[{"1", "-", 
          SubscriptBox["g", "L"], "-", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["b", "L"]}]}], 
         RowBox[{"1", "+", 
          SubscriptBox["g", "L"], "+", 
          RowBox[{"\[ImaginaryJ]", " ", 
           SubscriptBox["b", "L"]}]}]], "}"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1.1"}], "-", 
           RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
          RowBox[{"1.1", "+", 
           RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
           "RGBColorSwatchTemplate"], ",", 
          RowBox[{"PointSize", "[", "0.05", "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
     RowBox[{"PointLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(g\), \(L\)]\)\>\"", ",", 
           SubscriptBox["g", "L"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(b\), \(L\)]\)\>\"", ",", 
           SubscriptBox["b", "L"]}], "}"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["g", "L"], ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["b", "L"], ",", "0"}], "}"}], ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8842003264723997`*^9, 3.884200326972107*^9}, {
  3.884200367007456*^9, 3.884200452631691*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"9139f8f1-f339-46bb-815d-7eb88e542b18"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ComplexListPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         SubscriptBox["g", "L"], "-", 
         RowBox[{"\[ImaginaryJ]", " ", 
          SubscriptBox["b", "L"]}]}], 
        RowBox[{"1", "+", 
         SubscriptBox["g", "L"], "+", 
         RowBox[{"\[ImaginaryJ]", " ", 
          SubscriptBox["b", "L"]}]}]], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["g", "L"], ",", "0", ",", "10", ",", "0.5"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["b", "L"], ",", 
         RowBox[{"-", "5"}], ",", "5", ",", "0.05"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.1"}], "-", 
         RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
        RowBox[{"1.1", "+", 
         RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
     RowBox[{"Joined", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"ComplexListPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         SubscriptBox["g", "L"], "-", 
         RowBox[{"\[ImaginaryJ]", " ", 
          SubscriptBox["b", "L"]}]}], 
        RowBox[{"1", "+", 
         SubscriptBox["g", "L"], "+", 
         RowBox[{"\[ImaginaryJ]", " ", 
          SubscriptBox["b", "L"]}]}]], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["b", "L"], ",", 
         RowBox[{"-", "5"}], ",", "5", ",", "0.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["g", "L"], ",", "0", ",", "10", ",", "0.05"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.1"}], "-", 
         RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}], ",", 
        RowBox[{"1.1", "+", 
         RowBox[{"\[ImaginaryJ]", " ", "1.1"}]}]}], "}"}]}], ",", 
     RowBox[{"Joined", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8842004957269163`*^9, 3.884200529859374*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"a6fa7946-a20e-4522-a0c9-bca51d5043bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Impedance Matching with Smith Chart", "Section",
 CellChangeTimes->{{3.884573620501316*^9, 
  3.88457365662573*^9}},ExpressionUUID->"762f8ee2-2e28-4525-a483-\
2f0bd28585a9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"babySmith", "=", 
     RowBox[{"BabySmith", "[", "]"}]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"babySmith", ",", 
       RowBox[{"Legended", "[", 
        RowBox[{
         RowBox[{"ComplexListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            FractionBox[
             RowBox[{
              SubscriptBox["r", "L"], "+", 
              RowBox[{"\[ImaginaryJ]", " ", 
               SubscriptBox["x", "L"]}], "-", "1"}], 
             RowBox[{
              SubscriptBox["r", "L"], "+", 
              RowBox[{"\[ImaginaryJ]", " ", 
               SubscriptBox["x", "L"]}], "+", "1"}]], "}"}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
               "RGBColorSwatchTemplate"], ",", 
              RowBox[{"PointSize", "[", "0.025", "]"}]}], "}"}]}]}], "]"}], 
         ",", 
         RowBox[{"PointLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"], ",", 
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"], ",", 
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<\!\(\*SubscriptBox[\(r\), \(L\)]\)\>\"", ",", 
               SubscriptBox["r", "L"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\!\(\*SubscriptBox[\(x\), \(L\)]\)\>\"", ",", 
               SubscriptBox["x", "L"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
               FractionBox[
                RowBox[{
                 SubscriptBox["r", "L"], "+", 
                 RowBox[{"\[ImaginaryJ]", " ", 
                  SubscriptBox["x", "L"]}], "-", "1"}], 
                RowBox[{
                 SubscriptBox["r", "L"], "+", 
                 RowBox[{"\[ImaginaryJ]", " ", 
                  SubscriptBox["x", "L"]}], "+", "1"}]]}], "}"}]}], "}"}]}], 
          "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["r", "L"], ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "L"], ",", "0"}], "}"}], ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.884573779502225*^9, 3.8845737968323298`*^9}, {
   3.884573830396864*^9, 3.884573855335978*^9}, {3.884573964390386*^9, 
   3.884574014875671*^9}, {3.884574154379562*^9, 3.884574325732527*^9}, 
   3.884574622741699*^9, 3.884575093480959*^9, {3.8845752061745872`*^9, 
   3.884575213412044*^9}, 3.884575249995335*^9, {3.884575302776087*^9, 
   3.884575314269204*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"f2ed103c-6118-461b-8da6-372935e6b6f1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"babySmith", "=", 
     RowBox[{"BabySmith", "[", "]"}]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"babySmith", ",", 
       RowBox[{"Legended", "[", 
        RowBox[{
         RowBox[{"ComplexListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[CapitalGamma]", "0"], " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", "\[Theta]"}]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", "2", "\[Pi]", 
               " ", "l"}]]}], "}"}], ",", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
               "RGBColorSwatchTemplate"], ",", 
              RowBox[{"PointSize", "[", "0.025", "]"}]}], "}"}]}]}], "]"}], 
         ",", 
         RowBox[{"PointLegend", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"], ",", 
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"], ",", 
             TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
              "RGBColorSwatchTemplate"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<|\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(0\)]\)|\>\"", 
               ",", 
               SubscriptBox["\[CapitalGamma]", "0"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<\[Theta]\>\"", ",", "\[Theta]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<l\>\"", ",", 
               RowBox[{
                RowBox[{"ToString", "[", "l", "]"}], "<>", 
                "\"\<\[Lambda]\>\""}]}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CapitalGamma]", "0"], ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", "0.5", ",", "0.01"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8845745866649942`*^9, 3.884574602401485*^9}, {
  3.8845746359494057`*^9, 3.884574706114277*^9}, {3.88457473725996*^9, 
  3.88457474998055*^9}, {3.8845753816494102`*^9, 3.884575516175913*^9}, {
  3.8845758885248327`*^9, 3.884576073272046*^9}, {3.8845761934384747`*^9, 
  3.884576194045869*^9}, {3.884576229343204*^9, 3.884576241831914*^9}, {
  3.884576282667544*^9, 3.8845763085311728`*^9}, {3.884576687876067*^9, 
  3.8845766889793262`*^9}, {3.884581974857575*^9, 3.884581975591983*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"c220fdcd-e517-4f88-98ef-e13419a38989"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexPlot3D", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"\[CapitalGamma]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", "2", "\[Pi]", " ", 
          "l"}]]}]}], 
      RowBox[{"1", "-", 
       RowBox[{"\[CapitalGamma]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", "2", "\[Pi]", " ", 
          "l"}]]}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"\[CapitalGamma]", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[ImaginaryJ]"}], ",", 
       RowBox[{"1", "+", "\[ImaginaryJ]"}]}], "}"}], ",", 
     RowBox[{"RegionFunction", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "\[Gamma]", "}"}], ",", 
        RowBox[{"0", "<=", 
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "<=", "1"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"Opacity", "[", "0.5", "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "0", ",", "0.5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.88458225102696*^9, 3.8845823477087927`*^9}, {
  3.884582422018424*^9, 3.884582424625246*^9}, {3.884582488034568*^9, 
  3.884582643175581*^9}, {3.884583115667061*^9, 3.884583150697591*^9}, {
  3.884583435676271*^9, 3.8845834451691713`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"4d207266-fa0e-47e4-94c4-d09fa44e0a7c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "0"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "\[Theta]"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", "2", "\[Pi]", " ", 
           "l"}]]}]}], 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["\[CapitalGamma]", "0"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "\[Theta]"}]], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", "2", "\[Pi]", " ", 
           "l"}]]}]}]], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryJ]"}], " ", "25"}], ",", 
        RowBox[{"50", "+", 
         RowBox[{"\[ImaginaryJ]", " ", "25"}]}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
         "RGBColorSwatchTemplate"], ",", 
        RowBox[{"PointSize", "[", "0.05", "]"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CapitalGamma]", "0"], ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l", ",", "0", ",", "0.5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.884583356389118*^9, 3.884583413319181*^9}, {
  3.884583461825498*^9, 3.8845834667839947`*^9}, {3.884583516836729*^9, 
  3.884583539767068*^9}, {3.8845835821702347`*^9, 3.884583589687634*^9}, {
  3.884583907940466*^9, 3.8845839279103203`*^9}, {3.88458395929748*^9, 
  3.884583962489699*^9}, {3.8845840746008244`*^9, 3.884584085663062*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"24b3107a-7517-450d-b90b-f1cbec88f5f1"],

Cell[TextData[{
 "The effect of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["l", "TI"], TraditionalForm], "errors" -> {}, "input" -> "l", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "75b175dd-09e7-4516-9731-a854a6c6bb61"],
 " is to seemingly modify the angle ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2adb9de3-e54a-4b7b-aa7d-406df20c7f0e"],
 " of the reflection coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9d11bb9b-aa20-42dd-8a62-332d3ad161a7"],
 ". TODO: limit range, legend. TODO: plot a \[OpenCurlyDoubleQuote]Smith \
Chart\[CloseCurlyDoubleQuote]-like chart for this one."
}], "Text",
 CellChangeTimes->{{3.884583771334531*^9, 3.88458380108244*^9}, {
  3.884584100514803*^9, 3.884584135147883*^9}, {3.884584339928873*^9, 
  3.884584349750667*^9}},ExpressionUUID->"a9395cce-d394-410b-989d-\
13e885b6d230"],

Cell["\<\
TODO: plot the situation when matching with a stub. Standing wave in the \
stub. Why this works? My guess: because we move towards the point where the \
standing wave envelope is at minimum.\
\>", "Text",
 CellChangeTimes->{{3.884584352102476*^9, 
  3.884584408969091*^9}},ExpressionUUID->"16a4ebb1-40bb-4af6-ab5e-\
dfa5f3c338c2"],

Cell[TextData[{
 "TODO: Why is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "In"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eb67ad2d-58c7-42c5-8716-119269d066ac"],
 " useful? Do we want ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "in"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "def483fe-92b6-43f5-9ac0-3fbf7dd69349"],
 " to equal ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fdcc36d9-a857-41c3-accd-4d0fc7f2d20e"],
 "? (See P.59). If so, do we want to plot the surface intersecting the plane \
where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "in"], "=", " ", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "744ffcac-3eb7-4577-90ff-02bac55b19a3"],
 "?"
}], "Text",
 CellChangeTimes->{{3.884585358838078*^9, 
  3.884585433523081*^9}},ExpressionUUID->"689a77b1-5e98-4bc3-9580-\
4df464fa0f9f"],

Cell[TextData[{
 "TODO: does it matter where is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z  = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dcbb21bf-88d0-4df6-b466-9107bcaf0974"],
 "?"
}], "Text",
 CellChangeTimes->{{3.884585513889617*^9, 
  3.884585532383114*^9}},ExpressionUUID->"28837d7d-a1c2-4bce-a772-\
a3a67dfa1ed7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vector Analysis", "Chapter",
 CellChangeTimes->{{3.874294011728221*^9, 3.874294016217432*^9}, {
  3.8744540204286127`*^9, 3.874454031828761*^9}, {3.874454209303813*^9, 
  3.874454212208919*^9}},ExpressionUUID->"373c961d-29e7-49ab-b1e8-\
df27aaaa0133"],

Cell[CellGroupData[{

Cell["Fields", "Section",
 CellChangeTimes->{{3.889371469617585*^9, 
  3.889371472201951*^9}},ExpressionUUID->"3754a648-875d-485f-af0c-\
c162028866c8"],

Cell["Now, come up with a 2D scalar field and plot it.", "Text",
 CellChangeTimes->{{3.876235560876924*^9, 3.876235569776856*^9}, {
   3.876235633178939*^9, 3.876235637826468*^9}, {3.8762356737135973`*^9, 
   3.8762356745583572`*^9}, {3.889368628114558*^9, 3.889368629117807*^9}, {
   3.889368881359178*^9, 3.889368891290299*^9}, 3.889371448876336*^9, 
   3.8893714820458593`*^9},ExpressionUUID->"f8f3f021-8427-49fc-b19e-\
6fdbca9fe151"],

Cell[TextData[{
 "How about ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["f", "TI"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["y", "TI"]}], ")"}], "\[LongEqual]", "sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "f(x,y) = \\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "79649f21-6145-4226-9291-dcc568946482"],
 "? There are two ways to plot it: we can either use color to represent the \
value of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["f", "TI"], TraditionalForm], "errors" -> {}, "input" -> "f", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "026856c4-912b-4953-b074-171a87d002f3"]
}], "CodeText",
 CellChangeTimes->{{3.876235574091505*^9, 3.8762356002263813`*^9}, {
  3.87623592639613*^9, 3.876235959662711*^9}, {3.889368897610865*^9, 
  3.889368938841549*^9}, {3.889371356288765*^9, 
  3.889371357583291*^9}},ExpressionUUID->"ea96f5ca-064e-432d-b284-\
0cb48ada1dba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ScalarFieldPlot", "[", "f_", "]"}], ":=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"ColorFunction", "->", "\"\<MintColors\>\""}], ",", 
    RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScalarFieldPlot2", "[", "f_", "]"}], ":=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"ColorFunction", "->", "\"\<Pastel\>\""}], ",", 
    RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876235893035027*^9, 3.8762358959107103`*^9}, {
   3.876236803719454*^9, 3.876236942108287*^9}, {3.876237010414137*^9, 
   3.8762370244709272`*^9}, {3.876237499848096*^9, 3.8762375003661737`*^9}, {
   3.889371956528915*^9, 3.889371986688797*^9}, {3.8893733151515703`*^9, 
   3.889373315776424*^9}, {3.889375428013134*^9, 3.889375431697258*^9}, {
   3.889377337353322*^9, 3.88937736862398*^9}, 3.8893776930426598`*^9, {
   3.889377808817981*^9, 3.889377810262747*^9}, {3.889377863732815*^9, 
   3.889377865563643*^9}, {3.8893779244401693`*^9, 3.889377926514976*^9}, {
   3.889377959221416*^9, 3.889377960618959*^9}, {3.889379254629788*^9, 
   3.88937927690106*^9}, {3.8893793775283546`*^9, 3.889379389099882*^9}, {
   3.889379442582075*^9, 3.889379451583914*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"256586c2-b707-4b0f-9489-f3b9175212bb"],

Cell[BoxData[
 RowBox[{"ScalarFieldPlot", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "x", "]"}], 
   RowBox[{"Sin", "[", "y", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.889371990363449*^9, 3.8893719954409933`*^9}, {
  3.889373321932632*^9, 3.889373322614349*^9}},
 CellLabel->
  "In[990]:=",ExpressionUUID->"605cabff-11ab-444f-8aba-4a49817c156c"],

Cell[TextData[{
 "Or we can think of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["f", "TI"], TraditionalForm], "errors" -> {}, "input" -> "f", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "853c7e6b-39dc-41fe-b7b9-6c745c8fc650"],
 " as the height or altitude of a surface above the x-y plane"
}], "CodeText",
 CellChangeTimes->{{3.889368946430995*^9, 3.889368955255394*^9}, {
  3.889371323698639*^9, 
  3.889371371458581*^9}},ExpressionUUID->"90861758-302d-4561-83d9-\
9e511ba93975"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], 
    RowBox[{"Sin", "[", "y", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876235905422555*^9, 3.876235914633149*^9}, {
  3.8762368262042913`*^9, 3.8762368527386913`*^9}, {3.876236954177783*^9, 
  3.8762369581690607`*^9}},
 CellLabel->
  "In[991]:=",ExpressionUUID->"b7cd1577-ca15-4c86-99c4-e551a36cf4ae"],

Cell["Compute its gradient and plot it.", "Text",
 CellChangeTimes->{{3.876236218823848*^9, 
  3.8762362234476547`*^9}},ExpressionUUID->"cb1a6bbc-6b13-4326-bf6f-\
780a914da319"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], 
    RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.876235974769218*^9, 3.876236004243537*^9}, {
  3.876236104764922*^9, 3.8762361264144497`*^9}, {3.876236195645671*^9, 
  3.876236204309853*^9}, {3.876236967557431*^9, 3.876236972551957*^9}, {
  3.8893716945962257`*^9, 3.889371700156842*^9}},
 CellLabel->
  "In[992]:=",ExpressionUUID->"367ea366-ab5e-4c6a-8362-0d8bae930b7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectorFieldPlot", "[", "f_", "]"}], ":=", 
  RowBox[{"VectorPlot", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
    RowBox[{"ImageSize", "->", "Medium"}], ",", 
    RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8893733428008537`*^9, 3.889373359707714*^9}, {
  3.889375442248027*^9, 3.889375444501637*^9}, {3.889379416006433*^9, 
  3.88937941765275*^9}, {3.8893794552527733`*^9, 3.8893794570356817`*^9}, {
  3.889379572046376*^9, 3.889379578663663*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"ec3db1ed-48d7-4d94-8a9c-520efdeed51b"],

Cell[BoxData[
 RowBox[{"VectorFieldPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], " ", 
     RowBox[{"Sin", "[", "y", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", "y", "]"}], " ", 
     RowBox[{"Sin", "[", "x", "]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889373462131256*^9, 3.8893734820704412`*^9}},
 CellLabel->
  "In[994]:=",ExpressionUUID->"2bd4df48-d438-493b-8880-694f3ec5c77f"],

Cell["The gradient is a vector field.", "CodeText",
 CellChangeTimes->{{3.8762362314406633`*^9, 
  3.8762362378613567`*^9}},ExpressionUUID->"eefdfe68-77ea-48c7-92d2-\
c6b79c83fa7b"],

Cell["\<\
Now, plot the scalar field and its gradient vector field together.\
\>", "Text",
 CellChangeTimes->{{3.876237126575973*^9, 3.8762371571677933`*^9}, {
  3.889371845213872*^9, 
  3.889371846841066*^9}},ExpressionUUID->"d477e588-c5f0-46a5-9fe8-\
0a2a9b62cff0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GradientOf", "[", "f_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ScalarFieldPlot", "[", "f", "]"}], ",", 
    RowBox[{"VectorFieldPlot", "[", 
     RowBox[{
      SubscriptBox["\[Del]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]], "f"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.889372086089551*^9, 3.8893721029126062`*^9}, {
  3.889372381983783*^9, 3.8893723993855553`*^9}, {3.889373497312282*^9, 
  3.889373520582664*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"b8332123-4232-47c5-9503-9f4cd1297122"],

Cell[BoxData[
 RowBox[{"GradientOf", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "x", "]"}], 
   RowBox[{"Sin", "[", "y", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8893724031967373`*^9, 3.88937240913586*^9}},
 CellLabel->
  "In[996]:=",ExpressionUUID->"3fb49aa4-c4ad-49f1-ad4b-3f0ab9f9c78c"],

Cell["Does this graph fit your understanding of the gradient?", "Text",
 CellChangeTimes->{{3.876237180169956*^9, 3.876237227641014*^9}, {
  3.889372507424797*^9, 
  3.889372547152051*^9}},ExpressionUUID->"0d266c1d-6da3-4f1e-9e0f-\
b1883cdb338f"],

Cell["\<\
A vector in the gradient field represents the \
\[OpenCurlyDoubleQuote]direction and rate of fastest increase\
\[CloseCurlyDoubleQuote], which is clear in this overlapping plot.\
\>", "CodeText",
 CellChangeTimes->{{3.8893725976926317`*^9, 3.889372672685321*^9}, {
  3.8893727049688272`*^9, 
  3.8893727147497377`*^9}},ExpressionUUID->"bcb854b4-e889-4a66-b01a-\
e9f9a75e0444"],

Cell[TextData[{
 "Here is the gradient of another scalar field ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["x", "TI"], "2"], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "x^2\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6210ed98-310c-41c3-8cde-ba1c6d2b2e48"]
}], "Text",
 CellChangeTimes->{{3.889435614790813*^9, 
  3.8894356452191963`*^9}},ExpressionUUID->"a2f9d9f8-f010-42db-9718-\
2e26749651b5"],

Cell[BoxData[
 RowBox[{"GradientOf", "[", 
  RowBox[{
   SuperscriptBox["x", "2"], 
   RowBox[{"Sin", "[", "y", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.88937397575382*^9, 3.889374001986518*^9}},
 CellLabel->
  "In[997]:=",ExpressionUUID->"2535b555-784d-49b9-8731-d286fe8a7d66"],

Cell["\<\
Looking at these two gradient plots, what else can you notice about the \
gradient field?\
\>", "Text",
 CellChangeTimes->{
  3.889372545135499*^9, {3.889435659216751*^9, 
   3.889435678007485*^9}},ExpressionUUID->"17e9e0ca-3b5c-43a8-8a58-\
c0ea19e12945"],

Cell["\<\
I can see that in some spots, the arrows are pointing away while in some \
other spots, the arrows are pointing towards a point. In other words, it \
appears that some locations act as a \[OpenCurlyDoubleQuote]source\
\[CloseCurlyDoubleQuote] of the field lines, whereas other locations act as a \
\[OpenCurlyDoubleQuote]sink\[CloseCurlyDoubleQuote] of the field lines.\
\>", "CodeText",
 CellChangeTimes->{{3.876237229699505*^9, 3.8762372623829193`*^9}, {
  3.889372731999215*^9, 
  3.8893727749464607`*^9}},ExpressionUUID->"e62c3750-97a4-4b45-91e1-\
13922ffa894d"],

Cell["\<\
This \[OpenCurlyDoubleQuote]sourcing\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]sinking\[CloseCurlyDoubleQuote] can be represented by \
the divergence. Can you plot the divergence of the gradient field above?\
\>", "Text",
 CellChangeTimes->{{3.8762372833837976`*^9, 3.876237321351307*^9}, {
  3.889372726241527*^9, 3.889372729709999*^9}, {3.889372782993681*^9, 
  3.889372829662109*^9}},ExpressionUUID->"a9043855-c147-4970-84cf-\
acef0695e439"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]], ".", 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.889372864019643*^9},
 CellLabel->
  "In[998]:=",ExpressionUUID->"49fa9310-48f2-4270-8706-d58392ea898e"],

Cell[TextData[{
 "It seems that taking the divergence of the gradient of this particular \
scalar field ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f03696d7-a91a-4ac9-acda-39895de0a470"],
 " simply multiplies it by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-2", TraditionalForm], "errors" -> {}, "input" -> 
     "-2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a89f0064-0188-493f-83b5-834bf344e736"]
}], "CodeText",
 CellChangeTimes->{{3.8893765759741917`*^9, 
  3.889376621414483*^9}},ExpressionUUID->"2e2d9eec-efce-45b8-bcc2-\
c1deb6005d4b"],

Cell[BoxData[
 RowBox[{"ScalarFieldPlot", "[", 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]], ".", 
   RowBox[{
    SubscriptBox["\[Del]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}], "]"}]], "Input",
 CellLabel->
  "In[999]:=",ExpressionUUID->"f30eedf9-141d-4b46-a4f8-10fdcca05667"],

Cell[TextData[{
 "The plot does not look too different from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3d1d940a-6b53-46b5-afbe-00650d22fe4a"],
 " itself except that the colors are flipped, and the range of the color bar \
changed from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"-1", ",", "1"}], "]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "[-1, 1]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "754a020f-bf4c-4252-a7c4-43d776119d27"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"-2", ",", "2"}], "]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "[-2, 2]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "33878202-05af-49d5-96fa-966c2f19b1cd"],
 ", as expected."
}], "CodeText",
 CellChangeTimes->{{3.889376550105873*^9, 3.8893765737735*^9}, {
  3.889376639330866*^9, 
  3.8893766894203587`*^9}},ExpressionUUID->"c44d1805-e4a9-4bf2-962b-\
604e86bed803"],

Cell[TextData[{
 "It is illustrative to plot the original scalar field ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4a707789-0d80-4211-812f-2af85d4a4b93"],
 ", its gradient, and the divergence of the gradient side by side."
}], "Text",
 CellChangeTimes->{{3.8893764789152803`*^9, 3.889376533917543*^9}, {
  3.889435728236539*^9, 
  3.889435730600019*^9}},ExpressionUUID->"f3958ea8-dac4-421a-91b7-\
d54b151ebcad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ScalarFieldPlot", "[", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}], "]"}], ",", 
   RowBox[{"VectorFieldPlot", "[", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], 
       RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}], "]"}], ",", 
   RowBox[{"ScalarFieldPlot2", "[", 
    RowBox[{
     SubscriptBox["\[Del]", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]], ".", 
     RowBox[{
      SubscriptBox["\[Del]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sin", "[", "x", "]"}], 
        RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}], "]"}]}], "}"}]], "Input",\

 CellChangeTimes->{{3.889373294394856*^9, 3.889373302415206*^9}, {
   3.889375339558674*^9, 3.889375420993095*^9}, {3.8893756754923763`*^9, 
   3.8893756815401297`*^9}, 3.889378043025983*^9},
 CellLabel->
  "In[1000]:=",ExpressionUUID->"57a3253e-45b1-40b3-925f-55cfda18fae9"],

Cell["\<\
We chose to plot the divergence field in a different color to differentiate \
it from the original scalar field. Compare the divergence on the right side \
with the gradient vector field in the middle, what can you tell?\
\>", "Text",
 CellChangeTimes->{{3.889376710728526*^9, 3.8893767762906723`*^9}, {
  3.889378322963277*^9, 3.889378324636303*^9}, {3.8894357334611673`*^9, 
  3.889435760882875*^9}},ExpressionUUID->"7ceccd41-b9de-4186-a06a-\
5b903ce63729"],

Cell["\<\
We can see that the locations that have a positive divergence act as the \
sources and the locations that have a negative divergence act as sinks. In \
other words, where the divergence is positive, the vector field tends to \
\[OpenCurlyDoubleQuote]flow away\[CloseCurlyDoubleQuote] from that point; \
where the divergence is negative, the vector field tends to \
\[OpenCurlyDoubleQuote]flow into\[CloseCurlyDoubleQuote] that point.\
\>", "CodeText",
 CellChangeTimes->{{3.889373809909369*^9, 3.889373901210957*^9}, 
   3.889375312606595*^9, {3.8893754652018557`*^9, 3.88937546636554*^9}, {
   3.889375777879922*^9, 3.889375798908659*^9}, {3.8893758606079607`*^9, 
   3.889375907487088*^9}, {3.889376265285611*^9, 3.8893762713684397`*^9}, {
   3.8893764868929663`*^9, 3.889376488747785*^9}, 3.8893765467590837`*^9, {
   3.889376701575715*^9, 
   3.8893767019528913`*^9}},ExpressionUUID->"835d45c0-a86f-4aaf-ae77-\
037d522dfac2"],

Cell[TextData[{
 "The divergence of the gradient is a very common operator and is called the \
Laplace operator or simply Laplacian, and is usually denoted ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox["\[Del]", "2"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla^2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "56ba2228-9cae-4174-bb63-599d08e9361b"],
 ". Mathematica supports this notation too:"
}], "Text",
 CellChangeTimes->{{3.8893751176974163`*^9, 3.889375199701268*^9}, {
  3.889375262942453*^9, 
  3.889375272590199*^9}},ExpressionUUID->"1d2fc48a-0db3-4ab2-9f95-\
a2a3a4ccbb45"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], 
    RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.889375231490652*^9, 3.889375255474504*^9}},
 CellLabel->
  "In[1001]:=",ExpressionUUID->"39241ad4-a785-4e7b-80d4-cd6bdf0c03d5"],

Cell["\<\
I noticed that we started from a scalar field, and obtained a vector field \
via gradient, and then obtained another scalar field via divergence. It seems \
that this operation can be repeated infinitely.\
\>", "CodeText",
 CellChangeTimes->{{3.889375931586624*^9, 3.889375983493113*^9}, {
  3.889378401840232*^9, 
  3.889378404758553*^9}},ExpressionUUID->"636fe316-79a1-4163-9fb5-\
570917b253a9"],

Cell[TextData[{
 "Try to take the Laplacian of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8d84f572-d7f5-44fc-98dd-7823233b9c35"],
 " several times and see what happens."
}], "Text",
 CellChangeTimes->{{3.889375990085948*^9, 3.8893760155015583`*^9}, {
   3.889377023950634*^9, 3.889377025521698*^9}, 
   3.889413384497766*^9},ExpressionUUID->"c11eb552-ec28-4a43-ad9d-\
6740b08cfcc8"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{
   SubsuperscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.889373658009714*^9, 3.889373660718288*^9}, 
   3.8893737562637167`*^9, {3.889376021136119*^9, 3.889376046503242*^9}},
 CellLabel->
  "In[1002]:=",ExpressionUUID->"0521b08c-6810-4ed9-b331-7ff749b4f938"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{
   SubsuperscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "2"], 
   RowBox[{
    SubsuperscriptBox["\[Del]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{3.8893768113846827`*^9},
 CellLabel->
  "In[1003]:=",ExpressionUUID->"9ef5681b-8aab-48d9-b5f6-31efa8f56de2"],

Cell[TextData[{
 "It appears that taking the Laplacian ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["n", "TI"], TraditionalForm], "errors" -> {}, "input" -> "n", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d1ab0271-eda3-4543-beca-63202fbce500"],
 " times of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bb877865-83f5-4242-9879-4ccaf8526056"],
 " simply multiples it by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-2", TraditionalForm], "errors" -> {}, "input" -> 
     "-2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7e6857b8-1d1c-490c-a4f3-6f7b857f2369"],
 " the same amount of times."
}], "CodeText",
 CellChangeTimes->{{3.889376057260964*^9, 3.889376093627453*^9}, {
   3.889376843910481*^9, 3.8893770086400127`*^9}, {3.8893770624139338`*^9, 
   3.889377074443709*^9}, {3.8893780142172422`*^9, 3.8893780212792463`*^9}, 
   3.8893785318315973`*^9},ExpressionUUID->"3c764bdb-9e2c-4812-9e69-\
239898f7e868"],

Cell["\<\
For this specific scalar field, yes. If you have polynomials, the result will \
eventually die out when you take the Laplacian multiple times because both \
the gradient and the divergence are differential operators. For example:\
\>", "Text",
 CellChangeTimes->{{3.88937851014634*^9, 3.889378527436551*^9}, {
  3.889378637006336*^9, 3.8893787060135202`*^9}, {3.889378982385605*^9, 
  3.889379002882408*^9}, {3.889379223621944*^9, 
  3.889379232751096*^9}},ExpressionUUID->"f0c582bb-fbd9-4f10-9c4c-\
41d5497ccf39"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "3"], 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], 
     SuperscriptBox["y", "3"]}]}], ")"}]}]], "Input",
 CellChangeTimes->{
  3.88937860227488*^9, {3.8893787082659492`*^9, 3.889378726694141*^9}, {
   3.889378785109886*^9, 3.889378810068989*^9}},
 CellLabel->
  "In[1004]:=",ExpressionUUID->"10e5e38a-e285-430e-877a-7bec764366c6"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "3"], 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], 
     SuperscriptBox["y", "3"]}]}], ")"}]}]], "Input",
 CellChangeTimes->{3.889378614976001*^9, 3.889378815922306*^9},
 CellLabel->
  "In[1005]:=",ExpressionUUID->"9b1ec81e-741e-4547-9011-3bf79cb827b4"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{
   SubsuperscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "3"], 
      SuperscriptBox["y", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["x", "2"], 
      SuperscriptBox["y", "3"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8893786184219837`*^9, 3.8893786264962177`*^9}, {
  3.889378819671275*^9, 3.889378822426302*^9}},
 CellLabel->
  "In[1006]:=",ExpressionUUID->"2c522d9f-6746-4ba0-b101-1ef9a71bb9a6"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], "2"], 
  RowBox[{
   SubsuperscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "2"], 
   RowBox[{
    SubsuperscriptBox["\[Del]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "3"], 
       SuperscriptBox["y", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], 
       SuperscriptBox["y", "3"]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{3.889378828756814*^9},
 CellLabel->
  "In[1007]:=",ExpressionUUID->"fe302d5e-be03-4088-9457-9524742fe578"],

Cell["It makes sense.", "CodeText",
 CellChangeTimes->{{3.889378837469676*^9, 
  3.889378841235512*^9}},ExpressionUUID->"03779c80-6230-47db-b861-\
37aa3ecc09ba"],

Cell["\<\
We introduced the divergence for the gradient, but in fact it can operate on \
any vector field. Next, I will come up with some random vector fields and you \
will try to plot their divergence and observe their properties.\
\>", "Text",
 CellChangeTimes->{{3.8893790661600933`*^9, 3.889379157522541*^9}, {
  3.8893793200554037`*^9, 3.8893793246076183`*^9}, {3.889379493380046*^9, 
  3.8893795179842854`*^9}, {3.889413591044572*^9, 3.8894135920552197`*^9}, {
  3.889430481791388*^9, 
  3.8894305359166737`*^9}},ExpressionUUID->"55b4eea7-77dd-4b47-9b11-\
c0b83f8a96e4"],

Cell[TextData[{
 "Plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], "sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}], "+", 
         OverscriptBox[
          StyleBox["y", "TB"], "^"], "sin", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\hat{\\textbf{x}} \\sin(x)\\sin(y) + \\hat{\\textbf{y}} \
\\sin(x)\\sin(y)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "99b84e5d-5ac0-4448-a70d-2451a1700106"],
 "."
}], "Text",
 CellChangeTimes->{{3.889430761667815*^9, 3.889430762254592*^9}, 
   3.8894308258491993`*^9, 3.8894308629783697`*^9, {3.889430895564445*^9, 
   3.8894308962283497`*^9}},ExpressionUUID->"64ad7457-4a99-42d9-b781-\
2a8b5567ed51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivergenceOf", "[", "f_", "]"}], ":=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ScalarFieldPlot2", "[", 
     RowBox[{
      SubscriptBox["\[Del]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]], ".", "f"}], "]"}], ",", 
    RowBox[{"VectorFieldPlot", "[", "f", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8893771402835197`*^9, 3.889377194919344*^9}, {
   3.889377229691901*^9, 3.889377232416403*^9}, 3.8893773541318398`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"330485b0-dd4c-4151-be19-7bf92c7cc44c"],

Cell[BoxData[
 RowBox[{"DivergenceOf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8893772817581873`*^9, 3.889377310005682*^9}, {
  3.8893807056174097`*^9, 3.889380716346285*^9}},
 CellLabel->
  "In[1009]:=",ExpressionUUID->"02196392-9603-434d-92a8-46e94a8ec46d"],

Cell["\<\
It\[CloseCurlyQuote]s easy to see the the blue regions (positive divergence) \
act as sources and the magenta regions (negative divergence) act as sinks.\
\>", "CodeText",
 CellChangeTimes->{{3.8893807620769653`*^9, 
  3.889380775540814*^9}},ExpressionUUID->"eafe417a-8c63-4cfd-a8fd-\
89a880492e66"],

Cell[TextData[{
 "Next, plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         SuperscriptBox[
          StyleBox["x", "TI"], "2"], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}], "+", 
         OverscriptBox[
          StyleBox["y", "TB"], "^"], 
         SuperscriptBox[
          StyleBox["y", "TI"], "2"], "cos", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\hat{\\textbf{x}} x^2\\sin(y) + \\hat{\\textbf{y}} y^2\\cos(x)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2a1faf14-ea78-4627-9b8f-b876e049cd79"],
 "."
}], "Text",
 CellChangeTimes->{
  3.8894309407352753`*^9, {3.8894310571487713`*^9, 
   3.8894310649613733`*^9}},ExpressionUUID->"833bd59a-a086-4d90-871b-\
554bb5610d67"],

Cell[BoxData[
 RowBox[{"DivergenceOf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], 
     RowBox[{"Sin", "[", "y", "]"}]}], ",", 
    RowBox[{
     SuperscriptBox["y", "2"], 
     RowBox[{"Cos", "[", "x", "]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889378141656781*^9, 3.889378159591803*^9}, {
  3.8893791754108686`*^9, 3.889379185686981*^9}, {3.889379721646452*^9, 
  3.889379766135222*^9}},
 CellLabel->
  "In[1010]:=",ExpressionUUID->"eefc0cfe-a269-4379-9168-babfa06e5da4"],

Cell["\<\
Here it is not obvious to me that the blue regions act as sources and the \
magenta regions act as sinks.\
\>", "CodeText",
 CellChangeTimes->{{3.8893795491278*^9, 3.889379555840107*^9}, {
  3.889379777198792*^9, 3.8893797990464163`*^9}, {3.889379831471587*^9, 
  3.8893798472056007`*^9}, {3.889413716277822*^9, 
  3.889413721034533*^9}},ExpressionUUID->"7632d1c6-3657-4ba1-b85e-\
63805034f075"],

Cell[TextData[{
 "Perhaps not from the direction of the arrows, but notice that the arrow \
length indicates the field strength, so more field gets generated from the \
blue regions, and more field vanishes into the magenta regions.\n\nNext, plot \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         StyleBox["x", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"sin", "(", 
            StyleBox["y", "TI"], ")"}]], "+", 
         OverscriptBox[
          StyleBox["y", "TB"], "^"], 
         StyleBox["y", "TI"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"sin", "(", 
            StyleBox["x", "TI"], ")"}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\hat{\\textbf{x}} x e^{\\sin(y)} + \\hat{\\textbf{y}} y e^{\\sin(x)}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c18a0118-1f9e-4f68-9749-c606a224c050"],
 "."
}], "Text",
 CellChangeTimes->{{3.8893798535274763`*^9, 3.889379942254456*^9}, {
  3.8893801863220043`*^9, 3.889380194787869*^9}, {3.8894310725804358`*^9, 
  3.889431073202139*^9}},ExpressionUUID->"c972dfff-a5c5-4130-a3bf-\
1367fd185974"],

Cell[BoxData[
 RowBox[{"DivergenceOf", "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"x", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "y", "]"}]]}], ",", 
    RowBox[{"y", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "x", "]"}]]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889377213682692*^9, 3.889377224885145*^9}, {
  3.889380276904955*^9, 3.8893806187063637`*^9}, {3.8894279489864807`*^9, 
  3.8894279686924057`*^9}},
 CellLabel->
  "In[1011]:=",ExpressionUUID->"0b3e4e8d-1468-4376-bd8c-daf181acd658"],

Cell["\<\
Here one might be deceived by the colors, but look at the color bar on the \
right side and notice that this vector field actually has positive divergence \
everywhere, so in a sense the field is \[OpenCurlyDoubleQuote]oozing\
\[CloseCurlyDoubleQuote] out of everywhere. There is no sink for this vector \
field. This can also be seen algebraically:\
\>", "CodeText",
 CellChangeTimes->{{3.889380879239341*^9, 3.889380890956431*^9}, {
   3.889427893965805*^9, 3.889427944585394*^9}, 3.889429602623317*^9, {
   3.8894296631892147`*^9, 3.889429667182809*^9}, {3.889429704137703*^9, 
   3.889429755037657*^9}, 
   3.8894297858097057`*^9},ExpressionUUID->"5b1a40ce-a12d-42a7-8003-\
17b1412aa79b"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]], ".", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"x", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "y", "]"}]]}], ",", 
    RowBox[{"y", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "x", "]"}]]}]}], "}"}]}]], "Input",
 CellChangeTimes->{3.889380923873416*^9},
 CellLabel->
  "In[1012]:=",ExpressionUUID->"c56f56f6-3967-48fe-b9f8-135111008022"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"Sin", "[", "x", "]"}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.889427854304044*^9, 3.889427887337708*^9}},
 CellLabel->
  "In[1013]:=",ExpressionUUID->"9bdd0a4f-7e5a-49b8-9128-5fa48364c49d"],

Cell["We can see that the divergence is always larger than zero.", "CodeText",
 CellChangeTimes->{{3.88942997652633*^9, 
  3.889429988683894*^9}},ExpressionUUID->"130170a6-a045-4a8c-a71a-\
f1bb7a6b41f3"],

Cell[TextData[{
 "Next, plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         RowBox[{"(", 
           RowBox[{"-", 
             StyleBox["x", "TI"], 
             SuperscriptBox[
              StyleBox["e", "TI"], 
              RowBox[{"sin", "(", 
                StyleBox["y", "TI"], ")"}]]}], ")"}], "+", 
         OverscriptBox[
          StyleBox["y", "TB"], "^"], 
         RowBox[{"(", 
           RowBox[{"-", 
             StyleBox["y", "TI"], 
             SuperscriptBox[
              StyleBox["e", "TI"], 
              RowBox[{"sin", "(", 
                StyleBox["x", "TI"], ")"}]]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\hat{\\textbf{x}} (-x e^{\\sin(y)}) + \\hat{\\textbf{y}} (-y \
e^{\\sin(x)})", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3ef27378-8949-40bb-bbb9-b885cc38115c"],
 "."
}], "Text",
 CellChangeTimes->{
  3.889431188074534*^9},ExpressionUUID->"66aed23c-cd59-4240-9302-\
75bd4b49e518"],

Cell[BoxData[
 RowBox[{"DivergenceOf", "[", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "x"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "y", "]"}]]}], ",", 
    RowBox[{
     RowBox[{"-", "y"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"Sin", "[", "x", "]"}]]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889427978344013*^9, 3.889427980686927*^9}},
 CellLabel->
  "In[1014]:=",ExpressionUUID->"2c05893b-2cc4-403f-834d-9befdf67736f"],

Cell["\<\
Similarly, this vector field has negative divergence everywhere. Every point \
acts as a sink.\
\>", "CodeText",
 CellChangeTimes->{{3.889427987651429*^9, 3.889428005943709*^9}, {
  3.889429954570942*^9, 
  3.889429967311203*^9}},ExpressionUUID->"098d6511-2910-4b1c-8c95-\
ed95d68d5a47"],

Cell[TextData[{
 "Next, plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}], "+", 
         OverscriptBox[
          StyleBox["y", "TB"], "^"], "cos", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\hat{\\textbf{x}} \\sin(y) + \\hat{\\textbf{y}} \\cos(x)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "abc84f01-86e9-4c61-975f-7ff38bd631d5"],
 "."
}], "Text",
 CellChangeTimes->{
  3.88943124718714*^9},ExpressionUUID->"3377e874-3d4f-4149-b28a-a96fb8878a1e"],

Cell[BoxData[
 RowBox[{"DivergenceOf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sin", "[", "y", "]"}], ",", 
    RowBox[{"Cos", "[", "x", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8893777698331547`*^9, 3.889377781661881*^9}, {
  3.8894339708540983`*^9, 3.8894339770596943`*^9}, {3.889434358544013*^9, 
  3.889434363512266*^9}},
 CellLabel->
  "In[1015]:=",ExpressionUUID->"21a540db-6632-40ed-9be7-3956328376ff"],

Cell[TextData[StyleBox["The divergence vanished entirely!", "CodeText"]], \
"Text",
 CellChangeTimes->{{3.88938065739956*^9, 3.88938068046027*^9}, 
   3.8894313809355087`*^9},ExpressionUUID->"d2ff7fcc-7cd3-48b6-aecc-\
f1a31e8888f6"],

Cell[TextData[{
 "Indeed. Fields with zero divergence everywhere are intuitively called \
incompressible fields. The famous vector identity ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Del]", "\[CenterDot]", "\[Del]", "\[Cross]", 
         StyleBox["F", "TB"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\nabla \\cdot \\nabla \\times \\textbf{F} = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95abbc1d-cbc8-44a6-bd6c-1af2f5891dcd"],
 " says that the divergence of the curl of any vector field is equal to zero. \
This leads us to the third differential operator, the curl. Unlike the \
gradient and the divergence, the curl is usually defined for \
three-dimensional vector fields, so perhaps our 2D example is slightly \
deceptive."
}], "Text",
 CellChangeTimes->{{3.889431369601325*^9, 3.889431405487348*^9}, {
  3.8894315617654877`*^9, 3.8894316075785913`*^9}, {3.889431696152627*^9, 
  3.889431697864081*^9}, {3.889431748628278*^9, 3.889431771748801*^9}, {
  3.889431826022951*^9, 3.889431859004018*^9}, {3.889433226546198*^9, 
  3.889433317118558*^9}},ExpressionUUID->"ef1c181a-775b-477e-8c86-\
6ac5c7c135b6"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"Sin", "[", "x", "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"Cos", "[", "y", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.876237737281372*^9, 3.876237757059142*^9}, {
  3.8894319741560183`*^9, 3.889431974496917*^9}, {3.88943329360997*^9, 
  3.889433297145043*^9}, {3.889433524089828*^9, 3.8894335689500847`*^9}, {
  3.8894337093608313`*^9, 3.8894338319736433`*^9}, {3.889433927724655*^9, 
  3.889433966211013*^9}, {3.8894343250188007`*^9, 3.889434348034994*^9}, {
  3.8894343864478292`*^9, 3.8894344739436827`*^9}, {3.88943462997264*^9, 
  3.889434652432703*^9}, {3.8894349512297163`*^9, 3.889434961724883*^9}},
 CellLabel->
  "In[1016]:=",ExpressionUUID->"71e22b51-91b4-44b5-a870-962f04e320c5"],

Cell["\<\
While it is possible to plot 3D vector fields in Mathematica, the result is \
not as illustrative as 2D plots. For 3D vector fields, we will content \
ourselves with 2D plots of the planes perpendicular to the axes. \
\>", "Text",
 CellChangeTimes->{{3.889435025671234*^9, 3.889435049334051*^9}, {
  3.8894352595824137`*^9, 
  3.889435416134774*^9}},ExpressionUUID->"f8015fdb-dc81-4e6b-9260-\
670cd9c035c1"],

Cell[BoxData[
 RowBox[{"VectorPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "y", "]"}], ",", "0", ",", 
     RowBox[{"Cos", "[", "x", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8894338713316317`*^9, 3.889433894989327*^9}, {
  3.88943478303843*^9, 3.88943479122887*^9}},
 CellLabel->
  "In[1017]:=",ExpressionUUID->"1a8e0302-0841-4177-9d4f-dfd096e3f24e"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sin", "[", "y", "]"}], ",", 
    RowBox[{"Cos", "[", "x", "]"}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.889438981771392*^9, 3.8894389901705027`*^9}, {
  3.889439028853191*^9, 3.889439036838472*^9}},
 CellLabel->
  "In[1018]:=",ExpressionUUID->"2762bda1-e21a-47fd-9b6f-19fdda070855"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ScalarFieldPlot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "y", "]"}]}], "-", 
     RowBox[{"Sin", "[", "x", "]"}]}], "]"}], ",", 
   RowBox[{"VectorFieldPlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "y", "]"}], ",", 
      RowBox[{"Cos", "[", "x", "]"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.889439176415936*^9, 3.889439178750194*^9}, {
  3.889439233250388*^9, 3.889439246673305*^9}},
 CellLabel->
  "In[1019]:=",ExpressionUUID->"bcb37c1d-c7e7-4543-946f-a029e7513033"],

Cell["Explain this plot.", "Text",
 CellChangeTimes->{{3.889443194160458*^9, 
  3.88944319848381*^9}},ExpressionUUID->"1218dd74-9603-4e6a-8fc2-\
b5202149563b"],

Cell[TextData[{
 "Here we are plotting the the 3D vector field in any plane parallel to the \
x-y plane. Luckily, the vectors only have ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5df8f1fd-1743-4197-888f-d144bcb12b32"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e9979bbc-9055-4028-80c7-c13a4c88f330"],
 " components, therefore it\[CloseCurlyQuote]s appropriate to plot them as 2D \
vectors. The curl also forms a 3D vector field, but its ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9dbf7403-e4e3-4813-a7b0-69dc6e649e82"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "014067be-eabc-4e64-8915-42d15f364435"],
 " components are both zero, therefore we can plot the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ad3f8de7-cf20-4c0b-92dd-823f7c0e1b04"],
 " component of the curl as a scalar field. In other words, we are overlaying \
the original vector field with the magnitude of its curl.\n\nIf we consider \
the plane to be oriented with the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04cdeb93-a44f-491e-aca7-f267e78ca07d"],
 " direction pointing towards the reader, we can see that in the locations \
where the original field tend to rotate counterclockwise, we have a positive \
curl; In the locations where the original field tend to rotate clockwise, we \
have a negative curl. The curl obtains the largest absolute value at the \
center of the \[OpenCurlyDoubleQuote]vortex\[CloseCurlyDoubleQuote]."
}], "CodeText",
 CellChangeTimes->{{3.889443201579563*^9, 3.88944320774862*^9}, {
  3.8894433399345303`*^9, 3.8894434330926523`*^9}, {3.8894435137421093`*^9, 
  3.889443591269051*^9}, {3.889443658499814*^9, 3.8894437663744583`*^9}, {
  3.889443883029035*^9, 3.889444015240817*^9}, {3.889444091293631*^9, 
  3.889444190716383*^9}, {3.8894443263374557`*^9, 3.8894444206699543`*^9}, {
  3.889444568648551*^9, 
  3.889444587166305*^9}},ExpressionUUID->"ea1c2449-fcb7-4745-9f2b-\
9835276d32f7"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s study another example. Plot the vector field ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], "sin", 
         RowBox[{"(", 
           StyleBox["y", "TI"], ")"}], "cos", 
         RowBox[{"(", 
           StyleBox["x", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\hat{\\textbf{x}} \\sin(y)\\cos(x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b939739-70ca-40a6-9fec-a4c6c5f9b9f0"],
 " and its curl in a suitable way."
}], "Text",
 CellChangeTimes->{{3.8894444393404703`*^9, 
  3.889444507158395*^9}},ExpressionUUID->"3d677526-476f-4f18-a4b9-\
de665921a928"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "y", "]"}], 
     RowBox[{"Cos", "[", "x", "]"}]}], ",", "0", ",", "0"}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.889439107128068*^9, 3.8894391091699123`*^9}, {
  3.889439271754464*^9, 3.889439287613516*^9}},
 CellLabel->
  "In[1020]:=",ExpressionUUID->"159884f0-f01d-4e22-bed7-5711de34d225"],

Cell[TextData[{
 "We can see that the original vector field has only the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "65f2e505-255b-46bd-baa3-a1bec62ce72d"],
 " component, whereas its curl only has the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d19b5670-1583-4267-93eb-be94a95b91e6"],
 " component."
}], "CodeText",
 CellChangeTimes->{{3.889444535170526*^9, 3.889444557706668*^9}, {
  3.8894445929621563`*^9, 3.889444597344829*^9}, {3.889445101033609*^9, 
  3.8894451083251543`*^9}},ExpressionUUID->"ca83c5bd-6fb9-4d25-b4a1-\
46d58fc62c42"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ScalarFieldPlot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "x", "]"}]}], " ", 
     RowBox[{"Cos", "[", "y", "]"}]}], "]"}], ",", 
   RowBox[{"VectorFieldPlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "y", "]"}], 
       RowBox[{"Cos", "[", "x", "]"}]}], ",", "0"}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.889443111437743*^9, 3.889443122669587*^9}},
 CellLabel->
  "In[1021]:=",ExpressionUUID->"d6924a53-d9bd-4ba6-9cf2-b5ee41ab7a0e"],

Cell[TextData[{
 "Again, we are taking a slice of the original 3D vector field parallel to \
the x-y plane, and the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "24832546-3c66-40c5-9c2d-b611d848374a"],
 " component of the curl is plotted as a scalar field. The plane is oriented \
with the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a8fac920-6c2c-4a5e-a339-ac7ecd994e33"],
 " direction pointing towards the reader. We can see that where the curl is \
positive, two streams of field lines go in opposite directions resulting in a \
 counterclockwise rotation. In places where the curl is negative, two streams \
of field lines go in opposite directions resulting in a  clockwise rotation."
}], "CodeText",
 CellChangeTimes->{{3.88944512008882*^9, 
  3.88944534388953*^9}},ExpressionUUID->"e952126e-b7c8-4011-8eb4-\
c39346e76af2"],

Cell["\<\
TODO: positive everywhere, zero (This is actually a known result, tha)\
\>", "CodeText",
 CellChangeTimes->{{3.88945083070827*^9, 3.889450851235214*^9}, 
   3.8894528443044863`*^9},ExpressionUUID->"e58bd373-b058-404e-bf92-\
d739b95ccee2"],

Cell[BoxData[
 RowBox[{"VectorFieldPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "y"}], ",", "x"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889452067066083*^9, 3.889452106250164*^9}, {
  3.8894521917061987`*^9, 3.889452193879105*^9}},
 CellLabel->
  "In[1022]:=",ExpressionUUID->"ab1cdc56-7b3f-4c78-af8f-c22ee5643a3f"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "y"}], ",", "x", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.889452124286146*^9, 3.889452127967885*^9}, {
  3.889452200007332*^9, 3.889452208423643*^9}},
 CellLabel->
  "In[1023]:=",ExpressionUUID->"ad0ae499-a386-4df7-9094-668f9322f276"],

Cell["\<\
Since the curl operator operates on a vector field and spits out another \
vector field, we can of course let it operate on a gradient:\
\>", "Text",
 CellChangeTimes->{{3.889452463122422*^9, 
  3.8894525811955967`*^9}},ExpressionUUID->"2b9a8b2e-f89a-471f-8b0b-\
0e5a1583cbc2"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], 
    RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.889452606428699*^9, 3.88945261527531*^9}},
 CellLabel->
  "In[1024]:=",ExpressionUUID->"7e838f85-a403-4bf7-b03a-b6ca0c9d338a"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], 
     RowBox[{"Sin", "[", "y", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.889452639333496*^9},
 CellLabel->
  "In[1025]:=",ExpressionUUID->"1effe5b7-54fa-4fe1-93a1-90efee8d4eb8"],

Cell["\<\
The result is a zero vector. This is another well-known vector identity: the \
curl of a gradient is always the zero vector.\
\>", "CodeText",
 CellChangeTimes->{{3.889452645093122*^9, 3.889452674912414*^9}, {
  3.889452823755024*^9, 
  3.889452855916977*^9}},ExpressionUUID->"6d8f81f9-75be-4b11-a652-\
9d742cfe214a"],

Cell["\<\
Yes, so far we have demonstrated two vector identities:
1. The divergence of any curl is always zero
2. The curl of any gradient is always the zero vector

Mathematica actually goes pretty far as to \
\[OpenCurlyDoubleQuote]short-circuit\[CloseCurlyDoubleQuote] this computation:\
\>", "Text",
 CellChangeTimes->{{3.889452862751086*^9, 
  3.8894529707143707`*^9}},ExpressionUUID->"026aeda0-555c-4729-ac12-\
264148af481c"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], ".", 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{"\|01f605", ",", "\|01f605", ",", "\|01f605"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.889452983194188*^9, 3.8894530830151577`*^9}},
 CellLabel->
  "In[1026]:=",ExpressionUUID->"06a1390e-287d-4d82-9bea-f3451653b8fe"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\|01f605"}]}]], "Input",
 CellChangeTimes->{{3.889452680575396*^9, 3.889452711259639*^9}, {
  3.8894528065546303`*^9, 3.8894528100488873`*^9}},
 CellLabel->
  "In[1027]:=",ExpressionUUID->"8a912678-7cb7-4e57-ab78-706520d293dc"],

Cell[CellGroupData[{

Cell["Stoke\[CloseCurlyQuote]s Theorem", "Subsection",
 CellChangeTimes->{{3.876237907153899*^9, 
  3.876237913427085*^9}},ExpressionUUID->"e38b805e-ce39-42c3-bced-\
6b7c63cffb47"],

Cell["\<\
The Stoke\[CloseCurlyQuote]s Theorem says that

Try to verify this.\
\>", "Text",
 CellChangeTimes->{{3.876237768549124*^9, 3.87623784531817*^9}, 
   3.889450845489738*^9, {3.889451762231104*^9, 
   3.8894517903240767`*^9}},ExpressionUUID->"4bcb986a-5832-4ab8-be84-\
b8e308d1ba6a"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ScalarFieldPlot", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "y", "]"}]}], "-", 
     RowBox[{"Sin", "[", "x", "]"}]}], "]"}], ",", 
   RowBox[{"VectorFieldPlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "y", "]"}], ",", 
      RowBox[{"Cos", "[", "x", "]"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[1085]:=",ExpressionUUID->"32a9d951-d0ca-4147-ad50-6820cef35557"],

Cell[BoxData[
 RowBox[{"<<", "NDSolve`FEM`"}]], "Input",
 CellChangeTimes->{{3.8895442518930817`*^9, 3.889544251900243*^9}},
 CellLabel->
  "In[1039]:=",ExpressionUUID->"c0248a01-afc6-4f9b-a18b-3c7da520df4b"],

Cell[BoxData[
 RowBox[{"em", "=", 
  RowBox[{"ToElementMesh", "[", 
   RowBox[{
    RowBox[{"Disk", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", "0.5"}], "]"}], ",", 
    RowBox[{"\"\<MeshOrder\>\"", "->", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.889544226296658*^9, 3.8895442317807617`*^9}, {
  3.889544325880723*^9, 3.889544327341816*^9}, {3.8895465690681257`*^9, 
  3.8895465872664633`*^9}, {3.889547166914069*^9, 3.889547203145915*^9}},
 CellLabel->
  "In[1079]:=",ExpressionUUID->"248a8ae1-1e52-4d3b-a85a-ac729d2a3030"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coord", "=", 
   RowBox[{"em", "[", "\"\<Coordinates\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8895443616352158`*^9, 3.8895443662517757`*^9}, {
   3.889544774580269*^9, 3.889544811309984*^9}, {3.889546623346286*^9, 
   3.8895466457988377`*^9}, 3.889547010781713*^9, 3.8895471728226357`*^9, 
   3.889547209189645*^9, {3.889577285097416*^9, 3.8895772898391848`*^9}},
 CellLabel->
  "In[1103]:=",ExpressionUUID->"9a6bbb1c-f1c1-4298-a3ca-9609e93c190f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"elem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"em", "[", "\"\<MeshElements\>\"", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.889546654434443*^9, 3.889546677942959*^9}, {
  3.8895469849460917`*^9, 3.889547008722867*^9}, {3.889577315263188*^9, 
  3.889577317611965*^9}},
 CellLabel->
  "In[1105]:=",ExpressionUUID->"5faa8a4e-30cc-4fa3-86ac-b871e2ce104c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TriangleCoordinates", "[", 
   RowBox[{"mesh_", ",", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coord", "=", 
      RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"coord", "[", 
       RowBox[{"[", "a", "]"}], "]"}], ",", 
      RowBox[{"coord", "[", 
       RowBox[{"[", "b", "]"}], "]"}], ",", 
      RowBox[{"coord", "[", 
       RowBox[{"[", "c", "]"}], "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TriangleArea", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3_", ",", "y3_"}], "}"}]}], "}"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x1", 
      RowBox[{"(", 
       RowBox[{"y2", "-", "y3"}], ")"}]}], "+", 
     RowBox[{"x2", 
      RowBox[{"(", 
       RowBox[{"y3", "-", "y1"}], ")"}]}], "+", 
     RowBox[{"x3", 
      RowBox[{"(", 
       RowBox[{"y1", "-", "y2"}], ")"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScalarValue", "[", 
   RowBox[{"field_", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3_", ",", "y3_"}], "}"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"field", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", "3"], 
     RowBox[{"(", 
      RowBox[{"x1", "+", "x2", "+", "x3"}], ")"}]}], ",", 
    RowBox[{
     FractionBox["1", "3"], 
     RowBox[{"(", 
      RowBox[{"y1", "+", "y2", "+", "y3"}], ")"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.889577300481474*^9, 3.889577435395368*^9}, {
   3.88957751706551*^9, 3.889577517295682*^9}, {3.889578745571486*^9, 
   3.8895787466020803`*^9}, {3.889584876871355*^9, 3.889584896220037*^9}, 
   3.889585338163476*^9, {3.889588377685902*^9, 3.889588422309*^9}, {
   3.889596097594941*^9, 3.889596107563191*^9}, {3.889620711643504*^9, 
   3.889620726063068*^9}, {3.889620968389247*^9, 3.8896210322113867`*^9}, {
   3.889621133090564*^9, 3.889621236161796*^9}, {3.8896214023425617`*^9, 
   3.8896214181409492`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"094d003f-6da9-47dd-a7b6-4a8178ef0de1"],

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"TriangleCoordinates", "[", 
      RowBox[{"em", ",", "#"}], "]"}], "&"}], ",", "elem"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.8895774386895247`*^9, 3.889577471155924*^9}, {
  3.889578750778843*^9, 3.889578750924676*^9}},
 CellLabel->
  "In[1132]:=",ExpressionUUID->"393f5fea-edad-4cc2-912b-0aac31d12832"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.889576753774651*^9, 3.889576863797435*^9}, 
   3.889577515662005*^9},ExpressionUUID->"1ad8194c-0fbb-48c1-af99-\
780847c4e290"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalarValue", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "y", "]"}]}], "-", 
          RowBox[{"Sin", "[", "x", "]"}]}]}], "]"}], ",", "#"}], "]"}], "&"}],
     ",", "y"}], "]"}], ".", 
  RowBox[{"Map", "[", 
   RowBox[{"TriangleArea", ",", "y"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88958843033738*^9, 3.889588460379615*^9}, 
   3.889596120506048*^9, {3.8896210611470118`*^9, 3.889621064824407*^9}, {
   3.8896210968763447`*^9, 3.889621128487855*^9}, {3.889621548728388*^9, 
   3.889621574699246*^9}},
 CellLabel->
  "In[1197]:=",ExpressionUUID->"12faa51f-4282-4b07-9261-1a20d957636d"],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"0.5", 
        RowBox[{"Sin", "[", "t", "]"}]}], "]"}], ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"0.5", 
        RowBox[{"Cos", "[", "t", "]"}]}], "]"}]}], "}"}], ".", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.5", 
         RowBox[{"Cos", "[", "t", "]"}]}], ",", 
        RowBox[{"0.5", 
         RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", "t"}], "]"}]}], ",", 
   
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.889621735695631*^9, 3.889621779172408*^9}, {
  3.8896218091834393`*^9, 3.889621837388122*^9}, {3.8896220184755573`*^9, 
  3.889622062068227*^9}},
 CellLabel->
  "In[1210]:=",ExpressionUUID->"b9beac98-403b-4f3d-909e-e4f7f9021906"],

Cell[BoxData[
 RowBox[{"MeshRegion", "[", "em", "]"}]], "Input",
 CellChangeTimes->{{3.8895443941029367`*^9, 3.889544396299341*^9}},
 CellLabel->
  "In[1084]:=",ExpressionUUID->"627ecc77-bb75-4c35-8ead-6c95aad7c92d"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", "y"}], "]"}]}], " ", ",", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", "x"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.876238001149427*^9, 3.8762380250694647`*^9}},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"f8cfc992-cdb1-40f6-89b3-00b162e66c8e"],

Cell[BoxData[
 RowBox[{"Curl", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}]}], " ", ",", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", "x"}], "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8762380651431293`*^9, 3.876238089156315*^9}, {
  3.876238143859314*^9, 3.876238145641114*^9}},
 CellLabel->
  "In[1029]:=",ExpressionUUID->"d1694752-a4ec-4b20-afba-a9fa9c9142c4"],

Cell[BoxData[
 RowBox[{"VectorPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}]}], " ", ",", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", "x"}], "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876238255941988*^9, 3.8762382902171783`*^9}},
 CellLabel->
  "In[1030]:=",ExpressionUUID->"23276d27-ea6d-44d8-be31-46280e991047"],

Cell["Divergence Theorem", "Text",
 CellChangeTimes->{{3.8762379000715837`*^9, 
  3.8762379053377523`*^9}},ExpressionUUID->"e64bc770-badd-4c1a-8b22-\
916e6a07195e"],

Cell["\<\
We can, of course, plot 3D scalar fields. But they are not so clear to \
observe and for our purposes 2D can be perfectly illustrative.\
\>", "Text",
 CellChangeTimes->{{3.876235800321294*^9, 
  3.8762358761736803`*^9}},ExpressionUUID->"d6ce14dd-a232-4a71-bb8d-\
7729b055b8dc"],

Cell[BoxData[
 RowBox[{"DensityPlot3D", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    RowBox[{
     SuperscriptBox["y", "2"], "z"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876235722458872*^9, 3.8762357609249907`*^9}},
 CellLabel->
  "In[1031]:=",ExpressionUUID->"c6b4ab7c-6d7c-47cb-ae3c-da66cd29bc79"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electrostatics", "Chapter",
 CellChangeTimes->{{3.874453986442933*^9, 
  3.874453989288425*^9}},ExpressionUUID->"4f7e9df7-427d-4696-9dc0-\
d02ace24a4ee"],

Cell[CellGroupData[{

Cell["Medium adjectives", "Section",
 CellChangeTimes->{
  3.874760979972142*^9, {3.8762991119194202`*^9, 
   3.876299115452436*^9}},ExpressionUUID->"3e0d40e8-790f-47fe-af7d-\
9e7acd723ba8"],

Cell["\<\
Let\[CloseCurlyQuote]s have a chat about mediums. What kind of mediums do we \
usually talk about?\
\>", "Text",
 CellChangeTimes->{{3.874760984304133*^9, 3.8747609863659067`*^9}, {
  3.87476103792805*^9, 3.87476103979312*^9}, {3.874761832490323*^9, 
  3.874761859891645*^9}},ExpressionUUID->"a0591189-65c1-4dba-8679-\
3b254845eedc"],

Cell["What is a homogeneous medium?", "Text",
 CellChangeTimes->{{3.876298616315727*^9, 
  3.876298634117013*^9}},ExpressionUUID->"d34f82a4-1aa4-440d-88bf-\
8c21e18bc2e6"],

Cell[TextData[{
 "What are the three fundamental parameters, or ",
 StyleBox["constitutive parameters",
  FontSlant->"Italic"],
 ", of a medium?"
}], "Text",
 CellChangeTimes->{{3.874760994590386*^9, 3.8747610346172256`*^9}, {
  3.874761865287326*^9, 
  3.874761865577599*^9}},ExpressionUUID->"995c2d3e-8910-4e07-b17b-\
79d5bcbe1cd3"],

Cell["\<\
The permittivity \[Epsilon], the permeability \[Mu], and the conductivity \
\[Sigma].\
\>", "CodeText",
 CellChangeTimes->{{3.874761062092495*^9, 
  3.874761113589396*^9}},ExpressionUUID->"ff3239f7-e2f1-40fe-8e5c-\
2a13cf3edfd0"],

Cell[TextData[{
 "Good. What do we mean when we say a medium is ",
 StyleBox["homogeneous",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.874761125449205*^9, 
  3.874761160942602*^9}},ExpressionUUID->"12b91525-9f07-484d-8a21-\
6f422d77fc1d"],

Cell["\<\
If \[Epsilon], \[Mu] and \[Sigma] do not vary from one location to another, \
then it\[CloseCurlyQuote]s a homogeneous medium.\
\>", "CodeText",
 CellChangeTimes->{{3.8747611547811947`*^9, 3.874761198273971*^9}, {
  3.8762990261852903`*^9, 
  3.876299056841091*^9}},ExpressionUUID->"356118db-5da5-4429-8169-\
74b497191f04"],

Cell[TextData[{
 "What do we mean when we say a medium is ",
 StyleBox["isotropic",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.87629907435008*^9, 
  3.876299079993307*^9}},ExpressionUUID->"6097fbc7-29eb-4f7a-a194-\
6b61d4562957"],

Cell["\<\
If \[Epsilon], \[Mu] and \[Sigma] do not vary from one direction to another, \
then it\[CloseCurlyQuote]s a isotropic medium.\
\>", "CodeText",
 CellChangeTimes->{{3.876299124795065*^9, 3.8762991440828857`*^9}, {
  3.87629943239118*^9, 
  3.876299444503364*^9}},ExpressionUUID->"a6b84255-ad0a-43c9-9927-\
198b6bd0c089"],

Cell["Can a medium be homogeneous but anisotropic?", "Text",
 CellChangeTimes->{{3.876299447646906*^9, 
  3.8762994767342587`*^9}},ExpressionUUID->"437bb3f1-db2a-4e36-96cc-\
f5199644465b"],

Cell["hmm...", "CodeText",
 CellChangeTimes->{{3.8762994797125473`*^9, 
  3.876299481096423*^9}},ExpressionUUID->"dd096a0c-6197-460a-9faf-\
82c8ceeb6860"],

Cell["Can a medium be isotropic but inhomogeneous?", "Text",
 CellChangeTimes->{{3.87629948773085*^9, 3.876299510737767*^9}, {
  3.8762995718717318`*^9, 
  3.876299584723007*^9}},ExpressionUUID->"529b746b-5ad9-4a35-97dd-\
6f2af18ad187"],

Cell[TextData[StyleBox["hmm...", "CodeText"]], "Text",
 CellChangeTimes->{{3.876299502702392*^9, 
  3.876299503599646*^9}},ExpressionUUID->"37393d84-3ef8-42bd-b5b3-\
5db8613f7b82"],

Cell[TextData[{
 "What do we mean when we say a medium is ",
 StyleBox["linear",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.87629968064719*^9, 
  3.876299682741714*^9}},ExpressionUUID->"574c216a-77ab-43f8-b96a-\
7a89574a03c6"],

Cell[TextData[{
 "If \[Epsilon] is not dependent on the magnitude of applied electric field (",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["D", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{D}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c8738c2d-8dae-4dc5-9943-e6f7ce443fe1"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0f8a7bbd-d31f-4dc7-b5d2-86855ce22904"],
 " are related linearly). If a medium is nonlinear, then \[Epsilon] will be a \
function of the magnitude of the applied electric field."
}], "CodeText",
 CellChangeTimes->{{3.876299686197361*^9, 3.876299690202846*^9}, {
  3.876299840390335*^9, 3.876299960064535*^9}, {3.879499191571645*^9, 
  3.879499244830819*^9}},ExpressionUUID->"991f52ff-2ca7-4e98-8234-\
b346fc977d9d"],

Cell[TextData[{
 "When is a medium ",
 StyleBox["dispersive",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.8762996337199717`*^9, 
  3.876299644994735*^9}},ExpressionUUID->"6219ba90-392f-4dfc-bd02-\
61c026fae511"],

Cell["If \[Epsilon] is frequency dependent.", "CodeText",
 CellChangeTimes->{{3.876299652452998*^9, 3.876299665933386*^9}, {
  3.876299987324853*^9, 
  3.876299988947324*^9}},ExpressionUUID->"36dc4239-72f9-4947-9678-\
ffd104bc357b"],

Cell[TextData[{
 "What do we mean when we say a medium is ",
 StyleBox["lossless",
  FontWeight->"Bold"],
 " or ",
 StyleBox["lossy",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.874761286171076*^9, 3.8747613187858143`*^9}, {
  3.874761365946599*^9, 
  3.874761367967807*^9}},ExpressionUUID->"aec6aa74-adcf-4c07-b8b8-\
dd342cd9ecaf"],

Cell[TextData[{
 "A medium is lossless when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Sigma]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\sigma = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "123a2bc6-932b-4b44-ba15-e3682606d52d"],
 ". One could also say the medium is nonconducting. If the wave traveling \
within the medium does not attenuate, then it\[CloseCurlyQuote]s a lossless \
medium; otherwise, it\[CloseCurlyQuote]s a lossy medium."
}], "CodeText",
 CellChangeTimes->{{3.874761303875224*^9, 3.874761383091427*^9}, {
  3.8763004523078527`*^9, 
  3.8763005225822897`*^9}},ExpressionUUID->"6497d450-56d8-4ef2-9ed9-\
d0a043ded297"],

Cell[TextData[{
 "What do we mean when we say a medium is ",
 StyleBox["source-free",
  FontWeight->"Bold"],
 "?"
}], "Text",
 CellChangeTimes->{{3.876300298596237*^9, 
  3.8763003178994617`*^9}},ExpressionUUID->"32d23c7a-00de-452e-8ae5-\
ece5ac22d957"],

Cell["J = 0", "CodeText",
 CellChangeTimes->{{3.8763003330064497`*^9, 
  3.876300333917658*^9}},ExpressionUUID->"6ef27e5c-0f40-446e-96e0-\
ec2158c8d877"],

Cell[TextData[Cell[BoxData[GridBox[{
   {"homogeneous", "isotropic", "linear", "lossless", 
    RowBox[{"source", "-", "free"}], "\[Placeholder]"},
   {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{"\[Sigma]", "\[LongEqual]", "0"}], TraditionalForm], 
      "errors" -> {}, "input" -> "\\sigma = 0", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], "\[Placeholder]", "\[Placeholder]"},
   {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
    "\[Placeholder]", "\[Placeholder]"},
   {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
    "\[Placeholder]", "\[Placeholder]"}
  },
  GridBoxDividers->{
   "Columns" -> {{True}}, 
    "Rows" -> {{
      True}}}]],ExpressionUUID->"f765b143-8470-4b27-bb32-c41c158ed9ca"]], \
"Text",
 CellChangeTimes->{{3.876300633161562*^9, 
  3.876300678844201*^9}},ExpressionUUID->"30a3913e-1c95-4c98-be53-\
99598687596f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Charge Densities", "Section",
 CellChangeTimes->{{3.876238535571863*^9, 
  3.8762385399262753`*^9}},ExpressionUUID->"9452b594-8de0-4670-aa7a-\
32fc0f1bb1b9"],

Cell[TextData[{
 "We know the name of the game is to solve the fields. What are the common \
methods to solve ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d1e0d717-6c50-4be2-bb47-6c8a31e1eebe"],
 "?"
}], "Text",
 CellChangeTimes->{{3.879436224654705*^9, 3.879436230221053*^9}, {
  3.87947443016398*^9, 3.879474538065054*^9}, {3.8794745763254347`*^9, 
  3.8794746358009377`*^9}, {3.879496356877212*^9, 
  3.8794963579194193`*^9}},ExpressionUUID->"ba1a7f5f-5baf-4128-bc3b-\
e4c925ba580c"],

Cell[TextData[{
 "There are three common methods:\n1. If the geometry leads to a uniform ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cf9301e9-aab6-4ff3-90ca-c23d980d2d6c"],
 " field normal to a imaginary Gaussian surface, we can use Gauss\
\[CloseCurlyQuote]s law directly\n2. A more general method, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["V", "TI"], TraditionalForm], "errors" -> {}, "input" -> "V", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "45404938-9baa-4cd5-9536-d00314fbcd01"],
 "\n3. The mirror method."
}], "CodeText",
 CellChangeTimes->{{3.879474638191799*^9, 3.879474685153555*^9}, {
  3.879496384773596*^9, 
  3.879496467085145*^9}},ExpressionUUID->"3cadf43a-16d4-49ef-b211-\
49dc370c97b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric Field Examples", "Section",
 CellChangeTimes->{{3.889454965359688*^9, 3.8894550034864397`*^9}, 
   3.889456609337594*^9},ExpressionUUID->"9d409e5a-a0d3-48ed-af18-\
4f6d37889ffe"],

Cell[CellGroupData[{

Cell["Electric dipole", "Subsection",
 CellChangeTimes->{{3.8894550115022173`*^9, 
  3.88945502292819*^9}},ExpressionUUID->"36116afa-cfe8-40c7-873c-\
e9c2470b06db"],

Cell[TextData[{
 "Given a pair of equal and opposite charges ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b0a7fae1-ac4a-4ac0-8c85-7740b685bb4f"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         StyleBox["q", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "-q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f44cfa3a-b699-4aba-954e-db7984f3f088"],
 " separated by a small distance ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "04bed30d-552f-4be7-9d00-a267c9c3970d"],
 ", plot the electric field"
}], "Text",
 CellChangeTimes->{{3.889455026564926*^9, 3.889455065019229*^9}, {
  3.889455125065682*^9, 
  3.889455127567423*^9}},ExpressionUUID->"203cffe4-6fc8-4b4d-b912-\
40487d9b68e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalVectorPlotYZ", "[", "field_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"TransformedField", "[", 
        RowBox[{
         RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
         "field", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}], "/.", 
       RowBox[{"x", "->", "0"}]}]}], "}"}], ",", 
    RowBox[{"VectorPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "Medium"}], ",", 
      RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.889455223046439*^9, 3.889455228379485*^9}, {
  3.889455346348583*^9, 3.8894555517048798`*^9}, {3.8894556415090857`*^9, 
  3.889455734539154*^9}, {3.889624409070418*^9, 3.88962441450368*^9}, {
  3.889626177576503*^9, 3.889626200146722*^9}, {3.889626360580546*^9, 
  3.8896263723411922`*^9}, {3.8896264372113543`*^9, 3.889626441792918*^9}, {
  3.889626559497113*^9, 3.889626681163274*^9}, {3.889626748265727*^9, 
  3.889626778408534*^9}, {3.8896268400191174`*^9, 3.889626841656485*^9}, {
  3.8896289226194897`*^9, 3.889628930271212*^9}, {3.8896289704584637`*^9, 
  3.889628980104199*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"e4164df1-4e80-4ec6-a456-3f8801de2eed"],

Cell[BoxData[
 RowBox[{"SphericalVectorPlotYZ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["\[Epsilon]", "0"], 
       SuperscriptBox["R", "3"]}]], "2", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["\[Epsilon]", "0"], 
       SuperscriptBox["R", "3"]}]], 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8896266379277973`*^9, 3.88962666090873*^9}},
 CellLabel->
  "In[1392]:=",ExpressionUUID->"d2853a88-8306-46a3-836b-cd69d9b0f8ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Infinitely long, straight, line charge of uniform density ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Rho]", 
        StyleBox["l", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\rho_l", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b2b31945-44c7-47ed-9407-7a68288d6062"]
}], "Subsection",
 CellChangeTimes->{{3.8894550115022173`*^9, 3.88945502292819*^9}, {
  3.8896268773562517`*^9, 
  3.889626900392352*^9}},ExpressionUUID->"4174ed99-ead6-4cd4-bdea-\
2ea735a15a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CylindricalVectorPlotYZ", "[", "field_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"TransformedField", "[", 
        RowBox[{
         RowBox[{"\"\<Cylindrical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
         "field", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r", ",", "\[Phi]", ",", "zz"}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}], "/.", 
       RowBox[{"x", "->", "0"}]}]}], "}"}], ",", 
    RowBox[{"VectorPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "Medium"}], ",", 
      RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.889626936545558*^9, 3.8896269751265383`*^9}, 
   3.889627028810096*^9, {3.8896270696937933`*^9, 3.889627072020071*^9}, {
   3.8896290278939247`*^9, 3.889629031788952*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b4f1a684-7cd8-4a38-8214-1cedc78ffc9a"],

Cell[BoxData[
 RowBox[{"CylindricalVectorPlotYZ", "[", 
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", "\[Pi]", " ", 
      SubscriptBox["\[Epsilon]", "0"], "r"}]], ",", "0", ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.889626919428441*^9, 3.889626919701833*^9}, {
  3.889626999011221*^9, 3.889627020775299*^9}},
 CellLabel->
  "In[1394]:=",ExpressionUUID->"4b0c5579-936e-4f3f-a867-eb5bfb38429c"]
}, Open  ]],

Cell[TextData[{
 "Infinite planar charge of uniform density ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Rho]", 
        StyleBox["s", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\rho_s", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0fb3ba73-9c8a-4433-9ad8-406decc6bada"]
}], "Subsection",
 CellChangeTimes->{{3.8894550115022173`*^9, 3.88945502292819*^9}, {
  3.8896268773562517`*^9, 3.889626900392352*^9}, {3.889627147839712*^9, 
  3.889627149934504*^9}},ExpressionUUID->"f8178bc2-cbe9-4226-9ea1-\
b6ad17c273d2"],

Cell["Spherical cloud of electrons", "Subsection",
 CellChangeTimes->{{3.8894550115022173`*^9, 3.88945502292819*^9}, {
  3.8896268773562517`*^9, 3.889626900392352*^9}, {3.889627147839712*^9, 
  3.889627149934504*^9}, {3.889627182142726*^9, 
  3.8896271999254713`*^9}},ExpressionUUID->"b913e7e7-ad0d-45cf-8196-\
5e3421981cfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric Potential", "Section",
 CellChangeTimes->{{3.88945600649356*^9, 
  3.889456013533499*^9}},ExpressionUUID->"b1521dad-5dba-48e4-8a92-\
2dc89b5a8424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalScalarPlotYZ", "[", "field_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", "=", 
      RowBox[{"TransformedField", "[", 
       RowBox[{
        RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
        "field", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{"x", "->", "0"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
      RowBox[{"ColorFunction", "->", "\"\<Pastel\>\""}], ",", 
      RowBox[{"ImageSize", "->", "Large"}], ",", 
      RowBox[{"Contours", "->", "15"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88945605183421*^9, 3.889456085693346*^9}, {
  3.889627613144293*^9, 3.8896276592555857`*^9}, {3.889627695704493*^9, 
  3.889627695822179*^9}, {3.889627843987937*^9, 3.88962784652535*^9}, {
  3.889627877926248*^9, 3.889627878658229*^9}, {3.88962795784409*^9, 
  3.889627965917467*^9}, {3.889628904784482*^9, 3.889628908272533*^9}, {
  3.889629089574662*^9, 3.8896291487292967`*^9}, {3.889630503564103*^9, 
  3.88963051685923*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"9d75bd1e-4b1d-4c7d-b206-74b50bf37df2"],

Cell[BoxData[
 RowBox[{"SphericalScalarPlotYZ", "[", 
  FractionBox[
   RowBox[{"Cos", "[", "\[Theta]", "]"}], 
   RowBox[{"4", "\[Pi]", " ", 
    SubscriptBox["\[Epsilon]", "0"], 
    SuperscriptBox["R", "2"]}]], "]"}]], "Input",
 CellChangeTimes->{{3.889627662939499*^9, 3.889627684504499*^9}},
 CellLabel->
  "In[1427]:=",ExpressionUUID->"49e24ab1-2c41-4b44-a090-b6f35c50f78c"],

Cell[BoxData[
 RowBox[{"]", ","}]], "Input",
 CellChangeTimes->{
  3.8896283539117603`*^9},ExpressionUUID->"291bd38d-fb5a-4b19-9993-\
0e7f91cbc0de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SphericalVEPlotYZ", "[", "v_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", "=", 
      RowBox[{"TransformedField", "[", 
       RowBox[{
        RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", "v", 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"f", "/.", 
         RowBox[{"x", "->", "0"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
        RowBox[{"ColorFunction", "->", "\"\<Pastel\>\""}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"Contours", "->", "15"}]}], "]"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["\[Del]", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "f"}]}], ")"}], "/.", 
           RowBox[{"x", "->", "0"}]}]}], "}"}], ",", 
        RowBox[{"VectorPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"e", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"e", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}]}], "]"}]}], 
       "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88945605183421*^9, 3.889456085693346*^9}, {
  3.889627613144293*^9, 3.8896276592555857`*^9}, {3.889627695704493*^9, 
  3.889627695822179*^9}, {3.889627843987937*^9, 3.88962784652535*^9}, {
  3.889627877926248*^9, 3.889627878658229*^9}, {3.889627925995089*^9, 
  3.889628099553578*^9}, {3.8896281346548634`*^9, 3.889628166539503*^9}, {
  3.8896283012642736`*^9, 3.8896283576355867`*^9}, {3.8896284049887257`*^9, 
  3.8896285033677187`*^9}, {3.8896286787382507`*^9, 3.8896286913172617`*^9}, {
  3.889628802710656*^9, 3.8896288046945763`*^9}, {3.8896288541274*^9, 
  3.889628877173725*^9}, {3.8896303120470657`*^9, 3.889630359110195*^9}, {
  3.889630435748135*^9, 3.889630483928904*^9}, {3.8896305604967937`*^9, 
  3.8896305760905943`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"61bc2fee-96de-4bd4-9582-54c1053f710f"],

Cell[BoxData[
 RowBox[{"SphericalVEPlotYZ", "[", 
  FractionBox[
   RowBox[{"Cos", "[", "\[Theta]", "]"}], 
   RowBox[{"4", "\[Pi]", " ", 
    SubscriptBox["\[Epsilon]", "0"], 
    SuperscriptBox["R", "2"]}]], "]"}]], "Input",
 CellChangeTimes->{{3.889627986953991*^9, 3.889627987710868*^9}, {
  3.889630583684704*^9, 3.8896305840924397`*^9}},
 CellLabel->
  "In[1426]:=",ExpressionUUID->"9ab35f64-faef-4e20-bacf-bd1adef29232"],

Cell[BoxData[
 RowBox[{"DiracDelta", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.89009280207977*^9, 3.890092817087376*^9}},
 CellLabel->
  "In[1438]:=",ExpressionUUID->"db8c45a7-0b61-4de7-8bfc-ca002e623393"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boundary Conditions", "Section",
 CellChangeTimes->{{3.889456178916815*^9, 
  3.889456192871626*^9}},ExpressionUUID->"fcc39396-0974-46e9-a7c7-\
44d279333dba"],

Cell[BoxData[
 RowBox[{"Piecewise", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "y", "]"}], ",", 
        RowBox[{"Cos", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"x", "<", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "y", "]"}], ",", 
        RowBox[{"Sin", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"x", ">=", "0"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.889631421740265*^9, 3.889631440717901*^9}},
 CellLabel->
  "In[1433]:=",ExpressionUUID->"68922790-ddd9-42ad-a34c-a4211bff5752"],

Cell[BoxData[
 RowBox[{"VectorFieldPlot", "[", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", "y", "]"}], ",", 
         RowBox[{"Cos", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"x", "<", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", "x"}], "}"}], ",", 
       RowBox[{"x", ">=", "0"}]}], "}"}]}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.889631163954949*^9, 3.8896312251629877`*^9}, {
  3.8896313108514223`*^9, 3.889631393474697*^9}, {3.8896314468972607`*^9, 
  3.889631468385344*^9}},
 CellLabel->
  "In[1436]:=",ExpressionUUID->"1e73545d-c4b1-438f-9cb0-920bf04a5165"],

Cell[TextData[{
 "The tangential components of the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b3b6ab41-fdb2-42c5-8bab-bbfbbde9819e"],
 " field is continuous across a boundary."
}], "Text",
 CellChangeTimes->{{3.889704361894416*^9, 
  3.8897044068692636`*^9}},ExpressionUUID->"b0fcf8bd-9c8c-423a-9f3e-\
00225acbeb56"]
}, Open  ]],

Cell["Electric Flux Density", "Section",
 CellChangeTimes->{{3.889456301358572*^9, 
  3.889456305279861*^9}},ExpressionUUID->"829afc84-8732-4ca6-94ed-\
92a779619bc5"],

Cell["Poisson\[CloseCurlyQuote]s Equation and Laplace\[CloseCurlyQuote]s \
Equation", "Section",
 CellChangeTimes->{{3.8894563818001204`*^9, 
  3.8894564099922457`*^9}},ExpressionUUID->"f22c2d00-7ae9-432b-b3dc-\
0c6891c648a7"],

Cell["Method of Images", "Section",
 CellChangeTimes->{{3.889456427497614*^9, 
  3.889456429412561*^9}},ExpressionUUID->"e93ee1c6-688e-44ce-ba7d-\
b7c205a0daed"],

Cell[CellGroupData[{

Cell["Boundary-Value Problems", "Section",
 CellChangeTimes->{{3.889456481559679*^9, 
  3.889456485816202*^9}},ExpressionUUID->"f12f5769-96fb-45d8-b5c4-\
7b5b2d151eaa"],

Cell["Cartesian Coordinates", "Subsection",
 CellChangeTimes->{{3.889456491761619*^9, 
  3.8894564950635157`*^9}},ExpressionUUID->"ca4f5e8f-fac5-4875-b17f-\
c74641b1a059"],

Cell["Cylindrical Coordinates", "Subsection",
 CellChangeTimes->{{3.889456491761619*^9, 
  3.889456511744219*^9}},ExpressionUUID->"1337e003-da0c-4438-b927-\
db1f89a35e6e"],

Cell["Spherical Coordinates", "Subsection",
 CellChangeTimes->{{3.889456491761619*^9, 
  3.889456521580421*^9}},ExpressionUUID->"c2aabf2e-18de-410c-bf73-\
edf731e54246"]
}, Open  ]],

Cell["Steady Electric-Currents", "Section",
 CellChangeTimes->{{3.889456541555662*^9, 
  3.8894565465966988`*^9}},ExpressionUUID->"83d28a76-8ba9-404a-8409-\
73553fce9829"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetostatics", "Chapter",
 CellChangeTimes->{{3.874453999903912*^9, 
  3.874454004641904*^9}},ExpressionUUID->"148ad691-ad4e-4227-940e-\
818ed80a578e"],

Cell["Magnetic Field Examples", "Section",
 CellChangeTimes->{{3.88945661633434*^9, 
  3.889456620937377*^9}},ExpressionUUID->"2087b5d1-55dc-4955-98ab-\
88147b13f5e0"],

Cell["Vector Magnetic Potential", "Section",
 CellChangeTimes->{{3.889456632882704*^9, 
  3.889456637278358*^9}},ExpressionUUID->"85d95c76-f7e7-4ce2-927f-\
589bd57e4060"],

Cell["The Biot-Savart Law", "Section",
 CellChangeTimes->{{3.889456632882704*^9, 
  3.889456658538734*^9}},ExpressionUUID->"ef9ef5e3-105b-4fac-a032-\
2723e0e0dd40"],

Cell["The Magnetic Dipole", "Section",
 CellChangeTimes->{{3.889456691738942*^9, 
  3.8894566956966457`*^9}},ExpressionUUID->"aae7fe72-18e1-4b19-a79a-\
3f47bd6e2729"],

Cell["Boundary Conditions", "Section",
 CellChangeTimes->{{3.8894567295711823`*^9, 
  3.889456735151569*^9}},ExpressionUUID->"ad187a94-ca3c-4848-81ba-\
d685ef803382"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Maxwell\[CloseCurlyQuote]s Equations for Time-Varying Fields", "Chapter",
 CellChangeTimes->{{3.874453999903912*^9, 3.874454004641904*^9}, {
  3.874454037516027*^9, 3.874454042580698*^9}, {3.87445415236206*^9, 
  3.874454158730019*^9}},ExpressionUUID->"bfb9b062-8e7f-474d-9a3e-\
f090977b71f8"],

Cell["\<\
What are the names of the Maxwell\[CloseCurlyQuote]s equations, and what do \
they say, in human language?\
\>", "Text",
 CellChangeTimes->{{3.874454401872406*^9, 
  3.874454443450227*^9}},ExpressionUUID->"ea369acf-82a9-4b0d-b4cd-\
a31d01a8ea97"],

Cell["\<\
Well,
1. Gauss\[CloseCurlyQuote]s law says that; 
2. Gauss\[CloseCurlyQuote]s law for magnetism says that;
3. Faraday\[CloseCurlyQuote]s law says that;
4. Amp\[EGrave]re\[CloseCurlyQuote]s law says that;\
\>", "Text",
 CellChangeTimes->{{3.874454448018449*^9, 
  3.874454536826586*^9}},ExpressionUUID->"60ac0a12-87ea-4d49-8bd2-\
f805624375d7"],

Cell["\<\
Good. Now, write down the differential form of each of these equations.\
\>", "Text",
 CellChangeTimes->{{3.8744545412243357`*^9, 
  3.874454603038212*^9}},ExpressionUUID->"9ad76526-a0df-448a-8107-\
6168e139280e"],

Cell["That should be simple enough.", "Text",
 CellChangeTimes->{{3.8744546055568438`*^9, 
  3.874454614288226*^9}},ExpressionUUID->"b91f156a-0855-4585-aabe-\
dfec68fee7d4"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s begin with a magnetic field ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["B", "TB"], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["B", "TI"], "0"], 
         RowBox[{"(", 
           RowBox[{
             OverscriptBox[
              StyleBox["y", "TB"], "^"], "2", "+", 
             OverscriptBox[
              StyleBox["z", "TB"], "^"], "3"}], ")"}], "sin", 
         RowBox[{"\[Omega]", 
           StyleBox["t", "TI"]}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{B} = B_0 (\\hat{\\textbf{y}}2 + \\hat{\\textbf{z}}3) \
\\sin{\\omega t}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba5d12ea-05bb-4570-9a28-963e55cf5b39"],
 ". First, check that this could actually be a legitimate magnetic field."
}], "Text",
 CellChangeTimes->{{3.87459073760063*^9, 3.874590756420845*^9}, {
  3.874591185480822*^9, 3.8745911906541767`*^9}, {3.874591958357503*^9, 
  3.874591971688245*^9}, {3.874592933555691*^9, 3.874592933729374*^9}, {
  3.874760433248024*^9, 
  3.874760505067501*^9}},ExpressionUUID->"1b6cc447-ff85-44df-95e5-\
2c9858758039"],

Cell["Its divergence should be zero:", "CodeText",
 CellChangeTimes->{{3.874591983936578*^9, 3.874591993524596*^9}, {
  3.874592877520501*^9, 
  3.874592883365201*^9}},ExpressionUUID->"2122918f-053f-41c5-b9aa-\
7d358904a527"],

Cell[BoxData[
 RowBox[{"Div", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", " ", 
     RowBox[{"2", 
      SubscriptBox["B", "0"], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", 
     RowBox[{"3", 
      SubscriptBox["B", "0"], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Omega]", " ", "t"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874592007818348*^9, 3.874592018549962*^9}, {
  3.874592144574801*^9, 3.87459214538074*^9}, {3.874592721497715*^9, 
  3.874592805472704*^9}},
 CellLabel->
  "In[4276]:=",ExpressionUUID->"0db305c1-87d4-4346-b252-4bfc68f86099"],

Cell[TextData[{
 "Assume ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["B", "TI"], "0"], "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "B_0=1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5d8ecddc-531b-4327-9560-a1745bf388ab"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Omega]", "\[LongEqual]", "2", "\[Pi]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\omega = 2 \\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ef46d9a4-542f-4e49-a6e7-92e0b61aaa13"],
 ", plot the vector field and tell me what can you say about the vector field."
}], "Text",
 CellChangeTimes->{{3.874592903921698*^9, 3.874592922492537*^9}, {
  3.8745930013347683`*^9, 3.874593020575461*^9}, {3.874672532661523*^9, 
  3.874672554523645*^9}, {3.874672659850772*^9, 
  3.874672660130639*^9}},ExpressionUUID->"b13fc895-8ec1-4c64-bdd4-\
a32d79dcc75f"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VectorPlot3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"2", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}], ",", 
       RowBox[{"3", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"VectorPoints", "->", "Coarse"}], ",", 
     RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
     RowBox[{"VectorRange", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "2", ",", "0.01"}], "}"}], ",", 
   RowBox[{"AnimationRate", "->", "0.1"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8745929613480167`*^9, 3.87459299229738*^9}, {
   3.8745930285456457`*^9, 3.874593084062858*^9}, {3.8745932683330517`*^9, 
   3.874593390526538*^9}, {3.874593460803101*^9, 3.874593462664875*^9}, {
   3.874593494612956*^9, 3.8745934956080303`*^9}, {3.8745935612314453`*^9, 
   3.874593600336712*^9}, {3.874593658686705*^9, 3.874593658853612*^9}, {
   3.874593731904026*^9, 3.87459376649054*^9}, {3.8745938762759447`*^9, 
   3.87459388281863*^9}, {3.8745939249918633`*^9, 3.874593944732491*^9}, {
   3.874594004038292*^9, 3.874594055754691*^9}, {3.8745941416889668`*^9, 
   3.874594161999392*^9}, {3.8746708286162767`*^9, 3.874670835966866*^9}, {
   3.874670875968525*^9, 3.874670984319592*^9}, {3.874671099391749*^9, 
   3.874671128799581*^9}, 3.874671186538472*^9, {3.87467127390681*^9, 
   3.874671326222846*^9}, {3.8746713757804832`*^9, 3.874671471812846*^9}, {
   3.874671513290193*^9, 3.874671615288681*^9}, {3.874671660696619*^9, 
   3.874671721834756*^9}, {3.874672348336821*^9, 3.874672389837867*^9}, {
   3.874672427235652*^9, 3.8746724883509483`*^9}},
 CellLabel->
  "In[4291]:=",ExpressionUUID->"41e24900-daca-467b-8df5-129ff7e8f8c9"],

Cell[TextData[{
 "Since the vector field doesn\[CloseCurlyQuote]t have any space dependency, \
it has the same vector value everywhere in space. Also, note that the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       OverscriptBox[
        StyleBox["x", "TB"], "^"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\hat{\\textbf{x}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c35bed0c-e2b8-41a3-afbd-688f199c68ef"],
 " component is 0, it\[CloseCurlyQuote]s actually easier to just visualize it \
in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["y", "TI"], 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "yz", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "daa1889c-6f76-4c17-af79-ff763f49571c"],
 " plane:"
}], "CodeText",
 CellChangeTimes->{{3.874672693703154*^9, 3.874672727769842*^9}, {
  3.8746728332245903`*^9, 3.874672892380596*^9}, {3.8746729980290213`*^9, 
  3.87467302882897*^9}},ExpressionUUID->"a4331fea-17f0-46bf-9146-\
5e108afded4f"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VectorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}], ",", 
       RowBox[{"3", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"VectorPoints", "->", "Coarse"}], ",", 
     RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
     RowBox[{"VectorRange", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"y", ",", "z"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "2", ",", "0.01"}], "}"}], ",", 
   RowBox[{"AnimationRate", "->", "0.2"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874673035815543*^9, 3.8746731063482857`*^9}},
 CellLabel->
  "In[4278]:=",ExpressionUUID->"b1eb6b40-deb6-490c-a940-4a7af05bfc5d"],

Cell[TextData[{
 "Suppose there is conducting loop of 10 turns forming a unit circle in the \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], 
         StyleBox["y", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "xy", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69e2ea85-e3f0-4564-ae13-e254dd3e989c"],
 " plane, what would be the ",
 StyleBox["transformer emf",
  FontSlant->"Italic"],
 " created by this changing magnetic field?"
}], "Text",
 CellChangeTimes->{{3.8746738354780617`*^9, 3.874673881606716*^9}, {
  3.874673927633356*^9, 
  3.874673929573327*^9}},ExpressionUUID->"85a5e7a5-ab9b-4d3d-90e7-\
6c13896bf810"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "10"}], 
  RowBox[{"\[Integral]", 
   RowBox[{"x", 
    RowBox[{"\[DifferentialD]", "x"}]}]}]}]], "Input",
 CellChangeTimes->{{3.874673949899644*^9, 3.8746739616807623`*^9}, {
  3.874674122465261*^9, 3.8746741287556057`*^9}},
 CellLabel->
  "In[4279]:=",ExpressionUUID->"2df14f77-c2ab-4e39-bf17-207029ef6e88"],

Cell[BoxData[
 RowBox[{"\[Integral]", 
  RowBox[{"x", 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.874673966972927*^9, 3.874673968317422*^9}},
 CellLabel->
  "In[4280]:=",ExpressionUUID->"5cabb66d-8bed-4d93-97ba-a711e7860052"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "1"], 
  RowBox[{"x", 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.874673974743717*^9, 3.8746739859057426`*^9}, {
  3.874674021169729*^9, 3.874674028700498*^9}},
 CellLabel->
  "In[4281]:=",ExpressionUUID->"e99accf7-a6a7-4cd1-ab3a-5d0441de7df1"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VectorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}], "+", "y"}], ",", 
       RowBox[{"3", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", "\[Pi]", " ", "t"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"VectorPoints", "->", "Coarse"}], ",", 
     RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
     RowBox[{"VectorRange", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"y", ",", "z"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "2", ",", "0.01"}], "}"}], ",", 
   RowBox[{"AnimationRate", "->", "0.2"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874673129361668*^9, 3.874673130898326*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"955ea8a3-4678-4ffb-a4c7-250be03970aa"],

Cell["Charge-Current Continuity Relation", "Section",
 CellChangeTimes->{{3.874674260198008*^9, 
  3.87467427234188*^9}},ExpressionUUID->"9fe4567c-8618-4ac9-993a-\
b7f4644be2bd"],

Cell["Electromagnetic Potentials", "Section",
 CellChangeTimes->{{3.874674323247882*^9, 
  3.8746743323856373`*^9}},ExpressionUUID->"1c840c80-fc0d-4fbd-b39a-\
2693692a24f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plane-waves Propagation", "Chapter",
 CellChangeTimes->{{3.874453999903912*^9, 3.874454004641904*^9}, {
  3.874454105679229*^9, 3.874454108982766*^9}, {3.8744541659147043`*^9, 
  3.874454170389069*^9}},ExpressionUUID->"ed585af7-d24a-46ed-b5cb-\
28be44510216"],

Cell[CellGroupData[{

Cell["Basics", "Section",
 CellChangeTimes->{{3.877619238871071*^9, 
  3.877619239619194*^9}},ExpressionUUID->"c893db9e-ace5-4847-846b-\
f0be2f7c79fc"],

Cell["What are the Maxwell\[CloseCurlyQuote]s equations in the phasor \
domain?", "Text",
 CellChangeTimes->{{3.874455003680591*^9, 
  3.8744550178608427`*^9}},ExpressionUUID->"eca34a14-f483-4b86-bff7-\
ffc82427cff6"],

Cell["Derive the wave equation", "Text",
 CellChangeTimes->{{3.874455048631795*^9, 
  3.874455051382937*^9}},ExpressionUUID->"65ef230f-192f-4cbd-bed4-\
3db049253918"],

Cell["propagation constant", "Text",
 CellChangeTimes->{{3.87445512899576*^9, 
  3.874455131594293*^9}},ExpressionUUID->"ffcc8dd8-7079-4f0e-a0d1-\
ccb293800406"],

Cell["intrinsic impedance", "Text",
 CellChangeTimes->{{3.874455135155789*^9, 
  3.874455138818536*^9}},ExpressionUUID->"f30b64b2-1304-4a63-b138-\
56306f03a7e8"],

Cell["phase velocity", "Text",
 CellChangeTimes->{{3.8744551600103416`*^9, 
  3.874455162445466*^9}},ExpressionUUID->"1e86bb0c-92e9-4d15-b5ed-\
161173f95b92"],

Cell["\<\
What is a plane wave? \
https://reference.wolfram.com/language/ref/SliceVectorPlot3D.html\
\>", "Text",
 CellChangeTimes->{{3.874507695463007*^9, 3.8745076999655724`*^9}, {
  3.87450781342529*^9, 
  3.874507813670497*^9}},ExpressionUUID->"b4921fdf-3546-4d1a-a371-\
60e6a9c3afe9"],

Cell[TextData[{
 "How is the conduction current ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       OverscriptBox[
        StyleBox["J", "TI"], "~"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\tilde{\\vb{J}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "47fe4910-9d4c-4907-a677-963b81ddb401"],
 " (try to achieve \\vb) related to conductivity ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Sigma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\sigma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dd8804c1-e82f-4671-a409-02a70c51ef28"],
 "?"
}], "Text",
 CellChangeTimes->{{3.874507730751145*^9, 3.874507737911428*^9}, {
  3.874507817558343*^9, 
  3.87450789500106*^9}},ExpressionUUID->"8bfb231e-5032-4879-b6b3-\
e4bf0d465ac9"],

Cell[BoxData[
 RowBox[{"SliceVectorPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "x"}], ",", "z"}], "}"}], ",", "\"\<ZStackedPlanes\>\"", 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8745357911916437`*^9, 3.8745358355849247`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"3ee140f9-a5ad-48f5-81e7-62b57a39907f"],

Cell["\<\
Now that we know J = sigma E (assuming no other current flows in the medium), \
we can make curl(H) = J + j w e E neater by introducing the complex \
permittivity. We know that the conductivity of a dialectic medium is . Plot \
the complex permittivity of\
\>", "Text",
 CellChangeTimes->{{3.874674416588119*^9, 3.874674474420021*^9}, {
  3.874674581655851*^9, 
  3.874674689577117*^9}},ExpressionUUID->"14d79dfa-b344-4a70-a42e-\
96675a089979"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Epsilon]", "c"], "=", 
   RowBox[{"\[Epsilon]", "-", 
    RowBox[{"\[ImaginaryJ]", 
     FractionBox["\[Sigma]", "\[Omega]"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.874674666911255*^9, 3.874674748227515*^9}, 
   3.874674813788179*^9},
 CellLabel->
  "In[1565]:=",ExpressionUUID->"29791eac-5bfc-4a5c-b2a6-51098f057a1a"],

Cell[BoxData[
 RowBox[{"ComplexListPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"2.`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.6666666666666666`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.5`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.4`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.3333333333333333`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.2857142857142857`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.2222222222222222`", " ", "\[ImaginaryI]"}]}], ",", 
    RowBox[{"1.7708`*^-11", "-", 
     RowBox[{"0.2`", " ", "\[ImaginaryI]"}]}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.874674782132992*^9, 3.8746748497748737`*^9}, {
  3.874675107114182*^9, 3.874675107902028*^9}, {3.8746754212858677`*^9, 
  3.874675435095409*^9}, {3.874675525233921*^9, 3.874675604614273*^9}, {
  3.87467577047736*^9, 3.874675785420075*^9}, {3.874675819481782*^9, 
  3.8746758445110826`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"a0019b6f-38a6-41a6-9ba5-a5ebc09f67f7"],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "c"], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Epsilon]", "->", 
         RowBox[{"2", 
          SubscriptBox["\[Epsilon]", "0"]}]}], ",", 
        RowBox[{"\[Sigma]", "->", "2"}], ",", 
        RowBox[{"\[Omega]", "->", "#"}]}], "}"}]}], ")"}], "&"}], ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "10"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874675623220106*^9, 3.874675624986271*^9}, {
  3.874675732898314*^9, 3.8746757369271183`*^9}},
 CellLabel->
  "In[1566]:=",ExpressionUUID->"24132647-fc6f-4269-9222-5d290e895c45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Epsilon]", "c"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Epsilon]", "->", 
       RowBox[{"2", 
        SubscriptBox["\[Epsilon]", "0"]}]}], ",", 
      RowBox[{"\[Sigma]", "->", "2"}], ",", 
      RowBox[{"\[Omega]", "->", "#"}]}], "}"}]}], "&"}], "/@", 
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "10"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.874675748749517*^9, 3.874675761324345*^9}},
 CellLabel->
  "In[1567]:=",ExpressionUUID->"d818f23a-8c9c-4d7b-ba8d-c682bd2933df"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"g", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"h", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.874675944006502*^9, 3.874675971853571*^9}, {
  3.874676016742907*^9, 3.874676073175658*^9}},
 CellLabel->
  "In[1568]:=",ExpressionUUID->"aa241efa-3646-4f13-a24e-9296c2b5dc58"],

Cell["\<\
General solution of the wave equation (change phase of the reflection, \
describe the wave):\
\>", "Text",
 CellChangeTimes->{{3.874676332247594*^9, 3.874676347978451*^9}, {
  3.874676422382008*^9, 
  3.874676435569302*^9}},ExpressionUUID->"667cb235-7b91-41e8-94c3-\
0a529dec641d"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "+", 
         RowBox[{"2", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]]}]}], ")"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "\[Pi]", " ", "t"}]]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "10"}], ",", "10"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874676223093174*^9, 3.8746762845389*^9}},
 CellLabel->
  "In[1569]:=",ExpressionUUID->"9f6a7f8d-5a55-4271-9f38-4178ffdc8636"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VectorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Re", "[", 
        RowBox[{"2", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "x"}], "+", 
             FractionBox["\[Pi]", "4"]}], ")"}]}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "\[Pi]", " ", "t"}]]}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"VectorPoints", "->", "Coarse"}], ",", 
     RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
     RowBox[{"VectorRange", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "2", ",", "0.01"}], "}"}], ",", 
   RowBox[{"AnimationRate", "->", "0.2"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.874676856746657*^9, 3.874676942094369*^9}, {
  3.874676977252915*^9, 3.874677005139597*^9}},
 CellLabel->
  "In[907]:=",ExpressionUUID->"90aa3ec5-0e60-4018-858b-01b93e368776"],

Cell["Take a plane", "Text",
 CellChangeTimes->{{3.876303411696229*^9, 
  3.8763034133708344`*^9}},ExpressionUUID->"4aa9268b-45e4-4705-9883-\
4b491ec77ccb"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Append", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], "x"}], "-", "y"}], "3"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "x"}], "-", "y"}], "3"]}], "}"}], "+", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}], "*", 
                 RowBox[{"Re", "[", 
                  RowBox[{"4", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    FractionBox["\[Pi]", "4"]}]], 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", 
                    RowBox[{"(", 
                    RowBox[{"0.6", "\[Pi]"}], ")"}], " ", "t"}]]}], 
                  "]"}]}]}]}], "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "5"}], ",", "5", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "5"}], ",", "5", ",", "3"}], "}"}]}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Green", ",", "Thick", ",", 
         RowBox[{"Arrowheads", "[", "Large", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"3", "*", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "3"}], "}"}]}]}], "}"}], "]"}]}], 
        "}"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"the", " ", "propagation", " ", "direction"}], " ", "*)"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "15"}], ",", "15"}], "}"}]}], "}"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876304403048423*^9, 3.876304497401853*^9}, {
  3.87719243619625*^9, 3.877192443474794*^9}},
 CellLabel->
  "In[908]:=",ExpressionUUID->"fc4f1e9d-1f33-4f13-9b61-1c5e08c187e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zPoints", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Re", "[", 
                 RowBox[{"2", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                 "]"}], " ", "/.", 
                RowBox[{"\[Omega]", "->", 
                 RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], "}"}]}], 
            "}"}], "]"}]}], "}"}], "&"}], "/@", "zPoints"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"ViewVertical", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", "2.4", ",", " ", "2."}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
  3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
  3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
  3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
  3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
  3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
  3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
  3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
  3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
  3.8763157528001003`*^9, 3.87631578974681*^9}},
 CellLabel->
  "In[1620]:=",ExpressionUUID->"e71e3989-6061-4072-aa03-ba5f17bafd4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zPoints", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "           ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{"1.5", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
             "]"}]}], "}"}]}], "}"}], "&"}], "/@", "zPoints"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"ViewVertical", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"plotting", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzeRyemLZwzeOz/jNJoHoJcmBV0B0zI3KRyBaY/OF
NyB6rt6s3yBab3kiQzmQ3vbvCph+lMbGB6LNJS4JgfmfeGZWA2lG35j1INoh
hv0giL7z4tcxEJ2zf9kZEO0XcvIaiNY7UfoBRH/4KvoZRKecyf8OomWcu36B
6JLfwhI1QFrz7BowfWimviaI3njhNJjW9C8xAtH/lqlbg+icWZK+IPre0+2B
INpC63MsiE6q2psCouOuKeWDaC3F8iIQHRlvVgGi91j5guklM/kmguh3a7Wn
gegAjQ07QXTBN7+9IBoAUhut3A==
  "],
 CellLabel->
  "In[340]:=",ExpressionUUID->"82302cdd-3853-441f-9673-de12a04a1dc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZ2", "[", 
   RowBox[{"phasor1_", ",", "phasor2_"}], "]"}], ":=", 
  RowBox[{"Animate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blue", ",", 
                 RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                 RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"phasor1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}], ",", "y", ",", 
                    "zz"}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Green", ",", 
                 RowBox[{"Arrow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"phasor2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}], ",", "y", ",", 
                    "zz"}], "}"}]}], "}"}], "]"}]}], "}"}]}], "}"}]}], "]"}], 
           "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", 
             RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "}"}]}], "]"}]}], 
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Axes", "->", "True"}], ",", 
      RowBox[{"AxesLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
      ",", " ", 
      RowBox[{"ViewVertical", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
      RowBox[{"ViewPoint", "->", 
       RowBox[{"{", 
        RowBox[{"1.3", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], " ", ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
    RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.877229805454652*^9, 3.877229815907611*^9}, {
   3.877230026645505*^9, 3.877230161788383*^9}, {3.87723052674552*^9, 
   3.877230568073161*^9}, {3.877231049226554*^9, 3.87723113534871*^9}, {
   3.877233651493229*^9, 3.877233703622182*^9}, 3.877259327638019*^9},
 CellLabel->
  "In[1846]:=",ExpressionUUID->"82c65323-f521-4c5d-80fc-c89b8249f148"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2", "[", 
  RowBox[{
   RowBox[{"2", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z"}], "+", 
        FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", 
   RowBox[{"2", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", 
      RowBox[{"(", 
       RowBox[{"z", "+", 
        FractionBox["\[Pi]", "4"]}], ")"}]}]]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877230164957468*^9, 3.877230194969492*^9}, {
  3.877235558428158*^9, 3.877235572774489*^9}},
 CellLabel->
  "In[1847]:=",ExpressionUUID->"55f2e889-affa-4462-bafe-4afa3f6e4e9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldAlongZ", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xAbs", ",", "yAbs", ",", "xRange", ",", "yRange"}], "}"}], ",", 
    
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "xAbs"}], ",", "xAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "yAbs"}], ",", "yAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                   "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "}"}]}], 
              "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", "yRange", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
          RowBox[{"ViewPoint", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", " ", "2", ",", " ", "5"}], "}"}]}], " ",
           ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}], ",", 
        RowBox[{"AnimationRate", "->", ".5"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.87726710047084*^9, 3.87726714279492*^9}},
 CellLabel->
  "In[1988]:=",ExpressionUUID->"b1424151-5c67-45f4-a118-41fc0671454d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZ2a", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xAbs", ",", "yAbs", ",", "xRange", ",", "yRange"}], "}"}], ",", 
    
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"x1", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}], "+", 
        RowBox[{"Abs", "[", 
         RowBox[{"x2", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"y1", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}], "+", 
        RowBox[{"Abs", "[", 
         RowBox[{"y2", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "xAbs"}], ",", "xAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "yAbs"}], ",", "yAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "}"}]}], 
              "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", "yRange", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
          RowBox[{"ViewPoint", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", " ", "2", ",", " ", "5"}], "}"}]}], " ",
           ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}], ",", 
        RowBox[{"AnimationRate", "->", ".5"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8772353224006243`*^9, 3.877235338238358*^9}, {
   3.877235370702476*^9, 3.877235439935636*^9}, {3.877235504136835*^9, 
   3.8772355163511*^9}, {3.8772355894098682`*^9, 3.877235661452713*^9}, {
   3.877235711375139*^9, 3.877235743394515*^9}, {3.877235842164175*^9, 
   3.877235842680277*^9}, {3.877236066604953*^9, 3.8772361382471437`*^9}, {
   3.877236259678421*^9, 3.877236270103554*^9}, {3.877236596321262*^9, 
   3.8772366739704933`*^9}, {3.877236732794917*^9, 3.877236734622896*^9}, {
   3.8772377989639263`*^9, 3.877237864067608*^9}, {3.877238035554573*^9, 
   3.877238054260021*^9}, {3.877238090603231*^9, 3.8772382418039837`*^9}, {
   3.877238330393777*^9, 3.877238331772447*^9}, {3.8772383842818213`*^9, 
   3.8772384251239433`*^9}, {3.877238459918784*^9, 3.877238565686843*^9}, {
   3.877238706071761*^9, 3.87723879565963*^9}, 3.87723887366656*^9, {
   3.87723895408701*^9, 3.8772389824932537`*^9}, {3.877240219428768*^9, 
   3.87724035084444*^9}, {3.877240852712994*^9, 3.877240878566876*^9}, {
   3.8772410018479223`*^9, 3.877241021178584*^9}, {3.8772411801347733`*^9, 
   3.877241291333723*^9}, {3.8772414177304688`*^9, 3.8772414532783833`*^9}, {
   3.87725935754918*^9, 3.8772593856689453`*^9}, {3.877260405496965*^9, 
   3.877260408180726*^9}, {3.877260484675292*^9, 3.877260507777893*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"24fec2e4-030a-4051-95d2-aedd96f52888"],

Cell["\<\
This is the correct version of FieldsAlongZ2. To be used often.\
\>", "Text",
 CellChangeTimes->{{3.877259669552318*^9, 
  3.877259684094782*^9}},ExpressionUUID->"8695f589-c939-464c-b5be-\
be0546b7331c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZ2WithSum", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xAbs", ",", "yAbs", ",", "xRange", ",", "yRange"}], "}"}], ",", 
    
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"x1", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}], "+", 
        RowBox[{"Abs", "[", 
         RowBox[{"x2", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"y1", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}], "+", 
        RowBox[{"Abs", "[", 
         RowBox[{"y2", "/.", 
          RowBox[{"z", "->", "0"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "xAbs"}], ",", "xAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "yAbs"}], ",", "yAbs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "+", "x2"}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", " ", "+", " ", "y2"}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", " ", "+", " ", "z2"}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "}"}]}], 
              "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", "yRange", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
          RowBox[{"ViewPoint", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", " ", "2", ",", " ", "5"}], "}"}]}], " ",
           ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}], ",", 
        RowBox[{"AnimationRate", "->", ".5"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8772353224006243`*^9, 3.877235338238358*^9}, {
   3.877235370702476*^9, 3.877235439935636*^9}, {3.877235504136835*^9, 
   3.8772355163511*^9}, {3.8772355894098682`*^9, 3.877235661452713*^9}, {
   3.877235711375139*^9, 3.877235743394515*^9}, {3.877235842164175*^9, 
   3.877235842680277*^9}, {3.877236066604953*^9, 3.8772361382471437`*^9}, {
   3.877236259678421*^9, 3.877236270103554*^9}, {3.877236596321262*^9, 
   3.8772366739704933`*^9}, {3.877236732794917*^9, 3.877236734622896*^9}, {
   3.8772377989639263`*^9, 3.877237864067608*^9}, {3.877238035554573*^9, 
   3.877238054260021*^9}, {3.877238090603231*^9, 3.8772382418039837`*^9}, {
   3.877238330393777*^9, 3.877238331772447*^9}, {3.8772383842818213`*^9, 
   3.8772384251239433`*^9}, {3.877238459918784*^9, 3.877238565686843*^9}, {
   3.877238706071761*^9, 3.87723879565963*^9}, 3.87723887366656*^9, {
   3.87723895408701*^9, 3.8772389824932537`*^9}, {3.877240219428768*^9, 
   3.87724035084444*^9}, {3.877240852712994*^9, 3.877240878566876*^9}, {
   3.8772410018479223`*^9, 3.877241021178584*^9}, {3.8772411801347733`*^9, 
   3.877241291333723*^9}, {3.8772414177304688`*^9, 3.8772414532783833`*^9}, {
   3.877259715109853*^9, 3.877259800757362*^9}, {3.877260457814104*^9, 
   3.877260502515758*^9}, {3.877260533649754*^9, 3.8772605341787252`*^9}, {
   3.883450178953134*^9, 3.8834502469014273`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"18ee21dd-3681-4a87-a01f-c293509f2837"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2WithSum", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z"}], "+", 
         FractionBox["\[Pi]", "4"]}], ")"}]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", 
        RowBox[{"(", 
         RowBox[{"z", "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.87723538618476*^9, 3.877235387206007*^9}, {
   3.8772378793458138`*^9, 3.8772378794818707`*^9}, {3.877238844105961*^9, 
   3.8772389032736464`*^9}, 3.877240813263228*^9, {3.8772410175204678`*^9, 
   3.877241018937605*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"3710ac39-5344-4301-b5b0-eba0a431669f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZWithReflection", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xAbs", ",", "yAbs", ",", "xRange", ",", "yRange", ",", "x2", ",", "y2", 
      ",", "z2"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs"}], "*", "2"}], ",", 
           RowBox[{"xAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs"}], "*", "2"}], ",", 
           RowBox[{"yAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"xRange", ",", "yRange", ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "x2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    
                    TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "x2"}]}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", " ", "+", " ", 
                    RowBox[{"\[CapitalGamma]", " ", "y2"}]}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", " ", "+", " ", 
                    RowBox[{"\[CapitalGamma]", " ", "z2"}]}], ")"}], "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", 
                    RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "}"}]}], 
                 "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{"xRange", ",", "yRange", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5"}], ",", "2", ",", " ", "5"}], "}"}]}], " ", 
             ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", 
           RowBox[{"AnimationRate", "->", "0.5"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalGamma]", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877241623612651*^9, 3.8772417292153187`*^9}, {
   3.877241763949114*^9, 3.877241778726735*^9}, {3.8772418800098257`*^9, 
   3.877241910723689*^9}, {3.8772424741780643`*^9, 3.877242490937114*^9}, {
   3.877242683234914*^9, 3.877242693924851*^9}, {3.87724316210032*^9, 
   3.877243233075897*^9}, {3.8772434123957872`*^9, 3.8772434302290707`*^9}, {
   3.877243492419633*^9, 3.877243492729918*^9}, {3.877243788769437*^9, 
   3.877243802568293*^9}, {3.8772438939502296`*^9, 3.877243920894558*^9}, {
   3.8772448807903852`*^9, 3.877244936757709*^9}, {3.877244994232217*^9, 
   3.877244995620426*^9}, {3.877245944319364*^9, 3.877245944449791*^9}, {
   3.8772459930196877`*^9, 3.87724601928057*^9}, {3.877255569143099*^9, 
   3.877255616102809*^9}, {3.8772556678198357`*^9, 3.877255713352869*^9}, {
   3.877260414788563*^9, 3.877260417219144*^9}, {3.877260521268774*^9, 
   3.877260522052944*^9}, 3.87727111740617*^9, {3.883450290402173*^9, 
   3.883450303240528*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"671c40fb-6918-4698-a712-97fcf294d4a7"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithReflection", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "z"}], "+", 
         FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877241732608481*^9, 3.877241745846389*^9}, 
   3.877243505074095*^9},
 CellLabel->
  "In[906]:=",ExpressionUUID->"a52e76f0-5eb6-4aaf-be15-fec38b521d42"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{
    "would", " ", "it", " ", "be", " ", "better", " ", "if", " ", "we", " ", 
     "plot", " ", "them", " ", "in", " ", "separate", " ", 
     RowBox[{"planes", "?", " ", "Probably"}], " ", "not"}]}], ",", " ", 
   RowBox[{
   "since", " ", "the", " ", "polarization", " ", "would", " ", "then", " ", 
    "be", " ", "messy"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877618317757526*^9, 3.877618328575963*^9}, {
  3.877618918971312*^9, 
  3.877618932394853*^9}},ExpressionUUID->"80fb3b09-6c17-48e5-8aea-\
dc2620edb09e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{
   "change", " ", "to", " ", "colors", " ", "of", " ", "the", " ", "Plot", 
    " ", "defaults"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877618674287602*^9, 
  3.87761868400224*^9}},ExpressionUUID->"b46c1cc7-3aa4-417b-8ea6-\
0f76296de7bf"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Omega]", " ", "\[Mu]"}]], 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z"}], "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.877255845695616*^9, 3.877255954242421*^9}, {
  3.877256576374164*^9, 3.87725658707507*^9}, {3.877257327630219*^9, 
  3.877257330502369*^9}, {3.8772573714034147`*^9, 3.8772573722041883`*^9}},
 CellLabel->
  "In[1839]:=",ExpressionUUID->"4c3685af-41e6-4f2a-987b-3a4c7ee97f81"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2a", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z"}], "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z"}], "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.87725924791435*^9, 3.877259295323794*^9}, {
  3.877259407782487*^9, 3.877259420587907*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"42cd4210-2a83-4db5-a7f3-8c134db21edc"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Omega]", " ", "\[Mu]"}]], 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z"}], "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0", ",", "0"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.877257409753996*^9, 3.877257414361822*^9}},
 CellLabel->
  "In[1840]:=",ExpressionUUID->"ecaa5850-123c-4c6f-93df-f5c7adf6d2b0"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2a", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "z"}], "+", 
          FractionBox["\[Pi]", "4"]}], ")"}]}]]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["\[Pi]", "4"], "-", "z"}], ")"}]}]], ",", "0"}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.877259602376927*^9, 3.877259615801827*^9}},
 CellLabel->
  "In[1956]:=",ExpressionUUID->"c8034352-e1b4-47ad-8fba-12bde3931110"],

Cell[TextData[{
 "Express ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", "TB"], "(", 
         StyleBox["x", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\textbf{E}(x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "afc761af-d6b4-4305-86e2-93371fb19010"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["H", "TB"], "(", 
         StyleBox["x", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\textbf{H}(x)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "59f9440b-5af6-48f0-be0f-84b27edc7745"],
 " for a homogeneous plane wave propagating in the negative ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6a533676-e43e-4666-a532-dcd0774bd437"],
 " direction, when the electric field is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0f169dda-27aa-4525-a7af-7a558dc2a366"],
 " directed with amplitude ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "0"], ">", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "E_0 > 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c6ab1437-da09-41c1-a94c-2f08918e60c6"],
 "."
}], "Text",
 CellChangeTimes->{{3.877260605793768*^9, 
  3.8772607091111183`*^9}},ExpressionUUID->"eebafccd-b638-4a0c-9eed-\
fcd341b6859d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Omega]", " ", "\[Mu]"}]], 
   RowBox[{
    SubscriptBox["\[Del]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       SubscriptBox["E", "0"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "k", " ", "x"}]]}], ",", "0"}], 
     "}"}]}]}], "/.", 
  RowBox[{
   FractionBox["k", 
    RowBox[{"\[Omega]", " ", "\[Mu]"}]], "->", 
   FractionBox["1", "\[Eta]"]}]}]], "Input",
 CellChangeTimes->{{3.8772607270193872`*^9, 3.87726076283755*^9}, {
  3.877261227494452*^9, 3.877261274164486*^9}, {3.877261316336795*^9, 
  3.877261337708946*^9}, {3.877261609267008*^9, 3.8772616422309933`*^9}, {
  3.877261680428412*^9, 3.877261681609432*^9}, {3.877261737184121*^9, 
  3.8772617411530657`*^9}, {3.877261783340817*^9, 3.877261799731353*^9}, {
  3.877264705656996*^9, 3.8772647167352552`*^9}},
 CellLabel->
  "In[1973]:=",ExpressionUUID->"5f7c0fe8-5ddf-4e9a-919c-27242611a2eb"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[Del]", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]], 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["E", "0"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "x"], "x"}], "+", 
        RowBox[{
         SubscriptBox["k", "y"], "y"}], "+", 
        RowBox[{
         SubscriptBox["k", "z"], "z"}]}], ")"}]}]]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.877264807166842*^9, 3.877264844439049*^9}, {
  3.877266507817726*^9, 3.877266591721938*^9}, {3.877266654928541*^9, 
  3.8772667040100527`*^9}},
 CellLabel->
  "In[1986]:=",ExpressionUUID->"24fafb97-8fa4-455f-aab8-0e56b7a83c8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryJ]"}], " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "x"], ",", 
     SubscriptBox["k", "y"], ",", 
     SubscriptBox["k", "z"]}], "}"}], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      SubscriptBox["E", "0"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["k", "x"], "x"}], "+", 
          RowBox[{
           SubscriptBox["k", "y"], "y"}], "+", 
          RowBox[{
           SubscriptBox["k", "z"], "z"}]}], ")"}]}]]}], ",", "0"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.877266817339292*^9, 3.87726684412864*^9}, {
  3.877266885240593*^9, 3.877266888066904*^9}},
 CellLabel->
  "In[1987]:=",ExpressionUUID->"917bdd33-4d57-46a0-83bc-4c63d6a9d042"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wave Polarization", "Section",
 CellChangeTimes->{{3.876303729003849*^9, 
  3.876303734560939*^9}},ExpressionUUID->"2174ba11-5736-4c8d-825e-\
aebbd6fbad3d"],

Cell[CellGroupData[{

Cell["LHC Polarization", "Subsection",
 CellChangeTimes->{{3.876318323506591*^9, 
  3.876318334005885*^9}},ExpressionUUID->"60cd369f-7056-4146-a166-\
ad91af41faf7"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
    RowBox[{"2", "\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8772671559860353`*^9, 3.8772671676629467`*^9}},
 CellLabel->
  "In[3880]:=",ExpressionUUID->"0c8a054b-1bbd-49fb-875b-6555c1e4ff9e"],

Cell[TextData[{
 "It appears that this wave only propagates via rotation. The magnitude of \
the electric field stays constant. On the other hand, both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["E", "TI"], 
        StyleBox["x", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "E_x", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "873c482a-de16-492b-b6bc-a457d316d45e"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["E", "TI"], 
        StyleBox["y", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "E_y", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0d429da6-2064-4569-a2bb-4dd414558be4"],
 " only have ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c9dcaea3-148e-46f3-b6e0-06996e24f3a9"],
 " dependence."
}], "CodeText",
 CellChangeTimes->{{3.8772677358446503`*^9, 3.877267773052449*^9}, {
  3.877618503685347*^9, 
  3.877618529980454*^9}},ExpressionUUID->"7b78b48e-edc0-43ff-9bce-\
38adce7142c6"],

Cell["\<\
How does the magnetic field look like with this LHC polarized electric field?\
\
\>", "Text",
 CellChangeTimes->{{3.877268086267929*^9, 
  3.877268115724183*^9}},ExpressionUUID->"7afbc957-edd8-410b-8869-\
0c7d88822a2c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Omega]", " ", "\[Mu]"}]], 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
     RowBox[{"2", "\[ImaginaryJ]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{3.877267911406005*^9},
 CellLabel->
  "In[1992]:=",ExpressionUUID->"d2208594-bce9-4b44-bd3f-d9dd615ac0d6"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2a", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
     RowBox[{"2", "\[ImaginaryJ]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]]}], ",", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]], ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8772680312437057`*^9, 3.877268061892097*^9}},
 CellLabel->
  "In[1247]:=",ExpressionUUID->"4c9e3bec-4b1d-41fc-a511-e93ae233c0ae"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithReflection", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
    RowBox[{"2", "\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.87724482353533*^9, 3.8772448589093943`*^9}, 
   3.877244906033856*^9, {3.877246075892107*^9, 3.877246091720064*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"a7a1f9be-dccb-469b-8e68-88c791c95103"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RHC Polarization", "Subsection",
 CellChangeTimes->{{3.8763183384966507`*^9, 
  3.87631834287541*^9}},ExpressionUUID->"e9ddffee-60ff-42b7-9936-\
62d570b0e4d3"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"2", "\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877268214820285*^9, 3.877268217271309*^9}},
 CellLabel->
  "In[1997]:=",ExpressionUUID->"51980c75-62c9-4245-9462-aac81bb03c24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elliptical Polarization", "Subsection",
 CellChangeTimes->{{3.8763186003431053`*^9, 
  3.876318605298368*^9}},ExpressionUUID->"4c43ea67-37ca-4b2f-95a5-\
ce632413dc8c"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877268273902608*^9, 3.8772682976579313`*^9}, {
  3.877268331577468*^9, 3.877268332276718*^9}, {3.877268703480335*^9, 
  3.8772687036388597`*^9}},
 CellLabel->
  "In[2012]:=",ExpressionUUID->"60792607-3341-4632-9c1e-a9fb03ed5b73"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]], ",", 
    RowBox[{"2", "\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877268352110867*^9, 3.877268355162554*^9}, 
   3.877268665687076*^9, {3.877268713586731*^9, 3.877268714619933*^9}},
 CellLabel->
  "In[2013]:=",ExpressionUUID->"2a8edf1f-de1a-4829-ba0a-2c1988d8e5fe"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]], ",", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.877268366360766*^9, 3.877268662907487*^9, {3.877268719043867*^9, 
   3.877268728930283*^9}},
 CellLabel->
  "In[2015]:=",ExpressionUUID->"1a354918-3c8c-451d-ba71-d0f7a60b553e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Omega]", " ", "\[Mu]"}]], 
  RowBox[{
   SubscriptBox["\[Del]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]], "\[Cross]", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.877268657359858*^9, 3.8772687346592197`*^9}},
 CellLabel->
  "In[2016]:=",ExpressionUUID->"ae7c4ddd-7029-4f5f-9750-6ca46c95b6aa"],

Cell[BoxData[
 RowBox[{"FieldsAlongZ2a", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]], ",", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[ImaginaryJ]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]]}], ",", "0"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8772687615724154`*^9, 3.8772687870271597`*^9}},
 CellLabel->
  "In[2017]:=",ExpressionUUID->"f7d91598-0bef-46b6-b368-f07f037abd5d"],

Cell[TextData[{
 "The ellipse drawn by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["H", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{H}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8c632fa-d41f-4eac-9076-127012135396"],
 " is has the same shape, but it is rotated by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox["90", "\[EmptySmallCircle]"], TraditionalForm], 
     "errors" -> {}, "input" -> "90^\\degree", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cdfd91da-b478-4435-912f-9f4e0c643ef3"],
 ". Also, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["H", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{H}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "25c60cab-8ff5-4d85-911e-46d0348109aa"],
 " is perpendicular to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a3a11b45-5a4e-4de2-9edd-3bfa05cc6aa9"],
 " everywhere."
}], "CodeText",
 CellChangeTimes->{{3.877268837932287*^9, 
  3.877268976053232*^9}},ExpressionUUID->"f83e198c-0a37-4636-9e3a-\
d75fca8f8cf9"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["H", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{H}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20762636-9e1a-42b2-874c-84b62c16362c"],
 " is perpendicular to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7b7183ac-a53a-4ad7-9be5-25d283b20936"],
 " everywhere only when the medium is lossless."
}], "Text",
 CellChangeTimes->{{3.877269197574593*^9, 3.877269229540358*^9}, {
  3.8772692816386003`*^9, 
  3.87726929571215*^9}},ExpressionUUID->"cfa7270b-ecfd-4499-98b9-\
48d552418916"]
}, Open  ]]
}, Open  ]],

Cell["Lossy Mediums", "Section",
 CellChangeTimes->{{3.877269375799444*^9, 
  3.877269381697225*^9}},ExpressionUUID->"d13f76c2-7710-48e8-ab45-\
54342fea2577"],

Cell["Group Velocity", "Section",
 CellChangeTimes->{{3.877269375799444*^9, 3.877269381697225*^9}, {
  3.877269489966221*^9, 
  3.877269493879916*^9}},ExpressionUUID->"63a72acd-3527-4e70-a911-\
097489c7c25e"],

Cell["Power Flow", "Section",
 CellChangeTimes->{{3.8772695657665586`*^9, 
  3.8772695684529133`*^9}},ExpressionUUID->"edff5ce3-85ec-4991-89be-\
6cec0d1d8205"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wave Reflection and Transmission", "Chapter",
 CellChangeTimes->{{3.874453999903912*^9, 3.874454004641904*^9}, {
   3.874454105679229*^9, 3.874454108982766*^9}, {3.8744541659147043`*^9, 
   3.874454193212523*^9}, 
   3.877269480812561*^9},ExpressionUUID->"6990d69a-76dc-43d5-86f4-\
0eea3d011d19"],

Cell[CellGroupData[{

Cell["Basics", "Section",
 CellChangeTimes->{{3.8763207402729387`*^9, 3.876320742922566*^9}, {
  3.876320794695222*^9, 
  3.876320795488242*^9}},ExpressionUUID->"c2fa178f-e077-4e87-a4a2-\
7f90fcda3008"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WavesAlongZNoBoundary", "[", 
   RowBox[{"wave1_", ",", "wave2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wave1Abs", ",", "wave2Abs", ",", "plotRange", ",", "\[Omega]"}],
      "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wave1Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wave2Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave2", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "wave1Abs"}], "-", "wave2Abs", "-", "1"}], ",", 
         RowBox[{"wave1Abs", "+", "wave2Abs", "+", "1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"0.3", "\[Pi]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"wave1", "*", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], ",", 
              RowBox[{"Re", "[", 
               RowBox[{"wave2", "*", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], ",", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"wave1", "+", "wave2"}], ")"}], "*", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}]}], " ", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
            RowBox[{"PlotRange", "->", "plotRange"}], ",", 
            RowBox[{"PlotLegends", "->", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Wave1\>\"", ",", "\"\<Wave2\>\"", ",", "\"\<Total\>\""}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "->", "Large"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"PointLegend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> GrayLevel[0]|>,
               "GrayLevelColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
               "RGBColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
               "RGBColorSwatchTemplate"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<\[Omega]\>\"", ",", "\[Omega]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave1\>\"", ",", "wave1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave2\>\"", ",", "wave2"}], "}"}]}], "}"}]}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616262869247*^9, 
   3.877616264429681*^9}, {3.8776165454140453`*^9, 3.877616546072646*^9}, {
   3.8776166188147717`*^9, 3.877616619371581*^9}, {3.877703992569488*^9, 
   3.8777040684667797`*^9}, {3.8777042714386787`*^9, 3.877704323682255*^9}, {
   3.877704466358306*^9, 3.877704617825367*^9}, {3.877704677046824*^9, 
   3.87770470710962*^9}, {3.877704773815371*^9, 3.877704791971489*^9}, {
   3.877704868525515*^9, 3.877704877212737*^9}, {3.8777049160227947`*^9, 
   3.877704958245488*^9}, {3.8777049897992163`*^9, 3.8777050089689503`*^9}, 
   3.8777051116733627`*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"9dca5189-70e1-45d7-b3c7-58e7e8a9f76c"],

Cell[BoxData[
 RowBox[{"WavesAlongZNoBoundary", "[", 
  RowBox[{
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], ",", 
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877704624942706*^9, 3.877704637443577*^9}, {
  3.877704673912088*^9, 3.8777046807843513`*^9}, {3.877704832080935*^9, 
  3.8777048345919933`*^9}},
 CellLabel->
  "In[1123]:=",ExpressionUUID->"b6b0281d-fa64-4ea8-9307-6514b391e789"],

Cell[BoxData[
 RowBox[{"WavesAlongZNoBoundary", "[", 
  RowBox[{
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"0.1", "\[ImaginaryJ]"}]}], ")"}], "z"}]]}], ",", "0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877707398535095*^9, 3.877707419392786*^9}, {
  3.877707462139852*^9, 3.877707525923271*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"8222470f-d56b-4fc2-9694-5a8c3c496860"],

Cell["\<\
When a wave encounters a boundary (also called an interface) between two \
mediums, what happens?\
\>", "Text",
 CellChangeTimes->{{3.87632080062401*^9, 3.8763208446978397`*^9}, {
  3.8763208899205437`*^9, 
  3.8763208913913527`*^9}},ExpressionUUID->"255db834-596c-48cf-9354-\
3126b4bd6489"],

Cell["\<\
Some gets reflected back but some might pass through the interface and keep \
propagating in the second medium.\
\>", "CodeText",
 CellChangeTimes->{{3.876320853988419*^9, 
  3.8763209250899773`*^9}},ExpressionUUID->"ded50ed5-eb17-49c3-819f-\
39fe39c540f3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"THIS", " ", "ONE", " ", "IS", " ", "LOSSLESS"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.877652701533203*^9, 
  3.877652711113276*^9}},ExpressionUUID->"5a8d2f04-ac64-4d8d-a6c2-\
14b4ad6d56b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveAlongZ", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "incidentAbs", ",", "plotRange", ",", "reflected", ",", "transmitted", 
      ",", "\[CapitalGamma]", ",", "\[Tau]"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"incidentAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"incident", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "incidentAbs"}], "*", "2"}], "+", "2"}], ",", 
         RowBox[{
          RowBox[{"incidentAbs", "*", "2"}], "-", "2"}]}], "}"}]}], ";", " ", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "With", " ", "the", " ", "permittivity", " ", "values", " ", "we", " ",
         "know", " ", "the", " ", "total", " ", "wave", " ", 
        RowBox[{"won", "'"}], "t", " ", "exceed", " ", "this", " ", "range"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalGamma]", "=", 
           RowBox[{"N", "[", 
            FractionBox[
             RowBox[{
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r1"]], "-", 
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r2"]]}], 
             RowBox[{
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r1"]], "+", 
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r2"]]}]], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Tau]", "=", 
           RowBox[{"1", "+", "\[CapitalGamma]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"transmitted", "=", 
           RowBox[{"incident", "/.", 
            RowBox[{"z", "->", 
             RowBox[{
              FractionBox[
               SqrtBox[
                SubscriptBox["\[Epsilon]", "r2"]], 
               SqrtBox[
                SubscriptBox["\[Epsilon]", "r1"]]], "z"}]}]}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "We", " ", "have", " ", "cheated", " ", "a", " ", "little", " ", 
             RowBox[{"bit", ":", " ", 
              RowBox[{
              "the", " ", "k", " ", "is", " ", "a", " ", "scalled", " ", 
               "version"}]}]}], ",", " ", "or", ",", " ", 
            RowBox[{
             FractionBox[
              SubscriptBox["k", "2"], 
              SubscriptBox["k", "1"]], "=", 
             FractionBox[
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r2"]], 
              SqrtBox[
               SubscriptBox["\[Epsilon]", "r1"]]]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Animate", "[", 
           RowBox[{
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"incident", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "*", "transmitted", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
                RowBox[{"PlotRange", "->", "plotRange"}], ",", 
                RowBox[{"PlotLegends", "->", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Incident\>\"", ",", "\"\<Reflection\>\"", ",", 
                   "\"\<Transmission\>\"", ",", "\"\<Total\>\""}], "}"}]}], 
                ",", 
                RowBox[{"ImageSize", "->", "Large"}]}], " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Blue", ",", "Green", ",", "Orange", ",", "Green"}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(r1\)]\)\>\"", 
                    ",", 
                    SubscriptBox["\[Epsilon]", "r1"]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(r2\)]\)\>\"", 
                    ",", 
                    SubscriptBox["\[Epsilon]", "r2"]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\[CapitalGamma]\>\"", ",", "\[CapitalGamma]"}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Tau]\>\"", ",", "\[Tau]"}], "}"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
            RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "r1"], ",", "1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "r2"], ",", "10"}], "}"}], ",", "1", 
          ",", "10"}], "}"}]}], "]"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616262869247*^9, 
   3.877616264429681*^9}, {3.8776165454140453`*^9, 3.877616546072646*^9}, {
   3.8776166188147717`*^9, 3.877616619371581*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"fb83c383-68cb-4c41-8573-939d5208781c"],

Cell[BoxData[
 RowBox[{"WaveAlongZ", "[", 
  RowBox[{"10", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.877595419270485*^9, 3.877595429712607*^9}},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"1d360e7b-c4a9-4567-b357-b4dc7af328bb"],

Cell[TextData[{
 "When the wavenumber ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ccb2ab31-01b0-4465-93e0-3ec8123fe5ae"],
 " is large, there are more cycles per unit distance, so it represents the \
spatial frequency. Accordingly, when a large ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "825b5232-1dd1-4c3e-bf7b-d9b1d940acc9"],
 " comes a small ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Lambda]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\lambda", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "92638d51-3053-4d56-a1ca-3b6435733026"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.877615655147643*^9, 3.877615695151704*^9}, {
  3.87761581689256*^9, 
  3.877615891700006*^9}},ExpressionUUID->"1954f84a-e069-41da-95e3-\
4215d48e2da2"],

Cell[CellGroupData[{

Cell[TextData[{
 "Complex ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69be2847-acd9-4f17-8776-ca519789356f"]
}], "Subsection",
 CellChangeTimes->{{3.87762022659585*^9, 
  3.8776202301633577`*^9}},ExpressionUUID->"17c2fdb0-4dda-4b84-bc68-\
305cc1910e98"],

Cell[BoxData[
 RowBox[{"WaveAlongZ", "[", 
  RowBox[{"10", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"0.1", "\[ImaginaryJ]"}]}], ")"}], "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.877620146834573*^9, 3.8776201780613937`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"ab80bf4b-8dc6-4473-8549-c151b9b34c60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveAlongZLosslessToLossy", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "incidentAbs", ",", "plotRange", ",", "reflected", ",", "transmitted", 
      ",", 
      SubscriptBox["k", "1"], ",", "\[Omega]", ",", "T", ",", 
      SubscriptBox["\[Eta]", "1"], ",", 
      SubscriptBox["\[Eta]", "2"], ",", "\[CapitalGamma]", ",", "\[Tau]"}], 
     "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"incidentAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"incident", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "incidentAbs"}], "*", "2"}], "+", "2"}], ",", 
         RowBox[{
          RowBox[{"incidentAbs", "*", "2"}], "-", "2"}]}], "}"}]}], ";", " ", 
      
      RowBox[{"(*", " ", 
       RowBox[{
       "With", " ", "the", " ", "permittivity", " ", "values", " ", "we", " ",
         "know", " ", "the", " ", "total", " ", "wave", " ", 
        RowBox[{"won", "'"}], "t", " ", "exceed", " ", "this", " ", "range"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["k", "1"], "=", 
           RowBox[{"-", 
            RowBox[{"Im", "[", 
             RowBox[{"incident", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}]}], 
          ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"This", " ", "might", " ", "be", " ", "flaky"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", 
           FractionBox[
            SubscriptBox["k", "1"], 
            SqrtBox[
             RowBox[{
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "r1"], 
              SubscriptBox["\[Epsilon]", "0"]}]]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"T", "=", 
           FractionBox[
            RowBox[{"2", "\[Pi]"}], "\[Omega]"]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Eta]", "1"], "=", 
           SqrtBox[
            FractionBox[
             SubscriptBox["\[Mu]", "0"], 
             RowBox[{
              SubscriptBox["\[Epsilon]", "r1"], 
              SubscriptBox["\[Epsilon]", "0"]}]]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["\[Eta]", "2"], "=", 
           SqrtBox[
            FractionBox[
             SubscriptBox["\[Mu]", "0"], 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Epsilon]", "r2"], 
               SubscriptBox["\[Epsilon]", "0"]}], "-", 
              RowBox[{"\[ImaginaryJ]", 
               FractionBox[
                SubscriptBox["\[Sigma]", "2"], "\[Omega]"]}]}]]]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalGamma]", "=", 
           RowBox[{"N", "[", 
            FractionBox[
             RowBox[{
              SubscriptBox["\[Eta]", "2"], "-", 
              SubscriptBox["\[Eta]", "1"]}], 
             RowBox[{
              SubscriptBox["\[Eta]", "2"], "+", 
              SubscriptBox["\[Eta]", "1"]}]], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Tau]", "=", 
           RowBox[{"1", "+", "\[CapitalGamma]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"transmitted", "=", 
           RowBox[{"incident", "/.", 
            RowBox[{"z", "->", 
             RowBox[{
              FractionBox[
               SqrtBox[
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Epsilon]", "r2"], 
                  SubscriptBox["\[Epsilon]", "0"]}], "-", 
                 RowBox[{"\[ImaginaryJ]", 
                  FractionBox[
                   SubscriptBox["\[Sigma]", "2"], "\[Omega]"]}]}]], 
               SqrtBox[
                RowBox[{
                 SubscriptBox["\[Epsilon]", "r1"], 
                 SubscriptBox["\[Epsilon]", "0"]}]]], "z"}]}]}]}], ";", 
          RowBox[{"(*", " ", 
           RowBox[{"hacky", " ", "way", " ", "to", " ", "set", " ", 
            SubscriptBox["k", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Animate", "[", 
           RowBox[{
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"incident", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "*", "transmitted", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
                RowBox[{"PlotRange", "->", "plotRange"}], ",", 
                RowBox[{"PlotLegends", "->", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Incident\>\"", ",", "\"\<Reflection\>\"", ",", 
                   "\"\<Transmission\>\"", ",", "\"\<Total\>\""}], "}"}]}], 
                ",", 
                RowBox[{"ImageSize", "->", "Large"}]}], " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "Red", ",", "Blue", ",", "Green", ",", "Green", ",", "Green",
                   ",", "Orange", ",", "Green"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Omega]\>\"", ",", "\[Omega]"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(r1\)]\)\>\"", 
                    ",", 
                    SubscriptBox["\[Epsilon]", "r1"]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(r2\)]\)\>\"", 
                    ",", 
                    SubscriptBox["\[Epsilon]", "r2"]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(2\)]\)\>\"", ",", 
                    SubscriptBox["\[Sigma]", "2"]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(k\), \(2\)]\)\>\"", ",", 
                    RowBox[{
                    SubscriptBox["k", "1"], "*", 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "r2"], 
                    SubscriptBox["\[Epsilon]", "0"]}], "-", 
                    RowBox[{"\[ImaginaryJ]", 
                    FractionBox[
                    SubscriptBox["\[Sigma]", "2"], "\[Omega]"]}]}]], 
                    SqrtBox[
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "r1"], 
                    SubscriptBox["\[Epsilon]", "0"]}]]]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\[CapitalGamma]\>\"", ",", "\[CapitalGamma]"}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Tau]\>\"", ",", "\[Tau]"}], "}"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "r1"], ",", "1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "r2"], ",", "10"}], "}"}], ",", "1", 
          ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Sigma]", "2"], ",", "0", ",", "0.01"}], "}"}]}], 
       "]"}]}], ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616262869247*^9, 
   3.877616264429681*^9}, {3.8776165454140453`*^9, 3.877616546072646*^9}, {
   3.8776166188147717`*^9, 3.877616619371581*^9}, {3.877654006505802*^9, 
   3.877654007139051*^9}, {3.877656856346217*^9, 3.877656963551083*^9}, {
   3.8776569971570473`*^9, 3.8776569975567417`*^9}, {3.877657042599616*^9, 
   3.8776570432594147`*^9}, {3.877657183687235*^9, 3.8776572563788*^9}, {
   3.8776572911729393`*^9, 3.877657448416834*^9}, {3.877657513706547*^9, 
   3.877657549761181*^9}, {3.877659047978867*^9, 3.877659094441221*^9}, {
   3.8776592279976*^9, 3.877659231053885*^9}, {3.877659486292016*^9, 
   3.877659518704238*^9}, {3.8776596115799093`*^9, 3.877659647650569*^9}, {
   3.877659695219046*^9, 3.877659722604972*^9}, {3.8776597888848877`*^9, 
   3.8776598260742607`*^9}, {3.877659857662022*^9, 3.8776598740924797`*^9}, {
   3.877660034005581*^9, 3.877660034533867*^9}, {3.877660067617165*^9, 
   3.8776600682638597`*^9}, {3.877660146451767*^9, 3.877660148277169*^9}, {
   3.877660205769051*^9, 3.877660268049444*^9}, {3.877660375808619*^9, 
   3.877660376481262*^9}, {3.877663027284466*^9, 3.877663040541012*^9}, {
   3.877664706626911*^9, 3.8776647100959663`*^9}, {3.877664763282724*^9, 
   3.877664792613125*^9}, {3.877665224013571*^9, 3.877665226264084*^9}, {
   3.877665277727069*^9, 3.87766528675025*^9}, {3.877667190919406*^9, 
   3.87766719597652*^9}, {3.877667350133388*^9, 3.877667402563615*^9}, {
   3.8776676479807663`*^9, 3.87766768242144*^9}, {3.8776677339640627`*^9, 
   3.877667734929275*^9}, 3.877667821067375*^9, {3.877668758794372*^9, 
   3.8776687830955067`*^9}, 3.877668883445485*^9, {3.877668986460135*^9, 
   3.8776690596514072`*^9}, {3.8776691973459663`*^9, 3.877669199808606*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"2b90a622-b1d6-4c7b-8b8c-e6e7d2c235d5"],

Cell["\<\
What\[CloseCurlyQuote]s the relationship between complex permittivity and \
phase velocity?\
\>", "CodeText",
 CellChangeTimes->{{3.87765930792889*^9, 
  3.877659327959434*^9}},ExpressionUUID->"fdc941bc-697f-4e25-b522-\
ba00dde4d899"],

Cell[BoxData[
 RowBox[{"WaveAlongZLosslessToLossy", "[", 
  RowBox[{"10", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.877654444001248*^9, 3.877654444679348*^9}, {
   3.877657008341753*^9, 3.877657012853948*^9}, 3.877657235387814*^9, 
   3.877667359001116*^9, {3.8776676547615023`*^9, 3.877667656222274*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"a2f8cfd1-9b24-43a7-b502-ea77c35016f1"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"1", "/", 
   FractionBox[
    RowBox[{"6", "*", 
     SuperscriptBox["10", "8"]}], 
    RowBox[{"2", "\[Pi]"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.87766010884305*^9, 3.877660132227529*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"6293c1d5-a360-4e9f-8a19-243e0d96e453"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TreeForm", "[", "expr", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8776540344785547`*^9, 3.877654034630022*^9}, {
  3.87765767619772*^9, 3.877657713627742*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"47145463-bc1d-4810-ba4f-6fcb6dc4ebab"],

Cell[BoxData[
 RowBox[{"Im", "[", 
  RowBox[{"expr", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.877657723019198*^9, 3.877657800660817*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"f0280a9c-28f0-4419-9a71-0c9fa64a5628"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", "x"}], 
     RowBox[{"1", "+", "x"}]], "==", "\[CapitalGamma]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877615903231786*^9, 3.877615949507805*^9}, {
  3.877615989201383*^9, 3.877616025529853*^9}, {3.877616173348082*^9, 
  3.877616176451046*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"8bb0db05-824e-440d-a724-31556e32a00a"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  FractionBox[
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"1", "-", "\[CapitalGamma]"}], 
     RowBox[{"1", "+", "\[CapitalGamma]"}]]}], 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"1", "-", "\[CapitalGamma]"}], 
     RowBox[{"1", "+", "\[CapitalGamma]"}]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.87761605769914*^9, 3.877616071801547*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"e8547e0a-9448-4256-85f4-4a0cf9c66637"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"This", " ", 
   RowBox[{"doesn", "'"}], "t", " ", "work"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.8776162225248117`*^9, 
  3.877616226937251*^9}},ExpressionUUID->"a4b30d93-9bb7-4b9a-8435-\
73a6bd64448b"],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  FractionBox[
   RowBox[{
    SqrtBox[
     FractionBox["1", 
      SubscriptBox["\[Epsilon]", "r2"]]], "-", 
    SqrtBox[
     FractionBox["1", 
      SubscriptBox["\[Epsilon]", "r1"]]]}], 
   RowBox[{
    SqrtBox[
     FractionBox["1", 
      SubscriptBox["\[Epsilon]", "r2"]]], "+", 
    SqrtBox[
     FractionBox["1", 
      SubscriptBox["\[Epsilon]", "r1"]]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.87759689572213*^9, 3.8775969721031857`*^9}, {
  3.877597002581402*^9, 3.8775970309476643`*^9}, {3.877597330904562*^9, 
  3.877597343046618*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"d3a058bf-bf5e-403c-8b72-5be041b8e68f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WaveAlongZWithGamma", "[", "incident_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "incidentAbs", ",", "plotRange", ",", "reflected", ",", "transmitted"}], 
     "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"incidentAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"incident", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "incidentAbs"}], "*", "2"}], "-", "1"}], ",", 
         RowBox[{
          RowBox[{"incidentAbs", "*", "2"}], "+", "1"}]}], "}"}]}], ";", " ", 
      
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Since", " ", "we", " ", "take", " ", "extreme", " ", "values", " ", 
         "of", " ", "\[CapitalGamma]"}], ",", " ", 
        RowBox[{
        "we", " ", "need", " ", "some", " ", "extra", " ", "range"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"reflected", "=", 
       RowBox[{"incident", "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Tau]", "=", 
           RowBox[{"1", "+", "\[CapitalGamma]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"transmitted", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"\[CapitalGamma]", "==", 
              RowBox[{"-", "1"}]}], ",", "0", ",", "True", ",", 
             RowBox[{"incident", "/.", 
              RowBox[{"z", "->", 
               RowBox[{
                FractionBox[
                 RowBox[{"1", "-", "\[CapitalGamma]"}], 
                 RowBox[{"1", "+", "\[CapitalGamma]"}]], "z"}]}]}]}], "]"}]}],
           ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "We", " ", "have", " ", "cheated", " ", "a", " ", "little", " ", 
             RowBox[{"bit", ":", " ", 
              RowBox[{
              "the", " ", "k", " ", "is", " ", "a", " ", "scalled", " ", 
               "version"}]}]}], ",", " ", "or", ",", " ", 
            RowBox[{
             FractionBox[
              SubscriptBox["k", "2"], 
              SubscriptBox["k", "1"]], "=", 
             RowBox[{
              FractionBox[
               SqrtBox[
                SubscriptBox["\[Epsilon]", "r2"]], 
               SqrtBox[
                SubscriptBox["\[Epsilon]", "r1"]]], "=", 
              FractionBox[
               RowBox[{"1", "-", "\[CapitalGamma]"}], 
               RowBox[{"1", "+", "\[CapitalGamma]"}]]}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Animate", "[", 
           RowBox[{
            RowBox[{"Legended", "[", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"incident", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"\[CapitalGamma]", "==", 
                    RowBox[{"-", "1"}]}], ",", "NaN", ",", 
                    RowBox[{"\[CapitalGamma]", "==", "1"}], ",", "NaN", ",", 
                    "True", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "*", "transmitted", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}]}], "]"}], ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"incident", "+", 
                    RowBox[{"\[CapitalGamma]", "*", "reflected"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}]}], ",", 
                    RowBox[{"z", "<", "0"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"NaN", ",", 
                    RowBox[{"z", ">", "0"}]}], "}"}]}], "}"}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", "plotRange"}],
                   "}"}]}], ",", 
                RowBox[{"PlotLegends", "->", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Incident\>\"", ",", "\"\<Reflection\>\"", ",", 
                   "\"\<Transmission\>\"", ",", "\"\<Total\>\""}], "}"}]}], 
                ",", 
                RowBox[{"ImageSize", "->", "Large"}]}], " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Orange", ",", "Green"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<\[CapitalGamma]\>\"", ",", "\[CapitalGamma]"}], "}"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Tau]\>\"", ",", "\[Tau]"}], "}"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
            RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
         "\[IndentingNewLine]", ")"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalGamma]", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616273913993*^9, 
   3.8776163257774878`*^9}, {3.8776163677163486`*^9, 3.87761645481579*^9}, {
   3.8776165068125277`*^9, 3.877616525178512*^9}, 3.87761677205938*^9, {
   3.877616806728695*^9, 3.8776168184894238`*^9}, {3.8776168888802958`*^9, 
   3.877616918237582*^9}, {3.877616953204265*^9, 3.8776169730397577`*^9}, {
   3.877617016104241*^9, 3.877617052998719*^9}, {3.877617139911059*^9, 
   3.877617168955608*^9}, {3.877617201979007*^9, 3.877617209756632*^9}, {
   3.877617256084103*^9, 3.8776172612982817`*^9}, {3.877617295798822*^9, 
   3.877617322954529*^9}, {3.8776173563579617`*^9, 3.877617359049479*^9}, {
   3.877617441153017*^9, 3.8776174445763617`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"c58d4336-7f26-404a-acbe-d37b1c9b7e49"],

Cell[BoxData[
 RowBox[{"WaveAlongZWithGamma", "[", 
  RowBox[{"10", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.877616654945856*^9, 3.8776166572460527`*^9}, {
  3.877617264279482*^9, 3.877617265841833*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"0b952724-6854-4596-afa7-11c91917cbb8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{"the", " ", "effect", " ", "of", " ", "k", " ", "change", " ", 
    RowBox[{"weren", "'"}], "t", " ", "being", " ", "considered", " ", "in", 
    " ", "the", " ", "3", "D", " ", "plots"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877617756839117*^9, 
  3.8776177696332293`*^9}},ExpressionUUID->"6e52da4a-fbaa-4fd9-b28e-\
5407618f6bfb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General TEM Wave and the Wavenumber Vector", "Section",
 CellChangeTimes->{{3.877618151212788*^9, 
  3.877618175640875*^9}},ExpressionUUID->"77cd265a-f704-4004-9a4e-\
f140889aadf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldAlongK", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "aX", ",", "aY", ",", "aZ", ",", "xAbs", ",", "yAbs", ",", "zAbs", ",", 
      "xRange", ",", "yRange", ",", "zRange", ",", "points"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aX", ",", "aY", ",", "aZ"}], "}"}], "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "a", " ", "is", " ", "the", " ", "unit", " ", "vector", " ", 
        "pointing", " ", "at", " ", "k", " ", "direction"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", "0"}], ",", 
           RowBox[{"y", "->", "0"}], ",", 
           RowBox[{"z", "->", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", "0"}], ",", 
           RowBox[{"y", "->", "0"}], ",", 
           RowBox[{"z", "->", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"z1", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "->", "0"}], ",", 
           RowBox[{"y", "->", "0"}], ",", 
           RowBox[{"z", "->", "0"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"aX", "+", "10"}]}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "xAbs"}], ",", 
           RowBox[{"aX", "+", "10"}]}], "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{
        "this", " ", "needs", " ", "to", " ", "be", " ", "revised"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"aX", "+", "10"}]}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "yAbs"}], ",", 
           RowBox[{"aY", "+", "10"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"zAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"aX", "+", "10"}]}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "zAbs"}], ",", 
           RowBox[{"aZ", "+", "10"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"points", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"aX", "+", 
            RowBox[{"0.2", "n"}]}], ",", 
           RowBox[{"aY", "+", 
            RowBox[{"0.2", "n"}]}], ",", 
           RowBox[{"aZ", "+", 
            RowBox[{"0.2", "n"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "50"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"xx", ",", "yy", ",", "zz"}], "}"}], ",", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    
                    TemplateBox[<|
                    "color" -> 
                    RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85]|>,
                    "RGBColorSwatchTemplate"], ",", 
                    RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"xx", ",", "yy", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"xx", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"yy", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.3", "\[Pi]"}]}], ",", 
                    RowBox[{"x", "->", "xx"}], ",", 
                    RowBox[{"y", "->", "yy"}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                   "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
             "points"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"AxesLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
            "}"}]}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", "yRange", ",", "zRange"}], "}"}]}], ",", 
          RowBox[{"ViewVertical", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], " ", ",", 
          " ", 
          RowBox[{"ViewPoint", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", " ", "2", ",", " ", "5"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], " ", 
         RowBox[{"(*", " ", 
          RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8776189518054333`*^9, 3.877618955412032*^9}, {
   3.877619267861948*^9, 3.877619293428979*^9}, {3.877619361156878*^9, 
   3.877619377845147*^9}, {3.877619490936674*^9, 3.877619505848724*^9}, {
   3.877619651184045*^9, 3.877619669375412*^9}, {3.8776197368462*^9, 
   3.877619789094572*^9}, {3.877619830128706*^9, 3.877619877641254*^9}, {
   3.877619931902728*^9, 3.877619943836575*^9}, 3.877621137235711*^9, {
   3.877621226615494*^9, 3.8776213316524754`*^9}, {3.877621380294526*^9, 
   3.8776215274991407`*^9}, {3.877621611704527*^9, 3.877621611847371*^9}, {
   3.8776216465213413`*^9, 3.87762165202417*^9}, {3.877621715785109*^9, 
   3.8776217525581617`*^9}, {3.877621874866639*^9, 3.877621897793749*^9}, {
   3.877621938908929*^9, 3.877622015542268*^9}, {3.877622054905053*^9, 
   3.877622091318954*^9}, {3.877622132176065*^9, 3.877622143717904*^9}, {
   3.877623111414068*^9, 3.8776231334221897`*^9}, {3.877702178894665*^9, 
   3.8777021974421387`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0e20dde1-d087-4ef3-ae7c-dfdddf76ad7b"],

Cell[BoxData[
 RowBox[{"FieldAlongK", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryJ]"}], " ", "0.3", "x"}], "-", 
        RowBox[{"\[ImaginaryJ]", " ", "0.3", "y"}], " ", "-", " ", 
        RowBox[{"\[ImaginaryJ]", " ", "0.3", "z"}]}]]}], ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.3", ",", "0.3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877619508212919*^9, 3.8776195259260693`*^9}, {
  3.877619559040719*^9, 3.877619584254219*^9}, {3.877621549890436*^9, 
  3.877621551752488*^9}, {3.877622032564558*^9, 3.877622037591263*^9}, {
  3.8776226349800587`*^9, 3.877622641211548*^9}, {3.8776229808190327`*^9, 
  3.877623029166041*^9}},
 CellLabel->
  "In[1124]:=",ExpressionUUID->"83dcd3e1-7448-401c-a4ef-3db7168fe92a"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], 
          StyleBox["x", "TI"]], "\[LongEqual]", "2"}], TraditionalForm], 
     "errors" -> {}, "input" -> "E_x = 2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88cc743b-d3ae-49f8-90a7-4eb633257247"],
 " is a constant. This is true for uniform plane waves. What if it\
\[CloseCurlyQuote]s a function of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6f2ef68a-9824-4b07-8fd0-3adcda2b743b"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7d51d3f3-8dde-4626-8290-39a91a5397f6"],
 ", or ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8922b7f0-d922-4224-afd8-64ff222e5d1c"],
 "? What if it\[CloseCurlyQuote]s complex?"
}], "CodeText",
 CellChangeTimes->{{3.8776224267033978`*^9, 
  3.877622546772685*^9}},ExpressionUUID->"e93c60c1-6bf7-41ad-8f78-\
fad24f4124ee"],

Cell[TextData[{
 "Yes, the propagation is in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cb88923e-ebad-4281-bf44-3ec7315cce7c"],
 " direction. However, the fields are not contained in the plane transverse \
to the propagation direction. To make the field transverse to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eb12df4b-5572-4547-8442-0c2ab8be81bc"],
 ", the field components have to satisfy some conditions. In other words, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e1044e7f-6e7b-4a7d-a376-c0b8a7ed5264"],
 " dictates the propagation direction. However, the wave vectors can point at \
any direction. The wave components can be constant, or it can be dependent on \
 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "df2fa2a2-caca-4890-90e4-aedb81d3b934"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["y", "TI"], TraditionalForm], "errors" -> {}, "input" -> "y", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8d1be7df-f819-496e-a228-cdc4ddc22488"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfc68b25-2d31-47ea-bb3e-edd441a92f0f"],
 ". In other words, the general form ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["E", "TB"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["x", "TI"], ",", 
             StyleBox["y", "TI"], ",", 
             StyleBox["z", "TI"]}], ")"}], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["E", "TB"], "0"], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["x", "TI"]], 
            StyleBox["x", "TI"], "-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["y", "TI"]], 
            StyleBox["y", "TI"], "-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["z", "TI"]], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\textbf{E}(x, y, z) = \\textbf{E}_0 e^{-j k_x x - j k_y y - j k_z z}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f16241b3-d5b6-4344-90f5-e83c40d6c032"],
 ", the propagation direction is determined by the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", 
          StyleBox["j", "TI"], 
          SubscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["x", "TI"]], 
          StyleBox["x", "TI"], "-", 
          StyleBox["j", "TI"], 
          SubscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["y", "TI"]], 
          StyleBox["y", "TI"], "-", 
          StyleBox["j", "TI"], 
          SubscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["z", "TI"]], 
          StyleBox["z", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-j k_x x - j k_y y - j k_z z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9c30458e-5506-4a3e-b29b-4d16e7d937f9"],
 " term. The direction and magnitude of the field is determined by the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["E", "TB"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "89f31008-6ca9-499c-93ff-33e4ee8fafe6"],
 " term. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["E", "TB"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cbaf76c8-ed2d-4467-a86b-d9982024a34e"],
 " is a constant vector and lies in the plane perpendicular to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{k}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f7d8e32f-017a-49e4-b54a-0e7890f862ea"],
 ", then it\[CloseCurlyQuote]s a uniform plane wave."
}], "CodeText",
 CellChangeTimes->{{3.877622696529723*^9, 3.8776227311593733`*^9}, {
  3.877622770540269*^9, 3.877622825758333*^9}, {3.877622909299159*^9, 
  3.877622938577858*^9}, {3.877623215462772*^9, 3.877623362286783*^9}, {
  3.877623422390164*^9, 
  3.877623596837346*^9}},ExpressionUUID->"1d17c4a0-545b-4bdd-bfbd-\
0dd0877b3cf2"],

Cell["TODO: make it a plane wave", "CodeText",
 CellChangeTimes->{{3.877702379923476*^9, 
  3.877702395992787*^9}},ExpressionUUID->"d44c187f-03d7-4c1a-9e7d-\
5e205610f136"],

Cell[BoxData[
 RowBox[{"ColorData", "[", 
  RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.87761972827631*^9, 3.8776197282963448`*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"bbbbe71b-1683-4531-84d9-5ac548cb3c9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plane Waves in Lossy Media", "Section",
 CellChangeTimes->{{3.877623642758855*^9, 
  3.877623648500125*^9}},ExpressionUUID->"27b39845-ce47-4242-b611-\
780ac4cc13a3"],

Cell[TextData[{
 "We\[CloseCurlyQuote]ve already seen that the wavenumber ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2f0561f9-f338-4b3e-9bd8-433bda3058c5"],
 " can be complex, i.e. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["c", "TI"]], "\[LongEqual]", "\[Omega]", 
         SqrtBox[
          SubscriptBox["\[Mu]\[Epsilon]", 
           StyleBox["c", "TI"]]], "\[LongEqual]", "\[Omega]", 
         SqrtBox[
          RowBox[{"\[Mu]", "(", 
            RowBox[{
              SuperscriptBox["\[Epsilon]", "\[Prime]"], "-", 
              StyleBox["j", "TI"], 
              SuperscriptBox["\[Epsilon]", "\[Prime]\[Prime]"]}], ")"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "k_c = \\omega \\sqrt{\\mu \\epsilon_c} = \\omega \\sqrt{\\mu \
(\\epsilon^{\\prime} - j \\epsilon^{\\prime\\prime})}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "92b4d93b-edf7-4bce-847f-6f485a362fab"],
 " where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Epsilon]", "\[Prime]"], "\[LongEqual]", 
         "\[Epsilon]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\epsilon^{\\prime} = \\epsilon", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1b298151-ef0e-400b-beaa-7000a4615b49"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox["\[Epsilon]", "\[Prime]\[Prime]"], "\[LongEqual]", 
         FractionBox["\[Sigma]", "\[Omega]"]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\epsilon^{\\prime\\prime} = \\frac{\\sigma}{\\omega}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f519050d-b7eb-4963-a52b-bcfc3069ddb8"],
 ", and a complex wavenumber signifies loss or attenuation."
}], "Text",
 CellChangeTimes->{{3.877623731182233*^9, 3.877623766226345*^9}, {
  3.877623927513823*^9, 3.877623932661243*^9}, {3.8776240772789593`*^9, 
  3.877624109345437*^9}, {3.877624389278366*^9, 3.877624409721121*^9}, {
  3.877702449851604*^9, 3.877702453609887*^9}, {3.8777038594394503`*^9, 
  3.877703907067802*^9}, {3.877703959071663*^9, 
  3.877703960332213*^9}},ExpressionUUID->"21197ed5-05cd-43fd-9e77-\
197c4f841fde"],

Cell[BoxData[
 RowBox[{"WaveAlongZ", "[", 
  RowBox[{"10", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryJ]"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"0.1", "\[ImaginaryJ]"}]}], ")"}], "z"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.877620146834573*^9, 3.8776201780613937`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"017b528f-c9c8-46ff-a493-ede274ea75ee"],

Cell[TextData[{
 "It seems pretty realistic to have ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], "\[LongEqual]", "2"}], TraditionalForm], 
     "errors" -> {}, "input" -> "k = 2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3911a966-45ae-4d04-9f25-589ccf6031c5"],
 ":"
}], "Text",
 CellChangeTimes->{{3.877624581656827*^9, 
  3.8776245928033667`*^9}},ExpressionUUID->"96483756-ebf5-4620-8016-\
968606a3ef52"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"2", "\[Pi]", " ", 
   SuperscriptBox["10", "8"], 
   SqrtBox[
    RowBox[{
     SubscriptBox["\[Mu]", "0"], 
     SubscriptBox["\[Epsilon]", "0"]}]]}]}]], "Input",
 CellChangeTimes->{{3.877624432426752*^9, 3.877624455130248*^9}, {
  3.877624485139084*^9, 3.877624554376359*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"b23e12ed-27ca-48bc-9045-3236b132208b"],

Cell[BoxData[
 RowBox[{"2", "\[Pi]", " ", 
  SuperscriptBox["10", "8"], 
  SqrtBox[
   RowBox[{
    SubscriptBox["\[Mu]", "0"], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "0"], "-", 
      RowBox[{"\[ImaginaryJ]", " ", "0.1", 
       SubscriptBox["\[Epsilon]", "0"]}]}], ")"}]}]]}]], "Input",
 CellChangeTimes->{{3.877624724177875*^9, 3.877624785611775*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"74ed32e4-0120-4f3f-a55b-335f989c1041"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"This", " ", 
   RowBox[{"doesn", "'"}], "t", " ", "work"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877653742864468*^9, 
  3.8776537459093246`*^9}},ExpressionUUID->"d2082663-3545-4e0a-bc92-\
97bc87fc9363"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexListPlot", "[", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "0"], "-", 
      RowBox[{"\[ImaginaryJ]", " ", 
       FractionBox["\[Sigma]", "\[Omega]"]}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]", ",", "0", ",", 
     RowBox[{"6.30", " ", 
      SuperscriptBox["10", "7"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Omega]", ",", 
     SuperscriptBox["10", "3"], ",", 
     SuperscriptBox["10", "12"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877653378866253*^9, 3.877653422565593*^9}, {
  3.877653471301723*^9, 3.877653537716423*^9}, {3.877653606039691*^9, 
  3.877653687981954*^9}, {3.8776537538484077`*^9, 3.877653764003805*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"fccfbbe9-84b8-4ceb-ac4c-7345ad5097cc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"QUESTION", ":", " ", 
    RowBox[{"is", " ", "this", " ", 
     RowBox[{"correct", "?", " ", "I"}], " ", "mean"}]}], ",", " ", 
   RowBox[{
   "the", " ", "complex", " ", "\[Epsilon]", " ", "is", " ", "applied", " ", 
    "to", " ", "the", " ", "left", " ", "or", " ", "the", " ", "right", " ", 
    RowBox[{"medium", "?", " ", "How"}], " ", "does", " ", "it", " ", 
    "affect", " ", "our", " ", "calculation", " ", "of", " ", "k", " ", "in", 
    " ", "the", " ", "plotting", " ", 
    RowBox[{"function", "?"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877624982497179*^9, 
  3.877625029872785*^9}},ExpressionUUID->"5f997041-e5d2-4b9a-9dff-\
de39d6b9ec5b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k", "=", 
     RowBox[{"2", "\[Pi]", " ", 
      SuperscriptBox["10", "8"], 
      SqrtBox[
       RowBox[{
        SubscriptBox["\[Mu]", "0"], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Epsilon]", "0"], "-", 
          RowBox[{"\[ImaginaryJ]", " ", "0.1", 
           SubscriptBox["\[Epsilon]", "0"]}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"WaveAlongZ", "[", 
    RowBox[{"10", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "z"}]]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8776249255731783`*^9, 3.877624956683178*^9}, {
  3.877625347741025*^9, 3.8776253933207073`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"bcabd281-95e8-4029-90a3-75b4e06e908e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{
    "plot", " ", "a", " ", "Manipulate", " ", "with", " ", "the", " ", "loss",
      " ", "tangent", " ", "in", " ", "page", " ", "342"}]}], ",", " ", 
   RowBox[{"note", " ", "that", " ", 
    RowBox[{"it", "'"}], "s", " ", "frequency", " ", "dependent"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.877625062367928*^9, 3.877625082640284*^9}, {
  3.877625137821704*^9, 
  3.877625143015007*^9}},ExpressionUUID->"396bfa97-b015-4e70-9fb3-\
5e7c62e44bb3"],

Cell[TextData[{
 "Now, it\[CloseCurlyQuote]s customary to define ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[LongEqual]", 
         StyleBox["j", "TI"], 
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["c", "TI"]], "\[LongEqual]", "\[Alpha]", "+", 
         StyleBox["j", "TI"], "\[Beta]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\gamma = j k_c = \\alpha + j \\beta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "374697ad-2fc4-45f7-9078-0d4eb690fad6"],
 " as the propagation constant. For example, with phasor ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], 
            RowBox[{"(", 
              RowBox[{"2", "-", "0.1", 
                StyleBox["j", "TI"]}], ")"}], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "10 e^{-j (2-0.1j) z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "06b5570b-da66-43a2-91ff-6c83f93d286c"],
 ", the propagation constant ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Gamma]", "\[LongEqual]", 
         StyleBox["j", "TI"], 
         RowBox[{"(", 
           RowBox[{"2", "-", "0.1", 
             StyleBox["j", "TI"]}], ")"}], "\[LongEqual]", "0.1", "+", "2", 
         StyleBox["j", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma = j(2-0.1j) = 0.1+2j", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e3af532e-681d-4f02-9928-c052a500f092"],
 ". Thus ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Alpha]", "\[LongEqual]", "0.1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\alpha = 0.1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "072b58f0-0d6b-49bf-bbf2-e59845026fa7"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Beta]", "\[LongEqual]", "2", "\[LongEqual]", 
         StyleBox["k", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta = 2 = k", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a0a9b8e6-6899-4ed5-bec6-5bcfd9857302"],
 ". Therefore, the same phasor can be represented as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", "\[Gamma]", 
            StyleBox["z", "TI"]}]], "\[LongEqual]", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            RowBox[{"(", 
              RowBox[{"0.1", "+", "2", 
                StyleBox["j", "TI"]}], ")"}], 
            StyleBox["z", "TI"]}]], "\[LongEqual]", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-0.1", 
            StyleBox["z", "TI"]}]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], "2", 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "10 e^{-\\gamma z} = 10 e^{-(0.1 + 2j) z} = 10 e^{-0.1 z} e^{-j 2 z}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1b40a175-bc6c-41ad-b4f7-4ad10624e9a2"],
 ". It is obvious that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-0.1", 
          StyleBox["z", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-0.1z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1eceaf6a-1cc4-4731-bd36-4d9570f9b3e7"],
 " represents attenuation and therefore ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8149afd0-3119-42d2-b9f7-b5c4fd406b38"],
 " is called the attenuation constant."
}], "Text",
 CellChangeTimes->{{3.8777075953252373`*^9, 3.8777076214427433`*^9}, {
  3.87770790803034*^9, 3.877708004981884*^9}, {3.877708090460034*^9, 
  3.877708109066345*^9}, {3.877708143978943*^9, 3.877708168113941*^9}, {
  3.877708237062357*^9, 3.8777082373046227`*^9}, {3.877708308854144*^9, 
  3.8777083689762573`*^9}},ExpressionUUID->"21982b26-3d5f-4323-903a-\
684e72affeac"],

Cell[BoxData[
 RowBox[{"WavesAlongZNoBoundary", "[", 
  RowBox[{
   RowBox[{"10", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryJ]"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"0.1", "\[ImaginaryJ]"}]}], ")"}], "z"}]]}], ",", "0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877707398535095*^9, 3.877707419392786*^9}, {
  3.877707462139852*^9, 3.877707525923271*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"4df8a99b-78c6-45ca-b8dc-28182d74309f"],

Cell[CellGroupData[{

Cell["Good Conductors", "Subsection",
 CellChangeTimes->{{3.877708909928296*^9, 
  3.8777089144084263`*^9}},ExpressionUUID->"96989b5e-eec7-499b-8bdf-\
2b4ed373e627"],

Cell[BoxData[
 SqrtBox[
  RowBox[{"\[Pi]", " ", 
   SuperscriptBox["10", "3"], " ", 
   SubscriptBox["\[Mu]", "0"], "5.96", " ", 
   SuperscriptBox["10", "7"]}]]], "Input",
 CellChangeTimes->{{3.8777089180469112`*^9, 3.877708926958177*^9}, {
  3.877708971287819*^9, 3.877709003150818*^9}, {3.8777090522104*^9, 
  3.877709057680908*^9}},
 CellLabel->
  "In[500]:=",ExpressionUUID->"fa3284e6-ef7d-4488-b498-0e864879bf42"],

Cell["Plot 45 degree phase different between H and E", "Text",
 CellChangeTimes->{{3.877709070568467*^9, 
  3.877709087727304*^9}},ExpressionUUID->"c1dbfb87-86bc-4d0a-8197-\
0c2335f64ec9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Group Velocity", "Section",
 CellChangeTimes->{{3.8777092402675753`*^9, 
  3.877709243611886*^9}},ExpressionUUID->"a59aef5b-81dd-452c-9704-\
590ec8788f64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WavesAlongZNoBoundaryWithOmega", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wave1_", ",", "\[Omega]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"wave2_", ",", "\[Omega]2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wave1Abs", ",", "wave2Abs", ",", "plotRange"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wave1Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wave2Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave2", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "wave1Abs"}], "-", "wave2Abs", "-", "1"}], ",", 
         RowBox[{"wave1Abs", "+", "wave2Abs", "+", "1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"wave1", "*", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                "]"}], "/.", "\[Omega]1"}], ",", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"wave2", "*", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                "]"}], "/.", "\[Omega]2"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"wave1", "*", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", "\[Omega]1"}], ")"}], "+", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", 
                  RowBox[{"wave2", "*", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                  "]"}], "/.", "\[Omega]2"}], ")"}]}]}], " ", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
            RowBox[{"PlotRange", "->", "plotRange"}], ",", 
            RowBox[{"PlotLegends", "->", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Wave1\>\"", ",", "\"\<Wave2\>\"", ",", "\"\<Total\>\""}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "->", "Large"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"PointLegend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> GrayLevel[0]|>,
               "GrayLevelColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
               "RGBColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
               "RGBColorSwatchTemplate"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<\[Omega]\>\"", ",", "\[Omega]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave1\>\"", ",", "wave1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave2\>\"", ",", "wave2"}], "}"}]}], "}"}]}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616262869247*^9, 
   3.877616264429681*^9}, {3.8776165454140453`*^9, 3.877616546072646*^9}, {
   3.8776166188147717`*^9, 3.877616619371581*^9}, {3.877703992569488*^9, 
   3.8777040684667797`*^9}, {3.8777042714386787`*^9, 3.877704323682255*^9}, {
   3.877704466358306*^9, 3.877704617825367*^9}, {3.877704677046824*^9, 
   3.87770470710962*^9}, {3.877704773815371*^9, 3.877704791971489*^9}, {
   3.877704868525515*^9, 3.877704877212737*^9}, {3.8777049160227947`*^9, 
   3.877704958245488*^9}, {3.8777049897992163`*^9, 3.8777050089689503`*^9}, 
   3.8777051116733627`*^9, {3.8777093529762163`*^9, 3.8777093935384817`*^9}, {
   3.877709480128757*^9, 3.877709498146544*^9}, {3.877709559084025*^9, 
   3.877709620293981*^9}, {3.8777097872597303`*^9, 3.877709787462267*^9}, {
   3.877709834100718*^9, 3.8777098392790127`*^9}, {3.877711521358615*^9, 
   3.8777115215084677`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"6f1fe269-f564-4178-abf9-62728dfc8e08"],

Cell[BoxData[
 RowBox[{"WavesAlongZNoBoundaryWithOmega", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"10", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"0.29", "\[Pi]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"10", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "10", "z"}]]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"0.31", "\[Pi]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877709294858914*^9, 3.87770930530122*^9}, {
  3.877709454028269*^9, 3.8777094569672213`*^9}, {3.8777095056801777`*^9, 
  3.8777095367159977`*^9}, {3.877709859410303*^9, 3.8777098772397013`*^9}, {
  3.8777101321767483`*^9, 3.877710133404093*^9}, {3.8777101934072723`*^9, 
  3.877710260696607*^9}, {3.877710618171001*^9, 3.877710631355459*^9}, {
  3.8777107114125443`*^9, 3.877710739217741*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"f08e21c3-1fee-40e6-b378-46204396c0c9"],

Cell["\<\
TODO: Why the wave packet looks different from p.376? What are the effects of \
\[Omega]?\
\>", "Text",
 CellChangeTimes->{{3.877710804256474*^9, 
  3.8777108583696623`*^9}},ExpressionUUID->"bda7bb10-a771-4cab-acd3-\
e8856cf04409"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"choices", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "->", 
          RowBox[{"Sin", "[", "x", "]"}]}], ",", 
         RowBox[{"2", "->", 
          RowBox[{"Cos", "[", "x", "]"}]}], ",", 
         RowBox[{"3", "->", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"3", ",", "x"}], "]"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choices", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "CheckboxBar"}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.877710429117535*^9, 3.8777104291280203`*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"1f17965b-99d0-42ad-9a19-b2cb38a0d00f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WavePacketAlongZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wave1_", ",", "\[Omega]1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"wave2_", ",", "\[Omega]2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wave1Abs", ",", "wave2Abs", ",", "plotRange"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"wave1Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"wave2Abs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"wave2", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRange", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "wave1Abs"}], "-", "wave2Abs", "-", "1"}], ",", 
         RowBox[{"wave1Abs", "+", "wave2Abs", "+", "1"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"Legended", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"wave1", "*", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                "]"}], "/.", "\[Omega]1"}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"wave2", "*", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                "]"}], "/.", "\[Omega]2"}], ")"}]}], " ", ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
            RowBox[{"PlotRange", "->", "plotRange"}], ",", 
            RowBox[{"PlotLegends", "->", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Wave1\>\"", ",", "\"\<Wave2\>\"", ",", "\"\<Total\>\""}], 
              "}"}]}], ",", 
            RowBox[{"ImageSize", "->", "Large"}]}], " ", 
           RowBox[{"(*", " ", 
            RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"PointLegend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              TemplateBox[<|"color" -> GrayLevel[0]|>,
               "GrayLevelColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
               "RGBColorSwatchTemplate"], ",", 
              TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
               "RGBColorSwatchTemplate"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<\[Omega]\>\"", ",", "\[Omega]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave1\>\"", ",", "wave1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Wave2\>\"", ",", "wave2"}], "}"}]}], "}"}]}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877595183400758*^9, 3.877595210288351*^9}, 
   3.877595282140667*^9, {3.877595336126483*^9, 3.8775953375176563`*^9}, {
   3.877595400876133*^9, 3.877595413598068*^9}, 3.877595467898389*^9, {
   3.877595573431662*^9, 3.877595634906394*^9}, {3.877595665026803*^9, 
   3.877595759302931*^9}, {3.877595833082527*^9, 3.8775958985853567`*^9}, {
   3.87759593315653*^9, 3.877596072654215*^9}, {3.8775964906327047`*^9, 
   3.877596516334076*^9}, {3.877596554373033*^9, 3.877596568521406*^9}, {
   3.877597363711946*^9, 3.877597468071089*^9}, {3.877597517174087*^9, 
   3.877597547564885*^9}, {3.877597654385515*^9, 3.877597693070363*^9}, {
   3.877597751316998*^9, 3.877597763111189*^9}, {3.877597810755471*^9, 
   3.877597810991117*^9}, {3.877598041686117*^9, 3.877598096456271*^9}, {
   3.877598168724595*^9, 3.877598178794155*^9}, {3.877598468141927*^9, 
   3.877598556855116*^9}, {3.87759863273337*^9, 3.877598676052434*^9}, {
   3.8775987265415573`*^9, 3.8775988239459057`*^9}, {3.877598901449408*^9, 
   3.877598961593191*^9}, {3.877599098174027*^9, 3.877599104580352*^9}, {
   3.87759916430518*^9, 3.877599219412068*^9}, {3.877599259524197*^9, 
   3.8775992807758713`*^9}, {3.877599344945633*^9, 3.877599354637073*^9}, {
   3.877599436266364*^9, 3.8775994692789516`*^9}, {3.877599506161059*^9, 
   3.877599610961244*^9}, {3.877599784100272*^9, 3.87759982837624*^9}, {
   3.877601454757704*^9, 3.877601749054695*^9}, {3.877616262869247*^9, 
   3.877616264429681*^9}, {3.8776165454140453`*^9, 3.877616546072646*^9}, {
   3.8776166188147717`*^9, 3.877616619371581*^9}, {3.877703992569488*^9, 
   3.8777040684667797`*^9}, {3.8777042714386787`*^9, 3.877704323682255*^9}, {
   3.877704466358306*^9, 3.877704617825367*^9}, {3.877704677046824*^9, 
   3.87770470710962*^9}, {3.877704773815371*^9, 3.877704791971489*^9}, {
   3.877704868525515*^9, 3.877704877212737*^9}, {3.8777049160227947`*^9, 
   3.877704958245488*^9}, {3.8777049897992163`*^9, 3.8777050089689503`*^9}, 
   3.8777051116733627`*^9, {3.8777093529762163`*^9, 3.8777093935384817`*^9}, {
   3.877709480128757*^9, 3.877709498146544*^9}, {3.877709559084025*^9, 
   3.877709620293981*^9}, {3.8777097872597303`*^9, 3.877709787462267*^9}, {
   3.877709834100718*^9, 3.8777098392790127`*^9}, {3.877711468562415*^9, 
   3.877711517571929*^9}, {3.877711549280891*^9, 3.8777115583665123`*^9}, {
   3.877711804990074*^9, 3.877711848162163*^9}, {3.877711888855551*^9, 
   3.877711890157275*^9}, 3.877711927843178*^9, {3.8777120213767023`*^9, 
   3.8777120330195303`*^9}, {3.877712086687717*^9, 3.877712105688781*^9}, {
   3.87771218062884*^9, 3.877712219184762*^9}, {3.877712269130946*^9, 
   3.8777122799309597`*^9}, {3.8777465249080048`*^9, 3.877746549221187*^9}, 
   3.877746644595352*^9, {3.877746682312394*^9, 3.877746712917635*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"3c70b93c-41bd-47e0-a25d-9b7141c376d0"],

Cell[BoxData[
 RowBox[{"WavePacketAlongZ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"10", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"0.29", "\[Pi]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"10", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "10", "z"}]]}], ",", 
     RowBox[{"\[Omega]", "->", 
      RowBox[{"0.31", "\[Pi]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.87771151101245*^9, 3.8777115433829527`*^9}, {
  3.877711684070485*^9, 3.877711697677103*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"d0633dd2-6d61-4c89-bc87-d98ae09893a4"],

Cell["\<\
Can two dielectrics with different permittivity values and conductivity \
values form a reflection coefficient that is not complex?\
\>", "Text",
 CellChangeTimes->{{3.877746731549293*^9, 
  3.8777468034948263`*^9}},ExpressionUUID->"aa511293-cdd4-42df-a180-\
bf2cf7339099"],

Cell["TODO: plot complex reflection coefficients", "Text",
 CellChangeTimes->{{3.8777468689259453`*^9, 
  3.877746883958069*^9}},ExpressionUUID->"524e4f9c-5bf9-4c41-99fd-\
9f1e539d76e2"]
}, Open  ]],

Cell["Flow of Electromagnetic Power", "Section",
 CellChangeTimes->{{3.877712340076502*^9, 
  3.87771235265926*^9}},ExpressionUUID->"ed598491-5879-4b9a-be20-\
64226307aed7"],

Cell[CellGroupData[{

Cell["Normal Incidence", "Section",
 CellChangeTimes->{{3.876319722066144*^9, 
  3.876319730456017*^9}},ExpressionUUID->"faabe718-695e-4995-9967-\
d4826da2df90"],

Cell[TextData[{
 "Assume the incident wave travels along the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+z", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5dcc2895-c973-404b-a9e3-2c79cf92c649"],
 " direction and has electric field along the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["x", "TI"], TraditionalForm], "errors" -> {}, "input" -> "x", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f4c088bf-add8-4224-9903-ecc8db936902"],
 " direction:  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         SubsuperscriptBox[
          StyleBox["E", "TI"], "0", 
          StyleBox["i", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], "1"], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\hat{\\textbf{x}} E_0^i e^{-j k_1 z}", "state" -> "Boxes"|>,
    
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d52669f8-0b34-425f-8fb6-458e58d15839"],
 ", the reflected wave is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         SubsuperscriptBox[
          StyleBox["E", "TI"], "0", 
          StyleBox["r", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], "1"], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\hat{\\textbf{x}} E_ 0^r e^{j k_ 1 z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bdf32bc-8e8f-439c-b0d7-3e46ff28ddbc"],
 ", and the transmitted wave is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         OverscriptBox[
          StyleBox["x", "TB"], "^"], 
         SubsuperscriptBox[
          StyleBox["E", "TI"], "0", 
          StyleBox["t", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], 
            SubscriptBox[
             StyleBox["k", "TI"], "2"], 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\hat{\\textbf{x}} E_ 0^t e^{-j k_ 2 z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f4e109dd-97f2-4640-b378-eec4d8e22c01"],
 ". Can you plot one example when the wave hits an interface at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "05c24177-9202-4bd2-a473-76f6c2dc0c9d"],
 " with normal incidence?"
}], "Text",
 CellChangeTimes->{{3.8763213442291393`*^9, 3.8763213580173473`*^9}, {
  3.876321442559813*^9, 3.876321581557807*^9}, {3.876321843754116*^9, 
  3.87632192768044*^9}, {3.876321959322095*^9, 
  3.8763220366164217`*^9}},ExpressionUUID->"9c4e8bd7-fd97-416d-9a30-\
ad7354161c13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zPoints", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "10"}], ",", "0", ",", "0.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "           ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{"1.5", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", "           ", 
          RowBox[{"{", 
           RowBox[{"Green", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "           ", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{"-", "1.5"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                   "]"}], " ", "/.", 
                  RowBox[{"\[Omega]", "->", 
                   RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
             "]"}]}], "}"}]}], "}"}], "&"}], "/@", "zPoints"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"ViewVertical", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], " ", ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"plotting", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyTlIggEAxfEvg1rKoBAKHLKg1MCowQ4huhwitUMHAzs0dVGwzDwqjLYu
BxsKjZaQIijsoKIoOqCwNJAwa4gkoWOQkCQDheh73/D48fizVIZuDY0gCCY5
SGv1O82vsab3PP4C9Ax2haDiyRaF7L1gDK7w3GnIW1cSFtKDvxBlVJtFhzWF
9/nU/85xjZNmiBVe2KjIvoDPn6lrqD9bC0CJ7CYMeb7ROIz/MBJQHTD8QmbL
bAqa0gWFE6Scu03KS1clB+4E/ZScDlM1/FsrF0C9u0gMX94Ou2AtN9ELVWOn
atgXLjFALstihD39fCs8qRdTelx0J/zaqliEneztIziUlJzC6VxRs53U9uET
wvPMuXYov4pQSleLZbDtkS+Hjgh3AO56HzRQRSzr4JLRqocmRukIFCmPzbBO
mrTD0MbwFJQIGuZh2a3QAatmItpJ9H2ZDv4DV5T88w==
  "],
 CellLabel->"In[94]:=",ExpressionUUID->"0344d950-c4f3-4f0f-a43f-5a0a93b50faf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zPoints1", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zPoints2", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "5", ",", "0.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            "           ", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"1.5", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
               "]"}]}], "}"}], ",", "\[IndentingNewLine]", "           ", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            "           ", 
            RowBox[{"{", 
             RowBox[{"Black", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", "1.5"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
               "]"}]}], "}"}]}], "}"}], "&"}], "/@", "zPoints1"}], ",", 
        "\[IndentingNewLine]", "                ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"1", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "0", ",", "#"}], 
                  "}"}]}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            "           ", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
              RowBox[{"Arrow", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "#"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"0.75", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "#"}], "+", 
                    FractionBox["\[Pi]", "4"]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "#"}], "}"}]}], "}"}], 
               "]"}]}], "}"}]}], "}"}], "&"}], "/@", "zPoints2"}], ",", 
        "\[IndentingNewLine]", "                ", 
        RowBox[{"{", 
         RowBox[{"LightPink", ",", " ", 
          RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
          RowBox[{"InfinitePlane", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
           "]"}]}], "}"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
     ",", " ", 
     RowBox[{"ViewVertical", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"1.3", ",", " ", "2.4", ",", " ", "2."}], "}"}]}], " ", ",", 
     RowBox[{"ImageSize", "->", "Large"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"plotting", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]",
     "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdx0sowwEAx/G/Ka+YotWUw1BsUxOHeZW8dpBtjB2m5rHZXKzGjBkiJ+8D
iTZxYJFM8yiyaCgMfyXN4yDLijmMRKgp+f/+h2+fvklqfZWWQRAEhwoySs/H
Ox4DRc+xwgloa5R5oPLO7IPczcsAnBVYf6FgSUWYKLf+PLS+pjAmzGZfxdH/
EW3ppgyRKB2wUBl+AO9fgsdQ51okoVR+egMF7vZ3+P7F+oQaUv8DE0uGg9D4
G8/uoeRd2GkPLRk8uH55TsurMGbBv8W0fKizJkjgw9O2DObwP2uhumtPA+tu
kvWQn2QywJp6YSfczZPQ2izMcfi2mj4FK7lrO7DlW7oHB2PExb2UZr9bBPdD
R8qh4shLWz3PkcOyW6ECjnn5DXDDca2FamKmGU4bOnXQyEppg2KVswPmVn/3
Qs9yaz+U5heMwtQz0RjMHPI29VFOBrgGGOFc7oZ+/soALI5yWiEZ6aINvpJz
8EQrWoAcTYkdrgd9G/AfUwAjTg==
  "],
 CellLabel->"In[96]:=",ExpressionUUID->"aef9077d-4bd5-4538-b93f-255b211431d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZWithBoundary", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xAbs", ",", "yAbs", ",", "xRange", ",", "yRange", ",", "x2", ",", "y2", 
      ",", "z2"}], "}"}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs"}], "*", "2"}], ",", 
           RowBox[{"xAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs"}], "*", "2"}], ",", 
           RowBox[{"yAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"xRange", ",", "yRange", ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "x2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], " ", "x1", 
                    "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "5", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{"xRange", ",", "yRange", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5"}], ",", "2", ",", " ", "5"}], "}"}]}], " ", 
             ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", 
           RowBox[{"AnimationRate", "->", "0.5"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalGamma]", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfW3W5ySHx28cnzxWKwDRKvF1JSA6yzG8DETXBTA0
g+gyjettIHrLJtezIPran9jzYHUt6c9BdOKMvS9A9CVTZ2VHIH0gV0kHRHut
6nEC0T0hx11A9KLcXh8QXRs9HUxbzZ9RCKJL9YOKQbRHxr46EG2xQKYJRF/z
kvwFotXtJRidgHRQnjsHiO64VQymrS246kH0hhQ+MO2xUKEVROf9yugA0S5T
VIzcgbSZF7MFiJawqbID0Vu8tF1A9Avrm/2eIHcwq08A0WdmaswF0Ts2OoLp
/Q2rpP2AtNphJRkQ/UJvrzqIznNi0QDRn+IKTEF0YNZ/FxC9JndTEYg+Upnf
AqIB/cC1sQ==
  "],
 CellLabel->"In[99]:=",ExpressionUUID->"eb7a2874-fee2-44a6-ac78-a9fb33f14143"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithBoundary", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877269862957178*^9, 3.8772698774889174`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"3a846940-33e3-492a-b425-961f3c29e82d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZWithBoundary2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xAbs1", ",", "yAbs1", ",", "xAbs2", ",", "yAbs2", ",", "xRange", ",", 
      "yRange", ",", "xr1", ",", "yr1", ",", "zr1", ",", "xr2", ",", "yr2", 
      ",", "zr2"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xAbs1", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs1", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xAbs2", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x2", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs2", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y2", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xAbs1", "==", "0"}], "&&", 
          RowBox[{"xAbs2", "==", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"xAbs1", ">=", "xAbs2"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs1"}], "*", "2"}], ",", 
           RowBox[{"xAbs1", "*", "2"}]}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs2"}], "*", "2"}], ",", 
           RowBox[{"xAbs2", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"yAbs1", "==", "0"}], "&&", 
          RowBox[{"yAbs2", "==", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"yAbs1", ">=", "yAbs2"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs1"}], "*", "2"}], ",", 
           RowBox[{"yAbs1", "*", "2"}]}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs2"}], "*", "2"}], ",", 
           RowBox[{"yAbs2", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xr1", ",", "yr1", ",", "zr1"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xr2", ",", "yr2", ",", "zr2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], "/.", 
        RowBox[{"z", "->", 
         RowBox[{"-", "z"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "xAbs1", ",", "xAbs2", ",", "yAbs1", ",", "yAbs2", ",", "xRange", ",", 
        "yRange"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "xr1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "yr1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "zr1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Black", ",", 
                    RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "xr2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "yr2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "zr2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "5"}], ",", "0", ",", "0.3"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], " ", "x1", 
                    "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "y1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "z1", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], " ", "x2", 
                    "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "y2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "z2", "*", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "5", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{"xRange", ",", "yRange", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5"}], ",", "2", ",", " ", "5"}], "}"}]}], " ", 
             ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", 
           RowBox[{"AnimationRate", "->", "0.5"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalGamma]", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzlsogwEABeAxD6JIlBnJZbaVoZT1u4TN77aErZUHuS1iajeXacomtySa
JGbIJSnjAa3wMBSi3MrDRHmxleVSRlJL+M//cPpezqkTr9DImvwZDEY8Fei0
firyXa8it4urhZw6YwdsFVXpobGS0Q/1/NshaN8uvITOn5prujfQ/AQbLA4P
vMkoSBRRHqoSBFBiGxXDUfkpCZdVY2Wwp3qaNmvBooOdabJ2WNKyb4TEYkwf
dEqifJCXx/ITU8rUxYFw+L6dNpsIMsHNxhDakqW4Qaj2tQxDcpKTXkwplDAJ
yMrpzoV2STIJPdl35lL8YPLG4cUMfx7uboloD3pt0eWU3KOEGOhJdfCgWhzA
hx+12gwobf0j4YZquw0eGzQDUM/KtMIyr2EeGmeFK3BOOWGHF6TpHOaMSB/o
fdSbG06Fv7/AtbQjLwy1mT9gURfLB/+UxC+M060yKyib2e5gWH8VGQblezra
gJ1nNjw7mY6Gj1/ridATK0+C7tBvAdRGECnwH6LIFSY=
  "],
 CellLabel->
  "In[2062]:=",ExpressionUUID->"e22d4c78-8143-4747-8178-3973a101b647"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithBoundary2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"2", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]]}], ",", "0", ",", "0"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8772710220468493`*^9, 3.8772710450824337`*^9}, {
  3.877271486594529*^9, 3.877271491391678*^9}},
 CellLabel->
  "In[2064]:=",ExpressionUUID->"7cb2b3a0-4aee-4672-9d83-918fe4c95fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZWithBoundaryShowTotal", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xAbs", ",", "yAbs", ",", "xRange", ",", "yRange"}], "}"}], ",", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs"}], "*", "2"}], ",", 
           RowBox[{"xAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs"}], "*", "2"}], ",", 
           RowBox[{"yAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"xRange", ",", "yRange", ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "x1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "x1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "y1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "z1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], " ", "x1", 
                    " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "5", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{"xRange", ",", "yRange", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5"}], ",", "2", ",", " ", "5"}], "}"}]}], " ", 
             ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", 
           RowBox[{"AnimationRate", "->", "0.5"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalGamma]", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQfW3W5ySHx28cnzxWKwDRKvF1JSA6yzG8DETXBTA0
g+gyjettIHrLJtezIPran9jzYHUt6c9BdOKMvS9A9CVTZ2VHIH0gV0kHRHut
6nEC0T0hx11A9KLcXh8QXRs9HUxbzZ9RCKJL9YOKQbRHxr46EG2xQKYJRF/z
kvwFotXtJRidgHRQnjsHiO64VQymrS246kH0hhQ+MO2xUKEVROf9yugA0S5T
VIzcgbSZF7MFiJawqbID0Vu8tF1A9Avrm/2eIHcwq08A0WdmaswF0Ts2OoLp
/Q2rpP2AtNphJRkQ/UJvrzqIznNi0QDRn+IKTEF0YNZ/FxC9JndTEYg+Upnf
AqIbri53CwD5e9mDEBAdP5MtGkQnKQuD6VyZwngQ/eqsQzKIfhbO3weir/0+
MBtEP7n5fz6I1vE4tBBEAwClJuJr
  "],
 CellLabel->
  "In[102]:=",ExpressionUUID->"c8e0f0bb-7b4a-4036-b015-c745cb9d2bf5"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithBoundaryShowTotal", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877274411973771*^9, 3.8772744160238028`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"6aa5914b-5e19-4f44-8179-4159e283082f"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWithBoundaryShowTotal", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "z"}]]}], ",", "0"}], "}"}], "]"}]
  ], "Input",
 CellChangeTimes->{3.8843375260373507`*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"64a9ce1f-d6de-4793-9236-0fed248c2f1d"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s true that the tangential component of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5e50211b-deeb-4ff2-994e-910246facfc2"],
 " is continuous across the boundary. The transmitted field is virtually a \
continuation of the total field in medium ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b5a9201-76aa-4928-8a0a-7bda9912d300"],
 ". I imagine the same is true for the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["H", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{H}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "53e80775-973c-4737-8526-e543509e4e1f"],
 " field."
}], "CodeText",
 CellChangeTimes->{{3.877274482798922*^9, 3.8772745750896177`*^9}, {
  3.8772746061267433`*^9, 
  3.877274639347431*^9}},ExpressionUUID->"c5f711dd-09c7-4445-b9a5-\
1aa5c44915bc"],

Cell[CellGroupData[{

Cell["Reflection and Transmission Coefficients", "Subsection",
 CellChangeTimes->{{3.876323866753725*^9, 
  3.876323882933344*^9}},ExpressionUUID->"dafb0fd1-087b-4edb-b43d-\
11c87de1a720"],

Cell[BoxData[
 RowBox[{"Eliminate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubsuperscriptBox["E", "0", "i"], "+", 
       SubsuperscriptBox["E", "0", "r"]}], "==", 
      SubsuperscriptBox["E", "0", "t"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubsuperscriptBox["E", "0", "i"], 
        SubscriptBox["\[Eta]", "1"]], "-", 
       FractionBox[
        SubsuperscriptBox["E", "0", "r"], 
        SubscriptBox["\[Eta]", "1"]]}], "==", 
      FractionBox[
       SubsuperscriptBox["E", "0", "t"], 
       SubscriptBox["\[Eta]", "2"]]}]}], "}"}], ",", 
   SubsuperscriptBox["E", "0", "t"]}], "]"}]], "Input",
 CellChangeTimes->{{3.876323699030813*^9, 3.876323753799416*^9}, {
  3.876323890785068*^9, 3.876323955023947*^9}, {3.8763241622833776`*^9, 
  3.8763241627387953`*^9}, {3.876324533017672*^9, 3.87632454327536*^9}, {
  3.876324578359035*^9, 3.876324578632403*^9}},
 CellLabel->
  "In[1547]:=",ExpressionUUID->"7774f6ee-488a-4fe3-9cad-4e8976ecad29"],

Cell["\<\
The first and the second boolean expression basically tell the same story.\
\>", "CodeText",
 CellChangeTimes->{{3.876324713882077*^9, 3.8763247373418293`*^9}, 
   3.876877269513667*^9},ExpressionUUID->"7b7478cf-f72b-451e-8772-\
d99c1d783cf4"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  FractionBox[
   RowBox[{
    FractionBox["1", 
     SubscriptBox["\[Eta]", "1"]], "-", 
    FractionBox["1", 
     SubscriptBox["\[Eta]", "2"]]}], 
   RowBox[{
    FractionBox["1", 
     SubscriptBox["\[Eta]", "1"]], "+", 
    FractionBox["1", 
     SubscriptBox["\[Eta]", "2"]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.876324606055663*^9, 3.876324627812516*^9}},
 CellLabel->
  "In[594]:=",ExpressionUUID->"a010a86b-634a-4385-a79c-2413fce03806"],

Cell[TextData[{
 "This is to say, the reflection coefficient is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox["\[Eta]", "2"], "-", 
            SubscriptBox["\[Eta]", "1"]}], 
          RowBox[{
            SubscriptBox["\[Eta]", "2"], "+", 
            SubscriptBox["\[Eta]", "1"]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\Gamma = \\frac{\\eta_2 - \\eta_1}{\\eta_2 + \\eta_1}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d86789c5-b46a-4470-af3d-d46e57c397bb"],
 ". Similarly, we can derive the transmission coefficient:"
}], "CodeText",
 CellChangeTimes->{{3.876324744997404*^9, 3.8763247677340307`*^9}, {
  3.876324800226645*^9, 
  3.8763248285056267`*^9}},ExpressionUUID->"a447e2a5-15ca-4728-8512-\
30b25470c2db"],

Cell[BoxData[
 RowBox[{"Eliminate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubsuperscriptBox["E", "0", "i"], "+", 
       SubsuperscriptBox["E", "0", "r"]}], "==", 
      SubsuperscriptBox["E", "0", "t"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubsuperscriptBox["E", "0", "i"], 
        SubscriptBox["\[Eta]", "1"]], "-", 
       FractionBox[
        SubsuperscriptBox["E", "0", "r"], 
        SubscriptBox["\[Eta]", "1"]]}], "==", 
      FractionBox[
       SubsuperscriptBox["E", "0", "t"], 
       SubscriptBox["\[Eta]", "2"]]}]}], "}"}], ",", 
   SubsuperscriptBox["E", "0", "r"]}], "]"}]], "Input",
 CellChangeTimes->{{3.876324833996324*^9, 3.87632483423505*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"d637f60a-9e0d-44be-b098-b08bfd431baf"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  FractionBox["2", 
   RowBox[{"1", "+", 
    FractionBox[
     SubscriptBox["\[Eta]", "1"], 
     SubscriptBox["\[Eta]", "2"]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.876324850351791*^9, 3.8763248658566093`*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"d2ce5a5a-9a54-4c84-b707-404d25128081"],

Cell[TextData[{
 "Thus the transmission coefficient is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Tau]", "\[LongEqual]", 
         FractionBox[
          RowBox[{"2", 
            SubscriptBox["\[Eta]", "2"]}], 
          RowBox[{
            SubscriptBox["\[Eta]", "2"], "+", 
            SubscriptBox["\[Eta]", "1"]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\tau = \\frac{2 \\eta_2}{\\eta_2 + \\eta_1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b3c2e7d3-93b0-4454-a43e-1a46bf0b9841"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.87632487571054*^9, 
  3.8763249071087303`*^9}},ExpressionUUID->"c3444bc6-d60b-4e2e-a45f-\
931c8492de38"],

Cell[TextData[{
 "Can you find a relationship between ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "06be51ea-0e9b-49c6-a570-ca23ce73e67e"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ab9a915-697d-45bc-a979-fcf13ea63e68"],
 "?"
}], "Text",
 CellChangeTimes->{{3.876324985430032*^9, 
  3.876324999339183*^9}},ExpressionUUID->"335c961c-c18b-4bfd-a676-\
ba6c3146061b"],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["\[Eta]", "2"]}], 
    RowBox[{
     SubscriptBox["\[Eta]", "2"], "+", 
     SubscriptBox["\[Eta]", "1"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\[Eta]", "2"], "-", 
     SubscriptBox["\[Eta]", "1"]}], 
    RowBox[{
     SubscriptBox["\[Eta]", "2"], "+", 
     SubscriptBox["\[Eta]", "1"]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.87632501827849*^9, 3.8763250531751537`*^9}},
 CellLabel->
  "In[600]:=",ExpressionUUID->"d1f71d86-d9ee-49a2-b830-81db0ec09ec4"],

Cell[TextData[{
 "Looks like ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Tau]", "\[LongEqual]", "1", "+", "\[CapitalGamma]"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\tau = 1 + \\Gamma", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e013b50-f2c9-43ef-9f7a-52550ea32177"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.876325060632463*^9, 
  3.876325073967319*^9}},ExpressionUUID->"30733fbc-f587-4811-b57f-\
0a6bf1130eb2"],

Cell[TextData[{
 "Correct. Now, observe the reflection coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox["\[Eta]", "2"], "-", 
            SubscriptBox["\[Eta]", "1"]}], 
          RowBox[{
            SubscriptBox["\[Eta]", "2"], "+", 
            SubscriptBox["\[Eta]", "1"]}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\Gamma = \\frac{\\eta_2 - \\eta_1}{\\eta_2 + \\eta_1}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "efb38bed-b595-4b14-a8a5-f316ed5bb741"],
 " again. What is the range of the possible values of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "05658603-0674-4ec8-943b-29ee1f560282"],
 "?"
}], "Text",
 CellChangeTimes->{{3.876325245297357*^9, 
  3.876325296609838*^9}},ExpressionUUID->"65f84878-3d25-4f46-8ae1-\
2db01161ad25"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", "2"], "\[GreaterGreater]", 
         SubscriptBox["\[Eta]", "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\eta_2 \\gg \\eta_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2f0f3dfd-7cf1-4ad9-b0ef-ff846e4af3b8"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Eta]", "1"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a479ee9e-f4d2-43cb-bc6a-75644d7b8994"],
 " can be ignored and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2f9484e5-59f5-406e-9038-6c508b7f03b6"],
 ". If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Eta]", "2"], "\[LessLess]", 
         SubscriptBox["\[Eta]", "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\eta_2 \\ll \\eta_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eb5d7d63-e676-4527-a88a-f685366e330a"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Eta]", "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\eta_2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "60018011-235f-4cf6-9069-0ec2c4b49444"],
 " can be ignored and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", "-1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = -1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "28d60114-825b-4ce1-b575-ece1ff785a8e"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.876325300740446*^9, 3.876325303521467*^9}, {
  3.8763253492298717`*^9, 
  3.876325396329267*^9}},ExpressionUUID->"67098634-eb08-4a5e-8a41-\
d359be0543dc"],

Cell["\<\
Can you plot the two extreme scenarios and tell the difference?\
\>", "Text",
 CellChangeTimes->{{3.876325417081564*^9, 3.876325427257139*^9}, {
  3.876325587460758*^9, 
  3.876325592518013*^9}},ExpressionUUID->"bf0bb14b-6259-4de8-90ed-\
8c9defed1b27"],

Cell[TextData[{
 "I think I did this when we were studying waves. But I can do it again. When \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", "1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b6c9c04e-702f-444d-ab0d-2cd60e8cf77a"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.876325435269167*^9, 
  3.876325495583455*^9}},ExpressionUUID->"e5d4b6cc-a782-471a-9113-\
ab4c91e7873a"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"10", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "+", 
            RowBox[{"10", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]]}]}], ")"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "/.", 
         RowBox[{"\[Omega]", "->", 
          RowBox[{"0.6", "\[Pi]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "22"}], ",", "22"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Incident\>\"", ",", "\"\<Reflected\>\"", ",", "\"\<Total\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876748404661471*^9, 3.876748414613027*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"bee11894-f0b3-4148-a8b0-7534223e26ea"],

Cell[TextData[{
 "When  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "\[LongEqual]", "-1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma = -1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "788627af-2361-42ec-b5cb-2b0c5d31cc7b"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.8763255553306837`*^9, 
  3.87632556490757*^9}},ExpressionUUID->"7a1bca19-950c-41e0-b22f-\
e8881b299fe5"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"-", "10"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"10", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]]}], "-", 
            RowBox[{"10", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]]}]}], ")"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "/.", 
         RowBox[{"\[Omega]", "->", 
          RowBox[{"0.6", "\[Pi]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "22"}], ",", "22"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Incident\>\"", ",", "\"\<Reflected\>\"", ",", "\"\<Total\>\""}], 
       "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8763255774545107`*^9, {3.876325618896278*^9, 3.876325619144401*^9}, {
   3.87674842066289*^9, 3.8767484347751913`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"23692782-825a-4995-8445-973e30c72e10"],

Cell["\<\
Looks like in both cases the wave is 100% reflected, but there is phase \
difference.\
\>", "CodeText",
 CellChangeTimes->{{3.8763260088322983`*^9, 
  3.876326034986512*^9}},ExpressionUUID->"17fba043-08a7-47fe-af69-\
daa6665f215a"],

Cell[TextData[{
 "Notice that the reflection coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88dd32f9-e0a6-40a4-a167-80c35d495d7d"],
 " and transmission coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Tau]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\tau", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6085577e-f5ed-46d5-ae0e-632c45533e11"],
 " is defined at the boundary, i.e. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a56ff142-8676-4b67-83d7-a3d31eedbec0"],
 ". In general, we can also extend the definition to any location along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "54cfae0b-01a7-4398-86e7-217b0aebc03b"],
 ": ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", 
         RowBox[{"(", 
           StyleBox["z", "TI"], ")"}], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["E", "TI"], "-"], "(", 
            StyleBox["z", "TI"], ")"}], 
          RowBox[{
            SubscriptBox[
             StyleBox["E", "TI"], "+"], "(", 
            StyleBox["z", "TI"], ")"}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma(z) = \\frac{E_-(z)}{E_+(z)}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b29dde7-801f-433b-a09e-bc09fb2ec216"],
 ". Here ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "-"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_-(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9fc441ed-fa9e-4373-bbdb-93bd0917bb77"],
 " is the electric field of the wave traveling in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "-z", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "83b1bdea-313b-429c-a21e-7c2918301424"],
 " direction, and  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "+"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_+(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a8bed2f1-e661-4198-ac34-1285156712a7"],
 " is the electric field of the wave traveling in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"+", 
         StyleBox["z", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "+z", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7d63a7ce-6414-4224-9db2-356e4be4e7f9"],
 " direction. Can you plot the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "51919557-aa4a-41ec-95f4-e44302d1e5ad"],
 " of the previous example?"
}], "Text",
 CellChangeTimes->{{3.876749209579318*^9, 3.876749317086932*^9}, {
  3.876749412523706*^9, 
  3.8767495322209167`*^9}},ExpressionUUID->"fe4d7b46-5fdd-45d8-bdbd-\
544b2f740b1b"],

Cell[TextData[{
 "In the previous example we have ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "-"], 
         RowBox[{"(", 
           StyleBox["z", "TI"], ")"}], "\[LongEqual]", "-10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "2", 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_-(z) = -10 e^{j 2 z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "71ec1421-35fc-44b7-a59b-92cb098d16bf"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "+"], 
         RowBox[{"(", 
           StyleBox["z", "TI"], ")"}], "\[LongEqual]", "10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], "2", 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_+(z) = 10 e^{-j 2 z}", "state" -> "TeX"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8d7bcba-2f01-45c6-a488-1da83beae762"],
 ", thus ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", 
         RowBox[{"(", 
           StyleBox["z", "TI"], ")"}], "\[LongEqual]", 
         FractionBox[
          RowBox[{"-10", 
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{
               StyleBox["j", "TI"], "2", 
               StyleBox["z", "TI"]}]]}], 
          RowBox[{"10", 
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{"-", 
               StyleBox["j", "TI"], "2", 
               StyleBox["z", "TI"]}]]}]], "\[LongEqual]", "-", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "4", 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\Gamma(z) = \\frac{-10 e^{j 2 z}}{10 e^{-j 2 z}}=-e^{j 4 z}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88087fd1-8133-453c-9349-2bfeec02535d"],
 ". It seems that it\[CloseCurlyQuote]s basically ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", "-1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma(0) = -1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "976037bf-47f5-4ca6-8244-fda322c843ac"],
 " modified by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "4", 
          StyleBox["z", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{j 4 z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "16aa3158-a93c-4bd8-bac7-6531ae3ce703"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.876749544082945*^9, 3.876749584867127*^9}, {
  3.876749648957996*^9, 3.876749655902272*^9}, {3.87674969742192*^9, 
  3.8767497004558*^9}, {3.876749781933572*^9, 
  3.876749829924417*^9}},ExpressionUUID->"d7cb567c-9bd7-4b30-894d-\
8717f2231958"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "4", "z"}]]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
   RowBox[{"AxesLabel", "->", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8767498475012007`*^9, 3.87674988533324*^9}, {
  3.87674995472328*^9, 3.8767499738911343`*^9}, {3.876750570461862*^9, 
  3.876750578109659*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"8394f1a7-de54-491b-b638-64d186bc3118"],

Cell[TextData[{
 "Indeed in this plot ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", 
         RowBox[{"(", "0", ")"}], "\[LongEqual]", "-1"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\Gamma(0) = -1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "47253202-68a3-4a60-82ce-acb0749603da"],
 ", and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8154b9eb-5a59-4eab-a499-49527c437a51"],
 " basically is just a sinusoidal function along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "22a95584-445e-4844-9f21-e2e931ce7b27"],
 ". I also noticed that although it looks like a phasor, this quantity \
actually has no time dependency, i.e. we did not multiply by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "\[Omega]", 
          StyleBox["t", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{j \\omega t}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8c2cea71-9f5f-43a0-b360-ea2eb765c088"],
 " when plotting."
}], "CodeText",
 CellChangeTimes->{{3.8767506057332487`*^9, 3.876750678443606*^9}, {
  3.876750845346939*^9, 
  3.8767509113143883`*^9}},ExpressionUUID->"4e73683d-fff5-47df-b56d-\
249407b37f78"],

Cell[TextData[{
 "That\[CloseCurlyQuote]s correct. Although ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "-"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_-(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "73473b3a-989d-434a-9e44-c54c2bd7733c"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "+"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_+(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f1df7b5c-956f-447e-8775-a91b8560c418"],
 " both are changing with time, at any given location ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1f855cbe-a390-42e8-8737-ec872e27b9c8"],
 ", their ratio is always a constant. This can be intuitively verified by \
plotting ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "-"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_-(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac9ec796-cc99-4f60-a2fd-71ca7818ce87"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["E", "TI"], "+"], "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "E_+(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a77f1701-b191-4e5b-b4f6-ff2eaa7d10ce"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[CapitalGamma]", "(", 
         StyleBox["z", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma(z)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1401d822-292d-40bb-93cb-92cfb53cbda6"],
 " together."
}], "Text",
 CellChangeTimes->{{3.876750940658471*^9, 
  3.876751138480698*^9}},ExpressionUUID->"fb69da03-94a1-47db-9f4d-\
8f5b91ca1421"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{"-", "10"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
        RowBox[{"\[Omega]", "->", 
         RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
       RowBox[{"Re", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "10"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
         RowBox[{"10", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryJ]"}], " ", "2", "z"}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}]], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
     RowBox[{"PlotLegends", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(E\), \(_\)]\)(z)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(E\), \(+\)]\)(z)\>\"", ",", 
        "\"\<\[CapitalGamma](z)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876751164946631*^9, 3.876751308971838*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"e3638b06-746e-4509-9edc-bec69a4201df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["What does it mean when we say \[OpenCurlyDoubleQuote]to propagate \
something\[CloseCurlyDoubleQuote]?", "Subsection",
 CellChangeTimes->{{3.876751558997766*^9, 3.8767515805246687`*^9}, {
  3.876752650222649*^9, 
  3.8767526523059483`*^9}},ExpressionUUID->"74e2cb0b-5693-4dff-8671-\
e6ecdd834c9d"],

Cell[TextData[{
 "So far you are familiar with the the phasor form of a wave, e.g. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"10", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{"-", 
            StyleBox["j", "TI"], "2", 
            StyleBox["z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "10 e^{-j 2 z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d3a6a1f6-1c11-42e9-91fe-2977c55520da"],
 ". Another way to think of it is that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["10", TraditionalForm], "errors" -> {}, "input" -> 
     "10", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "23561c1d-b52f-4108-be7c-28d2ae050f3f"],
 " is the wave at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b2ab25dc-2765-4cc7-b0cd-4c1b562bed54"],
 ", and since the wave is propagating forward, this \
\[OpenCurlyDoubleQuote]modified by some phase term\[CloseCurlyDoubleQuote] is \
another way to think of the wave propagation. In other words, if a wave were \
to propagate forward from point ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ea27adf5-f247-4ad0-969d-bd74808fc35e"],
 " over a length of of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["l", "TI"], TraditionalForm], "errors" -> {}, "input" -> "l", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fff1d29d-2043-4d74-93b7-6f1ceaee920d"],
 " to point ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["2", TraditionalForm], "errors" -> {}, "input" -> "2", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6206b842-e6dd-476c-8d57-4ac3993e7178"],
 ", we simply multiply the field at point ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "28a4c6e1-7b0e-4a5f-8ad2-513237b97a8b"],
 " by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", 
          StyleBox["j", "TI"], 
          StyleBox["k", "TI"], 
          StyleBox["l", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "e^{-j k l}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "999decd6-e480-48a0-b548-fc1aca7d5065"],
 ". Please do some verifications about this to get an intuition."
}], "Text",
 CellChangeTimes->{{3.8767516390058203`*^9, 3.876751688847077*^9}, {
  3.876751767664846*^9, 3.876751775546492*^9}, {3.876751832578495*^9, 
  3.876751907624304*^9}, {3.8767519945316753`*^9, 3.876752020000826*^9}, {
  3.8767520560047607`*^9, 3.8767521114051037`*^9}, {3.876752299234877*^9, 
  3.876752379180561*^9}},ExpressionUUID->"0371752e-2ac2-4420-9a74-\
6766329db264"],

Cell[TextData[{
 "By the same token, the reflection coefficient ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[CapitalGamma]", TraditionalForm], "errors" -> {}, 
     "input" -> "\\Gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa8c9de6-3a6b-4892-bd21-1e7c39fb7371"],
 " can also propagate from one point to another (p.18 on Lecture 14)."
}], "Text",
 CellChangeTimes->{{3.876752659290515*^9, 
  3.876752702444833*^9}},ExpressionUUID->"33ef20bb-06d8-45ab-bfc9-\
39b9f93fff2e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Oblique Incidence", "Section",
 CellChangeTimes->{{3.876319745381548*^9, 
  3.8763197500620193`*^9}},ExpressionUUID->"b6d96baf-ec48-407c-a346-\
e9c4521f7e04"],

Cell[CellGroupData[{

Cell["Refraction Index", "Subsection",
 CellChangeTimes->{{3.8763277096929617`*^9, 
  3.8763277139997797`*^9}},ExpressionUUID->"17de8d12-7fe3-4c8c-bd74-\
63699db9e590"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s first define the refraction index ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["n", "TI"], TraditionalForm], "errors" -> {}, "input" -> "n", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8505ee5f-2f8a-43b7-ba93-876ea1ba91de"],
 " as the ratio of the phase velocity in free space to the phase velocity in \
the medium. Can you find an expression for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["n", "TI"], TraditionalForm], "errors" -> {}, "input" -> "n", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bde780d0-9963-4a2b-b71a-8f6cc26f4871"],
 "?"
}], "Text",
 CellChangeTimes->{{3.876326405099298*^9, 3.87632647046994*^9}, {
  3.876327325934675*^9, 
  3.876327344485857*^9}},ExpressionUUID->"09536589-304c-4430-bad8-\
a38c16fcda16"],

Cell[TextData[{
 "I do know that light travels slower in materials other than vacuum, and in \
general the denser the material, the slower it travels. A quick ",
 StyleBox["Googling",
  IgnoreSpellCheck->True],
 " tells me that the speed of light in diamond is only ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"1.2", "\[Cross]", 
         SuperscriptBox["10", "8"], 
         StyleBox["m", "TI"], "/", 
         StyleBox["s", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "1.2 \\times 10^8 m/s", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "698eeb56-bb26-4de6-acf2-41cf964875a4"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.876326475771419*^9, 3.876326619739078*^9}, 
   3.8763266622280283`*^9},ExpressionUUID->"de45155a-d56d-4842-a95c-\
07bbd28980c3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{
    "do", " ", "a", " ", "simple", " ", "Manipulate", " ", "of", " ", 
     "n1"}]}], ",", " ", 
   RowBox[{"n2", " ", "and", " ", "incident", " ", "theta"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.876327553819662*^9, 
  3.876327569977207*^9}},ExpressionUUID->"07e26111-b801-4764-9629-\
7b0337212e8c"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"10", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"0.6", "\[Pi]", " ", "t"}], "-", " ", "#", "+", 
               FractionBox["\[Pi]", "4"]}], "]"}]}]}], "}"}]}], "}"}], "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "10", ",", "0.2"}], "]"}]}], ",", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]], "Input",
 CellLabel->
  "In[625]:=",ExpressionUUID->"464f63aa-ed71-4be1-904c-3caf523b308d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plane of incidence", "Subsection",
 CellChangeTimes->{{3.87632768058532*^9, 
  3.876327686394649*^9}},ExpressionUUID->"c4f77870-1c55-411f-84dd-\
ab1077ee7df0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{
     RowBox[{"Snell", "'"}], "s", " ", "law"}]}], ",", " ", 
   RowBox[{
    RowBox[{"transmisson", " ", "&"}], " ", "reflection", " ", 
    "coefficient"}], ",", " ", 
   RowBox[{
    RowBox[{
    "do", " ", "we", " ", "need", " ", "to", " ", "consider", " ", "that", 
     " ", "k"}], " ", "=", " ", 
    RowBox[{"\[Omega]", 
     SqrtBox["\[Mu]\[Epsilon]"]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.876643025026163*^9, 3.87664302933139*^9}, {
  3.87664369363892*^9, 3.8766437201787157`*^9}, {3.876657855281218*^9, 
  3.876657874352256*^9}},ExpressionUUID->"5d9f796e-18e5-4d98-81b5-\
3adbdcc5a3ec"],

Cell[TextData[{
 "Assume that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Epsilon]", 
          RowBox[{
            StyleBox["r", "TI"], "1"}]], "\[LongEqual]", "1"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\epsilon_{r1} = 1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4f25d9e2-802b-4662-a708-aca449f7fc75"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Epsilon]", 
          RowBox[{
            StyleBox["r", "TI"], "2"}]], "\[LongEqual]", "4"}], 
       TraditionalForm], "errors" -> {}, "input" -> "\\epsilon_{r2} = 4", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "83a44a3a-fc23-43ed-ae8e-1856eaa0d047"],
 ", from Snell\[CloseCurlyQuote]s Laws we know that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          RowBox[{"sin", 
            SubscriptBox["\[Theta]", 
             StyleBox["t", "TI"]]}], 
          RowBox[{"sin", 
            SubscriptBox["\[Theta]", 
             StyleBox["i", "TI"]]}]], "\[LongEqual]", 
         SqrtBox[
          FractionBox[
           SubscriptBox["\[Epsilon]", 
            RowBox[{
              StyleBox["r", "TI"], "1"}]], 
           SubscriptBox["\[Epsilon]", 
            RowBox[{
              StyleBox["r", "TI"], "2"}]]]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{\\sin{\\theta_t}}{\\sin{\\theta_i}} = \
\\sqrt{\\frac{\\epsilon_{r1}}{\\epsilon_{r2}}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2ed6ca2a-a3e8-4d71-b78c-4110ce5a28b9"],
 ", thus ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", 
         SubscriptBox["\[Theta]", 
          StyleBox["t", "TI"]], "\[LongEqual]", 
         FractionBox[
          RowBox[{"sin", 
            SubscriptBox["\[Theta]", 
             StyleBox["i", "TI"]]}], "2"]}], TraditionalForm], "errors" -> {},
      "input" -> "\\sin{\\theta_t} = \\frac{\\sin{\\theta_i}}{2}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aaac506e-6ee8-499f-8f0c-ba0ab2208cc1"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Theta]", 
          StyleBox["t", "TI"]], "\[LongEqual]", "arcsin", 
         FractionBox[
          RowBox[{"sin", 
            SubscriptBox["\[Theta]", 
             StyleBox["i", "TI"]]}], "2"]}], TraditionalForm], "errors" -> {},
      "input" -> "\\theta_t = \\arcsin{\\frac{\\sin{\\theta_i}}{2}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "19f36c8c-5cc1-4b8e-a4d1-3e320a085ea0"],
 ". First, let\[CloseCurlyQuote]s calculate the intrinsic impedance of medium \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e19a9539-2727-4d5c-90a3-170e63c0236f"],
 " and medium ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["2", TraditionalForm], "errors" -> {}, "input" -> "2", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1cd760d4-5d04-4236-acc7-982dd9e175f2"],
 ":"
}], "Text",
 CellChangeTimes->{{3.876658247784686*^9, 3.8766583099371758`*^9}, {
   3.876658396100997*^9, 3.876658412876711*^9}, 3.8766584647280293`*^9, {
   3.876658615346529*^9, 3.8766586241615953`*^9}, 3.8766586721094303`*^9, {
   3.876659367838512*^9, 3.876659372798151*^9}, {3.876659411851022*^9, 
   3.87665943985699*^9}},ExpressionUUID->"c529ae3f-f5f2-4750-a53e-\
6ae3b007e7c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["\[Eta]", "1"], "=", 
   SqrtBox[
    FractionBox[
     SubscriptBox["\[Mu]", "0"], 
     SubscriptBox["\[Epsilon]", "1"]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Eta]", "2"], "=", 
   SqrtBox[
    FractionBox[
     SubscriptBox["\[Mu]", "0"], 
     SubscriptBox["\[Epsilon]", "2"]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.87665944503578*^9, 3.8766594983546667`*^9}, {
  3.876659647808486*^9, 3.876659648085856*^9}, {3.8766719327665*^9, 
  3.876671933528966*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"45d085ca-e0eb-4090-a8f2-6ae83c27788a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.876659516711335*^9, {3.8766596502703247`*^9, 3.8766596543206244`*^9}, {
   3.876666997434073*^9, 3.876666997936167*^9}, 
   3.876671931375144*^9},ExpressionUUID->"7c4690ef-6dca-4da9-afcb-\
5f0be0757e6e"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "1"], "=", 
      SubscriptBox["\[Epsilon]", "0"]}], ",", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "2"], "=", 
      RowBox[{"4", 
       SubscriptBox["\[Epsilon]", "0"]}]}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "-", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1.2"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[Perpendicular]\)]\)\>\""}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876659589379733*^9, 3.876659612504376*^9}, {
  3.876659658542409*^9, 3.8766597061629667`*^9}, {3.876659778535078*^9, 
  3.8766597804344387`*^9}, {3.8766603686197033`*^9, 3.876660375939456*^9}, {
  3.8766611017511253`*^9, 3.87666110261635*^9}, {3.876661136537734*^9, 
  3.876661149526991*^9}, {3.876666294541366*^9, 3.876666297205947*^9}, {
  3.876671878577476*^9, 3.876671900744399*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"8c4bfa52-6704-4108-a04f-267de78445a0"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "1"], "=", 
      SubscriptBox["\[Epsilon]", "0"]}], ",", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "2"], "=", 
      RowBox[{"4", 
       SubscriptBox["\[Epsilon]", "0"]}]}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "-", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "+", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0.8"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\""}], 
       "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8766598805730047`*^9, 3.876659882551763*^9}, {
  3.876660080443083*^9, 3.876660132336952*^9}, {3.876660193339423*^9, 
  3.8766601959340687`*^9}, {3.876660315638898*^9, 3.876660359859392*^9}, {
  3.876661086704975*^9, 3.8766611273298903`*^9}, {3.876671944428033*^9, 
  3.8766719471432943`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"70f9276b-0e8c-44c3-b0b2-36dddd27f064"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Epsilon]", "2"], ">", 
         SubscriptBox["\[Epsilon]", "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\epsilon_2 > \\epsilon_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2fe85f99-b210-4e01-9b04-70ef310ea85d"],
 ":"
}], "Text",
 CellChangeTimes->{{3.876672173349472*^9, 
  3.876672196941739*^9}},ExpressionUUID->"ffc10a49-1d66-4162-a9fc-\
19be212099b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "-", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1.2"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[Perpendicular]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]], ",", "1.1", ",", "10"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876659983688982*^9, 3.876660070771929*^9}, {
   3.87666042311593*^9, 3.876660588049226*^9}, {3.876660713605423*^9, 
   3.876660774306856*^9}, {3.876661189294976*^9, 3.876661189479807*^9}, 
   3.8766721574735613`*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"87a1dd5a-4390-4888-af5d-43f189d68b43"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Epsilon]", "2"], "<", 
         SubscriptBox["\[Epsilon]", "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\epsilon_2 < \\epsilon_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9f9d3c16-d38d-4ff9-b53b-a3074e95f510"],
 ":"
}], "Text",
 CellChangeTimes->{{3.876672173349472*^9, 
  3.876672196941739*^9}},ExpressionUUID->"049e7f9e-8f4f-4447-a99c-\
c36b5e48fe25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "-", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.1"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[Perpendicular]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]], ",", "0.1", ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8766606144799433`*^9, 3.876660626849688*^9}, {
   3.87666081248221*^9, 3.876660829128113*^9}, {3.876661195777296*^9, 
   3.876661195952529*^9}, {3.8766612279100647`*^9, 3.876661249472226*^9}, {
   3.876661292367302*^9, 3.876661292614328*^9}, 3.87667215981988*^9},
 CellLabel->
  "In[1348]:=",ExpressionUUID->"92ec8fb2-33a0-4a65-a969-ca9cbe510ab0"],

Cell["How about parallel polarization", "Text",
 CellChangeTimes->{{3.876662920716816*^9, 3.876662942657351*^9}, 
   3.876662987945732*^9, {3.876671967110354*^9, 
   3.8766719823043203`*^9}},ExpressionUUID->"215a2424-9dc5-44d8-9923-\
def6f976f59a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]]}], 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{
        FractionBox[
         SubscriptBox["\[Epsilon]", "2"], 
         SubscriptBox["\[Epsilon]", "1"]], 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], "-", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[DoubleVerticalBar]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]], ",", "0.1", ",", "10"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876659983688982*^9, 3.876660070771929*^9}, {
  3.87666042311593*^9, 3.876660588049226*^9}, {3.876660713605423*^9, 
  3.876660774306856*^9}, {3.876661189294976*^9, 3.876661189479807*^9}, {
  3.876672003490514*^9, 3.876672098804488*^9}, {3.8766723640845823`*^9, 
  3.8766723834782457`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"963f7a72-e385-49a0-b6fd-744ea9d66aca"],

Cell["\<\
We are often interested in the amount of field reflected and don\
\[CloseCurlyQuote]t care too much about phase.\
\>", "Text",
 CellChangeTimes->{{3.876672478427309*^9, 
  3.876672570335154*^9}},ExpressionUUID->"0fcec33d-1f49-4402-899e-\
75e00b441b7c"],

Cell["Let\[CloseCurlyQuote]s just plot its absolute value:", "CodeText",
 CellChangeTimes->{{3.876672582434396*^9, 
  3.876672597528534*^9}},ExpressionUUID->"842e8cb9-b2c8-4b24-b278-\
66173504ee9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]]}], 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
       RowBox[{
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[DoubleVerticalBar]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]], ",", "0.1", ",", "10"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876659983688982*^9, 3.876660070771929*^9}, {
  3.87666042311593*^9, 3.876660588049226*^9}, {3.876660713605423*^9, 
  3.876660774306856*^9}, {3.876661189294976*^9, 3.876661189479807*^9}, {
  3.876672003490514*^9, 3.876672098804488*^9}, {3.8766723640845823`*^9, 
  3.8766723834782457`*^9}, {3.8766726067450027`*^9, 3.8766726093633757`*^9}, {
  3.876708881616952*^9, 3.876708882584396*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"74f17454-1d86-4059-9efe-6ff55530354d"],

Cell["It seems that this graph has some discontinuity?", "Text",
 CellChangeTimes->{{3.876672870364369*^9, 
  3.876672878540242*^9}},ExpressionUUID->"482564d9-6c29-46a7-868c-\
f4241b7c07f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]]}], 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
       RowBox[{
        RowBox[{
         FractionBox[
          SubscriptBox["\[Epsilon]", "2"], 
          SubscriptBox["\[Epsilon]", "1"]], 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
        SqrtBox[
         RowBox[{
          FractionBox[
           SubscriptBox["\[Epsilon]", "2"], 
           SubscriptBox["\[Epsilon]", "1"]], "-", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0.31", ",", "0.33"}], "}"}], ",", 
     
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.31", ",", "0.33"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[DoubleVerticalBar]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]], ",", "0.1", ",", "0.101"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876659983688982*^9, 3.876660070771929*^9}, {
  3.87666042311593*^9, 3.876660588049226*^9}, {3.876660713605423*^9, 
  3.876660774306856*^9}, {3.876661189294976*^9, 3.876661189479807*^9}, {
  3.876672003490514*^9, 3.876672098804488*^9}, {3.8766723640845823`*^9, 
  3.8766723834782457`*^9}, {3.8766726067450027`*^9, 3.8766726093633757`*^9}, {
  3.876672700090719*^9, 3.876672789709955*^9}, {3.876672823626544*^9, 
  3.8766728527764463`*^9}, {3.8767089159877567`*^9, 3.8767089167535963`*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"a1779761-1123-4eea-8d91-41bd95ac8f42"],

Cell["Brewster angle", "Text",
 CellChangeTimes->{{3.876672929651863*^9, 
  3.87667293264371*^9}},ExpressionUUID->"c80e3c97-9b45-4133-b34a-\
626a1afe4678"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["\[Epsilon]", "2"], 
        SubscriptBox["\[Epsilon]", "1"]]}], 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       FractionBox[
        SubscriptBox["\[Epsilon]", "2"], 
        SubscriptBox["\[Epsilon]", "1"]], "-", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], "==", "0"}], ",", 
   SubscriptBox["\[Theta]", "i"]}], "]"}]], "Input",
 CellChangeTimes->{{3.876672935856094*^9, 3.8766729487925177`*^9}, {
  3.876673095874064*^9, 3.876673122537931*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"b88d5621-a0d6-4210-9ad7-d59b77cc4d9d"],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["\[Epsilon]", "2"], 
        SubscriptBox["\[Epsilon]", "1"]]}], 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
     SqrtBox[
      RowBox[{
       FractionBox[
        SubscriptBox["\[Epsilon]", "2"], 
        SubscriptBox["\[Epsilon]", "1"]], "-", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], "==", "0"}], ",", 
   RowBox[{"Sin", "[", 
    SubscriptBox["\[Theta]", "i"], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876673186620303*^9, 3.876673190536161*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"fbe3dbac-6d22-41c8-9e39-b1953d62a0f7"],

Cell["\<\
How does the reflection coefficient of parallel polarization compare with \
perpendicular polarization?\
\>", "Text",
 CellChangeTimes->{{3.8767087069159117`*^9, 
  3.87670877608882*^9}},ExpressionUUID->"1f091a5a-235b-466a-adb2-\
eb661b4eb59a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Abs", "[", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SubscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Epsilon]", "1"]]}], 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SubscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Epsilon]", "1"]], "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
         RowBox[{
          RowBox[{
           FractionBox[
            SubscriptBox["\[Epsilon]", "2"], 
            SubscriptBox["\[Epsilon]", "1"]], 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SubscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Epsilon]", "1"]], "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}], ",", 
       RowBox[{"Abs", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "-", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SubscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Epsilon]", "1"]], "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "+", 
          SqrtBox[
           RowBox[{
            FractionBox[
             SubscriptBox["\[Epsilon]", "2"], 
             SubscriptBox["\[Epsilon]", "1"]], "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", "0", ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["\[Pi]", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \
\(\[DoubleVerticalBar]\)]\)\>\""}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SubscriptBox["\[Epsilon]", "2"], 
        SubscriptBox["\[Epsilon]", "1"]], ",", "4"}], "}"}], ",", "0.1", ",", 
     "10"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemoveSymbolize", "[", 
   TemplateBox[{
     FractionBox[
      SubscriptBox["\[Epsilon]", "2"], 
      SubscriptBox["\[Epsilon]", "1"]]},
    "NotationTemplateTag"], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.876659983688982*^9, 3.876660070771929*^9}, {
  3.87666042311593*^9, 3.876660588049226*^9}, {3.876660713605423*^9, 
  3.876660774306856*^9}, {3.876661189294976*^9, 3.876661189479807*^9}, {
  3.876672003490514*^9, 3.876672098804488*^9}, {3.8766723640845823`*^9, 
  3.8766723834782457`*^9}, {3.8766726067450027`*^9, 3.8766726093633757`*^9}, {
  3.876708778550658*^9, 3.876708856674666*^9}, {3.87670903027929*^9, 
  3.8767090634773397`*^9}},
 CellLabel->
  "In[1351]:=",ExpressionUUID->"67efe89a-75fe-4d7a-aa84-7022b0e12f9e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Animate", "[", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "t"], "=", 
        RowBox[{"ArcSin", "[", 
         FractionBox[
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "-", 
          SqrtBox[
           RowBox[{"4", "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "i"], "]"}], "+", 
          SqrtBox[
           RowBox[{"4", "-", 
            SuperscriptBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
        RowBox[{"1", "+", 
         SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"z", " ", 
                   RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                  "z"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "}"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Green", ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "2", 
                    
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "z"}], " ", 
                   RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                  "z"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "}"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"points", " ", "of", " ", "reflection"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[Perpendicular]"], "2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"z", " ", 
                   RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                  "z"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "0", ",", "5", ",", "0.2"}], "}"}]}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{"points", " ", "of", " ", "transmission"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LightPink", ",", " ", 
              RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
              RowBox[{"InfinitePlane", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
               "]"}]}], "}"}], ",", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LightBlue", ",", " ", 
              RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
              RowBox[{"InfinitePlane", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Axes", "->", "True"}], ",", 
         RowBox[{"AxesLabel", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}],
          ",", " ", 
         RowBox[{"ViewVertical", "->", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
         RowBox[{"ViewPoint", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.3"}], ",", " ", "2.4", ",", " ", 
            RowBox[{"-", "2."}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", " ", 
         RowBox[{"ImageSize", "->", "Large"}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", 
       FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876671257146446*^9, 3.8766712582101097`*^9}},
 CellLabel->
  "In[1346]:=",ExpressionUUID->"b57b87ab-d8fe-480f-a182-73cc207a1388"],

Cell[TextData[{
 StyleBox["The ", "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "5fb837ac-78dc-480e-8128-73299b1b83d1"], "CodeText"],
 StyleBox[" field is perpendicular to the plane of incidence", "CodeText"]
}], "Text",
 CellChangeTimes->{{3.876642866385454*^9, 
  3.876642938118147*^9}},ExpressionUUID->"06403ebb-0a53-49ab-a7f9-\
45d6f48dd07e"],

Cell["\<\
This is called transverse electric (TE) polarization or perpendicular \
polarization.\
\>", "Text",
 CellChangeTimes->{{3.876642947598682*^9, 
  3.876643014157997*^9}},ExpressionUUID->"2f063f38-ccba-4c25-b859-\
5c284ae3c44c"],

Cell["\<\
You might want to take a closer look at the interface and observe how the \
phases relate to each other\
\>", "Text",
 CellChangeTimes->{{3.876663886441489*^9, 
  3.876663907906618*^9}},ExpressionUUID->"78f04592-4ac9-4db3-918f-\
88bd4399cca7"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["k", "2"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], ",", 
     SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "-", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
          RowBox[{"1", "+", 
           SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "2", 
                    
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "z"}], " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "reflection"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[Perpendicular]"], "2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "transmission"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1.5"}], ",", " ", "0.8", ",", " ", 
                RowBox[{"-", "0.3"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Magenta", ",", "Green", ",", "Magenta"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[Perpendicular]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\
\"", ",", 
                 SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876663797027026*^9, 3.8766638212899427`*^9}, {3.876664123496724*^9, 
   3.876664127404305*^9}, {3.876664157971575*^9, 3.876664176244535*^9}, {
   3.87666421561935*^9, 3.8766642701395493`*^9}, {3.876664301029516*^9, 
   3.876664337157278*^9}, {3.8766644072140713`*^9, 3.8766645662838583`*^9}, {
   3.876664629462276*^9, 3.876664637077113*^9}, {3.8766646785245113`*^9, 
   3.876664704331273*^9}, {3.8766647495812597`*^9, 3.876664769616045*^9}, {
   3.876665127591157*^9, 3.876665150581052*^9}, {3.8766653393125753`*^9, 
   3.876665351861246*^9}, {3.87666540885253*^9, 3.876665420638647*^9}, {
   3.876665503860876*^9, 3.87666550632882*^9}, {3.876665665783495*^9, 
   3.876665710539073*^9}, {3.876665749583544*^9, 3.87666590683078*^9}, {
   3.876665968547861*^9, 3.876665985161601*^9}, {3.8766678107917967`*^9, 
   3.876667865755314*^9}, {3.876667898431325*^9, 3.87666790876721*^9}, {
   3.8766680681202793`*^9, 3.876668078815722*^9}, {3.876668140572316*^9, 
   3.8766682000864162`*^9}, {3.8766682371724787`*^9, 
   3.8766683670767384`*^9}, {3.876668409712365*^9, 3.876668495755938*^9}, {
   3.876668589893342*^9, 3.876668609613043*^9}, {3.8766687649075823`*^9, 
   3.8766687674887543`*^9}, {3.876669893657606*^9, 3.876669894268611*^9}, 
   3.876670804449214*^9, {3.876671251938546*^9, 3.876671253001951*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"12b48e79-857f-4f68-b141-e9bfb3014694"],

Cell["How about the magnetic field?", "Text",
 CellChangeTimes->{{3.876709722982965*^9, 
  3.876709728894652*^9}},ExpressionUUID->"f5d796f4-ce18-4c2a-ac85-\
a2fc86c095d8"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["k", "2"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Eta]", "2"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", 
          SqrtBox[
           FractionBox[
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]]]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "2"], "=", 
          SqrtBox[
           FractionBox[
            SubscriptBox["\[Mu]", "0"], 
            RowBox[{"4", 
             SubscriptBox["\[Epsilon]", "0"]}]]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], ")"}],
            "*", 
           FractionBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "t"], "]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "0.01"}], ",", "0", ",", "0.001"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "z"}], " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "0.01"}], ",", "0", ",", "0.001"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "reflection"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "2"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "2"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "0.01", ",", "0.001"}], 
                    "}"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "transmission"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", " ", "2.5", ",", " ", 
                RowBox[{"-", "2."}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}]}], "}"}]}], ",",
              " ", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Magenta", ",", "Green", ",", "Magenta"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[DoubleVerticalBar]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[DoubleVerticalBar]\)]\
\)\>\"", ",", 
                 SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1.2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.87665332754464*^9, 
   3.8766533355714397`*^9}, {3.876653389220739*^9, 3.876653436208366*^9}, {
   3.876653509482827*^9, 3.876653529911317*^9}, {3.876653566786887*^9, 
   3.8766535721075287`*^9}, {3.8766539413498793`*^9, 3.876653950270563*^9}, {
   3.876653992096032*^9, 3.876654016061618*^9}, {3.876654111411982*^9, 
   3.87665414084055*^9}, {3.876654633309895*^9, 3.876654646986258*^9}, {
   3.876654719219173*^9, 3.876654760733322*^9}, {3.8766666529663563`*^9, 
   3.87666674079434*^9}, {3.876666832402791*^9, 3.876666851362093*^9}, {
   3.876666941226858*^9, 3.876666969257882*^9}, {3.876667020882619*^9, 
   3.876667068437991*^9}, {3.876667133339992*^9, 3.876667226759974*^9}, {
   3.8766673939770517`*^9, 3.876667453546797*^9}, {3.876667617548037*^9, 
   3.876667672758086*^9}, {3.876667712143076*^9, 3.876667753190227*^9}, {
   3.8766690105843983`*^9, 3.876669034403858*^9}, {3.8766690964108562`*^9, 
   3.876669124322318*^9}, {3.876669171650014*^9, 3.876669175794608*^9}, {
   3.876669348119581*^9, 3.876669485924048*^9}, {3.8766699011503*^9, 
   3.876669901779498*^9}, {3.876670005719755*^9, 3.876670013251712*^9}, {
   3.876670069855928*^9, 3.876670107447825*^9}, {3.876670659872479*^9, 
   3.8766707430384808`*^9}, {3.876670825933622*^9, 3.876670826179522*^9}, {
   3.876671244615244*^9, 3.8766712468810883`*^9}, {3.876673906649185*^9, 
   3.876673908832872*^9}, {3.876707059748376*^9, 3.8767071130342617`*^9}, {
   3.87670794634299*^9, 3.8767079667408743`*^9}, {3.876708032711051*^9, 
   3.8767080695668287`*^9}, {3.876708409224236*^9, 3.876708409453918*^9}, {
   3.8767084400865393`*^9, 3.876708440260394*^9}, {3.876708475678582*^9, 
   3.876708494599732*^9}, {3.876708543104198*^9, 3.876708543222313*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"bb6fb431-c8a8-4952-b4c9-e96e718d5224"],

Cell["\<\
We try to scale the magnetic field vectors so that\[CloseCurlyQuote]s \
actually visible in the same scale as the electric field.\
\>", "Text",
 CellChangeTimes->{{3.87670973726376*^9, 
  3.8767097914720287`*^9}},ExpressionUUID->"83a07e76-1977-46ce-9745-\
8ac369fc00d5"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["k", "2"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Eta]", "2"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "2"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], ")"}],
            "*", 
           FractionBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "t"], "]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "z"}], " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "reflection"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "2"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "2"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "transmission"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", " ", "2.5", ",", " ", 
                RowBox[{"-", "2."}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Magenta", ",", "Green", ",", "Magenta"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[DoubleVerticalBar]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[DoubleVerticalBar]\)]\
\)\>\"", ",", 
                 SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1.2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.87665332754464*^9, 
   3.8766533355714397`*^9}, {3.876653389220739*^9, 3.876653436208366*^9}, {
   3.876653509482827*^9, 3.876653529911317*^9}, {3.876653566786887*^9, 
   3.8766535721075287`*^9}, {3.8766539413498793`*^9, 3.876653950270563*^9}, {
   3.876653992096032*^9, 3.876654016061618*^9}, {3.876654111411982*^9, 
   3.87665414084055*^9}, {3.876654633309895*^9, 3.876654646986258*^9}, {
   3.876654719219173*^9, 3.876654760733322*^9}, {3.8766666529663563`*^9, 
   3.87666674079434*^9}, {3.876666832402791*^9, 3.876666851362093*^9}, {
   3.876666941226858*^9, 3.876666969257882*^9}, {3.876667020882619*^9, 
   3.876667068437991*^9}, {3.876667133339992*^9, 3.876667226759974*^9}, {
   3.8766673939770517`*^9, 3.876667453546797*^9}, {3.876667617548037*^9, 
   3.876667672758086*^9}, {3.876667712143076*^9, 3.876667753190227*^9}, {
   3.8766690105843983`*^9, 3.876669034403858*^9}, {3.8766690964108562`*^9, 
   3.876669124322318*^9}, {3.876669171650014*^9, 3.876669175794608*^9}, {
   3.876669348119581*^9, 3.876669485924048*^9}, {3.8766699011503*^9, 
   3.876669901779498*^9}, {3.876670005719755*^9, 3.876670013251712*^9}, {
   3.876670069855928*^9, 3.876670107447825*^9}, {3.876670659872479*^9, 
   3.8766707430384808`*^9}, {3.876670825933622*^9, 3.876670826179522*^9}, {
   3.8766709631305113`*^9, 3.876670977152606*^9}, {3.876671017502099*^9, 
   3.8766710824887457`*^9}, {3.876671230541542*^9, 3.876671231828607*^9}, {
   3.8766738960512877`*^9, 3.876673898754558*^9}, {3.876707142538516*^9, 
   3.876707174291013*^9}, 3.876707982619976*^9, 3.8767081007340803`*^9, {
   3.876708582713846*^9, 3.876708582847147*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"88f822f1-04bb-4100-9378-0b56aeec1fbc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{"give", " ", "it", " ", "a", " ", "title"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.876673322368161*^9, 
  3.876673329974915*^9}},ExpressionUUID->"87734257-7241-4c4d-837d-\
0711bdd74f92"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{
    "there", " ", "is", " ", "actually", " ", "a", " ", "bit", " ", "of", " ",
      "a", " ", "bug", " ", "here"}], ":", " ", 
    RowBox[{
    "what", " ", "we", " ", "intend", " ", "to", " ", "show", " ", "is", " ", 
     "the", " ", "magnetic", " ", "field"}]}], ",", " ", 
   RowBox[{
   "but", " ", "what", " ", "also", " ", "use", " ", "the", " ", "parallel", 
    " ", "reflection", " ", "coefficient", " ", "for", " ", "electric", " ", 
    RowBox[{"field", ".", " ", "These"}], " ", "two", " ", "cases", " ", 
    "should", " ", "be", " ", "dealt", " ", 
    RowBox[{"differently", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.876712389448402*^9, 
  3.8767124418869534`*^9}},ExpressionUUID->"ce8de382-57b3-4383-a82e-\
e7f1354d63e1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[Theta]", "i"], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", "Automatic"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "i"], ",", 
       FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8766501422456284`*^9, 3.876650179256857*^9}, {
  3.876651290554599*^9, 3.876651291792223*^9}, {3.87665133357547*^9, 
  3.876651347682518*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"b1b3df52-bdf1-4a94-9f5b-c98c15c55e45"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{"optimize", " ", "this"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.876651788194675*^9, 
  3.876651792808899*^9}},ExpressionUUID->"de5b5dc0-9227-4001-91d3-\
b8285128df4b"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Re", "[", 
       RowBox[{"2", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", " ", 
             RowBox[{"Sin", "[", 
              FractionBox["\[Pi]", "4"], "]"}]}], "+", 
            RowBox[{"z", " ", 
             RowBox[{"Cos", "[", 
              FractionBox["\[Pi]", "4"], "]"}]}]}], ")"}]}]], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], " ", 
      "/.", 
      RowBox[{"\[Omega]", "->", 
       RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.876651445591009*^9, 3.876651560575775*^9}, {
  3.87665176011769*^9, 3.8766517705365877`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"2f20c13f-d5e2-44b4-8fd1-0f66f0de2408"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], ",", 
     SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "-", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
          RowBox[{"1", "+", 
           SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "z"}], "}"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"point", " ", "of", " ", "incidence"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "y", ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"point", " ", "of", " ", "incidence"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"point", " ", "of", " ", "incidence"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
                 " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightYellow", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], "]"}]}], "}"}], " ", ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "wave"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", " ", 
                  RowBox[{"Opacity", "[", "1", "]"}], ",", "Thick", ",", 
                  RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
                  RowBox[{"Arrow", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", 
                RowBox[{"-", "2"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Magenta", ",", "Green", ",", "Magenta"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[Perpendicular]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\
\"", ",", 
                 SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}], ",", 
       RowBox[{"AnimationRate", "->", ".5"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876663797027026*^9, 3.8766638212899427`*^9}, {3.876664123496724*^9, 
   3.876664127404305*^9}, {3.876664157971575*^9, 3.876664176244535*^9}, {
   3.87666421561935*^9, 3.8766642701395493`*^9}, {3.876664301029516*^9, 
   3.876664337157278*^9}, {3.8766644072140713`*^9, 3.8766645662838583`*^9}, {
   3.876664629462276*^9, 3.876664637077113*^9}, {3.8766646785245113`*^9, 
   3.876664704331273*^9}, {3.8766647495812597`*^9, 3.876664769616045*^9}, {
   3.876665127591157*^9, 3.876665150581052*^9}, {3.8766653393125753`*^9, 
   3.876665351861246*^9}, {3.87666540885253*^9, 3.876665420638647*^9}, {
   3.876665503860876*^9, 3.87666550632882*^9}, {3.876665665783495*^9, 
   3.876665710539073*^9}, {3.876665749583544*^9, 3.87666590683078*^9}, {
   3.876665968547861*^9, 3.876665985161601*^9}, {3.8766678107917967`*^9, 
   3.876667865755314*^9}, {3.876667898431325*^9, 3.87666790876721*^9}, {
   3.8766680681202793`*^9, 3.876668078815722*^9}, {3.876668140572316*^9, 
   3.8766682000864162`*^9}, {3.8766682371724787`*^9, 
   3.8766683670767384`*^9}, {3.876668409712365*^9, 3.876668495755938*^9}, {
   3.876668589893342*^9, 3.876668609613043*^9}, {3.8766687649075823`*^9, 
   3.8766687674887543`*^9}, {3.876669893657606*^9, 3.876669894268611*^9}, 
   3.876670804449214*^9, {3.876671251938546*^9, 3.876671253001951*^9}, {
   3.876673390510161*^9, 3.8766734205481977`*^9}, {3.876673467858308*^9, 
   3.8766734734943047`*^9}, {3.8766735051128073`*^9, 3.876673524277205*^9}, {
   3.8766735625500383`*^9, 3.876673594122711*^9}, {3.876673725877789*^9, 
   3.876673726236993*^9}, {3.8766737957344847`*^9, 3.876673798612269*^9}, {
   3.876673830806992*^9, 3.8766738335408297`*^9}, {3.876673873193828*^9, 
   3.876673875740285*^9}, {3.876673954599743*^9, 3.8766739661702337`*^9}, {
   3.876674006698427*^9, 3.8766740866001596`*^9}, {3.876674282814458*^9, 
   3.8766743046838913`*^9}, {3.876674344473085*^9, 3.876674355595058*^9}, {
   3.8766744097434273`*^9, 3.876674461193392*^9}, {3.876674525053142*^9, 
   3.8766745692095613`*^9}, {3.87667632454465*^9, 3.876676334285717*^9}, {
   3.876676455912569*^9, 3.876676496210413*^9}, {3.87667653676248*^9, 
   3.876676651732917*^9}, {3.8766768066389093`*^9, 3.876676848292199*^9}, {
   3.876676927041059*^9, 3.8766769878741493`*^9}, {3.876677071547516*^9, 
   3.876677166282144*^9}, {3.876677224846057*^9, 3.876677335659936*^9}, {
   3.876677584362318*^9, 3.876677586167149*^9}, 3.876677646650096*^9, {
   3.87667771962998*^9, 3.876677722060142*^9}, {3.876705334610705*^9, 
   3.876705388551681*^9}, {3.876705429653779*^9, 3.876705472247266*^9}, {
   3.876705531975281*^9, 3.8767055808212557`*^9}, {3.876708120153781*^9, 
   3.87670812052979*^9}, {3.876709827849914*^9, 3.876709837587537*^9}, {
   3.876709947345538*^9, 3.876709980297827*^9}, {3.876714726142877*^9, 
   3.876714727078082*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c88f1fc4-ea51-4af4-a051-4891c346787d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{
   "show", " ", "the", " ", "composition", " ", "of", " ", "TE", " ", "and", 
    " ", "TM", " ", "of", " ", "linear", " ", "polarization", " ", "and", " ",
     "circular", " ", "polarization"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.876671653764264*^9, 
  3.876671697578801*^9}},ExpressionUUID->"4489477e-051c-421b-8455-\
02221b3b628d"],

Cell["\<\
Next, try to illustrate the waves when they have both TE and TM components:\
\>", "Text",
 CellChangeTimes->{{3.876705675952227*^9, 
  3.876705727387549*^9}},ExpressionUUID->"9276aefe-2676-45e1-a655-\
78f1a5214771"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "-", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
          RowBox[{"1", "+", 
           SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], ")"}],
            "*", 
           FractionBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "t"], "]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "2", 
                    
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "z"}], " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "reflection"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[Perpendicular]"], "2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "transmission"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", " ", "1", ",", " ", 
                RowBox[{"-", "2"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Blue", ",", "Magenta", ",", "Green", ",", "Green", ",", 
               "Magenta", ",", "Magenta"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[Perpendicular]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[DoubleVerticalBar]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\
\"", ",", 
                 SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[DoubleVerticalBar]\)]\
\)\>\"", ",", 
                 SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}], ",", 
       RowBox[{"AnimationRate", "->", ".5"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1.2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876663797027026*^9, 3.8766638212899427`*^9}, {3.876664123496724*^9, 
   3.876664127404305*^9}, {3.876664157971575*^9, 3.876664176244535*^9}, {
   3.87666421561935*^9, 3.8766642701395493`*^9}, {3.876664301029516*^9, 
   3.876664337157278*^9}, {3.8766644072140713`*^9, 3.8766645662838583`*^9}, {
   3.876664629462276*^9, 3.876664637077113*^9}, {3.8766646785245113`*^9, 
   3.876664704331273*^9}, {3.8766647495812597`*^9, 3.876664769616045*^9}, {
   3.876665127591157*^9, 3.876665150581052*^9}, {3.8766653393125753`*^9, 
   3.876665351861246*^9}, {3.87666540885253*^9, 3.876665420638647*^9}, {
   3.876665503860876*^9, 3.87666550632882*^9}, {3.876665665783495*^9, 
   3.876665710539073*^9}, {3.876665749583544*^9, 3.87666590683078*^9}, {
   3.876665968547861*^9, 3.876665985161601*^9}, {3.8766678107917967`*^9, 
   3.876667865755314*^9}, {3.876667898431325*^9, 3.87666790876721*^9}, {
   3.8766680681202793`*^9, 3.876668078815722*^9}, {3.876668140572316*^9, 
   3.8766682000864162`*^9}, {3.8766682371724787`*^9, 
   3.8766683670767384`*^9}, {3.876668409712365*^9, 3.876668495755938*^9}, {
   3.876668589893342*^9, 3.876668609613043*^9}, {3.8766687649075823`*^9, 
   3.8766687674887543`*^9}, {3.876669893657606*^9, 3.876669894268611*^9}, 
   3.876670804449214*^9, {3.876671251938546*^9, 3.876671253001951*^9}, {
   3.876673390510161*^9, 3.8766734205481977`*^9}, {3.876673467858308*^9, 
   3.8766734734943047`*^9}, {3.8766735051128073`*^9, 3.876673524277205*^9}, {
   3.8766735625500383`*^9, 3.876673594122711*^9}, {3.876673725877789*^9, 
   3.876673726236993*^9}, {3.8766737957344847`*^9, 3.876673798612269*^9}, {
   3.876673830806992*^9, 3.8766738335408297`*^9}, {3.876673873193828*^9, 
   3.876673875740285*^9}, {3.876673954599743*^9, 3.8766739661702337`*^9}, {
   3.876674006698427*^9, 3.8766740866001596`*^9}, {3.876674282814458*^9, 
   3.8766743046838913`*^9}, {3.876674344473085*^9, 3.876674355595058*^9}, {
   3.8766744097434273`*^9, 3.876674461193392*^9}, {3.876674525053142*^9, 
   3.8766745692095613`*^9}, {3.87667632454465*^9, 3.876676334285717*^9}, {
   3.876676455912569*^9, 3.876676496210413*^9}, {3.87667653676248*^9, 
   3.876676651732917*^9}, {3.8766768066389093`*^9, 3.876676848292199*^9}, {
   3.876676927041059*^9, 3.8766769878741493`*^9}, {3.876677071547516*^9, 
   3.876677166282144*^9}, {3.876677224846057*^9, 3.876677335659936*^9}, {
   3.876677584362318*^9, 3.876677586167149*^9}, 3.876677646650096*^9, {
   3.87667771962998*^9, 3.876677722060142*^9}, {3.876705334610705*^9, 
   3.876705388551681*^9}, {3.876705429653779*^9, 3.876705472247266*^9}, {
   3.876705531975281*^9, 3.8767055808212557`*^9}, {3.876705837348482*^9, 
   3.876705890132533*^9}, {3.876705932582389*^9, 3.876705946091922*^9}, {
   3.876706004835857*^9, 3.876706018390922*^9}, {3.876706055402196*^9, 
   3.8767060834171667`*^9}, {3.876706987555134*^9, 3.876707002940723*^9}, {
   3.8767072125545588`*^9, 3.876707253599202*^9}, {3.8767073125637074`*^9, 
   3.8767073356254473`*^9}, {3.876707431849859*^9, 3.87670744688358*^9}, {
   3.876708109565275*^9, 3.876708127200757*^9}, {3.876709125374354*^9, 
   3.876709125503606*^9}, {3.87670933353863*^9, 3.876709368561799*^9}, {
   3.876709412454234*^9, 3.8767094153851833`*^9}, {3.876710172907527*^9, 
   3.876710301894203*^9}, {3.876710761958078*^9, 3.876710800681974*^9}, {
   3.876711004252182*^9, 3.876711025230687*^9}, {3.876711383414774*^9, 
   3.876711397659849*^9}, {3.8767114625796547`*^9, 3.876711471709907*^9}, {
   3.876711908006599*^9, 3.876711909340996*^9}, {3.8767119416863337`*^9, 
   3.876711942294475*^9}, {3.8767119902339354`*^9, 3.8767119931871033`*^9}, {
   3.876714714314868*^9, 3.876714720246048*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"201eded0-5e7d-482b-8b3a-6853028e0ac5"],

Cell["\<\
Of course, the incident wave can have circular or the more general elliptical \
polarization: (TODO: verify the math)\
\>", "Text",
 CellChangeTimes->{{3.876712023338475*^9, 
  3.876712138350123*^9}},ExpressionUUID->"d9a2a991-6cc4-4ef6-b179-\
0eb6f09e7893"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "-", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
          RowBox[{"1", "+", 
           SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], ")"}],
            "*", 
           FractionBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "t"], "]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "2", 
                    
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[ImaginaryJ]", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "z"}], " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "reflection"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], " ", ",", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[Perpendicular]"], "2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"Tan", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}]}], ",", "0", ",", 
                    "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "transmission"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", " ", "1", ",", " ", 
                RowBox[{"-", "2"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Blue", ",", "Magenta", ",", "Green", ",", "Green", ",", 
               "Magenta", ",", "Magenta"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[Perpendicular]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[DoubleVerticalBar]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\
\"", ",", 
                 SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[DoubleVerticalBar]\)]\
\)\>\"", ",", 
                 SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}], ",", 
       RowBox[{"AnimationRate", "->", ".5"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1.2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876663797027026*^9, 3.8766638212899427`*^9}, {3.876664123496724*^9, 
   3.876664127404305*^9}, {3.876664157971575*^9, 3.876664176244535*^9}, {
   3.87666421561935*^9, 3.8766642701395493`*^9}, {3.876664301029516*^9, 
   3.876664337157278*^9}, {3.8766644072140713`*^9, 3.8766645662838583`*^9}, {
   3.876664629462276*^9, 3.876664637077113*^9}, {3.8766646785245113`*^9, 
   3.876664704331273*^9}, {3.8766647495812597`*^9, 3.876664769616045*^9}, {
   3.876665127591157*^9, 3.876665150581052*^9}, {3.8766653393125753`*^9, 
   3.876665351861246*^9}, {3.87666540885253*^9, 3.876665420638647*^9}, {
   3.876665503860876*^9, 3.87666550632882*^9}, {3.876665665783495*^9, 
   3.876665710539073*^9}, {3.876665749583544*^9, 3.87666590683078*^9}, {
   3.876665968547861*^9, 3.876665985161601*^9}, {3.8766678107917967`*^9, 
   3.876667865755314*^9}, {3.876667898431325*^9, 3.87666790876721*^9}, {
   3.8766680681202793`*^9, 3.876668078815722*^9}, {3.876668140572316*^9, 
   3.8766682000864162`*^9}, {3.8766682371724787`*^9, 
   3.8766683670767384`*^9}, {3.876668409712365*^9, 3.876668495755938*^9}, {
   3.876668589893342*^9, 3.876668609613043*^9}, {3.8766687649075823`*^9, 
   3.8766687674887543`*^9}, {3.876669893657606*^9, 3.876669894268611*^9}, 
   3.876670804449214*^9, {3.876671251938546*^9, 3.876671253001951*^9}, {
   3.876673390510161*^9, 3.8766734205481977`*^9}, {3.876673467858308*^9, 
   3.8766734734943047`*^9}, {3.8766735051128073`*^9, 3.876673524277205*^9}, {
   3.8766735625500383`*^9, 3.876673594122711*^9}, {3.876673725877789*^9, 
   3.876673726236993*^9}, {3.8766737957344847`*^9, 3.876673798612269*^9}, {
   3.876673830806992*^9, 3.8766738335408297`*^9}, {3.876673873193828*^9, 
   3.876673875740285*^9}, {3.876673954599743*^9, 3.8766739661702337`*^9}, {
   3.876674006698427*^9, 3.8766740866001596`*^9}, {3.876674282814458*^9, 
   3.8766743046838913`*^9}, {3.876674344473085*^9, 3.876674355595058*^9}, {
   3.8766744097434273`*^9, 3.876674461193392*^9}, {3.876674525053142*^9, 
   3.8766745692095613`*^9}, {3.87667632454465*^9, 3.876676334285717*^9}, {
   3.876676455912569*^9, 3.876676496210413*^9}, {3.87667653676248*^9, 
   3.876676651732917*^9}, {3.8766768066389093`*^9, 3.876676848292199*^9}, {
   3.876676927041059*^9, 3.8766769878741493`*^9}, {3.876677071547516*^9, 
   3.876677166282144*^9}, {3.876677224846057*^9, 3.876677335659936*^9}, {
   3.876677584362318*^9, 3.876677586167149*^9}, 3.876677646650096*^9, {
   3.87667771962998*^9, 3.876677722060142*^9}, {3.876705334610705*^9, 
   3.876705388551681*^9}, {3.876705429653779*^9, 3.876705472247266*^9}, {
   3.876705531975281*^9, 3.8767055808212557`*^9}, {3.876705837348482*^9, 
   3.876705890132533*^9}, {3.876705932582389*^9, 3.876705946091922*^9}, {
   3.876706004835857*^9, 3.876706018390922*^9}, {3.876706055402196*^9, 
   3.8767060834171667`*^9}, {3.876706987555134*^9, 3.876707002940723*^9}, {
   3.8767072125545588`*^9, 3.876707253599202*^9}, {3.8767073125637074`*^9, 
   3.8767073356254473`*^9}, {3.876707431849859*^9, 3.87670744688358*^9}, {
   3.876708109565275*^9, 3.876708127200757*^9}, {3.876709125374354*^9, 
   3.876709125503606*^9}, {3.87670933353863*^9, 3.876709368561799*^9}, {
   3.876709412454234*^9, 3.8767094153851833`*^9}, {3.876710172907527*^9, 
   3.876710301894203*^9}, {3.876710761958078*^9, 3.876710800681974*^9}, {
   3.876711004252182*^9, 3.876711025230687*^9}, {3.876711383414774*^9, 
   3.876711397659849*^9}, {3.8767114625796547`*^9, 3.876711471709907*^9}, {
   3.876711908006599*^9, 3.876711909340996*^9}, {3.8767119416863337`*^9, 
   3.876711942294475*^9}, {3.8767119902339354`*^9, 3.8767119931871033`*^9}, {
   3.876712141495748*^9, 3.876712163090575*^9}, {3.8767147039130783`*^9, 
   3.876714710399033*^9}, {3.877047587765235*^9, 3.8770477168000717`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"0178672e-8d9d-482a-bfd1-31d114a80224"],

Cell["\<\
It\[CloseCurlyQuote]s interesting that at the Brewster Angle, the parallel \
component of the reflected wave vanishes and the wave is strictly TE.\
\>", "Text",
 CellChangeTimes->{{3.8767122334698467`*^9, 3.8767122400766277`*^9}, {
  3.876712277195858*^9, 
  3.8767123215329123`*^9}},ExpressionUUID->"9a730a6e-0b20-4c12-adc9-\
f7bc40728843"],

Cell["\<\
How does the reflected wave look like? Let\[CloseCurlyQuote]s try linearly \
polarized incident wave:\
\>", "Text",
 CellChangeTimes->{{3.876714373597271*^9, 
  3.8767144077998667`*^9}},ExpressionUUID->"2f522c20-001e-429a-86ef-\
99d62277b3b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldAlongZ", "[", "phasor1_", "]"}], ":=", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ComplexExpand", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"phasor1", "*", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
         " ", "/.", 
         RowBox[{"\[Omega]", "->", 
          RowBox[{"0.6", "\[Pi]"}]}]}], "]"}], "//", "FullSimplify"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.87723077685682*^9, 3.877230786894883*^9}, {
  3.877230825172983*^9, 3.877230864643568*^9}, {3.877230970870327*^9, 
  3.877231021302581*^9}},
 CellLabel->
  "In[1609]:=",ExpressionUUID->"91f4a374-f5ed-4e36-b862-61266004f2bb"],

Cell[BoxData[
 RowBox[{"FieldAlongZ", "[", 
  RowBox[{"2", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryJ]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "z"}], "+", 
       FractionBox["\[Pi]", "4"]}], ")"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.8772307977633753`*^9, 3.877230806557481*^9}},
 CellLabel->
  "In[1615]:=",ExpressionUUID->"f1f592c9-8197-498c-a484-0be8588cfa21"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["k", "1"], ",", 
     SubscriptBox["\[Eta]", "1"], ",", 
     SubscriptBox["\[Theta]", "t"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], ",", 
     SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Animate", "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          SubscriptBox["k", "1"], "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["k", "2"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Eta]", "1"], "=", "2"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Theta]", "t"], "=", 
          RowBox[{"N", "[", 
           RowBox[{"ArcSin", "[", 
            FractionBox[
             RowBox[{"Sin", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "2"], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "-", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[Theta]", "i"], "]"}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{"N", "[", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}], 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
             SqrtBox[
              RowBox[{"4", "-", 
               SuperscriptBox[
                RowBox[{"Sin", "[", 
                 SubscriptBox["\[Theta]", "i"], "]"}], "2"]}]]}]], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[Perpendicular]"], "=", 
          RowBox[{"1", "+", 
           SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], ")"}],
            "*", 
           FractionBox[
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "i"], "]"}], 
            RowBox[{"Cos", "[", 
             SubscriptBox["\[Theta]", "t"], "]"}]]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Legended", "[", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}]}],
                     "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"2", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "+", 
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"], "2", 
                    
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}]}],
                     "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}], ",", 
                    "                                      ", 
                    "\[IndentingNewLine]", 
                    "                                   ", 
                    RowBox[{
                    RowBox[{"z", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], 
                    FractionBox["2", 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}], 
                    FractionBox[
                    RowBox[{
                    SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"], 
                    "2"}], 
                    SubscriptBox["\[Eta]", "1"]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryJ]"}], " ", 
                    SubscriptBox["k", "1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", " ", 
                    RowBox[{"Sin", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}], "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"Cos", "[", 
                    SubscriptBox["\[Theta]", "i"], "]"}]}]}], ")"}]}]], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}]}],
                     "]"}]}], " ", "/.", 
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
                    "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "2"}], ",", "0", ",", "0.1"}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{"points", " ", "of", " ", "incidence"}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"plane", " ", "of", " ", "interface"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightBlue", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"plane", " ", "of", " ", "incidence"}], " ", "*)"}], 
               "\[IndentingNewLine]", "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{"1.5", ",", " ", "1", ",", " ", 
                RowBox[{"-", "2"}]}], "}"}]}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", " ", 
             
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Blue", ",", "Magenta", ",", "Green", ",", "Green", ",", 
               "Magenta", ",", "Magenta"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(i\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "i"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(t\)]\)\>\"", ",", 
                 SubscriptBox["\[Theta]", "t"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[Perpendicular]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[Perpendicular]"]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(\
\[DoubleVerticalBar]\)]\)\>\"", ",", 
                 SubscriptBox["\[CapitalGamma]", "\[DoubleVerticalBar]"]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[Perpendicular]\)]\)\>\
\"", ",", 
                 SubscriptBox["\[Tau]", "\[Perpendicular]"]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(\[DoubleVerticalBar]\)]\
\)\>\"", ",", 
                 SubscriptBox["\[Tau]", "\[DoubleVerticalBar]"]}], "}"}]}], 
              "}"}]}], "]"}]}], "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
       RowBox[{"AnimationRunning", "->", "False"}], ",", 
       RowBox[{"AnimationRate", "->", ".5"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Theta]", "i"], ",", 
         FractionBox["\[Pi]", "4"]}], "}"}], ",", "0", ",", "1.2"}], "}"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8763040143520517`*^9, 3.8763040176894407`*^9}, {
   3.876304546543413*^9, 3.876304659807661*^9}, {3.8763047425218697`*^9, 
   3.87630486081819*^9}, {3.8763048990516577`*^9, 3.8763049026560926`*^9}, {
   3.876305008200059*^9, 3.876305046565456*^9}, {3.876314312404649*^9, 
   3.8763144908844*^9}, {3.876314632230011*^9, 3.876314679840925*^9}, {
   3.876314725210867*^9, 3.876314806291541*^9}, {3.876315011680686*^9, 
   3.8763150326862717`*^9}, {3.8763150674937*^9, 3.876315092320692*^9}, {
   3.876315328624445*^9, 3.876315333400044*^9}, {3.8763154654875193`*^9, 
   3.876315470369225*^9}, {3.876315539634663*^9, 3.876315609239135*^9}, {
   3.8763157528001003`*^9, 3.87631578974681*^9}, {3.8763158875989037`*^9, 
   3.8763159419211893`*^9}, {3.876316025088668*^9, 3.8763160517227983`*^9}, {
   3.876316097699139*^9, 3.8763160984134197`*^9}, {3.876316296456255*^9, 
   3.8763163373649817`*^9}, {3.876316621504921*^9, 3.8763166504675827`*^9}, {
   3.876319762376652*^9, 3.876319790278256*^9}, {3.876319836344208*^9, 
   3.87631983899284*^9}, {3.876319905019815*^9, 3.87631993771378*^9}, {
   3.876320001339789*^9, 3.876320046677697*^9}, {3.8763200928437967`*^9, 
   3.876320099763988*^9}, {3.876320153096369*^9, 3.876320181824377*^9}, {
   3.876320247697659*^9, 3.876320267551981*^9}, {3.8763203539447393`*^9, 
   3.8763203621809263`*^9}, {3.876322102985497*^9, 3.876322193278879*^9}, {
   3.876322269303959*^9, 3.876322365348987*^9}, {3.876322517813752*^9, 
   3.876322517969946*^9}, {3.87632255040405*^9, 3.876322586168674*^9}, {
   3.8763226581059723`*^9, 3.876322711093102*^9}, {3.876323237863345*^9, 
   3.876323346961961*^9}, {3.876625554346489*^9, 3.876625559462081*^9}, {
   3.876626588806492*^9, 3.87662663852393*^9}, {3.876627148654307*^9, 
   3.876627149919409*^9}, {3.8766304743744*^9, 3.8766304864626923`*^9}, {
   3.876630616929839*^9, 3.876630617754642*^9}, {3.8766307020971117`*^9, 
   3.876630718845001*^9}, {3.8766308805624638`*^9, 3.8766308902464123`*^9}, {
   3.876631521008854*^9, 3.876631522658683*^9}, 3.876631882165576*^9, {
   3.876631913664857*^9, 3.87663205039069*^9}, {3.876632188539185*^9, 
   3.8766322183158007`*^9}, {3.87663239220791*^9, 3.876632440689165*^9}, {
   3.876632495063211*^9, 3.87663252714789*^9}, {3.876639350503009*^9, 
   3.876639361760314*^9}, {3.876639403802309*^9, 3.87663945171441*^9}, 
   3.876641050127941*^9, {3.87664110599997*^9, 3.876641115872909*^9}, {
   3.876641163958356*^9, 3.876641218573654*^9}, {3.8766412675302362`*^9, 
   3.8766412730423594`*^9}, {3.8766414591977377`*^9, 3.876641467846339*^9}, {
   3.8766415750175962`*^9, 3.876641598914949*^9}, {3.8766416557537127`*^9, 
   3.876641859640806*^9}, {3.876641908498748*^9, 3.876641908839657*^9}, {
   3.876642332187462*^9, 3.8766423696776457`*^9}, 3.876642401124507*^9, {
   3.876642736200794*^9, 3.876642818733934*^9}, {3.8766440212407312`*^9, 
   3.8766440394618893`*^9}, {3.876644109783724*^9, 3.876644208952549*^9}, {
   3.876644249456319*^9, 3.87664425161617*^9}, {3.876644282111321*^9, 
   3.876644284091886*^9}, {3.876644339886745*^9, 3.876644377554359*^9}, {
   3.876644469983876*^9, 3.876644510281526*^9}, {3.8766445462936563`*^9, 
   3.876644548339623*^9}, {3.8766448981560183`*^9, 3.876645009236931*^9}, {
   3.876645088441963*^9, 3.876645096904087*^9}, {3.876645787686713*^9, 
   3.876645849571143*^9}, {3.876645901426409*^9, 3.876645947201336*^9}, {
   3.876646030266635*^9, 3.8766460897011127`*^9}, {3.876646683414706*^9, 
   3.8766468066173553`*^9}, {3.8766468469125557`*^9, 3.876646889505456*^9}, {
   3.876646930622864*^9, 3.876646941680194*^9}, {3.876647114288666*^9, 
   3.87664717099682*^9}, {3.876647773286675*^9, 3.8766478666711397`*^9}, {
   3.87664793610315*^9, 3.8766479945948353`*^9}, {3.876648111258974*^9, 
   3.876648205350746*^9}, {3.8766484006214037`*^9, 3.876648401413616*^9}, {
   3.876648453651163*^9, 3.8766485040353107`*^9}, {3.876648723590431*^9, 
   3.876648725531372*^9}, {3.876648856065446*^9, 3.8766488733503838`*^9}, {
   3.876648945883418*^9, 3.876648987179668*^9}, {3.876657937915471*^9, 
   3.876658091737398*^9}, {3.876658493336708*^9, 3.8766585265397043`*^9}, {
   3.876658606033534*^9, 3.8766586093828983`*^9}, {3.876658678361738*^9, 
   3.876658690716082*^9}, {3.8766591962289953`*^9, 3.876659209417736*^9}, 
   3.8766592400216923`*^9, 3.876661371619914*^9, {3.8766619725482683`*^9, 
   3.876662028759676*^9}, {3.87666207468577*^9, 3.8766620771414423`*^9}, {
   3.876662403560351*^9, 3.876662481317383*^9}, 3.87666251190617*^9, {
   3.8766625521698637`*^9, 3.876662569054536*^9}, {3.876662652036544*^9, 
   3.8766627679802628`*^9}, {3.876662865869052*^9, 3.876662900756775*^9}, 
   3.876662990728821*^9, {3.876663049841655*^9, 3.876663058614254*^9}, {
   3.8766634797695513`*^9, 3.876663500341588*^9}, {3.8766635328183928`*^9, 
   3.876663555599996*^9}, {3.876663657065736*^9, 3.876663688366269*^9}, {
   3.876663797027026*^9, 3.8766638212899427`*^9}, {3.876664123496724*^9, 
   3.876664127404305*^9}, {3.876664157971575*^9, 3.876664176244535*^9}, {
   3.87666421561935*^9, 3.8766642701395493`*^9}, {3.876664301029516*^9, 
   3.876664337157278*^9}, {3.8766644072140713`*^9, 3.8766645662838583`*^9}, {
   3.876664629462276*^9, 3.876664637077113*^9}, {3.8766646785245113`*^9, 
   3.876664704331273*^9}, {3.8766647495812597`*^9, 3.876664769616045*^9}, {
   3.876665127591157*^9, 3.876665150581052*^9}, {3.8766653393125753`*^9, 
   3.876665351861246*^9}, {3.87666540885253*^9, 3.876665420638647*^9}, {
   3.876665503860876*^9, 3.87666550632882*^9}, {3.876665665783495*^9, 
   3.876665710539073*^9}, {3.876665749583544*^9, 3.87666590683078*^9}, {
   3.876665968547861*^9, 3.876665985161601*^9}, {3.8766678107917967`*^9, 
   3.876667865755314*^9}, {3.876667898431325*^9, 3.87666790876721*^9}, {
   3.8766680681202793`*^9, 3.876668078815722*^9}, {3.876668140572316*^9, 
   3.8766682000864162`*^9}, {3.8766682371724787`*^9, 
   3.8766683670767384`*^9}, {3.876668409712365*^9, 3.876668495755938*^9}, {
   3.876668589893342*^9, 3.876668609613043*^9}, {3.8766687649075823`*^9, 
   3.8766687674887543`*^9}, {3.876669893657606*^9, 3.876669894268611*^9}, 
   3.876670804449214*^9, {3.876671251938546*^9, 3.876671253001951*^9}, {
   3.876673390510161*^9, 3.8766734205481977`*^9}, {3.876673467858308*^9, 
   3.8766734734943047`*^9}, {3.8766735051128073`*^9, 3.876673524277205*^9}, {
   3.8766735625500383`*^9, 3.876673594122711*^9}, {3.876673725877789*^9, 
   3.876673726236993*^9}, {3.8766737957344847`*^9, 3.876673798612269*^9}, {
   3.876673830806992*^9, 3.8766738335408297`*^9}, {3.876673873193828*^9, 
   3.876673875740285*^9}, {3.876673954599743*^9, 3.8766739661702337`*^9}, {
   3.876674006698427*^9, 3.8766740866001596`*^9}, {3.876674282814458*^9, 
   3.8766743046838913`*^9}, {3.876674344473085*^9, 3.876674355595058*^9}, {
   3.8766744097434273`*^9, 3.876674461193392*^9}, {3.876674525053142*^9, 
   3.8766745692095613`*^9}, {3.87667632454465*^9, 3.876676334285717*^9}, {
   3.876676455912569*^9, 3.876676496210413*^9}, {3.87667653676248*^9, 
   3.876676651732917*^9}, {3.8766768066389093`*^9, 3.876676848292199*^9}, {
   3.876676927041059*^9, 3.8766769878741493`*^9}, {3.876677071547516*^9, 
   3.876677166282144*^9}, {3.876677224846057*^9, 3.876677335659936*^9}, {
   3.876677584362318*^9, 3.876677586167149*^9}, 3.876677646650096*^9, {
   3.87667771962998*^9, 3.876677722060142*^9}, {3.876705334610705*^9, 
   3.876705388551681*^9}, {3.876705429653779*^9, 3.876705472247266*^9}, {
   3.876705531975281*^9, 3.8767055808212557`*^9}, {3.876705837348482*^9, 
   3.876705890132533*^9}, {3.876705932582389*^9, 3.876705946091922*^9}, {
   3.876706004835857*^9, 3.876706018390922*^9}, {3.876706055402196*^9, 
   3.8767060834171667`*^9}, {3.876706987555134*^9, 3.876707002940723*^9}, {
   3.8767072125545588`*^9, 3.876707253599202*^9}, {3.8767073125637074`*^9, 
   3.8767073356254473`*^9}, {3.876707431849859*^9, 3.87670744688358*^9}, {
   3.876708109565275*^9, 3.876708127200757*^9}, {3.876709125374354*^9, 
   3.876709125503606*^9}, {3.87670933353863*^9, 3.876709368561799*^9}, {
   3.876709412454234*^9, 3.8767094153851833`*^9}, {3.876710172907527*^9, 
   3.876710301894203*^9}, {3.876710761958078*^9, 3.876710800681974*^9}, {
   3.876711004252182*^9, 3.876711025230687*^9}, {3.876711383414774*^9, 
   3.876711397659849*^9}, {3.8767114625796547`*^9, 3.876711471709907*^9}, {
   3.876711908006599*^9, 3.876711909340996*^9}, {3.8767119416863337`*^9, 
   3.876711942294475*^9}, {3.8767119902339354`*^9, 3.8767119931871033`*^9}, {
   3.876714462681808*^9, 3.876714560221848*^9}, {3.876714696804969*^9, 
   3.876714699202345*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"84bce7bc-596d-410f-bb07-34529d2e8329"],

Cell["\<\
So even if the incident wave and the reflected wave are linearly polarized, \
the sum of them, i.e. the total wave, is elliptically polarized.\
\>", "CodeText",
 CellChangeTimes->{{3.876714747790627*^9, 
  3.876714786509159*^9}},ExpressionUUID->"4bba1490-8b8c-4e25-8df5-\
40817f3d3adf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multilayer Structures", "Chapter",
 CellChangeTimes->{{3.876327851515777*^9, 
  3.8763278613139668`*^9}},ExpressionUUID->"17cd6b31-529b-4e46-afe3-\
864d14bffa13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldsAlongZWith2BoundariesShowTotal", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xAbs", ",", "yAbs", ",", "xRange", ",", "yRange"}], "}"}], ",", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAbs", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"y1", "/.", 
         RowBox[{"z", "->", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"xAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "xAbs"}], "*", "2"}], ",", 
           RowBox[{"xAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yRange", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"yAbs", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "yAbs"}], "*", "2"}], ",", 
           RowBox[{"yAbs", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"xRange", ",", "yRange", ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Animate", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"x1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "x1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[CapitalGamma]", " ", "z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Magenta", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "x1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "y1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z1", "+", 
                    RowBox[{"\[CapitalGamma]", " ", "z1"}]}], ")"}], 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", 
                    RowBox[{"-", "5"}], ",", "0", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "zz"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], " ", "x1", 
                    " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], ",", 
                    RowBox[{"y", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "y1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}], " ", ",", 
                    RowBox[{"zz", "+", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[CapitalGamma]"}], ")"}], "z1", " ", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
                    "]"}]}]}], "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Omega]", "->", 
                    RowBox[{"0.6", "\[Pi]"}]}], ",", 
                    RowBox[{"z", "->", "zz"}]}], "}"}]}]}], "}"}], "]"}]}], 
                    "}"}], "\[IndentingNewLine]", "}"}]}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "z"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"z", ",", "0", ",", "10", ",", "0.2"}], "}"}]}], 
                   "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightPink", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"LightGreen", ",", " ", 
                  RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                  RowBox[{"InfinitePlane", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "5"}], "}"}]}], "}"}], 
                   "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Axes", "->", "True"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
               "}"}]}], ",", " ", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{"xRange", ",", "yRange", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ViewVertical", "->", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "1", ",", " ", "0"}], "}"}]}], ",", " ", 
             RowBox[{"ViewPoint", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "5"}], ",", "2", ",", " ", "5"}], "}"}]}], " ", 
             ",", 
             RowBox[{"ImageSize", "->", "Large"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{"plotting", " ", "options"}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "6.66"}], "}"}], ",", 
           RowBox[{"AnimationRunning", "->", "False"}], ",", 
           RowBox[{"AnimationRate", "->", "0.5"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalGamma]", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz08sggEABfDIzBywuWSyUa3aNDZb1mRUojSztLYOjSZMs/VPtLFJI9ah
cGhTzJKDP3GgdeCQGjYOms0mcrIVmjlxC8v3vsPb7/IO7zXozaqxYgqFUkcE
pja+9aLMpzibYVsgS+eYghNijR06lJRFaOc+LsNopDsJU7+Dd2TPNf4Oh/2x
HLzndzHFhAkjgwcVYY8EetTXUrhj9PbBOe06aVvQb4XTzSoblBvOHVCwTV+A
KUVNHnI6aUUSQpVJVgbdzzZSoaB8Hh6PVpDKQ/VL0JQ3uKHUx2qREbYqqAJI
a5/tgFFFoxTmhOnVXuygctbgbYC7BU9PxKRxZ7i2n5B9yaDDXFOMA02SEi78
GrLw4cBEQQqPjJFJeDVjdkHnw16PEr93X9RQFyjVQj2zmtRIt+rgR1I0At80
lSsw9ZPYhNl0IQh58osQ9Ln2D6H95pXU93RwBr1/VXH4D0JB9k0=
  "],
 CellLabel->
  "In[2082]:=",ExpressionUUID->"72d9c05d-ebca-4057-89e9-8ef2f0cdf550"],

Cell[BoxData[
 RowBox[{"FieldsAlongZWith2BoundariesShowTotal", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"2", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "z"}]]}], ",", "0"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.877274411973771*^9, 3.8772744160238028`*^9}, {
  3.877275020373158*^9, 3.877275022143756*^9}},
 CellLabel->
  "In[2083]:=",ExpressionUUID->"48f6e18d-e478-4965-95e4-83b5e2a4bf8e"],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{
  3.877418181971136*^9},ExpressionUUID->"42400f9d-d253-44a8-b861-\
64d18606e21d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Waveguides", "Chapter",
 CellChangeTimes->{{3.876808184912842*^9, 
  3.876808187090312*^9}},ExpressionUUID->"762a3d81-a99c-4cc8-b4ba-\
90ae4c89172d"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["E", "1"], 
          RowBox[{"Cos", "[", "x", "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", "y"}], "]"}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["E", "2"], 
          RowBox[{"Sin", "[", "x", "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", "y"}], "]"}]}], ")"}], "2"]}]], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["E", "1"], ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["E", "2"], ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877277015408526*^9, 3.877277260079734*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"439ef576-4717-4014-8f62-1a409eeb7ebf"],

Cell[BoxData[
 RowBox[{"VectorPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "y"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877277318546389*^9, 3.877277344148437*^9}, 
   3.877747056852583*^9},
 CellLabel->
  "In[576]:=",ExpressionUUID->"d8e24026-19c6-4c13-889c-8e203bb3fe3f"],

Cell[CellGroupData[{

Cell["TM Waves in Rectangular Waveguides", "Section",
 CellChangeTimes->{{3.8777923188454638`*^9, 
  3.877792333235497*^9}},ExpressionUUID->"23de55ed-303c-4c9c-9684-\
646bfe72b59c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     SuperscriptBox["h", "2"]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "0.01"}], ",", 
     RowBox[{"b", "=", "0.005"}], ",", 
     RowBox[{"m", "=", "1"}], ",", 
     RowBox[{"n", "=", "1"}], ",", 
     SuperscriptBox["h", "2"], ",", "f", ",", "\[Omega]", ",", "\[Gamma]"}], 
    "}"}], ",", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["h", "2"], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"5", " ", 
       SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"2", "\[Pi]", " ", "f"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", "=", 
      RowBox[{"\[ImaginaryJ]", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Omega]", "2"], 
          SubscriptBox["\[Mu]", "0"], 
          SubscriptBox["\[Epsilon]", "0"]}], "-", 
         SuperscriptBox["h", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         SqrtBox[
          RowBox[{
           SubscriptBox["\[Mu]", "0"], 
           SubscriptBox["\[Epsilon]", "0"]}]]}]], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["m", "a"], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["n", "b"], ")"}], "2"]}]]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      FractionBox["2", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["m", "a"], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["n", "b"], ")"}], "2"]}]]], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\[Gamma]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Gamma]", 
           SuperscriptBox["h", "2"]]}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[Gamma]"}], " ", "z"}]], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"z", "->", "0"}], ",", 
         RowBox[{"t", "->", "0"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"DensityPlot", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["\[Gamma]", 
             SuperscriptBox["h", "2"]]}], 
           RowBox[{"(", 
            FractionBox[
             RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "\[Gamma]"}], " ", "z"}]], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "b"}], "}"}], ",", 
         RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
         RowBox[{"ColorFunctionScaling", "->", "False"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
         FractionBox["2", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["m", "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["n", "b"], ")"}], "2"]}]]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", 
         FractionBox["1", "f"]}], "}"}]}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    SuperscriptBox["h", "2"], "]"}], ";", " ", 
   RowBox[{"RemoveSymbolize", "[", 
    TemplateBox[{
      SuperscriptBox["h", "2"]},
     "NotationTemplateTag"], "]"}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Remove", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "work", " ", "well", " ", "here"}], 
    ",", " ", 
    RowBox[{"why", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy1kowwEAx/FNjpUjLSKiHE+Mh2WSLTkeGBnGC5INk3NM2sLSZNaUIpTr
L6xZ/Vli8TpHzCRpYklJybHMWSY1xn7/h1+ffg/fuLoOocSHRqMlegdLGcGi
4rvnHLLaVQ/5/KkWOGbXKmHpvX0cDpoWdND4ot6FwzbhHjSHDlggUeGi1DTd
u6Bny/AN3wtvfQVeLRFrYbBKwYiCe2s30dDg44iH0h9WMuRJRemwv+uAB/Ni
ivLhjqJGBDdlXxL4usFshP6/7haYcSyTwniOugumXgTJIXeWHIbPKWcj0HRI
TkJr4Mo07PvuIKBq37wIKz4l65Agts3Qc5NggVm9QSdQ3ulvg5HKsTN4njZ3
BfWjJbdQ92N+gIJk9yM0Hr04IUtMfMDL+Tu/Eq+5PHoAXFELQ6B1yR0OPZvh
STDz9JQFtUY9Gz4xSQ78EtdxIdvUTfnBb+fD8TYb5f42twy+0ZPKoYP72QBX
J/9aYYEzUQZHhlIpmbX2Hqj3ZCthZLNGBWMFuwNUP0FqoC7dQcm4Ll+m/kwl
5T/nGEOE
  "],
 CellLabel->"In[58]:=",ExpressionUUID->"06125814-b420-44d5-8b1f-6c91c5903c8d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Symbolize", "[", 
     TemplateBox[{
       SuperscriptBox["h", "2"]},
      "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", "0.01"}], ",", 
       RowBox[{"b", "=", "0.005"}], ",", 
       RowBox[{"m", "=", "1"}], ",", 
       RowBox[{"n", "=", "1"}], ",", 
       SuperscriptBox["h", "2"], ",", "f", ",", "\[Omega]", ",", "\[Gamma]"}],
       "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["h", "2"], "=", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"5", " ", 
         SuperscriptBox["10", "10"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"2", "\[Pi]", " ", "f"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"\[ImaginaryJ]", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Omega]", "2"], 
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]}], "-", 
           SuperscriptBox["h", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[Gamma]", 
               SuperscriptBox["h", "2"]]}], 
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
             RowBox[{"Cos", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[Gamma]"}], " ", "z"}]], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "0", ",", "b"}], "}"}], ",", 
           RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}]}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           FractionBox["1", "f"]}], "}"}]}], "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     SuperscriptBox["h", "2"], "]"}], ";", " ", 
    RowBox[{"RemoveSymbolize", "[", 
     TemplateBox[{
       SuperscriptBox["h", "2"]},
      "NotationTemplateTag"], "]"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Remove", " ", 
      RowBox[{"doesn", "'"}], "t", " ", "work", " ", "well", " ", "here"}], 
     ",", " ", 
     RowBox[{"why", "?"}]}], " ", "*)"}], "\[IndentingNewLine]"}]}]], "Input",\

 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797159793961*^9, 3.877797174539207*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"db9b4ee5-f499-47b0-8fe6-ab9d6298ae43"],

Cell[TextData[{
 "At ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "39ea1afb-1abd-45b3-8fbc-c7ea31b517c1"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["t", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "t = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1a8f3dc9-d1c6-44b9-98f9-c0887a283182"],
 ", the field intensity is 0 everywhere."
}], "CodeText",
 CellChangeTimes->{{3.877797334209578*^9, 
  3.8777973890293913`*^9}},ExpressionUUID->"369886d2-717c-472a-b8ff-\
8d62a2b15f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TMModeEFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex_", ",", "Ey_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "x"], ",", 
      SubscriptBox["E", "y"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ex", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "x"], ",", 
                  SubscriptBox["E", "y"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["E", "x"], ",", 
                SubscriptBox["E", "y"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{"a", "/.", "aR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", " ", "*", " ", "3"}]}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", "2"}]}], ",", " ", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
           RowBox[{"{", 
            RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"46bbb346-c3e1-42fb-a74e-7b55f65bb640"],

Cell[BoxData[
 RowBox[{"TMModeEFieldAtZ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8778587840206614`*^9, 3.8778587882453623`*^9}, {
   3.8778588353899813`*^9, 3.87785887821765*^9}, {3.8778589296155767`*^9, 
   3.877858945015944*^9}, {3.8778590312607183`*^9, 3.877859039077783*^9}, {
   3.877859110221397*^9, 3.877859139803851*^9}, {3.877859230342458*^9, 
   3.877859243342208*^9}, 3.8778624048321333`*^9, {3.877862451496204*^9, 
   3.877862452448283*^9}, {3.877862488071266*^9, 3.877862488791109*^9}, {
   3.877862519201618*^9, 3.8778625198724337`*^9}, 3.877867750766747*^9, 
   3.8778715797211447`*^9},
 CellLabel->
  "In[1038]:=",ExpressionUUID->"a47c1ab7-26ed-4d98-88b4-bd1db3754bef"],

Cell[TextData[{
 "Notice how the magnitude of the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["E", "TB"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\textbf{E}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dd087e48-0441-4c66-98ca-856a0e49d784"],
 " field changes as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["f", "TI"], TraditionalForm], "errors" -> {}, "input" -> "f", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3da4745d-6930-4af6-8e25-61c1b6402ebe"],
 " gets higher"
}], "Text",
 CellChangeTimes->{{3.877862527991438*^9, 
  3.8778625530437403`*^9}},ExpressionUUID->"66d07462-196d-41ec-b584-\
1acf01ae5271"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "next", " ", "one", " ", "is", " ", "actually", " ", "TE"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877876889611568*^9, 
  3.877876897501992*^9}},ExpressionUUID->"0a6b272a-be2e-4802-8930-\
bc41561d7845"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TEModeEFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex_", ",", "Ey_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "x"], ",", 
      SubscriptBox["E", "y"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ex", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "x"], ",", 
                  SubscriptBox["E", "y"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["E", "x"], ",", 
                SubscriptBox["E", "y"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{"a", "/.", "aR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", "/", "500"}]}], " ", "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", "2"}]}], ",", " ", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
           RowBox[{"{", 
            RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877877077066956*^9, 3.877877117284669*^9}, {
   3.877877176898452*^9, 3.8778771791453114`*^9}, {3.877877217295782*^9, 
   3.877877222894701*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"2b22826c-4d20-4d78-93d7-441136b8f4d2"],

Cell[BoxData[
 RowBox[{"TEModeEFieldAtZ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
        SubscriptBox["\[Mu]", "0"]}], 
       SuperscriptBox["h", "2"]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
         SubscriptBox["\[Mu]", "0"]}], 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "0"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877876904222706*^9, 3.877877011833267*^9}, {
  3.87787708053113*^9, 3.877877080852015*^9}},
 CellLabel->
  "In[1040]:=",ExpressionUUID->"29ebdb76-3e27-4219-bfc6-289a5ea15f0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TEModeHFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex_", ",", "Ey_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "x"], ",", 
      SubscriptBox["E", "y"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ex", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "x"], ",", 
                  SubscriptBox["E", "y"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["E", "x"], ",", 
                SubscriptBox["E", "y"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{"a", "/.", "aR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", "/", "3"}]}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", "2"}]}], ",", " ", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
           RowBox[{"{", 
            RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877877077066956*^9, 3.877877117284669*^9}, {
   3.877877176898452*^9, 3.8778771791453114`*^9}, {3.877877217295782*^9, 
   3.877877222894701*^9}, {3.877877440885991*^9, 3.877877483667444*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"cfb7fa88-e1be-4a52-b5fb-922ddbba61e7"],

Cell[BoxData[
 RowBox[{"TEModeHFieldAtZ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["\[Gamma]", 
       SuperscriptBox["h", "2"]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      FractionBox["\[Gamma]", 
       SuperscriptBox["h", "2"]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "0"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877876904222706*^9, 3.877877011833267*^9}, {
  3.87787708053113*^9, 3.877877080852015*^9}, {3.877877368145832*^9, 
  3.877877413068857*^9}, {3.877877444626953*^9, 3.8778774451799088`*^9}},
 CellLabel->
  "In[1042]:=",ExpressionUUID->"576b1007-fd44-402c-84e0-9962d60d897f"],

Cell["TODO: Scale Vectors, ListAnimate this with z = 0", "Text",
 CellChangeTimes->{{3.87779743804175*^9, 
  3.877797460901911*^9}},ExpressionUUID->"85489d8c-aa69-48fe-9d79-\
df340d3b3e38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TMModeHFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Hx_", ",", "Hy_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["H", "x"], ",", 
      SubscriptBox["H", "y"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["H", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Hx", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["H", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Hy", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["H", "x"], ",", 
                  SubscriptBox["H", "y"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["H", "x"], ",", 
                SubscriptBox["H", "y"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{"a", "/.", "aR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", " ", "*", " ", "300"}]}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", "2"}]}], ",", " ", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
           RowBox[{"{", 
            RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871589756637*^9}, {
   3.877872575979731*^9, 3.877872642303833*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"60a72795-4dee-4551-9386-8155c3011a01"],

Cell[BoxData[
 RowBox[{"TMModeHFieldAtZ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
        SubscriptBox["\[Epsilon]", "0"]}], 
       SuperscriptBox["h", "2"]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
         SubscriptBox["\[Epsilon]", "0"]}], 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8778627833512793`*^9, 3.877862923535595*^9}, 
   3.877867756523337*^9, 3.87787159351528*^9},
 CellLabel->
  "In[462]:=",ExpressionUUID->"f53e3c78-919f-4ffb-a3bb-addc156f62cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TMModeEHFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ex_", ",", "Ey_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Hx_", ",", "Hy_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "x"], ",", 
      SubscriptBox["E", "y"], ",", 
      SubscriptBox["H", "x"], ",", 
      SubscriptBox["H", "y"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ex", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["H", "x"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Hx", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["H", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Hy", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "x"], ",", 
                  SubscriptBox["E", "y"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "x"], ",", 
                  SubscriptBox["E", "y"]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["H", "x"], ",", 
                  SubscriptBox["H", "y"]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", 
                RowBox[{"a", "/.", "aR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", " ", "*", " ", "3"}]}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Tiny", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", "2"}]}], ",", " ", 
              RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{
           FractionBox["2", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["m", "a"], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
           RowBox[{"{", 
            RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, {
   3.8778716611294413`*^9, 3.8778716816518927`*^9}, {3.8778717174415627`*^9, 
   3.8778717242024*^9}, {3.877871758706541*^9, 3.877871759791513*^9}, {
   3.877871810812983*^9, 3.877871932771041*^9}, {3.8778719694708357`*^9, 
   3.877871978320516*^9}, {3.877872085796644*^9, 3.877872151895344*^9}, {
   3.877872257823763*^9, 3.877872264900158*^9}, {3.8778726600049963`*^9, 
   3.877872688761147*^9}, {3.877872737189225*^9, 3.87787275900524*^9}, {
   3.877872800789956*^9, 3.877872800974306*^9}, {3.877872886027438*^9, 
   3.877872915618949*^9}, {3.877873014929124*^9, 3.8778730286334*^9}, {
   3.877873815731454*^9, 3.877873816344479*^9}, {3.877873850520113*^9, 
   3.8778738517493343`*^9}, {3.877873972973716*^9, 3.8778740233011417`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"d0da2c1b-aed1-429d-83e2-5d92fe11c18e"],

Cell[BoxData[
 RowBox[{"TMModeEHFieldAtZ", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
        SubscriptBox["\[Epsilon]", "0"]}], 
       SuperscriptBox["h", "2"]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
         SubscriptBox["\[Epsilon]", "0"]}], 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877871764545295*^9, 3.87787178816619*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"4cab93a3-3ec9-453f-9959-4fc72c5ac677"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TMModeEFieldAtX", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ey_", ",", "Ez_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "y"], ",", 
      SubscriptBox["E", "z"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "z"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ez", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "y"], ",", 
                  SubscriptBox["E", "z"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "z"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["E", "y"], ",", 
                SubscriptBox["E", "z"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "*", "2"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["m", "a"], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
                 RowBox[{"{", 
                  RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
               "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"maxNorm", "*", "2"}]}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}]}], "]"}]}],
            ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{"a", "/.", "aR"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, {
   3.877874180906147*^9, 3.877874237559432*^9}, {3.877874346066204*^9, 
   3.8778744326785507`*^9}, {3.877874540240087*^9, 3.877874542375597*^9}, {
   3.8778745920757923`*^9, 3.877874593181856*^9}, {3.8778746323510847`*^9, 
   3.877874687632305*^9}, {3.877874718193705*^9, 3.877874737751031*^9}, {
   3.8778747845010653`*^9, 3.8778747855769463`*^9}, {3.877874856274703*^9, 
   3.8778748564974117`*^9}, {3.877875478198992*^9, 3.877875531506199*^9}, {
   3.877875641451679*^9, 3.877875643085487*^9}, {3.8778776736058483`*^9, 
   3.877877695799618*^9}, {3.8778777524074993`*^9, 3.877877885389653*^9}, {
   3.8778779155995293`*^9, 3.877877919865882*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"d9591389-1d12-49bc-a839-70c65e549a65"],

Cell[BoxData[
 RowBox[{"TMModeEFieldAtX", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8778587840206614`*^9, 3.8778587882453623`*^9}, {
   3.8778588353899813`*^9, 3.87785887821765*^9}, {3.8778589296155767`*^9, 
   3.877858945015944*^9}, {3.8778590312607183`*^9, 3.877859039077783*^9}, {
   3.877859110221397*^9, 3.877859139803851*^9}, {3.877859230342458*^9, 
   3.877859243342208*^9}, 3.8778624048321333`*^9, {3.877862451496204*^9, 
   3.877862452448283*^9}, {3.877862488071266*^9, 3.877862488791109*^9}, {
   3.877862519201618*^9, 3.8778625198724337`*^9}, 3.877867750766747*^9, 
   3.8778715797211447`*^9, {3.877874463603085*^9, 3.8778745021568537`*^9}},
 CellLabel->
  "In[561]:=",ExpressionUUID->"778d0055-30a5-4ab8-825a-fbc07657f556"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TMModeEFieldAtXDensity", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ey_", ",", "Ez_"}], "}"}], ",", "aR_", ",", "bR_", ",", "mR_", 
    ",", "nR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", 
      SubscriptBox["E", "y"], ",", 
      SubscriptBox["E", "z"], ",", "maxNorm"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{"h", "->", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"m", " ", "\[Pi]"}], "a"], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], "2"]}]], "/.", 
          RowBox[{"{", 
           RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{"\[Gamma]", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryJ]", 
           SqrtBox[
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Omega]", "2"], 
              SubscriptBox["\[Mu]", "0"], 
              SubscriptBox["\[Epsilon]", "0"]}], "-", 
             SuperscriptBox["h", "2"]}]]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "->", 
              RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
            "hR"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "y"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ey", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "z"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Ez", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "bR", ",", "mR", ",", "nR", ",", "hR", ",", 
                "\[Gamma]R", ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"maxNorm", "=", 
             RowBox[{"NMaxValue", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["E", "y"], ",", 
                  SubscriptBox["E", "z"]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", "z"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DensityPlot", "[", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "y"], ",", 
                 SubscriptBox["E", "z"]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", 
                RowBox[{"b", "/.", "bR"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", "0", ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"2", "*", "2"}], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["m", "a"], ")"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["n", "b"], ")"}], "2"]}]]], "/.", 
                 RowBox[{"{", 
                  RowBox[{"aR", ",", "bR", ",", "mR", ",", "nR"}], "}"}]}]}], 
               "}"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"AspectRatio", "->", "2"}], ",", 
              RowBox[{"MaxRecursion", "->", "4"}]}], "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "0.002"}], "}"}], ",", "0", ",", 
          RowBox[{"a", "/.", "aR"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, {
   3.877874180906147*^9, 3.877874237559432*^9}, {3.877874346066204*^9, 
   3.8778744326785507`*^9}, {3.877874540240087*^9, 3.877874542375597*^9}, {
   3.8778745920757923`*^9, 3.877874593181856*^9}, {3.8778746323510847`*^9, 
   3.877874687632305*^9}, {3.877874718193705*^9, 3.877874737751031*^9}, {
   3.8778747845010653`*^9, 3.8778747855769463`*^9}, {3.877874856274703*^9, 
   3.8778748564974117`*^9}, {3.877875478198992*^9, 3.877875531506199*^9}, {
   3.877875641451679*^9, 3.877875643085487*^9}, {3.877875701690126*^9, 
   3.877875801837585*^9}, {3.877875882666904*^9, 3.877875886511375*^9}, {
   3.877877945172572*^9, 3.877877961375187*^9}, {3.877878080930071*^9, 
   3.877878081023572*^9}, {3.877878152962009*^9, 3.877878153200406*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d6a6666c-da95-4352-aca0-ac14bd894356"],

Cell[BoxData[
 RowBox[{"TMModeEFieldAtXDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Gamma]", 
        SuperscriptBox["h", "2"]]}], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"n", " ", "\[Pi]"}], "b"], ")"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"m", " ", "\[Pi]"}], "a"], "x"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"n", " ", "\[Pi]"}], "b"], "y"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}]}], "}"}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"b", "->", "0.005"}], ",", 
   RowBox[{"m", "->", "1"}], ",", 
   RowBox[{"n", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8778587840206614`*^9, 3.8778587882453623`*^9}, {
   3.8778588353899813`*^9, 3.87785887821765*^9}, {3.8778589296155767`*^9, 
   3.877858945015944*^9}, {3.8778590312607183`*^9, 3.877859039077783*^9}, {
   3.877859110221397*^9, 3.877859139803851*^9}, {3.877859230342458*^9, 
   3.877859243342208*^9}, 3.8778624048321333`*^9, {3.877862451496204*^9, 
   3.877862452448283*^9}, {3.877862488071266*^9, 3.877862488791109*^9}, {
   3.877862519201618*^9, 3.8778625198724337`*^9}, 3.877867750766747*^9, 
   3.8778715797211447`*^9, {3.877874463603085*^9, 3.8778745021568537`*^9}, 
   3.877875763418939*^9, {3.877875822543599*^9, 3.877875824059222*^9}, {
   3.877878035610026*^9, 3.877878053774605*^9}, {3.8778781570254393`*^9, 
   3.877878169466523*^9}},
 CellLabel->
  "In[862]:=",ExpressionUUID->"245ac29a-df2b-491e-97dd-ee586e30aa64"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{
   "This", " ", "one", " ", "definitely", " ", "needs", " ", 
    "ListAnimate"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.877875947470418*^9, 
  3.877875982101328*^9}},ExpressionUUID->"1f7ae2e3-347f-4727-86ee-\
0701190a0add"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bessel function", "Section",
 CellChangeTimes->{{3.8777470530597973`*^9, 
  3.8777470634748497`*^9}},ExpressionUUID->"e67eb7dd-ae65-4bb1-b876-\
1df39825e5f4"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BesselJ", "[", 
      RowBox[{"0", ",", "x"}], "]"}], ",", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"1", ",", "x"}], "]"}], ",", 
     RowBox[{"BesselJ", "[", 
      RowBox[{"2", ",", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "12"}], "}"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(J\), \(0\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(J\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(J\), \(2\)]\)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8777480858005733`*^9, 3.877748090380248*^9}, 
   3.877748155540428*^9, {3.877785952617765*^9, 3.877786000369808*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"3f438794-98e3-43c7-908b-dc092a53a824"],

Cell[BoxData[
 RowBox[{"<<", "NumericalCalculus`"}]], "Input",
 CellChangeTimes->{{3.877886306715951*^9, 3.877886336549344*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"2cbba988-1c33-4401-95e2-eb61c921c74d"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ND", "[", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", "y"}], "]"}], ",", "y", ",", "x"}], "]"}], ",", 
     RowBox[{"ND", "[", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"1", ",", "y"}], "]"}], ",", "y", ",", "x"}], "]"}], ",", 
     RowBox[{"ND", "[", 
      RowBox[{
       RowBox[{"BesselJ", "[", 
        RowBox[{"2", ",", "y"}], "]"}], ",", "y", ",", "x"}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "12"}], "}"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
SubsuperscriptBox[
StyleBox[\"J\", \"TI\"], \"0\", \"\[Prime]\"], TraditionalForm], \"errors\" \
-> {}, \"input\" -> \"J^\\\\prime_0\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", ",", 
      "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
SubsuperscriptBox[
StyleBox[\"J\", \"TI\"], \"1\", \"\[Prime]\"], TraditionalForm], \"errors\" \
-> {}, \"input\" -> \"J^\\\\prime_1\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", ",", 
      "\"\<\!\(\*TemplateBox[<|\"boxes\" -> FormBox[
SubsuperscriptBox[
StyleBox[\"J\", \"TI\"], \"2\", \"\[Prime]\"], TraditionalForm], \"errors\" \
-> {}, \"input\" -> \"J^\\\\prime_2\", \"state\" -> \
\"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877786020124782*^9, 3.877786047961876*^9}, {
  3.877786078535583*^9, 3.8777860927955227`*^9}, {3.877885856492984*^9, 
  3.8778859122530937`*^9}, {3.8778862997818117`*^9, 3.8778863042414722`*^9}, {
  3.8778863414160347`*^9, 3.8778863896261463`*^9}, {3.877886453204452*^9, 
  3.877886527309971*^9}, {3.877886570339962*^9, 3.8778865819219933`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"74a97427-0519-4841-bef9-f193fb220e03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BesselJ", "[", 
   RowBox[{"0", ",", "1"}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.877786110823848*^9, 3.8777861526897583`*^9}, {
  3.8778869295571957`*^9, 3.877886930015625*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"66b78776-afe9-4ab8-900b-ffe0b5f57012"],

Cell[BoxData[
 RowBox[{"BesselJ", "[", 
  RowBox[{"0", ",", "1.1"}], "]"}]], "Input",
 CellChangeTimes->{{3.877786156512504*^9, 3.877786157625042*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"503d6cb6-5b30-43d1-b27d-5fb459369d34"],

Cell[BoxData[
 RowBox[{"ND", "[", 
  RowBox[{
   RowBox[{"BesselJ", "[", 
    RowBox[{"0", ",", "y"}], "]"}], ",", "y", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.877886950246131*^9, 3.877886953234515*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"2ffc7464-c8d7-4276-85a2-5ab8799b6cd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], "/", "r"}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"r", "-", "t"}], "]"}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"r", "-", "t"}], "]"}], "/", "r"}]}], ")"}], "*", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"tf", "=", 
  RowBox[{"TransformedField", "[", 
   RowBox[{
    RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
    RowBox[{"e", "[", 
     RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]", ",", "1"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "\n", 
 RowBox[{"VectorPlot3D", "[", 
  RowBox[{"tf", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8777882177544928`*^9, 3.8777882370761023`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"4274ea5c-e945-4e3c-9cc7-b9805a3d30f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircularTMModeEFieldAtZ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Phi]_"}], "}"}], ",", "aR_", ",", "nR_", ",", 
    "pR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{
        RowBox[{"h", "->", 
         FractionBox["2.405", "a"]}], "/.", "aR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{
        RowBox[{"\[Gamma]", "->", 
         RowBox[{"\[ImaginaryJ]", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Omega]", "2"], 
             SubscriptBox["\[Mu]", "0"], 
             SubscriptBox["\[Epsilon]", "0"]}], "-", 
            SuperscriptBox["h", "2"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]", "->", 
            RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
          "hR"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]R", "=", 
       RowBox[{
        RowBox[{"\[Beta]", "->", 
         RowBox[{"\[Omega]", 
          SqrtBox[
           RowBox[{
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "->", 
           RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "r"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Er", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "nR", ",", "hR", ",", "\[Gamma]R", ",", "\[Beta]R", 
                ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Phi]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Phi]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "nR", ",", "hR", ",", "\[Gamma]R", ",", "\[Beta]R", 
                ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"vf", "=", 
             RowBox[{"TransformedField", "[", 
              RowBox[{
               RowBox[{"\"\<Polar\>\"", "->", "\"\<Cartesian\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "r"], ",", 
                 SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"r", ",", "\[Phi]"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"VectorPlot", "[", 
             RowBox[{"vf", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "a"}], ",", "a"}], "}"}], "/.", "aR"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"-", "a"}], ",", "a"}], "}"}], "/.", "aR"}], ",", 
              RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
              RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
              RowBox[{"VectorSizes", "->", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], ",", 
              RowBox[{"VectorStyle", "->", 
               RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
              RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
              RowBox[{"RegionFunction", "->", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["x", "2"], "+", 
                    SuperscriptBox["y", "2"]}], "<=", 
                   SuperscriptBox["a", "2"]}], "/.", "aR"}]}], "]"}]}]}], 
             "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", "0.01"}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"b19b9fc0-01c5-4903-b348-3ef8e20798cd"],

Cell[BoxData[
 RowBox[{"CircularTMModeEFieldAtZ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryJ]", " ", "\[Beta]"}], "h"]}], 
       RowBox[{"ND", "[", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", "x0"}], "]"}], ",", " ", "x0", ",", " ", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryJ]", " ", "\[Beta]", " ", "n"}], 
        RowBox[{
         SuperscriptBox["h", "2"], "r"}]], 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}]}]}], "}"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"n", "->", "0"}], ",", 
   RowBox[{"p", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877880402186311*^9, 3.87788043836786*^9}, {
  3.877880469929379*^9, 3.8778805149979362`*^9}, {3.8778805766221113`*^9, 
  3.877880668447316*^9}, {3.8778808492794647`*^9, 3.8778808906809387`*^9}, {
  3.8778824238221903`*^9, 3.8778824298606253`*^9}, {3.87788302519658*^9, 
  3.877883028960931*^9}, {3.8778830852121353`*^9, 3.877883088612713*^9}, {
  3.8778866276447897`*^9, 3.877886644591874*^9}, {3.877886688700465*^9, 
  3.877886746094133*^9}, {3.877887231926714*^9, 3.8778872353993587`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"339fcf9f-bd1f-4142-8956-c82f2c2fc7c1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "THIS", " ", "IS", " ", "ACTUALLY", " ", "THE", " ", "H", " ", "FIELD"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.877883725986966*^9, 
  3.877883731526602*^9}},ExpressionUUID->"6c5facf5-c025-44ad-a5b7-\
aa2c76cd455c"],

Cell[BoxData[
 RowBox[{"CircularTMModeEFieldAtZ", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
          SubscriptBox["\[Epsilon]", "0"], "n"}], 
         RowBox[{
          SuperscriptBox["h", "2"], "r"}]]}], 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", 
          SubscriptBox["\[Epsilon]", "0"]}], "h"]}], 
       RowBox[{"ND", "[", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", "x0"}], "]"}], ",", "x0", ",", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}]}]}], "}"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"n", "->", "0"}], ",", 
   RowBox[{"p", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877883736964098*^9, 3.8778838235681143`*^9}, {
  3.877886768627437*^9, 3.877886782264439*^9}, {3.877887323018759*^9, 
  3.877887325188846*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"6df18d92-5093-40a2-9b9c-566eb7835225"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"TODO", ":", " ", 
    RowBox[{"compute", " ", "VectorSizes", " ", "properly"}]}], ";", " ", 
   RowBox[{"make", " ", "faster"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.877887941979329*^9, 3.877887985694961*^9}, {
  3.877927263872201*^9, 
  3.8779272644349613`*^9}},ExpressionUUID->"bf75bc66-55d3-4edb-ad43-\
3182123cb593"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircularTMModeEFieldAtZStream", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Phi]_"}], "}"}], ",", "aR_", ",", "nR_", ",", 
    "pR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hR", ",", "T", ",", "\[Gamma]R", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hR", "=", 
       RowBox[{
        RowBox[{"h", "->", 
         FractionBox["2.405", "a"]}], "/.", "aR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]R", "=", 
       RowBox[{
        RowBox[{"\[Gamma]", "->", 
         RowBox[{"\[ImaginaryJ]", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Omega]", "2"], 
             SubscriptBox["\[Mu]", "0"], 
             SubscriptBox["\[Epsilon]", "0"]}], "-", 
            SuperscriptBox["h", "2"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]", "->", 
            RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", " ", 
          "hR"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]R", "=", 
       RowBox[{
        RowBox[{"\[Beta]", "->", 
         RowBox[{"\[Omega]", 
          SqrtBox[
           RowBox[{
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "->", 
           RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", 
       RowBox[{
        RowBox[{"Animate", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "r"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Er", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "nR", ",", "hR", ",", "\[Gamma]R", ",", "\[Beta]R", 
                ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Phi]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Phi]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
               "aR", ",", "nR", ",", "hR", ",", "\[Gamma]R", ",", "\[Beta]R", 
                ",", 
                RowBox[{
                 RowBox[{"\[Omega]", "->", 
                  RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"vf", "=", 
             RowBox[{"TransformedField", "[", 
              RowBox[{
               RowBox[{"\"\<Polar\>\"", "->", "\"\<Cartesian\>\""}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "r"], ",", 
                 SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"r", ",", "\[Phi]"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"StreamDensityPlot", "[", 
             RowBox[{"vf", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"-", "a"}], ",", "a"}], "}"}], "/.", "aR"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"-", "a"}], ",", "a"}], "}"}], "/.", "aR"}]}], 
             "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.04", "T"}]}], "}"}], ",", 
          RowBox[{"AnimationRunning", "->", "False"}], ",", 
          RowBox[{"AnimationRate", "->", "1"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "0.002"}], "}"}], ",", "0", ",", "0.01"}], 
         "}"}]}], "]"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008424162362*^9}, {3.8780085820251913`*^9, 
   3.878008596059718*^9}, {3.878008694291832*^9, 3.878008706564163*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"4291f7b3-d861-49ca-99f7-db484b873092"],

Cell[BoxData[
 RowBox[{"CircularTMModeEFieldAtZStream", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryJ]", " ", "\[Beta]"}], "h"]}], 
       RowBox[{"ND", "[", 
        RowBox[{
         RowBox[{"BesselJ", "[", 
          RowBox[{"n", ",", "x0"}], "]"}], ",", " ", "x0", ",", " ", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryJ]", " ", "\[Beta]", " ", "n"}], 
        RowBox[{
         SuperscriptBox["h", "2"], "r"}]], 
       RowBox[{"BesselJ", "[", 
        RowBox[{"n", ",", 
         RowBox[{"h", " ", "r"}]}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"n", " ", "\[Phi]"}], "]"}]}]}], "}"}], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], " ", "z"}]]}], ",", 
   RowBox[{"a", "->", "0.01"}], ",", 
   RowBox[{"n", "->", "0"}], ",", 
   RowBox[{"p", "->", "1"}], ",", 
   RowBox[{"f", "->", 
    RowBox[{"5", " ", 
     SuperscriptBox["10", "10"]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877880402186311*^9, 3.87788043836786*^9}, {
  3.877880469929379*^9, 3.8778805149979362`*^9}, {3.8778805766221113`*^9, 
  3.877880668447316*^9}, {3.8778808492794647`*^9, 3.8778808906809387`*^9}, {
  3.8778824238221903`*^9, 3.8778824298606253`*^9}, {3.87788302519658*^9, 
  3.877883028960931*^9}, {3.8778830852121353`*^9, 3.877883088612713*^9}, {
  3.8778866276447897`*^9, 3.877886644591874*^9}, {3.877886688700465*^9, 
  3.877886746094133*^9}, {3.877887231926714*^9, 3.8778872353993587`*^9}, {
  3.878008409699247*^9, 3.878008410456491*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"f6df2d76-521b-4a60-ab7c-da86f7f3503d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radiation and Antennas", "Chapter",
 CellChangeTimes->{{3.874453999903912*^9, 3.874454004641904*^9}, {
  3.874454105679229*^9, 3.874454108982766*^9}, {3.8744541659147043`*^9, 
  3.874454193212523*^9}, {3.876319576338606*^9, 
  3.876319595545966*^9}},ExpressionUUID->"cae580f9-b83b-42fd-97aa-\
8f87077d4528"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Hertzian",
  IgnoreSpellCheck->True],
 " Dipole"
}], "Section",
 CellChangeTimes->{{3.8780159399163017`*^9, 
  3.878015945616811*^9}},ExpressionUUID->"8e977286-2063-44a0-91f5-\
de325184c477"],

Cell["What\[CloseCurlyQuote]s the current assumption of a Hertzian dipole?", \
"Text",
 CellChangeTimes->{{3.891153986664351*^9, 3.8911540108088217`*^9}, {
  3.891154075564085*^9, 
  3.891154088681313*^9}},ExpressionUUID->"2e3a469a-6305-4e2b-8f5c-\
d369939752a0"],

Cell[TextData[{
 "The current is uniform and vary sinusoidally in the infinitesimal wire: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["i", "TI"], 
         RowBox[{"(", 
           StyleBox["t", "TI"], ")"}], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["I", "TI"], "0"], "cos", 
         RowBox[{"\[Omega]", 
           StyleBox["t", "TI"]}]}], TraditionalForm], "errors" -> {}, "input" -> 
     "i(t) = I_0 \\cos{\\omega t}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "caa21185-77b0-4e75-a946-9b6f9c090c6b"],
 ", or in phasor form, just ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "I_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20792a82-0a7d-48f7-b802-111becea2813"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.891154012833919*^9, 3.891154056814687*^9}, {
  3.891154096494429*^9, 3.891154161145298*^9}, {3.891154220642872*^9, 
  3.8911542544771757`*^9}, {3.8911815292803288`*^9, 
  3.891181538298224*^9}},ExpressionUUID->"bc149fa8-616d-40fc-8567-\
4d4a3a43059c"],

Cell[BoxData[
 RowBox[{"Curl", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["\[Mu]", "0"], "J", " ", "dl"}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Beta]", " ", "R"}]], "R"], 
       ")"}], 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["\[Mu]", "0"], "J", " ", "dl"}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Beta]", " ", "R"}]], "R"], 
       ")"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
   "\"\<Spherical\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.878016071728689*^9, 3.878016076847286*^9}, {
  3.878016130387636*^9, 3.8780161728912563`*^9}, {3.878016241356583*^9, 
  3.878016300885043*^9}, {3.878016365871028*^9, 3.8780163690863333`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"1724cbf2-fc4b-48f5-9a93-79602217a305"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HertzianDipole", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Theta]_", ",", "E\[Phi]_"}], "}"}], ",", "fR_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Theta]"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]R", "=", 
       RowBox[{
        RowBox[{"\[Beta]", "->", 
         RowBox[{"\[Omega]", 
          SqrtBox[
           RowBox[{
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "->", 
           RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["E", "r"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"Er", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], "}"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["E", "\[Theta]"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"E\[Theta]", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], "}"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["E", "\[Phi]"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"E\[Phi]", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}]}], "}"}]}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"vf", "=", 
           RowBox[{"TransformedField", "[", 
            RowBox[{
             RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["E", "r"], ",", 
               SubscriptBox["E", "\[Theta]"], ",", 
               SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SliceVectorPlot3D", "[", 
           RowBox[{"vf", ",", "\"\<CenterPlanes\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
            RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
            RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
            RowBox[{"VectorSizes", "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], ",", 
            RowBox[{"VectorStyle", "->", 
             RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
            RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
            RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "T", ",", 
          RowBox[{"0.04", "T"}]}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}], ",", 
        RowBox[{"AnimationRate", "->", "1"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}, {3.878018931580798*^9, 
   3.878018991774006*^9}, {3.878019084166729*^9, 3.878019135499254*^9}, {
   3.878019241804145*^9, 3.878019269150403*^9}, {3.878019350723929*^9, 
   3.878019455819491*^9}, {3.87801955139406*^9, 3.878019552313662*^9}, {
   3.878019593600873*^9, 3.878019636096538*^9}, {3.8780197035666943`*^9, 
   3.878019707993277*^9}, {3.878019757792944*^9, 3.878019763326497*^9}, {
   3.878019795460979*^9, 3.878019820219549*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"f7f55d74-b763-474a-999b-9aa1435e1ea3"],

Cell[BoxData[
 RowBox[{"HertzianDipole", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Beta]", " ", "r"}]], "r"], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878019466775522*^9, 3.878019531813725*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"64a8223b-3288-4775-95ad-7196071ea9a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HertzianDipole2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Theta]_", ",", "E\[Phi]_"}], "}"}], ",", "fR_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Theta]"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]R", "=", 
       RowBox[{
        RowBox[{"\[Beta]", "->", 
         RowBox[{"\[Omega]", 
          SqrtBox[
           RowBox[{
            SubscriptBox["\[Mu]", "0"], 
            SubscriptBox["\[Epsilon]", "0"]}]]}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "->", 
           RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["E", "r"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"Er", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", 
              RowBox[{"r", "->", "1"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["E", "\[Theta]"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"E\[Theta]", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", 
              RowBox[{"r", "->", "1"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["E", "\[Phi]"], "=", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"E\[Phi]", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"\[Beta]R", ",", 
              RowBox[{
               RowBox[{"\[Omega]", "->", 
                RowBox[{"2", "\[Pi]", " ", "f"}]}], "/.", "fR"}], ",", 
              RowBox[{"r", "->", "1"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vf", "=", 
           RowBox[{"TransformedField", "[", 
            RowBox[{
             RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["E", "r"], ",", 
               SubscriptBox["E", "\[Theta]"], ",", 
               SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"VectorPlot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"vf", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"vf", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", 
             RowBox[{"z", "->", "1"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"AxesLabel", "->", "Automatic"}], ",", 
            RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
            RowBox[{"VectorScaling", "->", "\"\<Linear\>\""}], ",", 
            RowBox[{"VectorSizes", "->", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], ",", 
            RowBox[{"VectorStyle", "->", 
             RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
            RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
            RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "T", ",", 
          RowBox[{"0.04", "T"}]}], "}"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}], ",", 
        RowBox[{"AnimationRate", "->", "1"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}, {3.878018931580798*^9, 
   3.878018991774006*^9}, {3.878019084166729*^9, 3.878019135499254*^9}, {
   3.878019241804145*^9, 3.878019269150403*^9}, {3.878019350723929*^9, 
   3.878019455819491*^9}, {3.87801955139406*^9, 3.878019552313662*^9}, {
   3.878019593600873*^9, 3.878019636096538*^9}, {3.8780197035666943`*^9, 
   3.878019707993277*^9}, {3.878019757792944*^9, 3.878019763326497*^9}, {
   3.878019795460979*^9, 3.878019820219549*^9}, 3.8782828092654867`*^9, {
   3.8782828703833103`*^9, 3.878282872412097*^9}, {3.878282908668832*^9, 
   3.8782829862190332`*^9}, {3.8782830262381268`*^9, 3.878283030316744*^9}, {
   3.878283064859604*^9, 3.8782830669390297`*^9}, {3.878283239358714*^9, 
   3.8782833049008904`*^9}, {3.878283382185953*^9, 3.8782833956737328`*^9}, {
   3.879093242322856*^9, 3.8790932476327143`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"92c854c3-9828-4b08-a1d0-d354308d9fc2"],

Cell[BoxData[
 RowBox[{"HertzianDipole2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryJ]"}], " ", "\[Beta]", " ", "r"}]], "r"], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Abs", "[", 
       RowBox[{"Cos", "[", 
        FractionBox["\[Phi]", "2"], "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878282821565411*^9, 3.878282840104357*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"e0676866-df85-41f5-b384-0cc1425a96b7"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "x"}], 
    RowBox[{"1", "-", "x"}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878342744105448*^9, 3.878342895016983*^9}},
 CellLabel->
  "In[1149]:=",ExpressionUUID->"9103fc95-beca-4de1-a972-8777d34a084a"],

Cell[BoxData[
 RowBox[{"ComplexPlot", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"Abs", "[", "\[CapitalGamma]", "]"}]}], 
    RowBox[{"1", "-", 
     RowBox[{"Abs", "[", "\[CapitalGamma]", "]"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[CapitalGamma]", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ",", 
     RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878342906969151*^9, 3.87834294946078*^9}, {
  3.87834300929313*^9, 3.8783430237228193`*^9}},
 CellLabel->
  "In[1181]:=",ExpressionUUID->"b05b06da-8ab2-41e7-87e6-dac1a5ac55c6"],

Cell[BoxData[
 RowBox[{"ComplexPlot", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"\[Eta]", "-", 
     SubscriptBox["\[Eta]", "0"]}], 
    RowBox[{"\[Eta]", "+", 
     SubscriptBox["\[Eta]", "0"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Eta]", ",", 
     RowBox[{
      RowBox[{"-", "1000"}], "-", 
      RowBox[{"1000", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1000", "+", 
      RowBox[{"1000", "\[ImaginaryI]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8783431702423153`*^9, 3.8783431728005447`*^9}, {
  3.878343228584066*^9, 3.878343265043516*^9}, {3.8783438812346287`*^9, 
  3.8783438903627043`*^9}, {3.878346550292943*^9, 3.878346558839856*^9}},
 CellLabel->
  "In[1234]:=",ExpressionUUID->"e30ef8b5-ddf3-42e0-8a82-954d2cab22c2"],

Cell[BoxData[
 RowBox[{"ComplexPlot3D", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"\[Eta]", "-", 
     SubscriptBox["\[Eta]", "0"]}], 
    RowBox[{"\[Eta]", "+", 
     SubscriptBox["\[Eta]", "0"]}]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Eta]", ",", 
     RowBox[{
      RowBox[{"-", "1000"}], "-", 
      RowBox[{"1000", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1000", "+", 
      RowBox[{"1000", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"ImageSize", "->", "Large"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878343274540873*^9, 3.8783433519636917`*^9}},
 CellLabel->
  "In[1233]:=",ExpressionUUID->"018effc6-db0b-4cbf-8435-8c4d93565f40"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"TODO", ":", " ", 
   RowBox[{
   "we", " ", "know", " ", "the", " ", "maximum", " ", "value", " ", "of", 
    " ", "the", " ", "E", " ", 
    RowBox[{"field", ".", " ", "Use"}], " ", "that", " ", "to", " ", 
    "control", " ", "the", " ", "vector", " ", "sizes"}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8791736318400183`*^9, 
  3.8791736501055202`*^9}},ExpressionUUID->"e15d7051-f2ca-485e-98b8-\
19dc204ddc01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HertzianDipoleXZPlaneVector", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Theta]_", ",", "E\[Phi]_"}], "}"}], ",", "iR_", 
    ",", "lR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Theta]"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "f"}], "/.", "fR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kR", "=", 
       RowBox[{"k", "->", 
        RowBox[{"\[Omega]", 
         SqrtBox[
          RowBox[{
           SubscriptBox["\[Mu]", "0"], 
           SubscriptBox["\[Epsilon]", "0"]}]]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "k"], "/.", "kR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListAnimate", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "r"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Er", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Theta]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Theta]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Phi]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Phi]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vf", "=", 
             RowBox[{"TransformedField", "[", 
              RowBox[{
               RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
               
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "r"], ",", 
                 SubscriptBox["E", "\[Theta]"], ",", 
                 SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Legended", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"VectorPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vf", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"vf", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
                 RowBox[{"y", "->", "0"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"Axes", "->", "True"}], ",", 
                RowBox[{"AxesLabel", "->", 
                 RowBox[{"{", 
                  RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
                RowBox[{"VectorScaling", "->", "\"\<Log\>\""}], ",", 
                RowBox[{"VectorSizes", "->", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], ",", 
                RowBox[{"VectorStyle", "->", 
                 RowBox[{"Arrowheads", "[", "Small", "]"}]}], ",", 
                RowBox[{"VectorColorFunctionScaling", "->", "True"}], ",", 
                RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
                   "RGBColorSwatchTemplate"]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<f\>\"", ",", 
                    RowBox[{"f", "/.", "fR"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Lambda]\>\"", ",", "\[Lambda]"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<k\>\"", ",", 
                    RowBox[{"k", "/.", "kR"}]}], "}"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.1", "T"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}, {3.878018931580798*^9, 
   3.878018991774006*^9}, {3.878019084166729*^9, 3.878019135499254*^9}, {
   3.878019241804145*^9, 3.878019269150403*^9}, {3.878019350723929*^9, 
   3.878019455819491*^9}, {3.87801955139406*^9, 3.878019552313662*^9}, {
   3.878019593600873*^9, 3.878019636096538*^9}, {3.8780197035666943`*^9, 
   3.878019707993277*^9}, {3.878019757792944*^9, 3.878019763326497*^9}, {
   3.878019795460979*^9, 3.878019820219549*^9}, 3.8782828092654867`*^9, {
   3.8782828703833103`*^9, 3.878282872412097*^9}, {3.878282908668832*^9, 
   3.8782829862190332`*^9}, {3.8782830262381268`*^9, 3.878283030316744*^9}, {
   3.878283064859604*^9, 3.8782830669390297`*^9}, {3.878283239358714*^9, 
   3.8782833049008904`*^9}, {3.878283382185953*^9, 3.8782833956737328`*^9}, {
   3.879090261775857*^9, 3.879090261835071*^9}, {3.879090556562855*^9, 
   3.8790905607359753`*^9}, {3.879090591551117*^9, 3.8790905974796333`*^9}, {
   3.879090628022296*^9, 3.8790906322186832`*^9}, {3.879090856151629*^9, 
   3.8790908714213133`*^9}, {3.8790911847210083`*^9, 3.879091189319014*^9}, {
   3.8790912193574457`*^9, 3.87909121954572*^9}, {3.8790912660777817`*^9, 
   3.879091304016191*^9}, {3.879091476348267*^9, 3.879091533720768*^9}, {
   3.879091564465598*^9, 3.879091566031274*^9}, {3.879091614079289*^9, 
   3.879091616442883*^9}, {3.879092958417162*^9, 3.879092984217682*^9}, {
   3.879093148791834*^9, 3.87909315462624*^9}, {3.879093224508613*^9, 
   3.879093235754076*^9}, {3.879093265772764*^9, 3.8790932660762053`*^9}, {
   3.879134650741714*^9, 3.879134654032824*^9}, {3.879136222165897*^9, 
   3.879136239341907*^9}, {3.879136277088955*^9, 3.879136277205164*^9}, {
   3.8791363268036327`*^9, 3.8791363492038107`*^9}, {3.8791364191456003`*^9, 
   3.8791364195083847`*^9}, 3.879139348206772*^9, {3.879141308409554*^9, 
   3.879141396077682*^9}, {3.8791414611907873`*^9, 3.879141614964417*^9}, {
   3.879141665370637*^9, 3.879141737253611*^9}, {3.8791646706466417`*^9, 
   3.879164698176422*^9}, {3.879165035198214*^9, 3.879165141467472*^9}, {
   3.8791662691015387`*^9, 3.879166274337785*^9}, {3.8791663299621*^9, 
   3.879166341774377*^9}, {3.8791664074375143`*^9, 3.8791664182244253`*^9}, {
   3.8791664592590446`*^9, 3.8791664611794357`*^9}, {3.8791665642020884`*^9, 
   3.879166588150774*^9}, {3.879166978143923*^9, 3.8791670096348743`*^9}, {
   3.879167194233244*^9, 3.879167219717476*^9}, {3.8791729793351507`*^9, 
   3.879172979559141*^9}, {3.879173415308621*^9, 3.879173417557407*^9}, {
   3.879173448085596*^9, 3.879173486309771*^9}, {3.879173533028723*^9, 
   3.879173556816078*^9}, {3.879173670545534*^9, 3.879173671388352*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"20a35d09-e387-4578-b53f-4677bfabd8f3"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlaneVector", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryJ]", " ", 
        SubscriptBox["I", "0"], "l", " ", "k", " ", 
        SubscriptBox["\[Eta]", "0"], " "}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "R"}]], "R"], ")"}], 
      
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "1"}], ",", 
   RowBox[{"l", "->", "0.001"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878282821565411*^9, 3.878282840104357*^9}, {
   3.879090277984335*^9, 3.879090295484668*^9}, {3.87909087895018*^9, 
   3.879090884074861*^9}, {3.8790911245513687`*^9, 3.879091128350996*^9}, {
   3.8790916453368464`*^9, 3.879091653113405*^9}, {3.8790929359678507`*^9, 
   3.879092946107462*^9}, {3.8791365323242617`*^9, 3.8791365364690533`*^9}, {
   3.8791391710779657`*^9, 3.879139257428035*^9}, 3.879139304679904*^9, 
   3.879141636734776*^9, {3.879165048165634*^9, 3.879165048390994*^9}, {
   3.879166314024291*^9, 3.879166336165806*^9}, {3.879172956818109*^9, 
   3.879172970589374*^9}, {3.879173666536343*^9, 3.879173667253518*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"65879983-1d0e-4e2d-a341-f169ddcfc4cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HertzianDipoleXZPlaneDensity", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Theta]_", ",", "E\[Phi]_"}], "}"}], ",", "iR_", 
    ",", "lR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Theta]"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "f"}], "/.", "fR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kR", "=", 
       RowBox[{"k", "->", 
        RowBox[{"\[Omega]", 
         SqrtBox[
          RowBox[{
           SubscriptBox["\[Mu]", "0"], 
           SubscriptBox["\[Epsilon]", "0"]}]]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "k"], "/.", "kR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListAnimate", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "r"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Er", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Theta]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Theta]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Phi]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Phi]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vf", "=", 
             RowBox[{"TransformedField", "[", 
              RowBox[{
               RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
               
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "r"], ",", 
                 SubscriptBox["E", "\[Theta]"], ",", 
                 SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Legended", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DensityPlot", "[", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vf", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"vf", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
                  RowBox[{"y", "->", "0"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"MaxRecursion", "->", "4"}], ",", 
                RowBox[{"Axes", "->", "True"}], ",", 
                RowBox[{"AxesLabel", "->", 
                 RowBox[{"{", 
                  RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
                RowBox[{"ImageSize", "->", "Large"}], ",", 
                RowBox[{"Epilog", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Lambda]", ",", "0"}], "}"}], "]"}]}], 
                  "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
                   "RGBColorSwatchTemplate"]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<f\>\"", ",", 
                    RowBox[{"f", "/.", "fR"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Lambda]\>\"", ",", "\[Lambda]"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<k\>\"", ",", 
                    RowBox[{"k", "/.", "kR"}]}], "}"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.05", "T"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}, {3.878018931580798*^9, 
   3.878018991774006*^9}, {3.878019084166729*^9, 3.878019135499254*^9}, {
   3.878019241804145*^9, 3.878019269150403*^9}, {3.878019350723929*^9, 
   3.878019455819491*^9}, {3.87801955139406*^9, 3.878019552313662*^9}, {
   3.878019593600873*^9, 3.878019636096538*^9}, {3.8780197035666943`*^9, 
   3.878019707993277*^9}, {3.878019757792944*^9, 3.878019763326497*^9}, {
   3.878019795460979*^9, 3.878019820219549*^9}, 3.8782828092654867`*^9, {
   3.8782828703833103`*^9, 3.878282872412097*^9}, {3.878282908668832*^9, 
   3.8782829862190332`*^9}, {3.8782830262381268`*^9, 3.878283030316744*^9}, {
   3.878283064859604*^9, 3.8782830669390297`*^9}, {3.878283239358714*^9, 
   3.8782833049008904`*^9}, {3.878283382185953*^9, 3.8782833956737328`*^9}, {
   3.879090261775857*^9, 3.879090261835071*^9}, {3.879090556562855*^9, 
   3.8790905607359753`*^9}, {3.879090591551117*^9, 3.8790905974796333`*^9}, {
   3.879090628022296*^9, 3.8790906322186832`*^9}, {3.879090856151629*^9, 
   3.8790908714213133`*^9}, {3.8790911847210083`*^9, 3.879091189319014*^9}, {
   3.8790912193574457`*^9, 3.87909121954572*^9}, {3.8790912660777817`*^9, 
   3.879091304016191*^9}, {3.879091476348267*^9, 3.879091533720768*^9}, {
   3.879091564465598*^9, 3.879091566031274*^9}, {3.879091614079289*^9, 
   3.879091616442883*^9}, {3.879092958417162*^9, 3.879092984217682*^9}, {
   3.879093148791834*^9, 3.87909315462624*^9}, {3.879093224508613*^9, 
   3.879093235754076*^9}, {3.879093265772764*^9, 3.8790932660762053`*^9}, {
   3.879134650741714*^9, 3.879134654032824*^9}, {3.879136222165897*^9, 
   3.879136239341907*^9}, {3.879136277088955*^9, 3.879136277205164*^9}, {
   3.8791363268036327`*^9, 3.8791363492038107`*^9}, {3.8791364191456003`*^9, 
   3.8791364195083847`*^9}, 3.879139348206772*^9, {3.879141308409554*^9, 
   3.879141396077682*^9}, {3.8791414611907873`*^9, 3.879141614964417*^9}, {
   3.879141665370637*^9, 3.879141737253611*^9}, {3.8791646706466417`*^9, 
   3.879164698176422*^9}, {3.879165035198214*^9, 3.879165141467472*^9}, {
   3.8791662691015387`*^9, 3.879166274337785*^9}, {3.8791663299621*^9, 
   3.879166341774377*^9}, {3.8791664074375143`*^9, 3.8791664182244253`*^9}, {
   3.8791664592590446`*^9, 3.8791664611794357`*^9}, {3.8791665642020884`*^9, 
   3.879166588150774*^9}, {3.879166978143923*^9, 3.8791670096348743`*^9}, {
   3.879167056829604*^9, 3.8791671061829023`*^9}, {3.8791671447056627`*^9, 
   3.87916717254599*^9}, {3.8791673111039124`*^9, 3.879167365483508*^9}, {
   3.8791697790378933`*^9, 3.87916982527041*^9}, {3.879169958500865*^9, 
   3.8791699594129543`*^9}, {3.879170149455908*^9, 3.879170154328*^9}, {
   3.879170204074191*^9, 3.879170210965464*^9}, {3.8791703095890102`*^9, 
   3.8791703097538*^9}, {3.8791716959779*^9, 3.879171712285973*^9}, {
   3.879172253315407*^9, 3.8791722658729763`*^9}, {3.879172617437961*^9, 
   3.8791727779878607`*^9}, {3.879172823672811*^9, 3.879172828251401*^9}, {
   3.879172919388384*^9, 3.879172946771137*^9}, {3.87917411953915*^9, 
   3.879174119738023*^9}, {3.879174424632093*^9, 3.87917443666825*^9}, {
   3.879174495069771*^9, 3.8791745026419287`*^9}, {3.8791745642879057`*^9, 
   3.879174565319409*^9}, {3.879174802253928*^9, 3.8791748024742937`*^9}, {
   3.8791749786729918`*^9, 3.87917500502071*^9}, {3.8791762371094522`*^9, 
   3.8791762397110853`*^9}, {3.879176294675331*^9, 3.879176295523746*^9}, {
   3.8791763376675673`*^9, 3.8791763378170843`*^9}, {3.879180197674589*^9, 
   3.879180237925963*^9}, {3.8791803513448277`*^9, 3.879180351734549*^9}, {
   3.879180453423827*^9, 3.879180453513939*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"b805b094-4550-4d0b-b8c9-d8beed69fdb0"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlaneDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryJ]", " ", 
        SubscriptBox["I", "0"], "l", " ", "k", " ", 
        SubscriptBox["\[Eta]", "0"], " "}], 
       RowBox[{"4", "\[Pi]"}]], 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "R"}]], "R"], ")"}], 
      
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "1"}], ",", 
   RowBox[{"l", "->", "0.001"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.879167116473239*^9, {3.879172952219509*^9, 3.879172952409608*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"24d76f86-7fb4-494b-82f7-e26f92382e0e"],

Cell[BoxData[
 RowBox[{"ColorData", "[", 
  RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8791701927859583`*^9, 3.8791701927917128`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"0599fc1a-61fd-41ab-87b4-f270157271e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HertzianDipoleXZPlanePowerDensity", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Er_", ",", "E\[Theta]_", ",", "E\[Phi]_"}], "}"}], ",", "iR_", 
    ",", "lR_", ",", "fR_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", "\[Beta]R", ",", 
      SubscriptBox["E", "r"], ",", 
      SubscriptBox["E", "\[Theta]"], ",", 
      SubscriptBox["E", "\[Phi]"], ",", "maxNorm", ",", "vf"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "=", 
       RowBox[{
        FractionBox["1", "f"], "/.", "fR"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "f"}], "/.", "fR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kR", "=", 
       RowBox[{"k", "->", 
        RowBox[{"\[Omega]", 
         SqrtBox[
          RowBox[{
           SubscriptBox["\[Mu]", "0"], 
           SubscriptBox["\[Epsilon]", "0"]}]]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "k"], "/.", "kR"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListAnimate", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "r"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Er", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Theta]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Theta]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             SubscriptBox["E", "\[Phi]"], "=", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"E\[Phi]", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryJ]", " ", "\[Omega]", " ", "t"}]]}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"iR", ",", "lR", ",", "kR"}], "}"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vf", "=", 
             RowBox[{"TransformedField", "[", 
              RowBox[{
               RowBox[{"\"\<Spherical\>\"", "->", "\"\<Cartesian\>\""}], ",", 
               
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["E", "r"], ",", 
                 SubscriptBox["E", "\[Theta]"], ",", 
                 SubscriptBox["E", "\[Phi]"]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"R", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "->", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Legended", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DensityPlot", "[", 
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vf", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"vf", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
                  RowBox[{"y", "->", "0"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"MaxRecursion", "->", "4"}], ",", 
                RowBox[{"PlotLegends", "->", "Automatic"}], ",", 
                RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"PlotRange", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", " ", "100"}], "}"}], " ", "is", " ", 
                  "selected", " ", "for", " ", "good", " ", "coloring"}], " ",
                  "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Axes", "->", "True"}], ",", 
                RowBox[{"AxesLabel", "->", 
                 RowBox[{"{", 
                  RowBox[{"\"\<x\>\"", ",", "\"\<z\>\""}], "}"}]}], ",", 
                RowBox[{"ImageSize", "->", "Large"}], ",", 
                RowBox[{"Epilog", "->", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Lambda]", ",", "0"}], "}"}], "]"}]}], 
                  "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"PointLegend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                   "RGBColorSwatchTemplate"], ",", 
                  
                  TemplateBox[<|
                   "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
                   "RGBColorSwatchTemplate"]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<f\>\"", ",", 
                    RowBox[{"f", "/.", "fR"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[Lambda]\>\"", ",", "\[Lambda]"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<k\>\"", ",", 
                    RowBox[{"k", "/.", "kR"}]}], "}"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T", ",", 
            RowBox[{"0.05", "T"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"AnimationRunning", "->", "False"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.877796900585149*^9, {3.8777970098996468`*^9, 3.877797050737163*^9}, {
   3.877797156272112*^9, 3.877797237606537*^9}, {3.877797465052216*^9, 
   3.877797524169626*^9}, {3.877798098774794*^9, 3.877798115002283*^9}, {
   3.8777982811812773`*^9, 3.8777982821447887`*^9}, 3.877798345070714*^9, {
   3.877798535510172*^9, 3.877798673292807*^9}, {3.877798726312212*^9, 
   3.877798743012539*^9}, {3.8778544351977987`*^9, 3.8778544419820232`*^9}, {
   3.8778544743103437`*^9, 3.877854474702721*^9}, {3.877854668557144*^9, 
   3.87785469539081*^9}, {3.877855334740237*^9, 3.8778553638879004`*^9}, {
   3.877855477105362*^9, 3.8778554822229156`*^9}, {3.877855542829084*^9, 
   3.8778555451842318`*^9}, {3.877855587665647*^9, 3.877855615237968*^9}, {
   3.8778559221745358`*^9, 3.877855938731213*^9}, {3.877857999886807*^9, 
   3.877858064163759*^9}, {3.8778580954273043`*^9, 3.87785815211674*^9}, 
   3.877858197482462*^9, {3.877858231241943*^9, 3.877858235269755*^9}, {
   3.877858273094892*^9, 3.87785836178118*^9}, {3.877858394204998*^9, 
   3.877858394508719*^9}, {3.8778584452044897`*^9, 3.87785847674837*^9}, {
   3.8778586100520067`*^9, 3.877858694181731*^9}, {3.8778587442655697`*^9, 
   3.877858748314959*^9}, {3.8778587805461397`*^9, 3.8778588182516117`*^9}, {
   3.877858854965363*^9, 3.877858875588368*^9}, {3.877858950995245*^9, 
   3.877858952740016*^9}, {3.877859042139552*^9, 3.877859064946768*^9}, {
   3.877859097005012*^9, 3.877859106861907*^9}, {3.877859185811984*^9, 
   3.877859238449237*^9}, {3.877859268569943*^9, 3.8778593224155817`*^9}, {
   3.877859472112975*^9, 3.8778594797848043`*^9}, {3.877859514265847*^9, 
   3.8778597009891853`*^9}, 3.877859741716518*^9, {3.8778597990126867`*^9, 
   3.877859851200313*^9}, {3.877860159413722*^9, 3.877860163198574*^9}, 
   3.877860224477015*^9, {3.877860265751964*^9, 3.8778602745647297`*^9}, {
   3.877860394222519*^9, 3.877860479908711*^9}, {3.877860521760705*^9, 
   3.877860522508504*^9}, {3.877860554020446*^9, 3.877860622623818*^9}, {
   3.877860690956313*^9, 3.87786073982913*^9}, {3.877860771643009*^9, 
   3.87786077631033*^9}, {3.877860842921143*^9, 3.877860968443616*^9}, {
   3.8778610723195953`*^9, 3.877861075817192*^9}, {3.87786110680894*^9, 
   3.877861123902329*^9}, {3.877861157174608*^9, 3.877861183575288*^9}, {
   3.877861288348102*^9, 3.877861353255233*^9}, {3.877861473006817*^9, 
   3.877861491005458*^9}, {3.877861537004655*^9, 3.877861583116643*^9}, {
   3.877861624535585*^9, 3.877861656674746*^9}, {3.8778616909479513`*^9, 
   3.877861716834146*^9}, {3.8778621378450127`*^9, 3.877862138283718*^9}, {
   3.87786218676416*^9, 3.877862235878566*^9}, {3.8778622923808737`*^9, 
   3.877862292556881*^9}, {3.8778625810279818`*^9, 3.87786270319454*^9}, {
   3.877867679693881*^9, 3.877867709610221*^9}, 3.877867746274612*^9, {
   3.8778684657188807`*^9, 3.8778684663178997`*^9}, {3.877868541842628*^9, 
   3.877868568802436*^9}, {3.877868599569644*^9, 3.877868599999281*^9}, {
   3.877871373986905*^9, 3.877871396493641*^9}, {3.8778714433460083`*^9, 
   3.87787146785557*^9}, {3.877871575201537*^9, 3.877871604480423*^9}, 
   3.8778770449860287`*^9, {3.877879949056802*^9, 3.87787995097366*^9}, {
   3.877879991621422*^9, 3.877880012192083*^9}, {3.877880073488339*^9, 
   3.877880079022328*^9}, {3.877880136989221*^9, 3.877880319933497*^9}, {
   3.87788036244928*^9, 3.8778803830572853`*^9}, {3.8778809616834297`*^9, 
   3.8778809665637817`*^9}, {3.877882159823679*^9, 3.877882191420597*^9}, {
   3.877882226666757*^9, 3.877882229809905*^9}, {3.87788231331172*^9, 
   3.877882399298369*^9}, {3.877882455662972*^9, 3.8778825475633*^9}, {
   3.877883185209961*^9, 3.8778832162896633`*^9}, {3.877883255756482*^9, 
   3.877883351793703*^9}, {3.8778834328073072`*^9, 3.8778834345792027`*^9}, {
   3.877883471175796*^9, 3.877883491290843*^9}, {3.877883524064088*^9, 
   3.8778835691260967`*^9}, {3.877883600051537*^9, 3.877883601306487*^9}, {
   3.877883637553884*^9, 3.877883637796015*^9}, {3.877885347759816*^9, 
   3.877885362361115*^9}, {3.877885593261458*^9, 3.877885620243367*^9}, {
   3.8778856842628803`*^9, 3.877885711439002*^9}, {3.877885750977076*^9, 
   3.877885775341178*^9}, {3.877885817621168*^9, 3.877885817804893*^9}, {
   3.877887046392172*^9, 3.877887056780846*^9}, {3.877887245864236*^9, 
   3.877887266249435*^9}, {3.877887303668106*^9, 3.8778873062187147`*^9}, {
   3.877887766415444*^9, 3.8778877695371943`*^9}, {3.877887801763213*^9, 
   3.877887802082464*^9}, {3.8778883041097183`*^9, 3.877888341868751*^9}, {
   3.877888378531892*^9, 3.877888412097858*^9}, {3.877888476277673*^9, 
   3.877888509936627*^9}, {3.877888561054141*^9, 3.877888592670084*^9}, {
   3.877927031738332*^9, 3.877927106723503*^9}, 3.87792715536438*^9, {
   3.878008322292007*^9, 3.878008347334507*^9}, {3.878018931580798*^9, 
   3.878018991774006*^9}, {3.878019084166729*^9, 3.878019135499254*^9}, {
   3.878019241804145*^9, 3.878019269150403*^9}, {3.878019350723929*^9, 
   3.878019455819491*^9}, {3.87801955139406*^9, 3.878019552313662*^9}, {
   3.878019593600873*^9, 3.878019636096538*^9}, {3.8780197035666943`*^9, 
   3.878019707993277*^9}, {3.878019757792944*^9, 3.878019763326497*^9}, {
   3.878019795460979*^9, 3.878019820219549*^9}, 3.8782828092654867`*^9, {
   3.8782828703833103`*^9, 3.878282872412097*^9}, {3.878282908668832*^9, 
   3.8782829862190332`*^9}, {3.8782830262381268`*^9, 3.878283030316744*^9}, {
   3.878283064859604*^9, 3.8782830669390297`*^9}, {3.878283239358714*^9, 
   3.8782833049008904`*^9}, {3.878283382185953*^9, 3.8782833956737328`*^9}, {
   3.879090261775857*^9, 3.879090261835071*^9}, {3.879090556562855*^9, 
   3.8790905607359753`*^9}, {3.879090591551117*^9, 3.8790905974796333`*^9}, {
   3.879090628022296*^9, 3.8790906322186832`*^9}, {3.879090856151629*^9, 
   3.8790908714213133`*^9}, {3.8790911847210083`*^9, 3.879091189319014*^9}, {
   3.8790912193574457`*^9, 3.87909121954572*^9}, {3.8790912660777817`*^9, 
   3.879091304016191*^9}, {3.879091476348267*^9, 3.879091533720768*^9}, {
   3.879091564465598*^9, 3.879091566031274*^9}, {3.879091614079289*^9, 
   3.879091616442883*^9}, {3.879092958417162*^9, 3.879092984217682*^9}, {
   3.879093148791834*^9, 3.87909315462624*^9}, {3.879093224508613*^9, 
   3.879093235754076*^9}, {3.879093265772764*^9, 3.8790932660762053`*^9}, {
   3.879134650741714*^9, 3.879134654032824*^9}, {3.879136222165897*^9, 
   3.879136239341907*^9}, {3.879136277088955*^9, 3.879136277205164*^9}, {
   3.8791363268036327`*^9, 3.8791363492038107`*^9}, {3.8791364191456003`*^9, 
   3.8791364195083847`*^9}, 3.879139348206772*^9, {3.879141308409554*^9, 
   3.879141396077682*^9}, {3.8791414611907873`*^9, 3.879141614964417*^9}, {
   3.879141665370637*^9, 3.879141737253611*^9}, {3.8791646706466417`*^9, 
   3.879164698176422*^9}, {3.879165035198214*^9, 3.879165141467472*^9}, {
   3.8791662691015387`*^9, 3.879166274337785*^9}, {3.8791663299621*^9, 
   3.879166341774377*^9}, {3.8791664074375143`*^9, 3.8791664182244253`*^9}, {
   3.8791664592590446`*^9, 3.8791664611794357`*^9}, {3.8791665642020884`*^9, 
   3.879166588150774*^9}, {3.879166978143923*^9, 3.8791670096348743`*^9}, {
   3.879167056829604*^9, 3.8791671061829023`*^9}, {3.8791671447056627`*^9, 
   3.87916717254599*^9}, {3.8791673111039124`*^9, 3.879167365483508*^9}, {
   3.8791697790378933`*^9, 3.87916982527041*^9}, {3.879169958500865*^9, 
   3.8791699594129543`*^9}, {3.879170149455908*^9, 3.879170154328*^9}, {
   3.879170204074191*^9, 3.879170210965464*^9}, {3.8791703095890102`*^9, 
   3.8791703097538*^9}, {3.8791716959779*^9, 3.879171712285973*^9}, {
   3.879172253315407*^9, 3.8791722658729763`*^9}, {3.879172617437961*^9, 
   3.8791727779878607`*^9}, {3.879172823672811*^9, 3.879172828251401*^9}, {
   3.879172919388384*^9, 3.879172946771137*^9}, {3.87917411953915*^9, 
   3.879174119738023*^9}, {3.879174424632093*^9, 3.87917443666825*^9}, {
   3.879174495069771*^9, 3.8791745026419287`*^9}, {3.8791745642879057`*^9, 
   3.879174565319409*^9}, {3.879174802253928*^9, 3.8791748024742937`*^9}, {
   3.8791749786729918`*^9, 3.87917497882716*^9}, {3.879175118920886*^9, 
   3.879175119343382*^9}, {3.879175151437232*^9, 3.879175162445909*^9}, {
   3.8791753437149076`*^9, 3.879175362668082*^9}, {3.879175657958562*^9, 
   3.8791756955653353`*^9}, {3.8791763457184963`*^9, 3.879176358753778*^9}, {
   3.879176412009247*^9, 3.879176468345375*^9}, {3.879176518382866*^9, 
   3.8791766603290577`*^9}, {3.879176818866296*^9, 3.8791768779574614`*^9}, 
   3.8791769178616*^9, {3.879176982714059*^9, 3.879176993292232*^9}, {
   3.879177036384059*^9, 3.879177036740803*^9}, {3.8791772019462767`*^9, 
   3.8791772289328623`*^9}, {3.879177316598687*^9, 3.8791773365446653`*^9}, 
   3.8794964963094463`*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"e4246eb1-d8c1-4de5-8bcf-80859572fe08"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlanePowerDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["I", "0"], "2"], 
        SuperscriptBox["l", "2"], " ", 
        SuperscriptBox["k", "2"], " ", 
        SubscriptBox["\[Eta]", "0"], " "}], 
       RowBox[{"32", 
        SuperscriptBox["\[Pi]", "2"], 
        SuperscriptBox["R", "2"]}]], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "20"}], ",", 
   RowBox[{"l", "->", "0.001"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8791739024466553`*^9, 3.879174037172585*^9}, {
  3.879175125799694*^9, 3.87917512680783*^9}, {3.879175179134707*^9, 
  3.879175195441564*^9}, {3.879175271275481*^9, 3.879175282013109*^9}, {
  3.87917653858482*^9, 3.879176559914483*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"78fa925a-4d9c-40fe-a497-04df7bcef260"],

Cell["\<\
The density has time dependency. What are the two white circles (abrupt \
change)? Why the irregular circle when the density is low? \
\>", "CodeText",
 CellChangeTimes->{{3.879175380214526*^9, 3.8791754016984253`*^9}, {
  3.879175471992653*^9, 3.879175496194401*^9}, {3.879175629636904*^9, 
  3.879175633396134*^9}},ExpressionUUID->"c67b2691-297a-4c0b-9f6f-\
48929c3c508c"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlaneVector", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["I", "0"], "2"], 
        SuperscriptBox["l", "2"], " ", 
        SuperscriptBox["k", "2"], " ", 
        SubscriptBox["\[Eta]", "0"], " "}], 
       RowBox[{"32", 
        SuperscriptBox["\[Pi]", "2"], 
        SuperscriptBox["R", "2"]}]], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "10"}], ",", 
   RowBox[{"l", "->", "0.001"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8791739024466553`*^9, 3.879174037172585*^9}, {
   3.87917418465388*^9, 3.879174186736911*^9}, 3.879177644842214*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"d920f23b-ef26-4048-a28a-a951816590b6"],

Cell["\<\
Wait, why would the arrow ever point inwards? That is clearly wrong.\
\>", "CodeText",
 CellChangeTimes->{{3.879177426709009*^9, 
  3.879177442531599*^9}},ExpressionUUID->"b02f43cd-ff8f-447d-a6b9-\
3075595da777"],

Cell[BoxData[
 RowBox[{"PolarPlot", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{
      FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}], "2"], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.879060397051756*^9, 3.879060432470924*^9}, {
  3.8790604784851837`*^9, 3.879060488076091*^9}, {3.879177745834845*^9, 
  3.879177750552219*^9}, {3.879177789185647*^9, 3.879177796175264*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"8a49599a-4cf5-4bed-ac54-a2dac9bdcade"],

Cell[BoxData[
 RowBox[{"PolarPlot", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.879060397051756*^9, 3.879060432470924*^9}, {
  3.8790604784851837`*^9, 3.879060488076091*^9}, {3.879177745834845*^9, 
  3.879177750552219*^9}, {3.879177789185647*^9, 3.879177796175264*^9}, {
  3.879177835346561*^9, 3.879177843027254*^9}, {3.8791788448192873`*^9, 
  3.8791788495966454`*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"cd394bd3-0bec-401e-adbc-74b856022f9b"],

Cell[BoxData[
 RowBox[{"PolarPlot", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["\[Pi]", "2"], 
       RowBox[{"Cos", "[", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], "]"}], "2"], 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      RowBox[{
       FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}], "2"]], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.879060397051756*^9, 3.879060432470924*^9}, {
  3.8790604784851837`*^9, 3.879060488076091*^9}, {3.879177745834845*^9, 
  3.879177750552219*^9}, {3.879177789185647*^9, 3.879177796175264*^9}, {
  3.879179157573956*^9, 3.8791792118955297`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"648a30c8-a267-47d5-aad1-da13582a2718"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox["l", "\[Lambda]"]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PolarPlot", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Pi]", 
           FractionBox["l", "\[Lambda]"], 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], "]"}], 
         "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Pi]", 
           FractionBox["l", "\[Lambda]"]}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]], ")"}], "2"], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "8"}], ",", "8"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["l", "\[Lambda]"], ",", "1"}], "}"}], ",", 
     FractionBox["1", "8"], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RemoveSymbolize", "[", 
  TemplateBox[{
    FractionBox["l", "\[Lambda]"]},
   "NotationTemplateTag"], "]"}]}], "Input",
 CellChangeTimes->{{3.879179263419104*^9, 3.879179366314495*^9}, {
  3.87917941586835*^9, 3.879179641195277*^9}, {3.879179680585507*^9, 
  3.879179701308281*^9}, {3.8791797410996027`*^9, 3.879179768806946*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"8da4de29-78e9-4695-afe6-8d0c15c8f099"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Symbolize", "[", 
   TemplateBox[{
     FractionBox["l", "\[Lambda]"]},
    "NotationTemplateTag"], "]"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Pi]", 
           FractionBox["l", "\[Lambda]"], 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], "]"}], 
         "-", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Pi]", 
           FractionBox["l", "\[Lambda]"]}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]], ")"}], "2"], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["l", "\[Lambda]"], ",", "1"}], "}"}], ",", 
     FractionBox["1", "8"], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RemoveSymbolize", "[", 
  TemplateBox[{
    FractionBox["l", "\[Lambda]"]},
   "NotationTemplateTag"], "]"}]}], "Input",
 CellChangeTimes->{{3.879215739979905*^9, 3.8792157403882933`*^9}, {
  3.8792157742279787`*^9, 3.879215782214179*^9}, {3.8792171226984987`*^9, 
  3.8792171526658792`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"a33685ec-f8b9-47a6-bca9-0a0e511510eb"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlaneDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"\[ImaginaryJ]", " ", "60", " ", 
      SubscriptBox["I", "0"], " ", 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "R"}]], "R"], ")"}], 
      
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"k", " ", "l"}], "2"], 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "-", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", "l"}], "2"], "]"}]}], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "1"}], ",", 
   RowBox[{"l", "->", "0.6"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.879167116473239*^9, {3.879172952219509*^9, 3.879172952409608*^9}, {
   3.879180011262176*^9, 3.879180055818527*^9}, {3.879180087586618*^9, 
   3.879180109007353*^9}, {3.879180326951549*^9, 3.879180328511847*^9}, {
   3.879180468137581*^9, 3.879180468448525*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"ab9abafd-0893-4356-b492-1698559436ac"],

Cell[BoxData[
 RowBox[{"HertzianDipoleXZPlaneDensity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"\[ImaginaryJ]", " ", "60.0", " ", 
      SubscriptBox["I", "0"], " ", 
      RowBox[{"(", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "R"}]], "R"], ")"}], 
      
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"k", " ", "l"}], "2"], 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "-", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", "l"}], "2"], "]"}]}], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]]}], ",", "0"}], "}"}], ",", 
   RowBox[{
    SubscriptBox["I", "0"], "->", "1"}], ",", 
   RowBox[{"l", "->", "0.9"}], ",", 
   RowBox[{"f", "->", 
    SuperscriptBox["10", "9"]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.879167116473239*^9, {3.879172952219509*^9, 3.879172952409608*^9}, {
   3.879180011262176*^9, 3.879180055818527*^9}, {3.879180087586618*^9, 
   3.879180109007353*^9}, {3.879180326951549*^9, 3.879180328511847*^9}, {
   3.879180468137581*^9, 3.879180468448525*^9}, {3.879180538383256*^9, 
   3.879180538691215*^9}, {3.8883905090871267`*^9, 
   3.888390510748307*^9}},ExpressionUUID->"095d5994-92d7-42b7-8aa4-\
eea6d1c9367b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Antenna Arrays",
 IgnoreSpellCheck->True]], "Section",
 CellChangeTimes->{{3.8780159399163017`*^9, 3.878015945616811*^9}, {
  3.890752138138756*^9, 
  3.890752142472012*^9}},ExpressionUUID->"43019836-9e6c-42f6-9d9c-\
3f137279a2df"],

Cell[CellGroupData[{

Cell["Array Factor of a Linear Array", "Subsection",
 CellChangeTimes->{{3.8917726368478403`*^9, 3.891772644516675*^9}, {
  3.8917851541450987`*^9, 
  3.8917851607727537`*^9}},ExpressionUUID->"a7aacb35-442f-4a9d-942b-\
d45fdb8160d7"],

Cell[TextData[{
 "We know that for an array of identical antenna elements along the z-axis, \
the array factor is given by\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "1"}], 
          StyleBox["N", "TI"], LimitsPositioning -> True], 
         SubscriptBox[
          StyleBox["I", "TI"], 
          StyleBox["n", "TI"]], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            StyleBox["k", "TI"], 
            SubsuperscriptBox[
             StyleBox["z", "TI"], 
             StyleBox["n", "TI"], "\[Prime]"], "cos", "\[Theta]"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "AF = \\sum_{n=1}^{N} I_n e^{j k z_n' \\cos\\theta}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "638f36c0-f4af-49c5-af7c-08b75b001bc1"],
 "\n\nApart from the frequency which controls ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a0710038-d632-4d24-a221-4f540f739a79"],
 ", what other variables that we can control?"
}], "Text",
 CellChangeTimes->{{3.891605552782124*^9, 3.891605578592188*^9}, {
  3.8916074630353727`*^9, 3.891607502481873*^9}, {3.891607813285602*^9, 
  3.8916078274388037`*^9}, {3.891607873858974*^9, 3.891607874196759*^9}, {
  3.891614443542468*^9, 3.891614468347404*^9}, {3.891614582324086*^9, 
  3.891614587336108*^9}, {3.8916162430847387`*^9, 
  3.89161627463118*^9}},ExpressionUUID->"c4ce7111-cdb4-42eb-8947-\
b5b4f80fc886"],

Cell[TextData[{
 "Obviously, we can control the number of elements. In addition, we can \
control the feed current ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["n", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I_n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c93d314a-5740-49ee-b83f-011e21746598"],
 " and the position of each element ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["n", "TI"], "\[Prime]"], TraditionalForm], "errors" -> {}, 
     "input" -> "z_n'", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "166fb39d-4f65-4055-a603-d8c27aa95613"],
 ". We can set the positions by controlling the spacing between the \
elements."
}], "CodeText",
 CellChangeTimes->{{3.891614555826631*^9, 3.891614560176875*^9}, {
  3.891614599641996*^9, 3.891614709760297*^9}, {3.891616281172955*^9, 
  3.8916163025917807`*^9}},ExpressionUUID->"0372d76b-3fdf-4416-a04f-\
93030cf0d890"],

Cell[TextData[{
 "The following are two definitions for the array factor, both accept a list \
of complex currents ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["I", "TI"], 
        StyleBox["n", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "I_n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "372945ff-181a-49ac-a8a9-47efb2875ad1"],
 " and a list of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["n", "TI"], "\[Prime]"], TraditionalForm], "errors" -> {}, 
     "input" -> "z_n'", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "331b5929-d0e0-45b7-80ff-0ddb79af5e84"],
 " positions. The two lists should have the same length.  The first function \
AF1 is more generic, expressing the array factor in terms of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d59663cc-c598-45fd-b0c1-8d9bac56ba18"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["n", "TI"], "\[Prime]"], TraditionalForm], "errors" -> {}, 
     "input" -> "z_n'", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ec0588e7-3820-493c-a669-79dfbf02dffc"],
 ". The second function AF2 allows us to express the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["z", "TI"], 
        StyleBox["n", "TI"], "\[Prime]"], TraditionalForm], "errors" -> {}, 
     "input" -> "z_n'", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f2513002-4d0c-4be2-815a-fdec19386e1a"],
 " positions measured in wavelengths (i.e. electrical lengths), which can be \
useful for plotting. Try to come up with some examples of the array factor \
with these functions."
}], "Text",
 CellChangeTimes->{{3.8916147261084423`*^9, 3.8916147720264063`*^9}, {
  3.89161486157891*^9, 3.891615111729972*^9}, {3.891615353071746*^9, 
  3.891615373802236*^9}, {3.891647296319363*^9, 3.8916473141342897`*^9}, {
  3.891647358219575*^9, 
  3.891647361406172*^9}},ExpressionUUID->"96046000-947d-4ab9-983a-\
266d0b49b2e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AF1", "[", 
   RowBox[{"In_", ",", "zn_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"In", "[", 
       RowBox[{"[", "n", "]"}], "]"}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "k", " ", 
        RowBox[{"zn", "[", 
         RowBox[{"[", "n", "]"}], "]"}], 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"Length", "[", "In", "]"}]}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AF2", "[", 
   RowBox[{"In_", ",", "zn_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"In", "[", 
        RowBox[{"[", "n", "]"}], "]"}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "k", " ", 
         RowBox[{"zn", "[", 
          RowBox[{"[", "n", "]"}], "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]]}], "/.", 
      RowBox[{"k", "->", 
       FractionBox[
        RowBox[{"2", "\[Pi]"}], "\[Lambda]"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"Length", "[", "In", "]"}]}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891607876127967*^9, 3.8916079370736017`*^9}, {
   3.891607975510401*^9, 3.891608034737294*^9}, {3.891608087757297*^9, 
   3.891608099664124*^9}, {3.891608987899967*^9, 3.891609000261189*^9}, {
   3.891609188348425*^9, 3.891609242596657*^9}, 3.891609284353675*^9, {
   3.891609323785944*^9, 3.891609324910178*^9}, {3.891610599390861*^9, 
   3.891610599637258*^9}, 3.891614390736065*^9, {3.89161478298767*^9, 
   3.891614849996091*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"ff233e0a-5716-4ff3-b4eb-15b7b7bcb13c"],

Cell[TextData[{
 "First, we can imagine two identical current elements of value ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9c540a87-ac88-403b-9a02-e1a7261eadb8"],
 ", one located at position ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         FractionBox[
          StyleBox["d", "TI"], "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "-\\frac{d}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0a6c5115-e51e-4b32-a25a-90c1ad852d9c"],
 " and the other located at position ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        StyleBox["d", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{d}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "da9ef0bd-6d32-4a43-a23b-54585d0bb320"]
}], "CodeText",
 CellChangeTimes->{{3.8916151315237637`*^9, 3.891615245773638*^9}, {
  3.891616090224186*^9, 
  3.891616096931411*^9}},ExpressionUUID->"a88ddaa2-b70b-4c86-ba8c-\
039a508ac61b"],

Cell[BoxData[
 RowBox[{"AF1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["d", "2"]}], ",", 
     FractionBox["d", "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891608050219594*^9, 3.891608058943904*^9}, {
   3.8916081105673037`*^9, 3.891608124904739*^9}, {3.8916092355977783`*^9, 
   3.891609241329506*^9}, {3.891609286504159*^9, 3.891609321673979*^9}, 
   3.891614392213834*^9},
 CellLabel->
  "In[636]:=",ExpressionUUID->"b9328feb-c016-4868-ba11-0d85a5ef9e8a"],

Cell["Or more generally", "CodeText",
 CellChangeTimes->{{3.8916158844450197`*^9, 
  3.891615893963982*^9}},ExpressionUUID->"2d266174-2afa-4cee-83b4-\
cb492c5c6b72"],

Cell[BoxData[
 RowBox[{"AF1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["I", "0"], ",", 
     SubscriptBox["I", "0"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["d", "2"]}], ",", 
     FractionBox["d", "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891609397280671*^9, 3.891609428876142*^9}, {
   3.891609460511834*^9, 3.891609462531365*^9}, 3.891614395453969*^9},
 CellLabel->
  "In[680]:=",ExpressionUUID->"00e8e3c3-4da1-4c73-9564-b431cfbaf96e"],

Cell["\<\
What if we move the antenna elements along the z-axis while keeping their \
spacing:\
\>", "Text",
 CellChangeTimes->{{3.891615322074828*^9, 3.8916153473895187`*^9}, {
  3.891615441358827*^9, 
  3.891615476869121*^9}},ExpressionUUID->"2c3de4ea-6ed6-4466-8f63-\
7a29f9a4b4aa"],

Cell[BoxData[
 RowBox[{"AF1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["I", "0"], ",", 
     SubscriptBox["I", "0"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "d"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891615269558756*^9, 3.891615286474825*^9}, {
  3.891615911422768*^9, 3.891615913515234*^9}},
 CellLabel->
  "In[681]:=",ExpressionUUID->"cffe7076-d14d-442b-b291-f7dc3901e6bb"],

Cell["\<\
Although we get a different expression, I imagine the shape of the radiation \
pattern itself does not change.\
\>", "CodeText",
 CellChangeTimes->{{3.8916154825774317`*^9, 3.8916155694923162`*^9}, {
  3.891784979451907*^9, 
  3.891785001852849*^9}},ExpressionUUID->"715c4636-0cf5-4b58-b511-\
6a17b7c66632"],

Cell["\<\
This can be verified this later. For now, try to increase the number of \
antenna elements.\
\>", "Text",
 CellChangeTimes->{{3.891615576005525*^9, 3.891615631432803*^9}, {
  3.891615666403741*^9, 3.891615666938315*^9}, {3.8916157684496527`*^9, 
  3.8916157687209053`*^9}, {3.8917849898568993`*^9, 3.891784994957676*^9}, {
  3.891785097768632*^9, 
  3.891785111887669*^9}},ExpressionUUID->"a82ce633-5c2c-4506-9467-\
c74073cacfbe"],

Cell[TextData[{
 StyleBox["We can have three antenna elements with distance ", "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "732e93ef-0f1e-4633-8787-5b7bdc438f9f"], "CodeText"],
 StyleBox[" apart and increasing currents", "CodeText"]
}], "Text",
 CellChangeTimes->{{3.8916156732610826`*^9, 3.891615732627164*^9}, {
  3.891615937066546*^9, 
  3.8916159744945717`*^9}},ExpressionUUID->"63a7e702-b6a4-4365-87a9-\
0beb98814479"],

Cell[BoxData[
 RowBox[{"AF1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["I", "0"], ",", 
     RowBox[{"2", 
      SubscriptBox["I", "0"]}], ",", 
     RowBox[{"3", 
      SubscriptBox["I", "0"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "d", ",", 
     RowBox[{"2", "d"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891609017883054*^9, 3.891609029752412*^9}, {
   3.8916092372749557`*^9, 3.89160923997821*^9}, {3.8916093344898653`*^9, 
   3.891609335888653*^9}, 3.891614393327716*^9, {3.891615676625927*^9, 
   3.891615678323461*^9}, {3.891616076929349*^9, 3.891616078893422*^9}},
 CellLabel->
  "In[682]:=",ExpressionUUID->"5fb0cf12-52eb-4806-84c7-3ac1421f2de4"],

Cell["\<\
What about current elements with the same amplitude but a phase shift (i.e. \
complex currents)?\
\>", "Text",
 CellChangeTimes->{{3.891615787047398*^9, 3.891615811393969*^9}, {
  3.891615862206583*^9, 3.891615863224971*^9}, {3.8916159875405397`*^9, 
  3.891615991585834*^9}},ExpressionUUID->"9bf3eb0e-d08b-4eec-b7ed-\
d1d0d1115792"],

Cell[TextData[{
 "Let there be a phase shift of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0af50cfc-0d13-4b30-9737-798d1f9643ae"],
 " radians between two current elements"
}], "CodeText",
 CellChangeTimes->{{3.8916158270038137`*^9, 3.891615858464102*^9}, {
  3.89161600098774*^9, 
  3.891616009494672*^9}},ExpressionUUID->"f3ec8955-6780-45c4-a748-\
a7a5728825fc"],

Cell[BoxData[
 RowBox[{"AF1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["I", "0"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", 
        RowBox[{"\[Alpha]", "/", "2"}]}]]}], ",", 
     RowBox[{
      SubscriptBox["I", "0"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", 
        RowBox[{"\[Alpha]", "/", "2"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["d", "2"]}], ",", 
     FractionBox["d", "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891609397280671*^9, 3.891609428876142*^9}, 
   3.8916143940804567`*^9},
 CellLabel->
  "In[683]:=",ExpressionUUID->"6d960115-afbe-4b41-8772-b3a4fed2475e"],

Cell["\<\
Now, let us work with some actual values that we can plot. Use AF2 and \
express the locations measured in of wavelengths\
\>", "Text",
 CellChangeTimes->{{3.8916160546875753`*^9, 3.8916160630011253`*^9}, {
  3.891616110454422*^9, 3.891616163013557*^9}, {3.891647339727346*^9, 
  3.891647367907456*^9}},ExpressionUUID->"ce4bd7c4-3def-4877-89c2-\
c053c45aaee7"],

Cell[TextData[{
 "I guess we can reuse our first example, i.e.  two identical current \
elements of value ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "00a130e2-5653-44bd-9116-d4cbc1d1896b"],
 ", one located at position ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"-", 
         FractionBox["\[Lambda]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "-\\frac{\\lambda}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b24ecaf4-f25c-482f-acb5-5afcf2848c31"],
 " and the other located at position ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["\[Lambda]", "2"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{\\lambda}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac46aece-0954-49fa-950e-f7c9bd781afc"]
}], "CodeText",
 CellChangeTimes->{{3.891616171053946*^9, 
  3.891616189286253*^9}},ExpressionUUID->"276f842d-f841-4ecc-8cc6-\
0a2ef052b1c9"],

Cell[BoxData[
 RowBox[{"AF2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Lambda]", "2"]}], ",", 
     FractionBox["\[Lambda]", "2"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8916093685733547`*^9, 3.8916093784230833`*^9}},
 CellLabel->
  "In[684]:=",ExpressionUUID->"f409d9eb-f82a-4cf6-ba06-245875cda363"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-element Array (Broadside)", "Subsection",
 CellChangeTimes->{{3.890752156001874*^9, 3.890752160029393*^9}, {
  3.8916164362415237`*^9, 3.8916164465662403`*^9}, {3.8916164766139517`*^9, 
  3.891616478018298*^9}},ExpressionUUID->"abccb4b5-cf8c-47af-8812-\
b772eda66f7e"],

Cell["\<\
Let us plot this last example. Try to plot both in 2D and 3D simultaneously.\
\>", "Text",
 CellChangeTimes->{{3.890754667784526*^9, 3.890754678530759*^9}, {
  3.891616520539812*^9, 
  3.8916165749652977`*^9}},ExpressionUUID->"b028967c-019b-4b64-bc83-\
631b9869eab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotAF", "[", "af_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"af1", "=", 
      RowBox[{"af", "/.", 
       RowBox[{"\[Theta]", "->", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PolarPlot", "[", 
        RowBox[{
         RowBox[{"Abs", "[", "af1", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", 
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
         RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
       RowBox[{"SphericalPlot3D", "[", 
        RowBox[{
         RowBox[{"Abs", "[", "af", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890752224031396*^9, 3.890752430979671*^9}, {
   3.8907525293151608`*^9, 3.8907525516698523`*^9}, {3.890752611056533*^9, 
   3.890752620191729*^9}, {3.890752927154635*^9, 3.890752956376524*^9}, {
   3.890753223077471*^9, 3.890753340730529*^9}, {3.89075353406837*^9, 
   3.89075354770795*^9}, {3.8907538471958017`*^9, 3.890753887377252*^9}, {
   3.89075392740993*^9, 3.890753999232374*^9}, {3.890754092959141*^9, 
   3.890754190399703*^9}, {3.890754255241992*^9, 3.890754287210531*^9}, {
   3.8907543343148108`*^9, 3.890754451353332*^9}, 3.890754524694427*^9, {
   3.8916142673956413`*^9, 3.891614273440311*^9}, {3.8916143665659733`*^9, 
   3.891614371026602*^9}, {3.891616584732401*^9, 3.891616633161921*^9}, {
   3.891616752892228*^9, 3.891616777630274*^9}, {3.891616886348546*^9, 
   3.891616888290304*^9}, {3.891617321462441*^9, 3.891617371160754*^9}, {
   3.891617770210114*^9, 3.891617772550437*^9}, {3.891617818547852*^9, 
   3.89161784873037*^9}, {3.89161788621504*^9, 3.891617966269148*^9}, {
   3.8917856615985203`*^9, 3.891785673766724*^9}, {3.891785765761043*^9, 
   3.891785821388411*^9}, {3.8917858711315804`*^9, 3.89178587535413*^9}, {
   3.8917859136727657`*^9, 3.891785915849527*^9}, {3.891785969841194*^9, 
   3.891785979169032*^9}, {3.891786035944338*^9, 3.891786081574943*^9}, {
   3.891786132411598*^9, 3.8917861438366327`*^9}, {3.891786355077756*^9, 
   3.891786355220952*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"28d44c5e-f1a2-467e-bd75-4869e8788898"],

Cell[BoxData[
 RowBox[{"PlotAF", "[", 
  RowBox[{"AF2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Lambda]", "2"]}], ",", 
      FractionBox["\[Lambda]", "2"]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.8916177879831543`*^9, 3.8916179905574903`*^9, {3.89178614533848*^9, 
   3.891786147498333*^9}},
 CellLabel->
  "In[726]:=",ExpressionUUID->"e480b2dc-404d-4cb2-bf03-97a860ee6702"],

Cell["\<\
Recall previously we tried to move the antenna elements along the z-axis. Now \
it\[CloseCurlyQuote]s possible to see what happens.\
\>", "Text",
 CellChangeTimes->{{3.891617035890278*^9, 
  3.891617073255273*^9}},ExpressionUUID->"94a5eef1-5153-4188-9ea8-\
09a4207da7f0"],

Cell[TextData[{
 "Let us move the antenna elements together upwards by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["\[Lambda]", "2"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{\\lambda}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c5070226-731b-49d4-8c30-986a77149ef7"]
}], "CodeText",
 CellChangeTimes->{{3.8916170825631227`*^9, 3.891617109174715*^9}, {
  3.8917855391371603`*^9, 
  3.8917855397323627`*^9}},ExpressionUUID->"6a338c5c-ec7a-43d5-a2b5-\
377bf787e9fe"],

Cell[BoxData[
 RowBox[{"PlotAF", "[", 
  RowBox[{"AF2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "\[Lambda]"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8916168106983957`*^9, 3.891616814491509*^9}, {
  3.891616908901559*^9, 3.891616940990452*^9}},
 CellLabel->
  "In[727]:=",ExpressionUUID->"fb786934-1f62-41c4-9b23-89c19001e324"],

Cell["\<\
As predicted, the array factor pattern stays exactly the same.\
\>", "CodeText",
 CellChangeTimes->{{3.8916171240770903`*^9, 3.891617203601782*^9}, {
  3.89178554726003*^9, 
  3.891785553704667*^9}},ExpressionUUID->"e055d58b-d11a-45dd-8afa-\
b6d1eea94cb1"],

Cell["\<\
Now, recall the variables we can control in the array factor. If we keep the \
same number of element and the same currents, but change the distance between \
the elements, how does the array factor change?\
\>", "Text",
 CellChangeTimes->{{3.891617214251668*^9, 3.89161721797184*^9}, {
   3.891618039640078*^9, 3.891618097831979*^9}, 3.891785557572138*^9, {
   3.891786452899578*^9, 
   3.89178645617795*^9}},ExpressionUUID->"8156286c-8e77-4b40-bc8d-\
61b08fb3a558"],

Cell[TextData[{
 "Let the ",
 StyleBox["electrical distance",
  FontSlant->"Italic"],
 " between the two elements be ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a1faaf45-1f20-41cf-a501-94b540b20419"],
 ", we have"
}], "CodeText",
 CellChangeTimes->{{3.8916182471600647`*^9, 3.8916183402367887`*^9}, {
  3.891647389050555*^9, 3.891647396720819*^9}, {3.8917888105504932`*^9, 
  3.891788813530157*^9}},ExpressionUUID->"fae1061e-dd63-4629-9c34-\
12f069c46288"],

Cell[BoxData[
 RowBox[{"AF2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
     RowBox[{
      FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891618150935483*^9, 3.891618153128478*^9}, {
  3.891618183933242*^9, 3.8916182204621267`*^9}},
 CellLabel->
  "In[728]:=",ExpressionUUID->"a3450eab-85f1-4a0e-84bc-fd36fafe575b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ManipulateDistanceAF", "[", "af_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"af1", "=", 
      RowBox[{"af", "/.", 
       RowBox[{"\[Theta]", "->", 
        RowBox[{
         FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], "}"}], ",", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PolarPlot", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "af1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", 
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2.2"}], ",", "2.2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
           RowBox[{"SphericalPlot3D", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "af", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]", ",", "0", ",", 
               RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
            "RGBColorSwatchTemplate"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], 
             "}"}], "]"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "0.25", ",", "2", ",", "0.25"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890752224031396*^9, 3.890752430979671*^9}, {
   3.8907525293151608`*^9, 3.8907525516698523`*^9}, {3.890752611056533*^9, 
   3.890752620191729*^9}, {3.890752927154635*^9, 3.890752956376524*^9}, {
   3.890753223077471*^9, 3.890753340730529*^9}, {3.89075353406837*^9, 
   3.89075354770795*^9}, {3.8907538471958017`*^9, 3.890753887377252*^9}, {
   3.89075392740993*^9, 3.890753999232374*^9}, {3.890754092959141*^9, 
   3.890754190399703*^9}, {3.890754255241992*^9, 3.890754287210531*^9}, {
   3.8907543343148108`*^9, 3.890754451353332*^9}, 3.890754524694427*^9, {
   3.8916142673956413`*^9, 3.891614273440311*^9}, {3.8916143665659733`*^9, 
   3.891614371026602*^9}, {3.891616584732401*^9, 3.89161661052888*^9}, {
   3.8916172236711607`*^9, 3.8916172468350163`*^9}, {3.891618372864604*^9, 
   3.891618396448604*^9}, 3.89161847449929*^9, {3.8917864767057962`*^9, 
   3.891786505657846*^9}, {3.891786553388463*^9, 3.8917865551909513`*^9}, {
   3.89183204696388*^9, 3.8918320504634647`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"d0ef6701-f58f-4153-b535-c7700365ebad"],

Cell[BoxData[
 RowBox[{"ManipulateDistanceAF", "[", 
  RowBox[{"AF2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
      RowBox[{
       FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.891618420435039*^9, 3.891618424001115*^9}},
 CellLabel->
  "In[789]:=",ExpressionUUID->"2b6aeebf-7a0d-4cc7-ba90-64083d370d44"],

Cell[TextData[{
 "We can observe that the array factor always has a maximum for any spacing \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "68f9ea5c-f3a6-4f62-aafa-921b0110b317"],
 " along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", 
         FractionBox["\[Pi]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\theta = \\frac{\\pi}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ecdc689a-314e-4b73-9d48-da784091139b"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.891619451141632*^9, 
  3.891619496994578*^9}},ExpressionUUID->"d8598e08-bb70-4460-a585-\
01f9ffdd21fa"],

Cell["Indeed. This arrangement is called a broadside array.", "Text",
 CellChangeTimes->{{3.891619347593358*^9, 3.891619409802997*^9}, {
  3.891619512840114*^9, 3.891619529078538*^9}, {3.8917873860966587`*^9, 
  3.8917873888018503`*^9}},ExpressionUUID->"8f2a196c-03db-429d-9ca3-\
95d0b8474d83"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pattern Multiplication", "Subsection",
 CellChangeTimes->{{3.8917871942252283`*^9, 
  3.8917871994429083`*^9}},ExpressionUUID->"9392c315-a965-409e-9ea8-\
0546863ade3f"],

Cell[TextData[{
 "According to the ",
 StyleBox["pattern multiplication theorem",
  FontSlant->"Italic"],
 ", the ",
 StyleBox["array pattern",
  FontWeight->"Bold"],
 " is the product of the ",
 StyleBox["element pattern",
  FontWeight->"Bold"],
 " and the",
 StyleBox[" array factor",
  FontWeight->"Bold"],
 ". Recall that the normalized field pattern of a Hertzian dipole is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"sin", "\[Theta]"}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\sin \\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba9a4663-9c1b-4f92-ae8a-29cc5b283ffe"],
 ". Assume a two element broadside array where the elements are Hertzian \
dipoles, plot the element pattern, array factor and the resulting array \
pattern."
}], "Text",
 CellChangeTimes->{{3.891787207947735*^9, 3.891787229838499*^9}, {
  3.891787433320854*^9, 3.891787589308627*^9}, {3.8917876611630077`*^9, 
  3.8917876893238087`*^9}},ExpressionUUID->"4265c111-dfd6-4821-b7f1-\
f94050cdce9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PatternMultiplication", "[", 
   RowBox[{"elem_", ",", "af_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elem1", "=", 
       RowBox[{"elem", "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], ",", 
      RowBox[{"af1", "=", 
       RowBox[{"af", "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], ",", 
      RowBox[{"prod", "=", 
       RowBox[{"elem", "*", "af"}]}], ",", 
      RowBox[{"prod1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"elem", "*", "af"}], ")"}], "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}]}], "}"}], ",", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PolarPlot", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "elem1", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", 
                 RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "0.6"}], ",", "0.6"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLabel", "->", "\"\<Element Pattern\>\""}], ",", 
               RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PolarPlot", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "af1", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", 
                 RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "2.2"}], ",", "2.2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLabel", "->", "\"\<Array Factor\>\""}], ",", 
               RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PolarPlot", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "prod1", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", 
                 RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "2.2"}], ",", "2.2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLabel", "->", "\"\<Array Pattern\>\""}], ",", 
               RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"SphericalPlot3D", "[", 
              RowBox[{
               RowBox[{"Abs", "[", "prod", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Phi]", ",", "0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotLabel", "->", "\"\<Array Pattern\>\""}], ",", 
               RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], ",", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
            "RGBColorSwatchTemplate"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], 
             "}"}], "]"}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "0.25", ",", "2", ",", "0.25"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891787704302812*^9, 3.891787791100027*^9}, {
  3.891787874078671*^9, 3.891787881317523*^9}, {3.891787912549078*^9, 
  3.891787972866612*^9}, {3.8917880282582903`*^9, 3.89178814812477*^9}, {
  3.891788190713608*^9, 3.89178827122642*^9}, {3.8917883103109713`*^9, 
  3.891788312277042*^9}, {3.891788343993828*^9, 3.891788428666349*^9}, {
  3.8917885848199053`*^9, 3.891788629256866*^9}, {3.8918307551161003`*^9, 
  3.8918307954879417`*^9}, {3.8918317888500423`*^9, 3.891831797583577*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"fd71bcde-acbe-4f8e-8857-89db05688ccf"],

Cell[BoxData[
 RowBox[{"PatternMultiplication", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
   RowBox[{"AF2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
       RowBox[{
        FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.891787916231043*^9, 3.891787917180284*^9}, {
  3.891787988519252*^9, 3.891788006054476*^9}},
 CellLabel->
  "In[785]:=",ExpressionUUID->"70b0be3e-a702-4985-a45d-5d53dd54b2a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-element Array (End-fire)", "Subsection",
 CellChangeTimes->{{3.890752156001874*^9, 3.890752160029393*^9}, {
  3.8916108149700737`*^9, 3.891610819535254*^9}, {3.891616482197959*^9, 
  3.891616487955667*^9}},ExpressionUUID->"2a7d1e45-8f02-434c-945b-\
a402b9caadc5"],

Cell[TextData[{
 "In the broadside array case, the current elements are in phase. What if we \
now introduce a phase shift  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["k", "TI"], 
         StyleBox["d", "TI"]}], TraditionalForm], "errors" -> {}, "input" -> 
     "kd", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46201fb6-ad68-4494-a498-9a97363523c5"],
 "  between the two elements?"
}], "Text",
 CellChangeTimes->{{3.891618549348304*^9, 3.891618551201351*^9}, {
  3.8916190019673433`*^9, 3.8916190517108803`*^9}, {3.891647450904949*^9, 
  3.891647451818273*^9}, {3.891788734080941*^9, 
  3.891788765150261*^9}},ExpressionUUID->"ad239e20-fdbe-4e92-8e74-\
ef201736ffdc"],

Cell[TextData[{
 StyleBox["Since we are expressing the distance in terms of ", "CodeText"],
 StyleBox[Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Lambda]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\lambda", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]], "CodeText",ExpressionUUID->
  "080004eb-d5fb-4783-afc1-d0957711a6c3"], "CodeText"],
 StyleBox[", we have", "CodeText"]
}], "Text",
 CellChangeTimes->{{3.8916190542249393`*^9, 
  3.891619079402349*^9}},ExpressionUUID->"838158cf-07a9-4bd3-addc-\
778b4f27dcd5"],

Cell[BoxData[
 RowBox[{"AF2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "d", " ", 
       RowBox[{"\[Lambda]", " ", "/", " ", "2"}]}]], ",", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "k", " ", "d", " ", 
       RowBox[{"\[Lambda]", "/", " ", "2"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
     RowBox[{
      FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891618150935483*^9, 3.891618153128478*^9}, {
  3.891618183933242*^9, 3.8916182204621267`*^9}, {3.89161888517657*^9, 
  3.891618954812759*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"73f4abb1-e962-4a0e-865e-a1f0e87a5141"],

Cell[TextData[{
 "Plot this array factor and observe while changing the value of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5b75a493-3479-48b0-963d-5cb8f7a9b5fc"],
 ". What\[CloseCurlyQuote]s a distinct feature of this arrangement?"
}], "Text",
 CellChangeTimes->{{3.8918316755629797`*^9, 3.891831758161584*^9}, {
  3.891832254864295*^9, 
  3.891832260006563*^9}},ExpressionUUID->"b9fcaff8-913f-478b-a336-\
c78474b0885b"],

Cell[BoxData[
 RowBox[{"ManipulateDistanceAF", "[", 
  RowBox[{"AF2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "d", " ", 
        RowBox[{"\[Lambda]", " ", "/", " ", "2"}]}]], ",", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "k", " ", "d", " ", 
        RowBox[{"\[Lambda]", "/", " ", "2"}]}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
      RowBox[{
       FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.891619120724926*^9},
 CellLabel->
  "In[798]:=",ExpressionUUID->"dab5fca7-adbd-4c76-b652-a88621fd4e4d"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s interesting to see that the array factor has at least \
one maximum for any spacing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c89d20fc-c785-49d5-b118-2214dcbfbbf6"],
 ". In this case, the maximum is along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", "\[Pi]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\theta = \\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "66c8c04e-956a-4896-b1f4-a10e9d8f37ba"],
 ", but it\[CloseCurlyQuote]s easy to imagine that the maximum can be \
arranged to be along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\theta = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1d07b7b9-a843-4f99-8e8b-0209969ca83b"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.891619193992782*^9, 3.891619338892819*^9}, {
  3.891831766004219*^9, 
  3.891831766262128*^9}},ExpressionUUID->"76e6997c-da99-400a-8bd3-\
a1d027dd5a5e"],

Cell["\<\
Yes. When the array factor always has a maximum along the axis of the array, \
it is called an endfire array. Try to visualize the total pattern when the \
two elements are Hertzian dipoles.\
\>", "Text",
 CellChangeTimes->{{3.891619347593358*^9, 3.891619409802997*^9}, {
  3.891832808871594*^9, 
  3.89183284056384*^9}},ExpressionUUID->"1dc4b8ff-1f99-41e1-b3e2-\
0c8f07ce3575"],

Cell[BoxData[
 RowBox[{"PatternMultiplication", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
   RowBox[{"AF2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryJ]"}], " ", "k", " ", "d", " ", 
         RowBox[{"\[Lambda]", " ", "/", " ", "2"}]}]], ",", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "k", " ", "d", " ", 
         RowBox[{"\[Lambda]", "/", " ", "2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["d", "2"]}], " ", "\[Lambda]"}], ",", 
       RowBox[{
        FractionBox["d", "2"], " ", "\[Lambda]"}]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.891832858371793*^9},
 CellLabel->
  "In[800]:=",ExpressionUUID->"a6c91afb-fed2-417d-bda2-542cca3a4152"],

Cell[TextData[{
 "In this case, even though the array pattern has a maximum along ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Theta]", "\[LongEqual]", "\[Pi]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\theta = \\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ac894550-5920-4839-a222-febed0cac512"],
 ", the total pattern does not. This is due to the fact that the element \
pattern has a null along the same direction."
}], "CodeText",
 CellChangeTimes->{{3.891833394019726*^9, 
  3.891833506935074*^9}},ExpressionUUID->"7b118af9-5ab9-4db2-9a71-\
0b2c0134c98a"],

Cell["\<\
TODO: compute directivity
TODO: grating lobe
TODO: maxima & nulls\
\>", "Text",
 CellChangeTimes->{{3.891619615325276*^9, 3.891619633563026*^9}, {
  3.89164679415858*^9, 3.891646801491693*^9}, {3.891832274441942*^9, 
  3.891832277992751*^9}, {3.891832391379262*^9, 3.891832395467902*^9}, {
  3.891833549197113*^9, 
  3.8918335567389307`*^9}},ExpressionUUID->"0334191e-d74d-47bb-b3cb-\
35d8d14a5dc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Uniform Array", "Subsection",
 CellChangeTimes->{{3.890752156001874*^9, 3.890752160029393*^9}, {
  3.8916108149700737`*^9, 3.891610819535254*^9}, {3.891610966926937*^9, 
  3.8916109694675217`*^9}},ExpressionUUID->"c284dfdd-f1ae-4b3b-86c9-\
4d7d93f7a3c0"],

Cell[TextData[{
 "The two element array is a special case of a uniform array, where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e5e0deb-5ada-46cd-8459-b87109a82499"],
 " elements are placed along the z-axis with equal distance ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6481ef9f-4e45-4bea-ba76-345ca4814f10"],
 ", and the currents are of equal magnitude with a progressive phase shift ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a3a9aaf4-2816-4042-aacf-cd274b467a0f"],
 " between the elements.\n\nFor a uniform array, the analysis is usually \
transformed into the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ec58d15-88b3-4660-b07a-5e8d6304bc67"],
 " domain, where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Psi]", "\[LongEqual]", 
         StyleBox["k", "TI"], 
         StyleBox["d", "TI"], "cos", "\[Theta]", "+", "\[Alpha]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi = k d \\cos \\theta + \\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cca32d45-151c-4c31-bacd-182ecb67fee3"],
 ". This way, the array factor can be expressed as\[LineSeparator]\
\[LineSeparator]",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "1"}], 
          StyleBox["N", "TI"], LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            RowBox[{"(", 
              RowBox[{
                StyleBox["n", "TI"], "-", "1"}], ")"}], "\[Psi]"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "AF = \\sum_{n=1}^{N}e^{j(n-1)\\psi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1ded1f65-83dd-475f-933b-48dae4d5e9a9"],
 "\n\nor, through some algebraic manipulation,\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{
               StyleBox["j", "TI"], 
               StyleBox["N", "TI"], "\[Psi]"}]], "-", "1"}], 
          RowBox[{
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{
               StyleBox["j", "TI"], "\[Psi]"}]], "-", "1"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "AF = \\frac{e^{j N \\psi} - 1}{e^{j \\psi} - 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bd55d933-ecc1-4b19-b230-2484fb7e89dd"],
 "\[LineSeparator]\[LineSeparator]What relationship can you tell about ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "84a80e4a-25f6-40a7-943b-66be261f47df"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "af516e61-b884-426e-8289-b1c026cc0858"],
 "?"
}], "Text",
 CellChangeTimes->{{3.891619823087318*^9, 3.891619829840604*^9}, {
  3.8916199058996468`*^9, 3.891619929459*^9}, {3.891620122036565*^9, 
  3.8916201404440804`*^9}, {3.891646469982895*^9, 3.891646473992708*^9}, {
  3.8916468457891417`*^9, 3.891646862685643*^9}, {3.891647904530382*^9, 
  3.891647925071498*^9}, {3.891648108064378*^9, 3.8916481125591717`*^9}, {
  3.8918339902444696`*^9, 3.8918341319977303`*^9}, {3.891834601136036*^9, 
  3.891834614009162*^9}},ExpressionUUID->"eb838e26-2e8e-44b6-8400-\
a62f3434aab3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Psi", "[", 
   RowBox[{"d_", ",", "\[Alpha]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"2", "\[Pi]", " ", "d", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", "\[Alpha]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891611019954536*^9, 3.891611024901863*^9}, {
   3.891611074745667*^9, 3.891611107002675*^9}, 3.891611392724629*^9, {
   3.892212758807137*^9, 3.892212763126989*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"9d8e2164-a56b-48dd-afa0-8d67ae159a76"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Psi", "[", 
      RowBox[{"d", " ", ",", "\[Alpha]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{
        RowBox[{"-", "3"}], "\[Pi]"}], ",", 
       RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], "\[Pi]"}], ",", 
          RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ColorFunctionScaling", "->", "False"}], ",", 
     RowBox[{"ColorFunction", "->", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Psi]"}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"0", "<=", "\[Theta]", "<=", "\[Pi]"}], ",", 
          TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
           "RGBColorSwatchTemplate"], ",", 
          TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
           "RGBColorSwatchTemplate"]}], "]"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0.25", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891611111748724*^9, 3.891611112689349*^9}, {
   3.8916111458247557`*^9, 3.891611219186705*^9}, {3.891619859408361*^9, 
   3.891619884636237*^9}, {3.8916199891460323`*^9, 3.891620086216819*^9}, {
   3.891620330094331*^9, 3.891620365229341*^9}, {3.891620395735436*^9, 
   3.8916205141885557`*^9}, {3.891620660516884*^9, 3.891620680694778*^9}, {
   3.8916208059646873`*^9, 3.891620811917611*^9}, {3.891620848969647*^9, 
   3.8916208495396957`*^9}, 3.8922127648003063`*^9},
 CellLabel->
  "In[1934]:=",ExpressionUUID->"10e278cc-7470-4322-8d96-d87951d53389"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s easy to see that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "24514635-78ec-452c-84ad-20ea915f5732"],
 " is a periodic function since it\[CloseCurlyQuote]s just cosine scaled and \
shifted vertically. On the other hand, in the real world ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d937924e-d864-4218-8e6f-e0efeecec3d0"],
 " changes from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["0", TraditionalForm], "errors" -> {}, "input" -> "0", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0160059e-0a64-4f3b-9d65-6e8e436aa3ac"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Pi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7802a13b-db59-434a-b4d2-f7328fe03209"],
 ", thus only a small section of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5760ce58-788c-40c2-9723-9cda9005bef2"],
 " is actually meaningful."
}], "CodeText",
 CellChangeTimes->{{3.8916468694048433`*^9, 3.8916469469106903`*^9}, {
  3.8916470183440533`*^9, 3.891647077046475*^9}, {3.891834801307188*^9, 
  3.891834803293932*^9}},ExpressionUUID->"bb8aa733-3d24-4e24-bf49-\
188c9419b36f"],

Cell[TextData[{
 "This section is called the visible region and is highlighted in the plot \
above. How does the element spacing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9dbcaa7a-9ee7-4c05-a9c0-eb2e5cbb6210"],
 " and progressive phase shift ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "11c32f6e-775d-4585-b05a-ba395e0b09fe"],
 " affect the visible region?"
}], "Text",
 CellChangeTimes->{{3.891647080393182*^9, 3.891647100882403*^9}, {
  3.891647150199991*^9, 3.891647174230144*^9}, {3.8916475319233522`*^9, 
  3.891647538064909*^9}, {3.891834830688115*^9, 
  3.891834838473695*^9}},ExpressionUUID->"085905f6-68c0-441b-a774-\
cc20a592d7e7"],

Cell[TextData[{
 "Obviously, the visible region increases with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8fca3e2e-f010-4fd3-930d-4b79b03f9f59"],
 ". A positive phase shift ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e18cf851-ee4f-49e2-8e19-71ae6eb704f0"],
 " shifts ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3e4b70a5-a197-4155-96b8-b202ebeb1c8a"],
 " towards the positive side, but it does not change the size of the visible \
region."
}], "CodeText",
 CellChangeTimes->{{3.891647188320936*^9, 3.8916472588987637`*^9}, {
  3.891647509032433*^9, 3.89164762909044*^9}, {3.891834854601684*^9, 
  3.891834854961215*^9}},ExpressionUUID->"320ac3d4-663f-454a-84e1-\
8388bdf636f3"],

Cell[TextData[{
 "Now, since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f67f4e1c-11e4-4649-b8a7-bacd13f43b78"],
 " is transformed into the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ad1b90b-8913-4d77-b115-33f578ce98e8"],
 " domain, try to plot the array factor in the Cartesian coordinate in terms \
of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1957064d-c4c8-47c7-9c10-610bdd5d3e65"],
 "."
}], "Text",
 CellChangeTimes->{{3.891647832353592*^9, 3.891647889080986*^9}, {
  3.89183495413923*^9, 
  3.891834977908676*^9}},ExpressionUUID->"657c0faa-8fce-4f84-adce-\
23eadef52223"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "N", " ", "\[Psi]"}]], "-", "1"}], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", "1"}]], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", 
         RowBox[{
          RowBox[{"-", "5"}], "\[Pi]"}], ",", 
         RowBox[{"5", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
         "RGBColorSwatchTemplate"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8916118119642143`*^9, 3.891611840173252*^9}, {
   3.891611875820702*^9, 3.891611889355493*^9}, {3.891611960916263*^9, 
   3.891611979751087*^9}, 3.89164825231102*^9, 3.891834949391142*^9, {
   3.8918350296437607`*^9, 3.89183503225562*^9}, 3.891835630943434*^9},
 CellLabel->
  "In[808]:=",ExpressionUUID->"6f7bc397-711f-49f3-aa5c-cd13dd2fdb6d"],

Cell["What observations can you make here?", "Text",
 CellChangeTimes->{{3.891648163748967*^9, 
  3.891648198032178*^9}},ExpressionUUID->"dce2da70-07f9-494e-a389-\
68d2e3a53d7e"],

Cell[TextData[{
 "1. The array factor of the uniform array is periodic with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "794a6172-ab2e-4472-8237-db4c98058237"],
 ".\n2. The maximum of the array factor is just ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "11e8a95a-d0f1-49a1-8094-05bad9be1bb3"],
 " so as ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1eb250b7-0bcb-4f1f-a046-b68f701c44a3"],
 " increases the magnitude of the array factor also increases.\n3. The \
locations of the maxima do not change. They are located at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[PlusMinus]", "2", 
         StyleBox["m", "TI"], "\[Pi]"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\pm 2 m\\pi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9215f0bc-0c0e-4cfd-b587-aad51da326ee"],
 " where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["m", "TI"], "\[LongEqual]", "0", ",", "1", ",", "2", ",", 
         "3", ",", "..."}], TraditionalForm], "errors" -> {}, "input" -> 
     "m = 0, 1, 2, 3, ...", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "95b8cac0-eb10-4f9c-9bb6-3a27b1e58f7f"],
 "\n4. \[OpenCurlyDoubleQuote]side lobes\[CloseCurlyDoubleQuote] start \
appearing once  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], ">", "2"}], TraditionalForm], "errors" -> {}, 
     "input" -> "N > 2", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6dfe96b5-839a-4d35-a89a-668e47173335"],
 ".\n5. There are ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "-", "1"}], TraditionalForm], "errors" -> {}, 
     "input" -> "N-1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a00b047f-b8df-4470-9211-00839914d558"],
 " nulls between two maximums."
}], "CodeText",
 CellChangeTimes->{{3.8916482083478203`*^9, 3.8916482175642776`*^9}, {
  3.891648270056911*^9, 3.891648569455592*^9}, {3.8918366610039988`*^9, 
  3.89183667269928*^9}, {3.891836766978182*^9, 
  3.8918368828602743`*^9}},ExpressionUUID->"5553f038-716c-41c5-a825-\
4e30d67d0b93"],

Cell[TextData[{
 "The last observation is a good point. It allows us to easily determine the \
number of array elements from the plot. In addition, the lobe containing the \
maximum corresponding to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["m", "TI"], "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "m = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b5da41f3-4875-4a8e-84d6-338b74531562"],
 " is the main lobe. The other lobes containing the maxima are called ",
 StyleBox["grating lobes",
  FontWeight->"Bold"],
 ".\n\nNow, it can be shown that the magnitude of the array factor can be \
reduced to\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       TemplateBox[{
         RowBox[{
           StyleBox["A", "TI"], 
           StyleBox["F", "TI"], "|", "\[LongEqual]", "|", 
           FractionBox[
            RowBox[{"sin", 
              FractionBox[
               RowBox[{
                 StyleBox["N", "TI"], "\[Psi]"}], "2"]}], 
            RowBox[{"sin", 
              FractionBox["\[Psi]", "2"]}]]}]}, "Abs"], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\lvert AF \\rvert = \\lvert \
\\frac{\\sin{\\frac{N\\psi}{2}}}{\\sin{\\frac{\\psi}{2}}} \\rvert", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0406a4e7-b347-4efb-a7c9-df104519a4bb"],
 "\n\nFurthermore, it is often more convenient to normalize the magnitude\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       TemplateBox[{
         RowBox[{
           StyleBox["A", "TI"], 
           SubscriptBox[
            StyleBox["F", "TI"], 
            StyleBox["n", "TI"]], "|", "\[LongEqual]", "|", 
           FractionBox[
            RowBox[{"sin", 
              FractionBox[
               RowBox[{
                 StyleBox["N", "TI"], "\[Psi]"}], "2"]}], 
            RowBox[{
              StyleBox["N", "TI"], "sin", 
              FractionBox["\[Psi]", "2"]}]]}]}, "Abs"], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\lvert AF_n \\rvert = \\lvert \\frac{\\sin{\\frac{N\\psi}{2}}}{N\\sin{\
\\frac{\\psi}{2}}} \\rvert", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8b627a08-5cbb-415e-aa32-06d68165f888"],
 "\n\nShow that the normalized array factor gives the same shape compared to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          SuperscriptBox[
           StyleBox["e", "TI"], 
           RowBox[{
             StyleBox["j", "TI"], 
             StyleBox["N", "TI"], "\[Psi]"}]], "-", "1"}], 
        RowBox[{
          SuperscriptBox[
           StyleBox["e", "TI"], 
           RowBox[{
             StyleBox["j", "TI"], "\[Psi]"}]], "-", "1"}]], TraditionalForm], 
     "errors" -> {}, "input" -> "\\frac{e^{j N \\psi} - 1}{e^{j \\psi} - 1}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5f848d1d-0ad3-4bcc-ae91-89da74194a92"],
 "."
}], "Text",
 CellChangeTimes->{{3.8916485879987164`*^9, 3.891648684019759*^9}, {
  3.891648802305475*^9, 3.891648889094153*^9}, {3.891648933976369*^9, 
  3.891648964892528*^9}, {3.891837018929144*^9, 
  3.8918370772075853`*^9}},ExpressionUUID->"aa2f32d3-5adb-4084-ac60-\
3fff39f2d133"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        FractionBox[
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
         RowBox[{"N", " ", 
          RowBox[{"Sin", "[", 
           FractionBox["\[Psi]", "2"], "]"}]}]], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", 
         RowBox[{
          RowBox[{"-", "5"}], "\[Pi]"}], ",", 
         RowBox[{"5", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", "Full"}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{
          TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
           "RGBColorSwatchTemplate"], ",", 
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "#", " ", "\[Pi]"}], ",", "1"}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "]"}]}], "]"}]}], "}"}]}]}], 
      "]"}], ",", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
         "RGBColorSwatchTemplate"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.891649688793696*^9, 3.891649688973278*^9}, {
  3.891835614198102*^9, 3.891835647377324*^9}, {3.891837255421218*^9, 
  3.8918373122545223`*^9}, {3.89183834745284*^9, 3.891838366586549*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"8524f413-7369-4ec8-ab7d-e2cf17699451"],

Cell["The maxima points are shown as well this time.", "CodeText",
 CellChangeTimes->{{3.89183861621312*^9, 
  3.891838636475608*^9}},ExpressionUUID->"734b24cb-88cd-43ba-8d3c-\
657be58f1e98"],

Cell["\<\
Now, recall that only a small section of this plot is meaningful \
realistically. Try to plot the normalized array factor with visible region \
shown.\
\>", "Text",
 CellChangeTimes->{{3.891649009596957*^9, 3.891649119217635*^9}, {
  3.891835659407776*^9, 
  3.891835669599078*^9}},ExpressionUUID->"eb0dd757-9440-4f3c-b181-\
e938a84671b8"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          FractionBox[
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
           RowBox[{"N", " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Psi]", "2"], "]"}]}]], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Psi]", ",", 
           RowBox[{
            RowBox[{"-", "5"}], "\[Pi]"}], ",", 
           RowBox[{"5", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          FractionBox[
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
           RowBox[{"N", " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Psi]", "2"], "]"}]}]], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Psi]", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], "\[Pi]", " ", "d"}], "+", 
            RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ",", 
           RowBox[{
            RowBox[{"2", "\[Pi]", " ", "d"}], "+", 
            RowBox[{"\[Alpha]", " ", "\[Pi]"}]}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            
            TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], "}"}],
           "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[Alpha]: \>\"", ",", "\[Alpha]", ",", "\"\<\[Pi]\>\""}], 
           "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "0.5"}], "}"}], ",", "0.25", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0.25"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8916115602804003`*^9, 3.8916116651291647`*^9}, {
   3.8916116979934263`*^9, 3.891611723362895*^9}, {3.89161191744591*^9, 
   3.891611944447035*^9}, {3.891647718323668*^9, 3.891647742432892*^9}, {
   3.891649169432913*^9, 3.891649278246801*^9}, {3.891649380318514*^9, 
   3.891649391653161*^9}, {3.891649535067698*^9, 3.8916495664980783`*^9}, {
   3.891649696293545*^9, 3.891649774133752*^9}, {3.891649836193616*^9, 
   3.891649894324559*^9}, {3.891649957044701*^9, 3.891650224887918*^9}, {
   3.891650255850175*^9, 3.8916502568028927`*^9}, {3.891650288241485*^9, 
   3.8916504284662533`*^9}, {3.89165046171384*^9, 3.891650504966704*^9}, {
   3.891651247674786*^9, 3.891651279607243*^9}, {3.8918356841019983`*^9, 
   3.891835701990109*^9}, 3.891838705813208*^9, {3.8922125006952267`*^9, 
   3.8922125009135647`*^9}, 3.892214676908991*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"4cea7bd7-be24-4d15-8228-96e20cd6d21a"],

Cell["\<\
When do the grating lobes start appearing in the visible region?\
\>", "Text",
 CellChangeTimes->{{3.891838668446561*^9, 3.891838692635578*^9}, {
  3.8918397033348427`*^9, 
  3.8918397054825487`*^9}},ExpressionUUID->"0b7113f0-d6ba-462a-95e9-\
d7ef0c74f731"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2e3ea44a-9f16-4291-ada3-b6a3d54c3fa9"],
 " is slightly larger than ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["\[Lambda]", "2"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{\\lambda}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6747e39c-f7a4-47f0-b3fd-12b63e22cc1f"],
 ",  grating lobes start appearing in the visible region when we change ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4a749462-1d25-45a7-a57b-4391f6f19cc0"],
 ". When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "434a4a94-c14b-4e36-b461-3e791833d1dc"],
 " is large,  grating lobes can appear even when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Alpha]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\alpha = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0bad148a-7d2b-4e11-9fdf-6f1ebc9807f3"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.891838743894167*^9, 3.89183878809233*^9}, {
  3.891839701139738*^9, 3.891839809662965*^9}, {3.89184024841711*^9, 
  3.891840283559416*^9}},ExpressionUUID->"a607e1fe-2d5a-407c-b31e-\
c158f747410c"],

Cell[TextData[{
 "Now, let\[CloseCurlyQuote]s study the peaks of the array factor. It can be \
shown that the peaks of the array factor of an N-element uniform array are \
the solutions of\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "tan", 
         FractionBox["\[Psi]", "2"], "\[LongEqual]", "tan", 
         FractionBox[
          RowBox[{
            StyleBox["N", "TI"], "\[Psi]"}], "2"]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "N\\tan{\\frac{\\psi}{2}}=\\tan{\\frac{N\\psi}{2}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "53d420d4-ec54-4fe7-9005-28b70ebb77e3"],
 "\n\nTry to solve this equation with Mathematica with a special case of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cd683861-e8ce-47c8-b822-fbfe42ac3296"],
 "."
}], "Text",
 CellChangeTimes->{{3.891651389842914*^9, 3.891651441370329*^9}, {
  3.8916514970971737`*^9, 3.891651508258627*^9}, {3.891840294916297*^9, 
  3.8918403127377033`*^9}, {3.891840747158659*^9, 
  3.891840753929967*^9}},ExpressionUUID->"763727f4-0936-40e4-a189-\
823275107261"],

Cell[TextData[{
 "Since this equation has infinite number of solutions, \
let\[CloseCurlyQuote]s limit ourselves to e.g. the range of  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"[", 
         RowBox[{"-3", "\[Pi]", ",", "3", "\[Pi]"}], "]"}], TraditionalForm], 
     "errors" -> {}, "input" -> "[-3\\pi, 3\\pi]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9232c9b4-fdd2-4841-be5d-308567f84c50"],
 " and solve for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "\[LongEqual]", "4"}], TraditionalForm], 
     "errors" -> {}, "input" -> "N = 4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7a296d25-49df-40d0-946b-b62590fe0942"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.89220990153014*^9, 
  3.892209956223906*^9}},ExpressionUUID->"1d41d224-09db-41d8-affa-\
1bbccbf3540e"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"N", " ", 
         RowBox[{"Tan", "[", 
          FractionBox["\[Psi]", "2"], "]"}]}], "==", 
        RowBox[{"Tan", "[", 
         FractionBox[
          RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}]}], "/.", 
       RowBox[{"N", "->", "4"}]}], ")"}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], "\[Pi]"}], "<=", "\[Psi]", "<=", 
      RowBox[{"3", "\[Pi]"}]}]}], ",", "\[Psi]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.891916161742242*^9, 3.891916218131988*^9}, {
  3.8919163443332644`*^9, 3.891916355295023*^9}, {3.892208892586111*^9, 
  3.892208904073036*^9}, {3.8922090622636137`*^9, 3.892209085234405*^9}, {
  3.892209355101017*^9, 3.892209356335793*^9}, {3.89220957098769*^9, 
  3.892209612740917*^9}, {3.892209651698924*^9, 3.892209652087247*^9}, {
  3.8922106394624987`*^9, 3.892210642235334*^9}},
 CellLabel->
  "In[1893]:=",ExpressionUUID->"42df0725-921e-4de1-8a7a-82f340acdf9d"],

Cell[TextData[{
 "Visually, the solutions to this equation are the intersection points of the \
left and right hand sides of the equation, i.e. ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "tan", 
         FractionBox["\[Psi]", "2"]}], TraditionalForm], "errors" -> {}, 
     "input" -> "N\\tan{\\frac{\\psi}{2}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b86cebb5-81da-4cf0-a546-a0fdd2e23670"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"tan", 
         FractionBox[
          RowBox[{
            StyleBox["N", "TI"], "\[Psi]"}], "2"]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\tan{\\frac{N\\psi}{2}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "36ad672e-682d-42af-8539-7dad96c42c14"],
 ":"
}], "Text",
 CellChangeTimes->{{3.892210007160801*^9, 3.892210117061504*^9}, 
   3.8922102359382544`*^9, {3.89221028700618*^9, 
   3.892210360923408*^9}},ExpressionUUID->"9f2f58da-c6f0-444b-a9a7-\
09623bfd6e6e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sol", "=", 
       RowBox[{"ToRules", "[", 
        RowBox[{"Reduce", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"N", " ", 
              RowBox[{"Tan", "[", 
               FractionBox["\[Psi]", "2"], "]"}]}], "==", 
             RowBox[{"Tan", "[", 
              FractionBox[
               RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}]}], ")"}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "\[Pi]"}], "<=", "\[Psi]", "<=", 
            RowBox[{"3", "\[Pi]"}]}]}], ",", "\[Psi]"}], "]"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"N", " ", 
          RowBox[{"Tan", "[", 
           FractionBox["\[Psi]", "2"], "]"}]}], ",", 
         RowBox[{"Tan", "[", 
          FractionBox[
           RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], ",", 
         RowBox[{"Abs", "[", 
          FractionBox[
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
           RowBox[{" ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Psi]", "2"], "]"}]}]], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Psi]", ",", 
         RowBox[{
          RowBox[{"-", "3"}], "\[Pi]"}], ",", 
         RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], "\[Pi]"}], ",", 
            RowBox[{"3", "\[Pi]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"N", " ", 
           RowBox[{"Tan", "[", 
            FractionBox["\[Psi]", "2"], "]"}]}], ",", 
          RowBox[{"Tan", "[", 
           FractionBox[
            RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], ",", "AF"}], "}"}]}], 
       ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"{", 
         RowBox[{
          TemplateBox[<|"color" -> RGBColor[0.922526, 0.385626, 0.209179]|>,
           "RGBColorSwatchTemplate"], ",", 
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Psi]", ",", "0"}], "}"}], "/.", 
            RowBox[{"{", "sol", "}"}]}], "]"}]}], "}"}]}]}], "]"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", ",", "2"}], "}"}], ",", "2", ",", "6", ",", "1"}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.891612459997361*^9, 3.891612539562361*^9}, {
   3.891612605215022*^9, 3.891612639882469*^9}, {3.891612675480974*^9, 
   3.891612693901844*^9}, {3.89161273255689*^9, 3.891612734033001*^9}, {
   3.8916127982433968`*^9, 3.891612818788784*^9}, {3.891651521617558*^9, 
   3.89165153113018*^9}, {3.8916516319121523`*^9, 3.8916516924114027`*^9}, {
   3.8918405851255827`*^9, 3.891840656174223*^9}, {3.891840701722453*^9, 
   3.8918407028280478`*^9}, {3.891840920466899*^9, 3.8918409617897053`*^9}, {
   3.891841336044931*^9, 3.89184147107441*^9}, {3.891841513028536*^9, 
   3.8918415584838333`*^9}, {3.891841590480352*^9, 3.8918416200103073`*^9}, {
   3.8918419809808064`*^9, 3.891842001528119*^9}, 3.8918422543434067`*^9, {
   3.892209117806436*^9, 3.892209169078843*^9}, {3.892209247202071*^9, 
   3.892209325131674*^9}, {3.892209372465878*^9, 3.8922093794117327`*^9}, {
   3.892209409937202*^9, 3.89220948986895*^9}, {3.8922103906622887`*^9, 
   3.892210390871079*^9}, {3.892210451646413*^9, 3.8922104677597237`*^9}, {
   3.892210503714617*^9, 3.8922105095754757`*^9}, {3.892210912125738*^9, 
   3.8922109269452972`*^9}, {3.892211235234289*^9, 3.8922112902694283`*^9}},
 CellLabel->
  "In[1899]:=",ExpressionUUID->"81653b3d-1ca2-41b4-b81d-98494b941c19"],

Cell["\<\
(TODO: It seems that Mathematica does not solve all roots of the equation?)\
\>", "CodeText",
 CellChangeTimes->{{3.8922113102913933`*^9, 
  3.8922113406900187`*^9}},ExpressionUUID->"564809ed-1b82-4f21-96bb-\
e8f6d8ad0ea5"],

Cell["\<\
We can see that the maxima of the normalized array factor are obtained at the \
points where the blue curves intersect with the orange curves and both have \
the value zero.\
\>", "CodeText",
 CellChangeTimes->{{3.891651736188388*^9, 3.891651811718528*^9}, {
  3.892211383802964*^9, 
  3.892211524421405*^9}},ExpressionUUID->"78c03e40-df50-49e8-a0cd-\
abd73bde31d1"],

Cell[TextData[{
 "So far, we have been working with the transformed ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "421f05fa-3700-4bd0-8e87-41f9c9930372"],
 " domain. To have a better visual understanding, we can plot the visible \
array factor in the polar space simultaneously in the original ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Theta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\theta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b3399632-f4be-4419-b0ba-9347139112e6"],
 " domain."
}], "Text",
 CellChangeTimes->{{3.8922115569098663`*^9, 3.8922116155843773`*^9}, {
  3.8922120850434837`*^9, 3.892212137281145*^9}, {3.8922148285659323`*^9, 
  3.892214829478366*^9}},ExpressionUUID->"40a6fd76-523f-4071-8fe0-\
d65a0b6b81a9"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             FractionBox[
              RowBox[{"Sin", "[", 
               FractionBox[
                RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
              RowBox[{"N", " ", 
               RowBox[{"Sin", "[", 
                FractionBox["\[Psi]", "2"], "]"}]}]], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Psi]", ",", 
              RowBox[{
               RowBox[{"-", "5"}], "\[Pi]"}], ",", 
              RowBox[{"5", "\[Pi]"}]}], "}"}], ",", 
            RowBox[{"ImageSize", "->", "Large"}], ",", 
            RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             FractionBox[
              RowBox[{"Sin", "[", 
               FractionBox[
                RowBox[{"N", " ", "\[Psi]"}], "2"], "]"}], 
              RowBox[{"N", " ", 
               RowBox[{"Sin", "[", 
                FractionBox["\[Psi]", "2"], "]"}]}]], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Psi]", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "\[Pi]", " ", "d"}], "+", 
               RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ",", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "d"}], "+", 
               RowBox[{"\[Alpha]", " ", "\[Pi]"}]}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "->", 
             RowBox[{"{", 
              RowBox[{
               
               TemplateBox[<|
                "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
                "RGBColorSwatchTemplate"], ",", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"PolarPlot", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           FractionBox[
            RowBox[{"Sin", "[", 
             FractionBox[
              RowBox[{"N", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "\[Pi]", " ", "d", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{
                    FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], 
                 "+", 
                 RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ")"}]}], "2"], "]"}], 
            RowBox[{"N", " ", 
             RowBox[{"Sin", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "d", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], "+", 
                RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], "2"], "]"}]}]], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
          "RGBColorSwatchTemplate"], ",", 
         TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
          "RGBColorSwatchTemplate"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], "}"}],
           "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[Alpha]: \>\"", ",", "\[Alpha]", ",", "\"\<\[Pi]\>\""}], 
           "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", ",", "0.5"}], "}"}], ",", "0.25", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1", ",", "0.25"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892211664744911*^9, 3.892211677379601*^9}, {
   3.892211738674994*^9, 3.8922117540255213`*^9}, {3.892211808526177*^9, 
   3.892212001437827*^9}, {3.892212156575263*^9, 3.892212188421685*^9}, {
   3.8922122913157177`*^9, 3.892212317415564*^9}, {3.8922123798236094`*^9, 
   3.892212386252235*^9}, {3.892212445331242*^9, 3.89221245073088*^9}, {
   3.8922125191102953`*^9, 3.892212543958129*^9}, {3.892212609676867*^9, 
   3.892212610523185*^9}, {3.892212687579348*^9, 3.892212715949366*^9}, {
   3.892212785377466*^9, 3.892212794143887*^9}, {3.892212877505321*^9, 
   3.892212962810907*^9}, {3.8922142774238663`*^9, 3.8922142866925793`*^9}, {
   3.8922144796144657`*^9, 3.892214491923314*^9}, 3.892214664921056*^9, {
   3.892214990226345*^9, 3.892214991835705*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"761aa0a5-b401-46f8-9ed7-1cf7a7e72566"],

Cell[TextData[{
 "I can see how changing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "186484d7-75ea-47d4-bb8b-ccfdfd0e2c7a"],
 " steers the beam and increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ffa7ac88-df54-4b8d-8c13-7f9bde726913"],
 " introduces grating lobes."
}], "CodeText",
 CellChangeTimes->{{3.892215031775029*^9, 
  3.892215097349813*^9}},ExpressionUUID->"1ecf2864-c49b-4729-a40f-\
7cb677b6f2c0"],

Cell["\<\
It can also be illustrative to plot the element pattern, normalized array \
factor, and total array pattern together. What observations can you make?\
\>", "Text",
 CellChangeTimes->{{3.8922159703038473`*^9, 3.892216020461038*^9}, {
  3.892216168103321*^9, 3.892216176598115*^9}, {3.892216257027762*^9, 
  3.892216264499194*^9}, {3.892253774452479*^9, 
  3.892253776015596*^9}},ExpressionUUID->"a5d08881-3712-41f3-9582-\
2401a87cb694"],

Cell["\<\
Let the element pattern be that of a Hertzian dipole, we have\
\>", "CodeText",
 CellChangeTimes->{{3.892253781260191*^9, 3.892253803691307*^9}, {
  3.89225400655545*^9, 
  3.8922540075637007`*^9}},ExpressionUUID->"322a7290-a3db-4766-b0cf-\
c4f15cdc1916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PatternMultiplicationPolar", "[", 
   RowBox[{"elem_", ",", "af_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"elem1", "=", 
       RowBox[{"elem", "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], ",", 
      RowBox[{"af1", "=", 
       RowBox[{"af", "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}], ",", 
      RowBox[{"prod", "=", 
       RowBox[{"elem", "*", "af"}]}], ",", 
      RowBox[{"prod1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"elem", "*", "af"}], ")"}], "/.", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{
          FractionBox["\[Pi]", "2"], "-", "\[Theta]"}]}]}]}]}], "}"}], ",", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"PolarPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Abs", "[", "elem1", "]"}], ",", 
            RowBox[{"Abs", "[", "af1", "]"}], ",", 
            RowBox[{"Abs", "[", "prod1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.1"}], ",", "1.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "->", "Large"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            
            TemplateBox[<|"color" -> RGBColor[0.528488, 0.470624, 0.701351]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.528488, 0.470624, 0.701351]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.528488, 0.470624, 0.701351]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.560181, 0.691569, 0.194885]|>,
             
             "RGBColorSwatchTemplate"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], 
              "}"}], "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\[Alpha]: \>\"", ",", "\[Alpha]", ",", "\"\<\[Pi]\>\""}], 
              "}"}], "]"}], ",", "\"\<Element Pattern\>\"", ",", 
            "\"\<Array Factor\>\"", ",", "\"\<Array Pattern\>\""}], "}"}]}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "0.5"}], "}"}], ",", "0.25", ",", "2"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.25"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.892215127885726*^9, 3.892215240408722*^9}, {
   3.892215289461615*^9, 3.892215317306416*^9}, {3.89221538228605*^9, 
   3.892215411961834*^9}, {3.892215493077869*^9, 3.892215511058852*^9}, 
   3.8922155916466837`*^9, 3.892215755482815*^9, {3.8922158104382467`*^9, 
   3.892215872680212*^9}, {3.892215933085235*^9, 3.89221593391751*^9}, {
   3.8922160594988317`*^9, 3.892216143527842*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"27488984-b7d4-45ef-b89b-2bf0869be4b3"],

Cell[BoxData[
 RowBox[{"PatternMultiplicationPolar", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
   FractionBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"N", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "\[Pi]", " ", "d", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ")"}]}], "2"], "]"}], 
    RowBox[{"N", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"2", "\[Pi]", " ", "d", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], "2"], "]"}]}]]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.892215283093144*^9, {3.8922157947588587`*^9, 3.892215802380567*^9}, {
   3.892216144636661*^9, 3.892216145539093*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"d394024f-8a67-47c2-9880-f5e23a6127c7"],

Cell[TextData[{
 "1. Again, changing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "eb28701a-85ef-4380-a8c8-aee11b46a88e"],
 " steers the beam and increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b9bcc1e4-0522-40b6-815d-87dfc68184d0"],
 " introduces grating lobes.\[LineSeparator]2. The total array pattern is \
confined within, or bounded by  the element pattern.\[LineSeparator]3. \
Increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20475020-67dd-4c33-b13b-55ec7bc0de40"],
 " increases the directivity, i.e. the beamwidth is narrower\n4. A large ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "327e98e4-5cd6-4e2d-80a8-a12222e407fd"],
 " has a higher number of side lobes albeit the the level of the side lobes \
are lower."
}], "CodeText",
 CellChangeTimes->{{3.892216269989485*^9, 3.892216276670936*^9}, {
  3.892216343439271*^9, 3.892216361936449*^9}, {3.89221654511563*^9, 
  3.892216600759429*^9}, {3.892216659846904*^9, 3.892216662208008*^9}, {
  3.8922507391022997`*^9, 3.892250775651814*^9}, {3.892250813225911*^9, 
  3.892250818491831*^9}},ExpressionUUID->"22a524a7-4734-48d2-ab00-\
d1919511fc2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polynomial Representation", "Subsection",
 CellChangeTimes->{{3.8917726368478403`*^9, 3.891772644516675*^9}, {
  3.8917851541450987`*^9, 3.8917851607727537`*^9}, {3.8922168063695793`*^9, 
  3.8922168267601624`*^9}, {3.892217645964809*^9, 
  3.892217659078903*^9}},ExpressionUUID->"c3637b22-f21a-4199-899a-\
9647f8fbfd47"],

Cell[TextData[{
 "Recall that the array factor of a uniform array of N-elements placed along \
the z-axis with equal spacing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa04f136-b71f-46b4-9e3d-680b128abf31"],
 " is\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "1"}], 
          StyleBox["N", "TI"], LimitsPositioning -> True], 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], 
            RowBox[{"(", 
              RowBox[{
                StyleBox["n", "TI"], "-", "1"}], ")"}], "\[Psi]"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "AF = \\sum_{n=1}^{N}e^{j(n-1)\\psi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e2c711da-d32d-4d42-90da-6e13b2e05b64"],
 "\n\nWe have plotted the array factor in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69e48055-b974-440a-bd51-6b6bf74f9190"],
 " domain. Now, if we consider ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "\[Psi]"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = e^{j \\psi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e8aa413c-7385-4eda-a669-3a03d748816f"],
 ", we can plot the array factor in the complex domain. We know that the \
array factor can also be expressed as\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{
               StyleBox["j", "TI"], 
               StyleBox["N", "TI"], "\[Psi]"}]], "-", "1"}], 
          RowBox[{
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{
               StyleBox["j", "TI"], "\[Psi]"}]], "-", "1"}]]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "AF = \\frac{e^{j N \\psi} - 1}{e^{j \\psi} - 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dfd749a3-ba07-46f3-ba78-c1f44fc28cf0"],
 "\n\nHow to express it in terms of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4d0680b0-c316-4b32-bbea-3bd9b138c452"],
 "?"
}], "Text",
 CellChangeTimes->{{3.892218135501483*^9, 3.89221828481896*^9}, {
  3.892218725789578*^9, 3.8922187502649403`*^9}, {3.892218780596156*^9, 
  3.892218830888269*^9}},ExpressionUUID->"7f020ada-883b-4bd3-a8e1-\
61f09cb37c75"],

Cell[TextData[{
 "It\[CloseCurlyQuote]s just ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          SuperscriptBox[
           StyleBox["z", "TI"], 
           StyleBox["N", "TI"]], "-", "1"}], 
        RowBox[{
          StyleBox["z", "TI"], "-", "1"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{z^N - 1}{z - 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "54a5ae2e-0cab-498d-8795-7e5c12a40fc2"]
}], "CodeText",
 CellChangeTimes->{{3.89221883285179*^9, 
  3.892218876370014*^9}},ExpressionUUID->"d272003e-e7f7-449d-b7f3-\
608283ce4653"],

Cell[TextData[{
 "Where are the ",
 StyleBox["possible",
  FontSlant->"Italic"],
 " nulls?"
}], "Text",
 CellChangeTimes->{{3.892218885133381*^9, 3.8922189031708*^9}, {
  3.892219717640716*^9, 3.892219739273237*^9}, {3.892219790039974*^9, 
  3.892219790457102*^9}},ExpressionUUID->"54d84fb7-008c-4ae1-a6ea-\
d9b954d0b208"],

Cell[TextData[{
 "The possible nulls are the roots of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["N", "TI"]], "-", "1", "\[LongEqual]", "0"}], 
       TraditionalForm], "errors" -> {}, "input" -> "z^N - 1 = 0", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4480933f-11c5-4108-91c3-683d4707ed44"],
 " in the complex plane. We know that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "\[Psi]"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "e^{j \\psi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cd7f9a48-7e27-45ec-a970-f3fcebfaa3c2"],
 " lies on the unit circle. This can be visually seen if we plot the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["z", "TI"], 
          StyleBox["N", "TI"]], "-", "1"}], TraditionalForm], "errors" -> {}, 
     "input" -> "z^N - 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "071b9db4-4fda-492b-9dd4-d3d88972eea1"],
 " as a complex function:"
}], "CodeText",
 CellChangeTimes->{{3.892218912886251*^9, 3.8922190472501907`*^9}, {
  3.8922197722956944`*^9, 
  3.892219775720182*^9}},ExpressionUUID->"ea6869f0-bcdb-4955-99fc-\
8c381ef30df3"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexPlot", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["z", "N"], "-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "1.5"}], "-", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.5", "+", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", ",", "5"}], "}"}], ",", "2", ",", "10", ",", "1"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892217631318061*^9, 3.8922176313238087`*^9}, {
   3.89221829259312*^9, 3.892218414736554*^9}, {3.892219018910842*^9, 
   3.892219019216662*^9}, {3.892219062252199*^9, 3.892219062911132*^9}, 
   3.8922192073273373`*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"a0d39625-b51f-44d3-8c2a-04446d7e86df"],

Cell[TextData[{
 "Of course, one of the roots is always ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "18e5b5df-05b6-4234-b4a1-18b472caf319"],
 ", so for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          SuperscriptBox[
           StyleBox["z", "TI"], 
           StyleBox["N", "TI"]], "-", "1"}], 
        RowBox[{
          StyleBox["z", "TI"], "-", "1"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{z^N - 1}{z - 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "02596600-b577-4ddd-ac4b-02d933af9a3a"],
 ", the denominator gets cancelled out:"
}], "Text",
 CellChangeTimes->{{3.892219101104764*^9, 
  3.8922191545938997`*^9}},ExpressionUUID->"e69dc408-416a-4c80-b488-\
99fa3d6854ed"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexPlot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "N"], "-", "1"}], 
      RowBox[{"z", "-", "1"}]], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "1.5"}], "-", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.5", "+", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"N", ",", "5"}], "}"}], ",", "2", ",", "10", ",", "1"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892218556026108*^9, 3.892218564375646*^9}, {
  3.892219083999289*^9, 3.892219094943033*^9}, {3.892219180780026*^9, 
  3.892219197519746*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"50a8aacf-95a8-4605-8ad8-6bdd06b66617"],

Cell[TextData[{
 "According to the Fundamental Theorem of Algebra, the array factor can be \
factorized as\n\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         StyleBox["F", "TI"], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "-", 
             SubscriptBox[
              StyleBox["z", "TI"], "1"]}], ")"}], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "-", 
             SubscriptBox[
              StyleBox["z", "TI"], "2"]}], ")"}], "...", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["z", "TI"], "-", 
             SubscriptBox[
              StyleBox["z", "TI"], 
              RowBox[{
                StyleBox["N", "TI"], "-", "1"}]]}], ")"}]}], TraditionalForm],
      "errors" -> {}, "input" -> "AF = (z - z_1)(z - z_2)...(z - z_{N-1})", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "15abb690-237d-424a-ab77-a0276930f22d"],
 "\n\nwhere ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["z", "TI"], "1"], ",", 
         SubscriptBox[
          StyleBox["z", "TI"], "2"], ",", "...", ",", 
         SubscriptBox[
          StyleBox["z", "TI"], 
          RowBox[{
            StyleBox["N", "TI"], "-", "1"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "z_1, z_2, ..., z_{N - 1}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "5cf0e9fd-cd82-47ff-88cd-29192f973445"],
 " are the roots of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        RowBox[{
          SuperscriptBox[
           StyleBox["z", "TI"], 
           StyleBox["N", "TI"]], "-", "1"}], 
        RowBox[{
          StyleBox["z", "TI"], "-", "1"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{z^N - 1}{z - 1}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "abd93fc3-972b-46d5-94c3-41f02bbad97c"],
 ".\n\nWhat have we achieved with this representation?"
}], "Text",
 CellChangeTimes->{{3.892219328152154*^9, 3.892219353410757*^9}, {
  3.8922193836635857`*^9, 3.8922194785571537`*^9}, {3.8922198448944473`*^9, 
  3.8922198485448713`*^9}},ExpressionUUID->"aace060c-c6c0-469a-b5e3-\
13a741d39fb0"],

Cell[TextData[StyleBox["It maybe possible to manipulate the roots to \
synthesize new array factors with e.g. non-uniform excitation. We know that \
for uniform excitation the roots are equally spaced on the unit circle, but \
if we relax this rule, we might get interesting results.",
 FontSlant->"Plain"]], "CodeText",
 CellChangeTimes->{{3.8922198590842943`*^9, 3.8922199504181547`*^9}},
 FontSlant->"Italic",ExpressionUUID->"9191ef9b-0fd2-45f8-ac49-5c645a483083"],

Cell["\<\
Exactly. You may try to construct some random examples with non-uniform \
spacing of roots.\
\>", "Text",
 CellChangeTimes->{{3.892219991338057*^9, 3.892220016432022*^9}, {
  3.892221151408993*^9, 
  3.892221155441671*^9}},ExpressionUUID->"99924b59-fb6b-404b-adb3-\
36d8a22d84c1"],

Cell[TextData[{
 "For example, we could have an ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "\[LongEqual]", "4"}], TraditionalForm], 
     "errors" -> {}, "input" -> "N=4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "042d9caa-78bb-4ee1-be37-71bdcfcb4be2"],
 " array with one root at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], 
          FractionBox["\[Pi]", "3"]}]], TraditionalForm], "errors" -> {}, 
     "input" -> "e^{j \\frac{\\pi}{3}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0219a23b-8744-4d81-8887-d6d117a40054"],
 ", another root at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], 
          FractionBox[
           RowBox[{"2", "\[Pi]"}], "3"]}]], TraditionalForm], "errors" -> {}, 
     "input" -> "e^{j \\frac{2\\pi}{3}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8879bef4-3ca9-4c05-9c26-d619d422e301"],
 ", and another root at  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", 
          StyleBox["j", "TI"], 
          FractionBox["\[Pi]", "2"]}]], TraditionalForm], "errors" -> {}, 
     "input" -> "e^{-j \\frac{\\pi}{2}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e7d3563b-04a2-419f-82d4-a3af00946484"],
 ", like this:"
}], "CodeText",
 CellChangeTimes->{{3.8922206334336843`*^9, 3.892220679384778*^9}, {
  3.892220787679459*^9, 3.89222082980134*^9}, {3.892221013083458*^9, 
  3.8922210392178*^9}, {3.892221130510127*^9, 3.892221131590197*^9}, {
  3.8922213123988132`*^9, 3.8922213133928213`*^9}, {3.892251626940522*^9, 
  3.892251628821024*^9}, {3.8922530498626537`*^9, 
  3.89225305053281*^9}},ExpressionUUID->"0959975d-e337-4bb4-a3b8-\
419daba0d252"],

Cell[BoxData[
 RowBox[{"ComplexPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", 
        FractionBox["\[Pi]", "3"]}]]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], "3"]}]]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", 
        FractionBox["\[Pi]", "2"]}]]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{
      RowBox[{"-", "1.5"}], "-", 
      RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5", "+", 
      RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892220971655188*^9, 3.892220987953143*^9}, {
  3.892221076492124*^9, 3.892221080509856*^9}, {3.89222111719669*^9, 
  3.892221124172248*^9}, {3.892221199370637*^9, 3.8922212036229143`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"13048285-ed82-480c-a65d-215a80306bb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotAFWithPsi", "[", "af_", "]"}], ":=", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Legended", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "af", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Psi]", ",", 
            RowBox[{
             RowBox[{"-", "5"}], "\[Pi]"}], ",", 
            RowBox[{"5", "\[Pi]"}]}], "}"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "af", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Psi]", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], "\[Pi]", " ", "d"}], "+", 
             RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ",", 
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "d"}], "+", 
             RowBox[{"\[Alpha]", " ", "\[Pi]"}]}]}], "}"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{
             TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
              "RGBColorSwatchTemplate"], ",", 
             RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"SwatchLegend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
           "RGBColorSwatchTemplate"], ",", 
          TemplateBox[<|"color" -> RGBColor[0.880722, 0.611041, 0.142051]|>,
           "RGBColorSwatchTemplate"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], 
            "}"}], "]"}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[Alpha]: \>\"", ",", "\[Alpha]", ",", "\"\<\[Pi]\>\""}], 
            "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "0.5"}], "}"}], ",", "0.25", ",", "2"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1", ",", "0.25"}], "}"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.89225145789533*^9, 3.892251483947994*^9}, {
  3.892251520837346*^9, 3.892251521003015*^9}, {3.892251594916307*^9, 
  3.892251604407468*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"8124bd5b-51a9-4526-87e1-5deb63d1239f"],

Cell[BoxData[
 RowBox[{"PlotAFWithPsi", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", 
       FractionBox["\[Pi]", "3"]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]"}], "3"]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", 
       FractionBox["\[Pi]", "2"]}]]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892251556583935*^9, 3.8922515567342176`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"d896469e-1599-470a-9b1a-2f6bd0c38e7d"],

Cell[TextData[{
 "We can see that the array factor is still periodic in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "460878c4-f01a-4018-8be6-a975d85c02f0"],
 " space."
}], "CodeText",
 CellChangeTimes->{{3.892251633960681*^9, 
  3.892251674163417*^9}},ExpressionUUID->"0f7c1506-968d-4e95-95fc-\
e780abf0ca6d"],

Cell["\<\
Let\[CloseCurlyQuote]s visualize the array factor in the polar and spherical \
space.\
\>", "Text",
 CellChangeTimes->{{3.8922520280394573`*^9, 
  3.892252059812242*^9}},ExpressionUUID->"8b83e7a8-ba3c-458d-ad8f-\
6e3c31de1c8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotAFWithPsi3D", "[", "af_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"af1", "=", 
       RowBox[{"af", "/.", 
        RowBox[{"\[Psi]", "->", 
         RowBox[{
          RowBox[{"2", "\[Pi]", " ", "d", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["\[Pi]", "2"], "-", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{"\[Alpha]", " ", "\[Pi]"}]}]}]}]}], ",", 
      RowBox[{"af3d", "=", 
       RowBox[{"af", "/.", 
        RowBox[{"\[Psi]", "->", 
         RowBox[{
          RowBox[{"2", "\[Pi]", " ", "d", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"\[Alpha]", " ", "\[Pi]"}]}]}]}]}]}], "}"}], ",", 
    RowBox[{"Manipulate", "[", 
     RowBox[{
      RowBox[{"Legended", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PolarPlot", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "af1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", 
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             RowBox[{"PlotRange", "->", "Full"}]}], "]"}], ",", 
           RowBox[{"SphericalPlot3D", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "af3d", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]", ",", "0", ",", 
               RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "}"}], "]"}], 
        ",", 
        RowBox[{"SwatchLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            
            TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
             
             "RGBColorSwatchTemplate"], ",", 
            
            TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
             
             "RGBColorSwatchTemplate"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<d: \>\"", ",", "d", ",", "\"\<\[Lambda]\>\""}], 
              "}"}], "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\[Alpha]: \>\"", ",", "\[Alpha]", ",", "\"\<\[Pi]\>\""}], 
              "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d", ",", "0.5"}], "}"}], ",", "0.25", ",", "2"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.25"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.890752224031396*^9, 3.890752430979671*^9}, {
   3.8907525293151608`*^9, 3.8907525516698523`*^9}, {3.890752611056533*^9, 
   3.890752620191729*^9}, {3.890752927154635*^9, 3.890752956376524*^9}, {
   3.890753223077471*^9, 3.890753340730529*^9}, {3.89075353406837*^9, 
   3.89075354770795*^9}, {3.8907538471958017`*^9, 3.890753887377252*^9}, {
   3.89075392740993*^9, 3.890753999232374*^9}, {3.890754092959141*^9, 
   3.890754190399703*^9}, {3.890754255241992*^9, 3.890754287210531*^9}, {
   3.8907543343148108`*^9, 3.890754451353332*^9}, 3.890754524694427*^9, {
   3.8916142673956413`*^9, 3.891614273440311*^9}, {3.8916143665659733`*^9, 
   3.891614371026602*^9}, {3.891616584732401*^9, 3.891616633161921*^9}, {
   3.891616752892228*^9, 3.891616777630274*^9}, {3.891616886348546*^9, 
   3.891616888290304*^9}, {3.891617321462441*^9, 3.891617371160754*^9}, {
   3.891617770210114*^9, 3.891617772550437*^9}, {3.891617818547852*^9, 
   3.89161784873037*^9}, {3.89161788621504*^9, 3.891617966269148*^9}, {
   3.8917856615985203`*^9, 3.891785673766724*^9}, {3.891785765761043*^9, 
   3.891785821388411*^9}, {3.8917858711315804`*^9, 3.89178587535413*^9}, {
   3.8917859136727657`*^9, 3.891785915849527*^9}, {3.891785969841194*^9, 
   3.891785979169032*^9}, {3.891786035944338*^9, 3.891786081574943*^9}, {
   3.891786132411598*^9, 3.8917861438366327`*^9}, {3.891786355077756*^9, 
   3.891786355220952*^9}, {3.8922201962791843`*^9, 3.892220284185707*^9}, {
   3.892220362116468*^9, 3.892220385911837*^9}, {3.892220436523065*^9, 
   3.892220495697914*^9}, {3.892221461024559*^9, 3.8922214641819468`*^9}, {
   3.892221541853941*^9, 3.892221545551034*^9}, {3.892221577622939*^9, 
   3.8922215852627163`*^9}, {3.892221640664587*^9, 3.892221672992292*^9}, {
   3.892251428696547*^9, 3.892251429183628*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"22d02650-be47-45a2-a344-c9289a95161b"],

Cell[BoxData[
 RowBox[{"PlotAFWithPsi3D", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", 
       FractionBox["\[Pi]", "3"]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", 
       FractionBox[
        RowBox[{"2", "\[Pi]"}], "3"]}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", 
       FractionBox["\[Pi]", "2"]}]]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892220298352079*^9, 3.892220301148641*^9}, {
  3.892221172772091*^9, 3.8922211840169697`*^9}, {3.892251431546945*^9, 
  3.892251432041726*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"45f5b4ba-86c5-45aa-a1f8-bbeb8a49a1c4"],

Cell[TextData[{
 "As a second example, we may try an array with roots close to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-1", TraditionalForm], "errors" -> {}, "input" -> 
     "-1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "76bc6eaa-ea26-4681-a710-c13f81ffe0b4"],
 ": one root at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "0.9", "\[Pi]"}]], TraditionalForm], 
     "errors" -> {}, "input" -> "e^{j 0.9\\pi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b1a26d14-ce59-4b63-8890-816731aca9eb"],
 ", another root at ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{
          StyleBox["j", "TI"], "\[Pi]"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "e^{j \\pi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0a2ff3a2-4183-430d-9558-ac1399660731"],
 ", and another root at  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["e", "TI"], 
        RowBox[{"-", 
          StyleBox["j", "TI"], "0.9", "\[Pi]"}]], TraditionalForm], 
     "errors" -> {}, "input" -> "e^{-j 0.9 \\pi}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f4cc36a6-0295-4783-a8d3-2a2451a97a2f"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.8922213203980503`*^9, 
  3.892221345227309*^9}},ExpressionUUID->"0c9ea0d1-3db5-44fb-b14a-\
cd89ee831d3f"],

Cell[BoxData[
 RowBox[{"ComplexPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "0.9", "\[Pi]"}]]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "\[Pi]"}]]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryJ]"}], " ", "0.9", "\[Pi]"}]]}], ")"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{
      RowBox[{"-", "1.5"}], "-", 
      RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5", "+", 
      RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8922213953298407`*^9, 3.8922214082196627`*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"8127c628-0095-4a43-89d6-31a74186daf3"],

Cell[BoxData[
 RowBox[{"PlotAFWithPsi", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "0.9", "\[Pi]"}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Pi]"}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "0.9", "\[Pi]"}]]}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892251718184064*^9, 3.892251730386105*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"d34c20a1-43c5-4fe4-a72b-70c7d2d91e81"],

Cell[TextData[{
 "Again, the periodicity comes from the fact that the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["z", "TI"], TraditionalForm], "errors" -> {}, "input" -> "z", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "de1f34f6-de77-43fe-a4f7-8b86b6cdd591"],
 " space is just the unit circle (recall that  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["z", "TI"], "\[LongEqual]", 
         SuperscriptBox[
          StyleBox["e", "TI"], 
          RowBox[{
            StyleBox["j", "TI"], "\[Psi]"}]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "z = e^{j \\psi}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7eed60e5-8f00-46c9-9dc6-329f6d73f610"],
 ")."
}], "CodeText",
 CellChangeTimes->{{3.892251786151816*^9, 3.892251913228421*^9}, 
   3.892252012577115*^9},ExpressionUUID->"6afca1ec-b54c-4581-9bad-\
66cea97b5b65"],

Cell["\<\
Let\[CloseCurlyQuote]s visualize the array factor in the polar and spherical \
space.\
\>", "Text",
 CellChangeTimes->{{3.8922520280394573`*^9, 
  3.892252059812242*^9}},ExpressionUUID->"3b35dc28-ef5e-43bc-b272-\
b93b2d640c21"],

Cell[BoxData[
 RowBox[{"PlotAFWithPsi3D", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "0.9", "\[Pi]"}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Pi]"}]]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryJ]"}], " ", "0.9", "\[Pi]"}]]}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.892221423563119*^9, 3.892221431847268*^9}, {
  3.892251438240097*^9, 3.8922514388810673`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"95370b2e-f60f-4afc-be79-0b4781069e8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Array with Non-uniform Excitation: Binomial Array", "Subsection",
 CellChangeTimes->{{3.8917726368478403`*^9, 3.891772644516675*^9}, {
  3.8917851541450987`*^9, 3.8917851607727537`*^9}, {3.8922168063695793`*^9, 
  3.8922168267601624`*^9}},ExpressionUUID->"9b9f5cdf-6b41-49a1-8c5f-\
d835255e805d"],

Cell[TextData[{
 "Base on the last example, one might wonder, what if we push all the zeros \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-1", TraditionalForm], "errors" -> {}, "input" -> 
     "-1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6cfe4413-b708-4a11-9840-7baf719748ff"],
 "?"
}], "Text",
 CellChangeTimes->{{3.892221702532696*^9, 
  3.892221720133306*^9}},ExpressionUUID->"2d3b0a42-52ff-4282-b522-\
6991f069dd63"],

Cell[TextData[{
 "In this case, the array factor is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            StyleBox["z", "TI"], "-", 
            SuperscriptBox[
             StyleBox["e", "TI"], 
             RowBox[{"-", 
               StyleBox["j", "TI"], "\[Pi]"}]]}], ")"}], 
        StyleBox["N", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(z -e^{-j\\pi})^N", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c1a26924-c5e2-4408-a2b3-15c21d40189a"],
 ", or simply ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            StyleBox["z", "TI"], "+", "1"}], ")"}], 
        StyleBox["N", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(z+1)^N", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1727cce4-b60a-408a-ab07-2cf48c5c4dd6"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.892252706857068*^9, 
  3.892252765924448*^9}},ExpressionUUID->"065c6c91-c906-4931-93d5-\
b3ccfa5c0d9a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Legended", "[", 
    RowBox[{
     RowBox[{"ComplexPlot", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"z", "+", "1"}], ")"}], "N"], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"-", "1.5"}], "-", 
          RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"1.5", "+", 
          RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
       RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
     RowBox[{"SwatchLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        TemplateBox[<|"color" -> RGBColor[0.368417, 0.506779, 0.709798]|>,
         "RGBColorSwatchTemplate"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<N: \>\"", ",", "N"}], "}"}], "]"}], "}"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892221733781506*^9, 3.892221747559959*^9}, {
  3.892250835331126*^9, 3.892250929270762*^9}, {3.892252665629101*^9, 
  3.892252665934478*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"b382a6eb-51f2-4c27-b05a-1b29f965ac8f"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PlotAFWithPsi", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "+", "1"}], ")"}], "N"], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8922519689709787`*^9, 3.892251969322019*^9}, {
  3.892252681143208*^9, 3.892252682819563*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"d46f42f5-5116-4ea0-9849-e9fbc2e5cc80"],

Cell["What unique feature can you observe?", "Text",
 CellChangeTimes->{{3.892221794778164*^9, 
  3.892221800161304*^9}},ExpressionUUID->"aaa7d7a4-7568-4118-b42e-\
f8a3bd3300ae"],

Cell[TextData[{
 "Increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "492b388c-dc70-42af-b903-825dadd82f64"],
 " does not introduce \[OpenCurlyDoubleQuote]side lobes\
\[CloseCurlyDoubleQuote] in the array factor, it merely makes the beamwidth \
narrower. Note that the \[OpenCurlyDoubleQuote]side lobes\
\[CloseCurlyDoubleQuote] of the array factor is in quotation marks since the \
actual array pattern depends on the visible region, and side lobes may be \
created if the visible region is select to have a non-null at one end. If we \
select the visible region carefully, for some values of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["d", "TI"], TraditionalForm], "errors" -> {}, "input" -> "d", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "46309533-3181-47aa-9c52-adc64d2adbc8"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Alpha]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\alpha", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9d130b18-0400-485a-8ad4-eb244f73cb6f"],
 ", increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ce16bb97-a9a5-4902-b26e-56064f6a8082"],
 " does not introduce side lobes at all."
}], "CodeText",
 CellChangeTimes->{{3.892251140610507*^9, 3.892251226693796*^9}, {
  3.8922521234152193`*^9, 3.892252160922997*^9}, {3.89225221635273*^9, 
  3.892252250829541*^9}, {3.8922522844474897`*^9, 3.892252344744031*^9}, {
  3.892252377144927*^9, 
  3.892252420409445*^9}},ExpressionUUID->"d92fb1bd-0bd2-4c0a-8e12-\
ae6346151a34"],

Cell["\<\
Yes, and that\[CloseCurlyQuote]s the usefulness of this arrangement, which is \
called a binomial array. Let\[CloseCurlyQuote]s also plot the array factor in \
the polar and spherical space:\
\>", "Text",
 CellChangeTimes->{{3.8922512337727547`*^9, 3.892251251027522*^9}, {
  3.892251304658546*^9, 3.892251353452449*^9}, {3.89225246081322*^9, 
  3.892252467123015*^9}},ExpressionUUID->"e5b308fd-183e-4be8-aeac-\
771beb18530a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PlotAFWithPsi3D", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "+", "1"}], ")"}], "N"], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.89222175893506*^9, 3.89222176358587*^9}, {
  3.8922509817392073`*^9, 3.892250986247278*^9}, {3.892251040718709*^9, 
  3.892251053581655*^9}, {3.892251446037642*^9, 3.892251446331354*^9}, {
  3.8922526913303823`*^9, 3.8922526930701447`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"a51b7b70-1cf5-429c-ab14-42da5858ee90"],

Cell["How does this correspond to the actual excitation currents?", "Text",
 CellChangeTimes->{{3.892252489113616*^9, 
  3.89225250805254*^9}},ExpressionUUID->"2d5f0848-b9b9-461d-a541-\
7049aa481090"],

Cell[TextData[{
 "I imagine we can simply expand the product ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            StyleBox["z", "TI"], "+", "1"}], ")"}], 
        StyleBox["N", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "(z +1)^N", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "bcbeeb8b-b7b6-46e2-8713-ab519a676d4b"],
 " to obtain the individual current amplitudes according to the binomial \
theorem. For example, if ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "\[LongEqual]", "10"}], TraditionalForm], 
     "errors" -> {}, "input" -> "N = 10", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d25b9e6f-d79f-4f95-96f7-7914abf071db"],
 ":"
}], "CodeText",
 CellChangeTimes->{{3.892252517397428*^9, 3.8922525202847567`*^9}, {
  3.892252561424312*^9, 3.892252628783248*^9}, {3.892252773138455*^9, 
  3.892252785257571*^9}, {3.8922528813640947`*^9, 3.892252927864654*^9}, {
  3.892253014475492*^9, 
  3.89225301716661*^9}},ExpressionUUID->"a10a200f-66dc-432c-b8c6-\
4b2f183e4e6c"],

Cell[BoxData[
 RowBox[{"CoefficientList", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"z", "+", "1"}], ")"}], "10"], ",", "z"}], "]"}]], "Input",
 CellChangeTimes->{{3.892252792630509*^9, 3.892252831276279*^9}, {
  3.89225286594108*^9, 3.892252893060995*^9}, {3.892253231011362*^9, 
  3.892253259000374*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"09fbb744-df95-40a7-99fd-ad72a42742c9"],

Cell["\<\
We can of course also build the current amplitudes based on the Pascal\
\[CloseCurlyQuote]s triangle.\
\>", "CodeText",
 CellChangeTimes->{{3.8922531223211317`*^9, 3.892253126752447*^9}, {
  3.89225321255027*^9, 3.892253218840775*^9}, {3.8922532674657707`*^9, 
  3.892253288708159*^9}},ExpressionUUID->"a47411a6-a472-4517-8b86-\
ebe6e8fca17c"],

Cell["What would be the magnitude of this array factor?", "Text",
 CellChangeTimes->{{3.892253495006548*^9, 
  3.892253516656622*^9}},ExpressionUUID->"934e119a-7d63-4737-9006-\
73c2a4051e16"],

Cell["It would be just the sum of the Pascal\[CloseCurlyQuote]s triangle:", \
"CodeText",
 CellChangeTimes->{{3.892253521792953*^9, 
  3.8922535674725*^9}},ExpressionUUID->"0b28b0c2-feab-462c-9e23-23946b6504e7"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z", "+", "1"}], ")"}], "10"], ",", "z"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8922534481166162`*^9, 3.8922534675871677`*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"31355d75-4991-4ff4-9711-08e4d4b54d0c"],

Cell[TextData[{
 "It is well-known that the sum of the all the entries in the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["n", "TI"], TraditionalForm], "errors" -> {}, "input" -> "n", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f8269f63-1759-43a7-83dc-4f6abc031d2c"],
 "-th row of Pascal\[CloseCurlyQuote]s triangle is equal to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox["2", 
        StyleBox["n", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "2^n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "78499897-a180-4f43-93a4-0190da153f8e"],
 ". This allows us to express the ",
 StyleBox["normalized",
  FontWeight->"Bold"],
 " array factor of the binomial array. This allows us to use the \
PatternMultiplicationPolar function which we defined earlier to plot the \
element pattern, normalized array factor, and total array pattern together."
}], "Text",
 CellChangeTimes->{{3.8922535766242657`*^9, 3.892253603287085*^9}, {
  3.892253844336542*^9, 3.892253909496888*^9}, {3.892253941445075*^9, 
  3.89225397531131*^9}},ExpressionUUID->"b78f6117-24de-40fc-b1e1-\
1086d4c01a6a"],

Cell["\<\
Let the element pattern be that of a Hertzian dipole, we have\
\>", "CodeText",
 CellChangeTimes->{{3.892253992210455*^9, 
  3.892254000432453*^9}},ExpressionUUID->"c1cb3283-e623-4973-9d25-\
8d8181767b7e"],

Cell[BoxData[
 RowBox[{"PatternMultiplicationPolar", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryJ]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Pi]", " ", "d", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"\[Alpha]", " ", "\[Pi]"}]}], ")"}]}]], "+", "1"}], ")"}], 
     "N"], 
    SuperscriptBox["2", "N"]]}], "]"}]], "Input",
 CellChangeTimes->{{3.892253629154469*^9, 3.892253686034083*^9}, {
  3.8922537437872543`*^9, 3.892253744406069*^9}, {3.892253913622568*^9, 
  3.892253922916774*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"5ce43d56-c42a-4d55-9bc8-c5720592bfd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Array with Non-uniform Excitation: Chebyshev Array Synthesis", \
"Subsection",
 CellChangeTimes->{{3.8917726368478403`*^9, 3.891772644516675*^9}, {
  3.8917851541450987`*^9, 3.8917851607727537`*^9}, {3.8922168063695793`*^9, 
  3.892216849643384*^9}},ExpressionUUID->"279cd3e8-5b9e-4a3f-93ab-\
b1010f9c53ed"],

Cell["\<\
The array factor can also be synthesized using the Chebyshev polynomial. Plot \
the Chebyshev polynomials of degree 2, 3 and 4, and characterize them.\
\>", "Text",
 CellChangeTimes->{{3.8922541359261713`*^9, 3.892254153585384*^9}, {
  3.892254258300489*^9, 3.892254275533111*^9}, {3.892254484038315*^9, 
  3.8922545442731743`*^9}, {3.892254598802154*^9, 
  3.892254612218851*^9}},ExpressionUUID->"e01d014d-0ed2-4554-8f3c-\
8291954f0317"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ChebyshevT", "[", 
      RowBox[{"2", ",", "x"}], "]"}], ",", 
     RowBox[{"ChebyshevT", "[", 
      RowBox[{"3", ",", "x"}], "]"}], ",", 
     RowBox[{"ChebyshevT", "[", 
      RowBox[{"4", ",", "x"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8922545773733263`*^9, 3.892254580887844*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"45674ab5-1342-4881-8743-6b02440fa518"],

Cell[TextData[{
 "We can see that these polynomials have values between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "1"}], TraditionalForm]],ExpressionUUID->
  "621915f7-53c5-4026-b7cf-5e45181cc604"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["1", TraditionalForm], "errors" -> {}, "input" -> "1", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "24e3f2c9-b1db-4f78-ad66-769d7c8853ae"],
 " for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["x", "TI"], "\[Element]", 
         RowBox[{"[", 
           RowBox[{"-1", ",", "1"}], "]"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "x \\in [-1, 1]", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "817508ae-2692-418b-9b91-bf61e0b1a3c5"],
 ". Outside of this interval, they increase or decrease monotonically."
}], "CodeText",
 CellChangeTimes->{{3.892254627577271*^9, 
  3.892254712655513*^9}},ExpressionUUID->"52ba1e9f-a409-4fb0-9a2e-\
268b6718fdd8"],

Cell["\<\
The array factor synthesized this way has the interesting property that it \
minimizes the beamwidth for a given side lobe level (SLL). For example, let \
the SLL be 25 dB. Calculate its value in terms of ratio.\
\>", "Text",
 CellChangeTimes->{{3.892254311472196*^9, 3.892254427828661*^9}, {
  3.892254459257134*^9, 
  3.892254466020884*^9}},ExpressionUUID->"8b1b6072-67eb-49b2-b5b7-\
44eae99b73e0"],

Cell[BoxData[
 RowBox[{"N", "[", 
  SuperscriptBox["10", 
   RowBox[{"25", "/", "20"}]], "]"}]], "Input",
 CellChangeTimes->{{3.892254438529189*^9, 3.892254451723866*^9}, {
  3.892254819680328*^9, 
  3.892254821579308*^9}},ExpressionUUID->"7fcde98a-3963-4661-a7cb-\
b0459ce08145"],

Cell[TextData[{
 "The order of the Chebyshev polynomial should be ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["m", "TI"], "\[LongEqual]", 
         StyleBox["N", "TI"], "-", "1"}], TraditionalForm], "errors" -> {}, 
     "input" -> "m = N - 1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "770abb68-28d3-4fa7-a58a-9e32d4072e1a"],
 ". "
}], "Text",
 CellChangeTimes->{{3.892254477423987*^9, 3.892254477775819*^9}, {
  3.892254723752839*^9, 
  3.892254761817773*^9}},ExpressionUUID->"e7a22eae-a4d7-45d5-82c1-\
a4b03c89e920"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["N", "TI"], "\[LongEqual]", "4"}], TraditionalForm], 
     "errors" -> {}, "input" -> "N = 4", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4dafac8f-4811-41b2-8534-543f52230888"],
 ", then ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["m", "TI"], "\[LongEqual]", "3"}], TraditionalForm], 
     "errors" -> {}, "input" -> "m = 3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e608dd07-0437-47c7-bcf7-295684313422"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.892254763488838*^9, 
  3.892254772699923*^9}},ExpressionUUID->"b218588d-86c5-4d58-b889-\
acbba558a129"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], "0"], TraditionalForm], "errors" -> {}, "input" -> 
     "x_0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e7767fb-a3f6-4d9c-926c-8cb86e0115b7"],
 " is given by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cosh", "(", 
         RowBox[{
           FractionBox["1", 
            StyleBox["m", "TI"]], 
           SuperscriptBox["cosh", "-1"], 
           StyleBox["b", "TI"]}], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\cosh(\\frac{1}{m}\\cosh^{-1}b)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c5f14773-73cb-45e0-a4ce-630c333dea1d"]
}], "Text",
 CellChangeTimes->{{3.8922548333335123`*^9, 
  3.892254847816473*^9}},ExpressionUUID->"ef274ca2-df0a-4ffe-b7c7-\
f2617171b36e"],

Cell[BoxData[
 RowBox[{"Cosh", "[", 
  RowBox[{
   FractionBox["1", "3"], 
   RowBox[{"ArcCosh", "[", 
    RowBox[{"N", "[", 
     SuperscriptBox["10", 
      RowBox[{"25", "/", "20"}]], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892254884881259*^9, 3.892254936078401*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"7668d3ba-ac96-4b79-ae4a-3755217c971a"],

Cell[TextData[{
 "The zeros of the Chebyshev polynomial  are found by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"cos", 
         FractionBox[
          RowBox[{
            RowBox[{"(", 
              RowBox[{"2", 
                StyleBox["i", "TI"], "-", "1"}], ")"}], "\[Pi]"}], 
          RowBox[{"2", 
            StyleBox["m", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\cos{\\frac{(2i-1)\\pi}{2m}}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e955ab9a-2a54-4214-b1ed-47353754415d"],
 "."
}], "Text",
 CellChangeTimes->{{3.892255034415086*^9, 3.8922550503433657`*^9}, 
   3.8922550849396544`*^9},ExpressionUUID->"d8090331-51bf-4e35-a7f9-\
914cdb0bbfa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "#"}], "-", "1"}], ")"}], "\[Pi]"}], 
     RowBox[{"2", " ", "3"}]], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.892255183059016*^9, 3.892255212292225*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"e0fd2bec-b475-4cf1-bca0-c99385a3df1a"],

Cell[TextData[{
 "Then the zeros of the array factor are ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"2", 
         SuperscriptBox["cos", "-1"], 
         RowBox[{"(", 
           FractionBox[
            SubscriptBox[
             StyleBox["x", "TI"], 
             StyleBox["i", "TI"]], 
            SubscriptBox[
             StyleBox["x", "TI"], "0"]], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "2\\cos^{-1}(\\frac{x_i}{x_0})", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fe45a8e0-fdda-4c6b-8cab-9d53f965fac7"]
}], "Text",
 CellChangeTimes->{{3.892255259386181*^9, 
  3.892255286072961*^9}},ExpressionUUID->"57c76d1b-331c-4c57-a67c-\
c5df74c0df14"],

Cell[BoxData[
 RowBox[{"2", 
  RowBox[{"ArcCos", "[", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "#"}], "-", "1"}], ")"}], "\[Pi]"}], 
        RowBox[{"2", " ", "3"}]], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
    RowBox[{"Cosh", "[", 
     RowBox[{
      FractionBox["1", "3"], 
      RowBox[{"ArcCosh", "[", 
       RowBox[{"N", "[", 
        SuperscriptBox["10", 
         RowBox[{"25", "/", "20"}]], "]"}], "]"}]}], "]"}]], "]"}]}]], "Input",\

 CellChangeTimes->{{3.892255318531776*^9, 3.892255330300033*^9}, {
  3.8922565378058167`*^9, 3.8922565454736347`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"694d19cc-b082-4b85-96dc-b41be0b740e9"],

Cell[TextData[{
 "These are the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Psi]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\psi", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "43d2e3d2-6f78-4415-a74f-e189420d9324"],
 " values we need."
}], "Text",
 CellChangeTimes->{{3.8922554731815443`*^9, 
  3.892255491148677*^9}},ExpressionUUID->"c062789a-4c79-4d4e-a5a5-\
b8ad18fde4f3"],

Cell[BoxData[
 RowBox[{"PlotAFWithPsi", "[", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "2", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "i"}], "-", "1"}], ")"}], "\[Pi]"}], 
            RowBox[{"2", " ", "3"}]], "]"}], 
          RowBox[{"Cosh", "[", 
           RowBox[{
            FractionBox["1", "3"], 
            RowBox[{"ArcCosh", "[", 
             SuperscriptBox["10", 
              RowBox[{"25", "/", "20"}]], "]"}]}], "]"}]], "]"}], " "}]]}], 
     ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.89225551230582*^9, 3.8922555279683313`*^9}, {
  3.892255596898432*^9, 3.892255616025365*^9}, {3.8922556587821608`*^9, 
  3.892255676569208*^9}, {3.892255718600683*^9, 3.892255748827415*^9}, {
  3.892256549421813*^9, 3.8922565510208607`*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"52a64bec-cc31-42cf-bb57-27f56b168769"],

Cell["\<\
We have built a fairly large expression that allows us to synthesize the \
array factor in one step. We can now expression this as a function.\
\>", "Text",
 CellChangeTimes->{{3.892255861447229*^9, 3.892255881888994*^9}, {
  3.892256307720426*^9, 3.892256322102442*^9}, {3.892256785185515*^9, 
  3.8922567927543793`*^9}},ExpressionUUID->"c1528c72-c84b-4323-a1b3-\
eacdaec0d76d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChebyshevAF", "[", 
   RowBox[{"b_", ",", "N_"}], "]"}], ":=", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "\[Psi]"}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryJ]", " ", "2", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "i"}], "-", "1"}], ")"}], "\[Pi]"}], 
            RowBox[{"2", " ", "N"}]], "]"}], 
          RowBox[{"Cosh", "[", 
           RowBox[{
            FractionBox["1", "N"], 
            RowBox[{"ArcCosh", "[", 
             SuperscriptBox["10", 
              RowBox[{"b", "/", "20"}]], "]"}]}], "]"}]], "]"}], " "}]]}], 
     ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.892256794817767*^9, 3.892256823115402*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"ab101104-b0d7-43f0-92fb-4c9a0237a388"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PlotAFWithPsi", "[", 
    RowBox[{"ChebyshevAF", "[", 
     RowBox[{"b", ",", "N"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "10", ",", "25", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892256400280884*^9, 3.8922564402456427`*^9}, {
  3.8922565047696133`*^9, 3.892256527828662*^9}, {3.89225656952036*^9, 
  3.892256572994392*^9}, {3.892256609586843*^9, 3.892256680967016*^9}, {
  3.892256743088196*^9, 3.89225674452582*^9}, {3.892256819982163*^9, 
  3.892256846351986*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"0820abac-b06a-46a0-94a5-ac1b1e54e21d"],

Cell[TextData[{
 "Indeed, increasing ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["N", "TI"], TraditionalForm], "errors" -> {}, "input" -> "N", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8ac7bd36-be45-4db3-9718-cdc1ebd7ac7a"],
 " does not change the side lobe level."
}], "CodeText",
 CellChangeTimes->{{3.8922568665235853`*^9, 
  3.892256883375144*^9}},ExpressionUUID->"31446ae5-f183-4e16-b740-\
c87fb40f1309"],

Cell["\<\
One might also be interested in the distribution of the zeros in the complex \
plane.\
\>", "Text",
 CellChangeTimes->{{3.892256891444104*^9, 
  3.892256910712913*^9}},ExpressionUUID->"00084a90-6660-4145-aa2b-\
a0563186ba9c"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ComplexPlot", "[", 
    RowBox[{
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", "-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryJ]", " ", "2", 
           RowBox[{"ArcCos", "[", 
            FractionBox[
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "i"}], "-", "1"}], ")"}], "\[Pi]"}], 
               RowBox[{"2", " ", "N"}]], "]"}], 
             RowBox[{"Cosh", "[", 
              RowBox[{
               FractionBox["1", "N"], 
               RowBox[{"ArcCosh", "[", 
                SuperscriptBox["10", 
                 RowBox[{"b", "/", "20"}]], "]"}]}], "]"}]], "]"}], " "}]]}], 
        ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "N"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "1.5"}], "-", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.5", "+", 
        RowBox[{"1.5", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "10", ",", "100", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892256703424926*^9, 3.89225675533212*^9}, {
  3.892256997006164*^9, 3.892256997511457*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"ab9a4aee-d073-4f6a-9f72-ddef44772098"],

Cell[TextData[{
 "We can see that when we increase SLL (recall that if we define SLL as the \
amplitude at the peak of the main lobe to the amplitude at the peak of a side \
lobe, the higher the SLL, the lower the actual level of the side lobes), the \
zeros also tend to move towards ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["-1", TraditionalForm], "errors" -> {}, "input" -> 
     "-1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1fe7728d-ac4b-439d-9891-d55411de7774"],
 "."
}], "CodeText",
 CellChangeTimes->{{3.892257034267902*^9, 3.892257036458848*^9}, {
  3.892257339459722*^9, 3.8922573581627827`*^9}, {3.892257555748847*^9, 
  3.892257651048005*^9}, {3.892257701328287*^9, 3.8922577222829037`*^9}, {
  3.892257869608951*^9, 
  3.89225787648234*^9}},ExpressionUUID->"d097457b-e6d3-4379-97bb-\
4955554fbf34"],

Cell["\<\
Let' s plot the array factor in the polar and spherical space:\
\>", "Text",
 CellChangeTimes->{{3.8922578971950703`*^9, 
  3.892257923214355*^9}},ExpressionUUID->"a6bdaf6c-0997-4ea8-a9c6-\
f4cf5d508d19"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"PlotAFWithPsi3D", "[", 
    RowBox[{"ChebyshevAF", "[", 
     RowBox[{"b", ",", "N"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "10", ",", "25", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"N", ",", "2", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892257405778802*^9, 3.892257414408658*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"1c5a68f4-a562-4093-990d-f2b82c2ca340"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.883449963320361*^9, 
  3.8834499645258837`*^9}},ExpressionUUID->"fb818051-256e-4d70-9eac-\
7f5c2a1e529e"],

Cell[BoxData[
 RowBox[{"ColorData", "[", 
  RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.89165194875106*^9, 3.891651948898761*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"22481a83-27ec-47fb-8d19-4c525f707ea6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 1051},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f16af5b2-c9d9-4da0-a5bd-ef661cc1b553"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 363, 6, 98, "Title",ExpressionUUID->"2878dbbf-9640-4527-9e35-8bc6fde02b26"],
Cell[946, 30, 703, 16, 94, "Subtitle",ExpressionUUID->"78aff8d8-2178-427f-a7a0-bd3d3ee35f36"],
Cell[1652, 48, 374, 6, 62, "Text",ExpressionUUID->"a5e3caac-1336-4654-b112-a8b35ab9f9c7"],
Cell[CellGroupData[{
Cell[2051, 58, 157, 3, 69, "Chapter",ExpressionUUID->"aa379228-55fd-46b6-8d0d-f977d9933e42"],
Cell[2211, 63, 6527, 97, 610, "Text",ExpressionUUID->"51923026-0b43-485c-95e1-05a315ea3b5b"],
Cell[8741, 162, 7476, 213, 1287, "Input",ExpressionUUID->"f2c4fa37-e85a-47ee-bfba-da4ffaba1b30",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16254, 380, 211, 4, 69, "Chapter",ExpressionUUID->"1e49a833-782e-4eca-bd18-0091e6b81df2"],
Cell[CellGroupData[{
Cell[16490, 388, 363, 6, 67, "Section",ExpressionUUID->"2fd1ce77-1c86-4d42-8330-a3d25a9a4d68"],
Cell[16856, 396, 620, 17, 37, "Text",ExpressionUUID->"0d6041fd-c0ff-4021-a4b5-117f83b9f77c"],
Cell[17479, 415, 336, 5, 38, "CodeText",ExpressionUUID->"aa6515c1-c8e9-40c5-a8b6-18c23f65bdae"],
Cell[17818, 422, 164, 3, 35, "Text",ExpressionUUID->"1cdda761-cac6-4891-9fc4-68e957a73b81"],
Cell[17985, 427, 595, 15, 38, "CodeText",ExpressionUUID->"cf3090f2-c06c-49ed-b8ab-48748f41557b"],
Cell[18583, 444, 642, 18, 37, "Text",ExpressionUUID->"a53e5c6d-0e98-479c-9ebe-104fb685db6f"],
Cell[19228, 464, 987, 16, 59, "CodeText",ExpressionUUID->"6ce16a1b-14ac-4b48-abf3-0dc1e12e85c1"],
Cell[20218, 482, 1028, 22, 46, "Input",ExpressionUUID->"3b6d0ad0-0962-43b0-ab6e-ab1d482c1b04",
 InitializationCell->True],
Cell[21249, 506, 331, 9, 30, "Input",ExpressionUUID->"7a227a9d-afb0-44e9-8495-4d7fdd132e36"],
Cell[21583, 517, 639, 17, 40, "CodeText",ExpressionUUID->"8df2a08d-8adf-4811-a3fe-8d262fa96caf"],
Cell[22225, 536, 166, 3, 35, "Text",ExpressionUUID->"c43bc8f9-226b-4aba-9f3d-0cc4ba07ec88"],
Cell[22394, 541, 1264, 31, 38, "CodeText",ExpressionUUID->"5f9dfa15-c683-45b5-8e43-4a2ee72e90a5"],
Cell[23661, 574, 414, 7, 35, "Text",ExpressionUUID->"a8d8d063-92de-4a18-9374-b401528ea241"],
Cell[24078, 583, 1146, 25, 38, "CodeText",ExpressionUUID->"943d347d-0041-42b4-bc52-2e3164604a26"],
Cell[25227, 610, 806, 19, 35, "Text",ExpressionUUID->"add48133-1051-4775-9b9e-9d82e2a61a48"],
Cell[26036, 631, 851, 14, 38, "CodeText",ExpressionUUID->"bd9477f9-b05d-429a-955c-ee5eaaa97dcc"],
Cell[26890, 647, 772, 20, 37, "Text",ExpressionUUID->"48abe503-349c-4070-aff7-565a17c30f74"],
Cell[27665, 669, 1181, 25, 46, "Input",ExpressionUUID->"5abbc522-573d-4cf1-80ee-f8c01adee85e",
 InitializationCell->True],
Cell[28849, 696, 524, 12, 30, "Input",ExpressionUUID->"7fd8aef9-e7bf-41dd-a5a0-e736f4c7df13"],
Cell[29376, 710, 648, 15, 38, "CodeText",ExpressionUUID->"d0e6f9c0-362f-44cd-b6b2-fcd3f9f56ebc"],
Cell[30027, 727, 162, 3, 35, "Text",ExpressionUUID->"703255bd-7c27-47a1-8256-e364ffb8f30f"],
Cell[30192, 732, 237, 6, 38, "CodeText",ExpressionUUID->"dcaa41d5-fffe-4a4f-9ba2-1d9da30b3514"],
Cell[30432, 740, 655, 19, 41, "Text",ExpressionUUID->"9dda3cc0-6a1b-45c0-90d9-9f87981bed6f"],
Cell[31090, 761, 1490, 33, 46, "Input",ExpressionUUID->"7cbd9fd3-f13b-4ee0-888c-ba8105aff35b",
 InitializationCell->True],
Cell[32583, 796, 384, 10, 40, "Input",ExpressionUUID->"d667b6e1-8bd9-4f1c-a3da-f495de106d73"],
Cell[32970, 808, 933, 19, 40, "CodeText",ExpressionUUID->"a6c223b6-c7b2-4d87-9510-5a0a4ecd1778"],
Cell[33906, 829, 2509, 65, 41, "Text",ExpressionUUID->"9f6c8290-ce5e-4462-9597-cdc0e58ca280"],
Cell[36418, 896, 793, 26, 40, "Input",ExpressionUUID->"e9b976d2-f44c-4517-9c52-1a1645ec3929"],
Cell[37214, 924, 2122, 56, 40, "CodeText",ExpressionUUID->"327e5488-60aa-4ee7-9253-df2cc911cff2"],
Cell[39339, 982, 1121, 27, 69, "Text",ExpressionUUID->"94f84df5-72ce-4d03-b720-a24191d7a5b8"],
Cell[40463, 1011, 1346, 32, 37, "Text",ExpressionUUID->"6e62e98f-2f34-4aa1-86c8-e8edc8eb2aaa"],
Cell[41812, 1045, 976, 27, 62, "Input",ExpressionUUID->"3172d5b9-0799-44f0-bc41-955fd961dd4d"],
Cell[42791, 1074, 348, 7, 38, "CodeText",ExpressionUUID->"f2748720-68c4-4740-bf99-11c9eb9635e5"],
Cell[43142, 1083, 493, 13, 35, "Text",ExpressionUUID->"1419d4ca-6af9-44a4-8741-9a0528c4c918"],
Cell[43638, 1098, 452, 13, 62, "Input",ExpressionUUID->"ca5352dc-e9cd-4576-bbfd-12cefd22e985"],
Cell[44093, 1113, 796, 22, 37, "Text",ExpressionUUID->"9a0377b0-1f30-4886-8e62-4c1b5250bf76"],
Cell[44892, 1137, 2331, 52, 89, "Input",ExpressionUUID->"c608cd63-402e-4884-956c-d57a91918349",
 InitializationCell->True],
Cell[47226, 1191, 481, 11, 30, "Input",ExpressionUUID->"50e8a2f7-3acb-484c-98b9-454a17bcefc8"],
Cell[47710, 1204, 1530, 33, 61, "CodeText",ExpressionUUID->"0ab0756c-493e-4644-931b-a62999f513c0"],
Cell[49243, 1239, 178, 3, 35, "Text",ExpressionUUID->"62ef9b03-c330-4253-8e78-ae081769f315"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49458, 1247, 454, 7, 67, "Section",ExpressionUUID->"48b90859-e10d-42ef-bcc4-0a05bd152cb5"],
Cell[49915, 1256, 3515, 83, 37, "Text",ExpressionUUID->"2ab4306e-8430-45a3-a8b0-0b9c72b1573f"],
Cell[53433, 1341, 3036, 79, 44, "Input",ExpressionUUID->"17e4eb15-9735-4cd6-bb5c-3699dcea82b8"],
Cell[56472, 1422, 3790, 86, 84, "CodeText",ExpressionUUID->"c1a9b28a-0011-427c-ba79-c550fe29ed5e"],
Cell[60265, 1510, 940, 13, 35, "Text",ExpressionUUID->"5f789e45-013b-4377-aec2-6d651a5b36b4"],
Cell[61208, 1525, 971, 22, 38, "CodeText",ExpressionUUID->"343a164e-67d7-4b65-a23a-7e9172d0544a"],
Cell[62182, 1549, 6237, 166, 62, "Text",ExpressionUUID->"38788031-89a8-41a5-9fda-162d4cae9d3a"],
Cell[68422, 1717, 1612, 37, 46, "Input",ExpressionUUID->"cf06eb8f-7fb5-43d9-8aa4-0e3f2d8315cb",
 InitializationCell->True],
Cell[70037, 1756, 462, 11, 44, "Input",ExpressionUUID->"bb896f47-ffbb-413b-971a-69a71db74428"],
Cell[70502, 1769, 644, 15, 40, "CodeText",ExpressionUUID->"0c4542ec-b72a-43ec-9943-38febaf2ca89"],
Cell[71149, 1786, 1826, 44, 60, "Text",ExpressionUUID->"6ed171e5-e1a9-41af-8cf4-3ef0fc42149a"],
Cell[72978, 1832, 835, 21, 40, "CodeText",ExpressionUUID->"f040d2c1-10d3-43af-b797-c09322282600"],
Cell[73816, 1855, 235, 4, 35, "Text",ExpressionUUID->"c5695533-4e79-468b-b926-321fb56441ba"],
Cell[74054, 1861, 472, 13, 37, "Text",ExpressionUUID->"e114d69b-90d6-4303-b036-3b7898630fd4"],
Cell[74529, 1876, 1027, 24, 40, "CodeText",ExpressionUUID->"e5f46611-d3dd-4ea6-bc0f-a6f4dcaabbe9"],
Cell[75559, 1902, 3699, 89, 79, "Text",ExpressionUUID->"987b511a-7f52-4692-a4e4-517a3f793de4"],
Cell[79261, 1993, 2144, 52, 44, "Input",ExpressionUUID->"af823c6a-feb9-4be3-addd-e73d1e11c8bc"],
Cell[81408, 2047, 1424, 38, 40, "CodeText",ExpressionUUID->"9dfe774a-15b8-4ea4-b080-29466cb7c3a3"],
Cell[82835, 2087, 1928, 51, 37, "Text",ExpressionUUID->"7f47d148-4537-489e-a293-3645d5245c54"],
Cell[84766, 2140, 3894, 100, 63, "CodeText",ExpressionUUID->"0f80dc87-83ff-4850-9d54-74633838ae82"],
Cell[88663, 2242, 1889, 41, 44, "Input",ExpressionUUID->"b6bf1ff5-8e97-4b9a-a1c2-53308bf4f726"],
Cell[90555, 2285, 2058, 47, 37, "Text",ExpressionUUID->"a4720737-47d6-4c67-87bc-a4ea6793f5fa"],
Cell[92616, 2334, 2089, 54, 40, "CodeText",ExpressionUUID->"4c824393-ddd3-4802-8b8a-c2158f8a8bc2"],
Cell[94708, 2390, 1327, 32, 35, "Text",ExpressionUUID->"c2e29fa9-3eb8-49b3-a59d-1a537462807c"],
Cell[96038, 2424, 1365, 33, 44, "Input",ExpressionUUID->"e3f55493-5e70-4cc6-a8e1-8017d3172838"],
Cell[97406, 2459, 839, 21, 35, "Text",ExpressionUUID->"93724d59-e7a3-4281-b676-c81ca4645a4b"],
Cell[98248, 2482, 807, 21, 56, "CodeText",ExpressionUUID->"5bdd1c7c-e5bd-4e92-b637-810bfd12e7bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99092, 2508, 237, 4, 67, "Section",ExpressionUUID->"241ce77d-e96a-463f-ada8-f1f5425c879f"],
Cell[99332, 2514, 804, 22, 37, "Text",ExpressionUUID->"cbd87819-9958-44d5-b0ff-74b35bcbbad7"],
Cell[100139, 2538, 1855, 47, 40, "CodeText",ExpressionUUID->"1ad9b6dd-55ac-4558-b57e-be4f6a956cd0"],
Cell[101997, 2587, 699, 12, 35, "Text",ExpressionUUID->"c4cf1078-9013-410d-9c2d-a8d06f086384"],
Cell[102699, 2601, 1671, 42, 41, "CodeText",ExpressionUUID->"2148ea88-7fbf-42fb-a8b0-03dd8a41fb3f"],
Cell[104373, 2645, 730, 15, 33, "Input",ExpressionUUID->"2c2b1f13-4da3-4dc7-8eef-a5c03660d541"],
Cell[105106, 2662, 751, 19, 37, "Text",ExpressionUUID->"5ab47651-6ca3-4cd7-9722-ef9f092f791a"],
Cell[105860, 2683, 1650, 38, 40, "CodeText",ExpressionUUID->"961b1f88-7c3c-4ec9-a0d4-e519bbd71ee5"],
Cell[107513, 2723, 446, 12, 44, "Input",ExpressionUUID->"194883a7-eb77-4e39-8efd-920cf3c6c1f3"],
Cell[107962, 2737, 1207, 34, 40, "CodeText",ExpressionUUID->"7e70a0ac-595d-4366-af0b-6579691ea073"],
Cell[109172, 2773, 661, 17, 42, "Input",ExpressionUUID->"885f41f5-0586-45f6-b32a-6a218677192b"],
Cell[109836, 2792, 5222, 133, 81, "Text",ExpressionUUID->"2886fb01-e2d4-49d7-9a4f-a591820e5117"],
Cell[115061, 2927, 626, 15, 40, "CodeText",ExpressionUUID->"933ab843-fc91-4764-a36a-66258dd4a5e3"],
Cell[115690, 2944, 679, 16, 42, "Input",ExpressionUUID->"c610964f-67aa-4fac-8704-f3e14be434ea"],
Cell[116372, 2962, 1146, 32, 56, "CodeText",ExpressionUUID->"bab3e504-c82a-4ee4-ac8a-bc562a0b5553"],
Cell[117521, 2996, 879, 21, 58, "Input",ExpressionUUID->"8f135b83-5d90-4bbd-afa9-77c67dbb5a49"],
Cell[118403, 3019, 793, 20, 50, "Text",ExpressionUUID->"02f4a5fc-186c-40f9-b9f2-3aa62215eef9"],
Cell[119199, 3041, 2611, 66, 44, "CodeText",ExpressionUUID->"14c0d235-cd0c-4d5b-8b66-63ce348861d4"],
Cell[121813, 3109, 967, 25, 49, "Input",ExpressionUUID->"c9160027-a7b6-4b0a-868d-a4520f963e63",
 InitializationCell->True],
Cell[122783, 3136, 437, 12, 42, "Input",ExpressionUUID->"58ca25b5-22aa-4d7a-8608-771249d9f536"],
Cell[123223, 3150, 308, 6, 35, "Text",ExpressionUUID->"6857e0cc-0ff6-46e7-9364-4d31ee64f599"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123568, 3161, 156, 3, 67, "Section",ExpressionUUID->"cacf83d6-5a68-4dd3-b6ee-8a0b21bde768"],
Cell[123727, 3166, 863, 20, 37, "Text",ExpressionUUID->"9785bf66-db7d-40c1-8806-977cf6142e64"],
Cell[124593, 3188, 375, 10, 33, "Input",ExpressionUUID->"1df4b078-0e7c-4f80-921f-7018405f95ac"],
Cell[124971, 3200, 723, 17, 40, "CodeText",ExpressionUUID->"85aad354-c1bf-40be-a4e6-3fddf9af3062"],
Cell[125697, 3219, 224, 3, 35, "Text",ExpressionUUID->"1b08ad1b-6e27-4776-9a3a-998e06372a3d"],
Cell[125924, 3224, 2046, 54, 44, "CodeText",ExpressionUUID->"04766e45-c5dc-4364-9b2a-7255262f3288"],
Cell[127973, 3280, 2081, 49, 49, "Input",ExpressionUUID->"220effbe-d603-46c0-b55b-2bfa8dfe0b1e",
 InitializationCell->True],
Cell[130057, 3331, 588, 16, 42, "Input",ExpressionUUID->"761174dc-76b1-43f9-b80a-84c14679b472"],
Cell[130648, 3349, 582, 14, 40, "CodeText",ExpressionUUID->"a96826e5-d0f0-4dc5-8353-e0531a6defa7"],
Cell[131233, 3365, 1117, 29, 37, "Text",ExpressionUUID->"bf675e34-433a-473a-9e84-d2f9d34ebd77"],
Cell[132353, 3396, 156, 3, 38, "CodeText",ExpressionUUID->"f521f3ce-60e8-401c-9448-24189d2924d0"],
Cell[132512, 3401, 2750, 68, 62, "Text",ExpressionUUID->"3290d1be-0cb7-4738-9806-e8bb282e7762"],
Cell[135265, 3471, 2349, 61, 40, "CodeText",ExpressionUUID->"a338b428-8d5a-42dc-8f50-ec70074ae5ea"],
Cell[137617, 3534, 763, 22, 53, "Input",ExpressionUUID->"d353d042-9023-407a-a1a3-14a6089576a0"],
Cell[138383, 3558, 557, 14, 40, "CodeText",ExpressionUUID->"2d00e754-7056-46d2-978c-3ae96ca574f9"],
Cell[138943, 3574, 201, 4, 35, "Text",ExpressionUUID->"7a1bbb81-e55c-47ab-b2a4-48fa2524b653"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139181, 3583, 276, 4, 67, "Section",ExpressionUUID->"a8270ee5-8180-4ba8-8f47-260db419cc4a"],
Cell[139460, 3589, 800, 15, 81, "Text",ExpressionUUID->"3c8e7629-f94a-4107-85a1-ec4625294769"],
Cell[140263, 3606, 3577, 90, 93, "Input",ExpressionUUID->"607c7f7d-86e6-451a-84f6-32ea1fd42b7b",
 InitializationCell->True],
Cell[143843, 3698, 687, 19, 33, "Input",ExpressionUUID->"a52daad2-f8a4-42f2-ba17-9b27e7b7845c"],
Cell[144533, 3719, 574, 10, 35, "Text",ExpressionUUID->"da99c75d-206f-4615-82ab-444f8fb7fbbd"],
Cell[145110, 3731, 604, 16, 33, "Input",ExpressionUUID->"091b0216-db54-4093-86d1-5694718e9355"],
Cell[145717, 3749, 1119, 31, 44, "CodeText",ExpressionUUID->"d767b38b-0fc4-4ec0-b393-38eff279b82e"],
Cell[146839, 3782, 281, 6, 38, "CodeText",ExpressionUUID->"77f76a64-386d-4cf9-9637-b6445c015ff1"],
Cell[147123, 3790, 452, 9, 35, "Text",ExpressionUUID->"411e6366-a788-4303-8974-b6784b1d551a"],
Cell[147578, 3801, 316, 6, 38, "CodeText",ExpressionUUID->"ec221523-fc3f-43e0-8316-5c5caf50b4aa"],
Cell[147897, 3809, 1449, 34, 37, "Text",ExpressionUUID->"aeffb8f1-4db6-47fa-ba2c-a0dc8d3559ed"],
Cell[149349, 3845, 1439, 41, 44, "CodeText",ExpressionUUID->"16c522ba-57b8-429f-9dca-d1a575b11a7e"],
Cell[150791, 3888, 641, 21, 65, "Input",ExpressionUUID->"aa901677-3a81-4391-b424-fc7ed1d9da9e"],
Cell[151435, 3911, 537, 13, 40, "CodeText",ExpressionUUID->"58cde102-5e77-4561-a318-b604cf699663"],
Cell[151975, 3926, 1325, 28, 37, "Text",ExpressionUUID->"6093c120-0c02-436a-889c-5bd1a1849e2e"],
Cell[153303, 3956, 3764, 88, 139, "Input",ExpressionUUID->"e2d0a19c-9769-447e-85c5-7c17b3ccc35e",
 InitializationCell->True],
Cell[157070, 4046, 336, 8, 33, "Input",ExpressionUUID->"509514ff-38aa-4b72-a60b-dff90d44a030"],
Cell[157409, 4056, 3179, 75, 139, "Input",ExpressionUUID->"966dd25f-9acc-4d31-a17c-84e884143d9c",
 InitializationCell->True],
Cell[160591, 4133, 341, 8, 33, "Input",ExpressionUUID->"45f430d5-e83a-498e-80c1-225935b4a5a3"],
Cell[160935, 4143, 203, 3, 35, "Text",ExpressionUUID->"2b602a06-0cee-4ebb-b1b0-33985e61c3de"],
Cell[161141, 4148, 454, 10, 55, "CodeText",ExpressionUUID->"010536d6-dbe1-48a9-ae54-02c22c7898ba"],
Cell[161598, 4160, 4299, 101, 139, "Input",ExpressionUUID->"a83a58f4-46c7-4a43-93b9-7af5d72188b6",
 InitializationCell->True],
Cell[165900, 4263, 344, 8, 33, "Input",ExpressionUUID->"55ac0bda-d0e0-4e4b-9bbe-be56e00c3a18"],
Cell[166247, 4273, 2045, 56, 33, "Input",ExpressionUUID->"675a8095-f3bd-4157-a965-0db5d82b3495"],
Cell[168295, 4331, 2336, 61, 56, "Input",ExpressionUUID->"128a5eee-38d1-4140-b1f6-07da746651eb"],
Cell[170634, 4394, 2610, 68, 56, "Input",ExpressionUUID->"0b6ac101-1fbb-4cd6-ac07-4b314eeb8509"],
Cell[173247, 4464, 573, 16, 40, "Text",ExpressionUUID->"40169f83-8bbe-4497-8a5c-d09635d3ba60"],
Cell[173823, 4482, 167, 3, 35, "Text",ExpressionUUID->"047a1b71-7355-4e44-8c0f-3b98c4aba694"],
Cell[173993, 4487, 313, 7, 33, "Input",ExpressionUUID->"7a74d009-b729-4f0e-942f-e432382f7d6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174343, 4499, 210, 4, 67, "Section",ExpressionUUID->"cedc51d1-069e-426f-b8f0-404840da5083"],
Cell[174556, 4505, 3710, 98, 76, "Text",ExpressionUUID->"828b3739-839e-4269-b008-cb52a8d697cc"],
Cell[178269, 4605, 365, 6, 35, "Text",ExpressionUUID->"a8e7ad28-e941-4bdd-8a1e-c067649877d1"],
Cell[178637, 4613, 685, 18, 33, "Input",ExpressionUUID->"d5e2a5be-162c-471f-bac9-eef46adf1ff3"],
Cell[179325, 4633, 1424, 41, 30, "Input",ExpressionUUID->"70245152-177a-4e11-bbf1-41629828d593"],
Cell[180752, 4676, 660, 18, 33, "Input",ExpressionUUID->"cf8df578-d45a-428d-b760-61499d32332f"],
Cell[181415, 4696, 777, 16, 40, "CodeText",ExpressionUUID->"a501d663-5d7f-4dc4-9066-0a787b91b2c5"],
Cell[182195, 4714, 1812, 46, 38, "Input",ExpressionUUID->"2404f500-5bdc-46da-a640-d29e665cc7e8"],
Cell[184010, 4762, 183, 3, 35, "Text",ExpressionUUID->"94f5aa81-6035-4f10-9cf8-3f1686f89a11"],
Cell[184196, 4767, 539, 10, 38, "CodeText",ExpressionUUID->"6a471b88-2f4e-4f2e-a383-1ea988b55415"],
Cell[184738, 4779, 2664, 71, 71, "Input",ExpressionUUID->"8bacc7ce-6eef-4cc6-aaa1-9e828b876653"],
Cell[187405, 4852, 281, 6, 38, "CodeText",ExpressionUUID->"49eb4a03-fd00-43f7-a8d7-e6148b682c0d"],
Cell[187689, 4860, 1339, 39, 30, "Input",ExpressionUUID->"f21e3321-6867-43ad-81e8-a1c75c337818"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189065, 4904, 212, 3, 67, "Section",ExpressionUUID->"2e59b6e5-1f97-46bd-b33a-287fe288890c"],
Cell[189280, 4909, 438, 8, 35, "Text",ExpressionUUID->"092f51e9-038f-4581-b38c-3943342be095"],
Cell[189721, 4919, 4053, 105, 63, "CodeText",ExpressionUUID->"55b58299-89d5-4c19-b50d-c63beb42f6b2"],
Cell[193777, 5026, 2281, 48, 42, "Input",ExpressionUUID->"0d624177-fef2-4268-85fd-517d2f58ef10"],
Cell[196061, 5076, 438, 9, 38, "CodeText",ExpressionUUID->"cc5fcb7d-e621-466a-a8a8-5d5dc06139a1"],
Cell[196502, 5087, 1774, 41, 42, "Input",ExpressionUUID->"2d61d806-3a75-4d78-88a6-f7004e0dad02"],
Cell[198279, 5130, 181, 3, 35, "Text",ExpressionUUID->"d6952d8b-e03d-4fa0-899c-b08b2bc39883"],
Cell[198463, 5135, 163, 3, 35, "Text",ExpressionUUID->"a9aada7a-df8b-428d-b176-2bf30e341b95"],
Cell[198629, 5140, 1012, 26, 42, "Input",ExpressionUUID->"3acb1efb-0dc6-40d4-8786-b1d879859cd0"],
Cell[199644, 5168, 2742, 60, 42, "Input",ExpressionUUID->"5bb6aa40-702a-4dbb-b619-0472797efad6"],
Cell[202389, 5230, 2279, 56, 99, "Input",ExpressionUUID->"693d01a7-fe5d-49f8-889a-5d70ade55bfb"],
Cell[204671, 5288, 3234, 78, 127, "Input",ExpressionUUID->"35353915-e72a-4585-9012-c710803d6eee"],
Cell[207908, 5368, 481, 12, 30, "Input",ExpressionUUID->"4dd91082-4aba-4c78-b309-fbbffe627965"],
Cell[208392, 5382, 3526, 90, 106, "Input",ExpressionUUID->"823ca253-2c67-4d77-8ba8-05e098f01d0a"],
Cell[211921, 5474, 202, 3, 38, "CodeText",ExpressionUUID->"0ebedcb7-078e-4b96-92b1-95d99bb9ca15"],
Cell[212126, 5479, 1435, 44, 42, "Text",ExpressionUUID->"ded6d09e-c996-40cd-b0dc-05f79f975d0f"],
Cell[213564, 5525, 785, 14, 58, "Text",ExpressionUUID->"1db6a7a7-b937-4478-bec4-67a58dd1d2d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214386, 5544, 159, 3, 67, "Section",ExpressionUUID->"c7928850-f322-483b-a86e-3bbec69a9e04"],
Cell[214548, 5549, 508, 14, 48, "Input",ExpressionUUID->"aaecb0a5-1c29-4b2a-9324-6d9bf2d92539"],
Cell[215059, 5565, 263, 5, 33, "Input",ExpressionUUID->"b9a15f9a-8f2a-4d95-84b6-b618d83e2c60"],
Cell[215325, 5572, 297, 7, 36, "Input",ExpressionUUID->"7d4a9298-2f75-4bcd-a392-b83f1e0b6c5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215659, 5584, 148, 3, 67, "Section",ExpressionUUID->"52e9c100-b83e-484d-8061-1653eddb26ac"],
Cell[215810, 5589, 1603, 41, 95, "Input",ExpressionUUID->"1df1953c-5fe4-48f0-8f13-35935d36a1f6"],
Cell[217416, 5632, 2390, 59, 88, "Input",ExpressionUUID->"a6422097-32c2-42e3-b3d4-a6c606a7f561"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219855, 5697, 163, 3, 69, "Chapter",ExpressionUUID->"93173e8b-127d-4099-89ca-73d59c67b73c"],
Cell[220021, 5702, 247, 6, 35, "Text",ExpressionUUID->"e34cd0ed-32ab-4efd-9104-b793b190ffda"],
Cell[CellGroupData[{
Cell[220293, 5712, 159, 3, 67, "Section",ExpressionUUID->"0a67eeef-cc07-45cf-b4e3-ad3f56a8ff1c"],
Cell[220455, 5717, 206, 4, 35, "Text",ExpressionUUID->"ad41c022-49ff-4c7d-8510-831739ff86cb"],
Cell[220664, 5723, 186, 4, 30, "Input",ExpressionUUID->"f5d3d390-6526-4180-aaa3-e69ec0573983"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220887, 5732, 270, 4, 67, "Section",ExpressionUUID->"379970fd-80a4-4dd5-b1c5-c8d569a0c3be"],
Cell[221160, 5738, 568, 14, 37, "Text",ExpressionUUID->"129b5462-56cb-4838-9be7-9b3d14ef9587"],
Cell[221731, 5754, 515, 12, 40, "CodeText",ExpressionUUID->"e36b234a-6504-400b-bb30-972129c0c55e"],
Cell[222249, 5768, 660, 15, 37, "Text",ExpressionUUID->"43349a23-af05-4c66-a34c-8b8cca380bb2"],
Cell[222912, 5785, 1795, 45, 41, "CodeText",ExpressionUUID->"8f576446-7fd7-412f-9547-ae0ff55798b6"],
Cell[224710, 5832, 567, 14, 37, "Text",ExpressionUUID->"b1e36c97-06c7-4b56-a79a-686eddb81007"],
Cell[225280, 5848, 1975, 55, 58, "CodeText",ExpressionUUID->"62b1f168-4af6-4624-8c9b-18802b11a256"],
Cell[227258, 5905, 1622, 42, 37, "Text",ExpressionUUID->"9f142271-50f7-4325-acdf-632eb068d6a5"],
Cell[228883, 5949, 1805, 52, 58, "CodeText",ExpressionUUID->"8a4465e6-9499-4561-8d63-f495f75a9301"],
Cell[230691, 6003, 3697, 98, 55, "Text",ExpressionUUID->"68fcaa1a-de69-4d5c-94cf-a5e7cc9593d0"],
Cell[234391, 6103, 1915, 53, 40, "CodeText",ExpressionUUID->"4226448d-4a66-4a28-ad8a-4f31dc65bd26"],
Cell[236309, 6158, 1249, 33, 37, "Text",ExpressionUUID->"0e708261-46ea-4265-93b0-23004e9212a9"],
Cell[237561, 6193, 3285, 80, 94, "Input",ExpressionUUID->"a99aa70a-3c00-4c6c-9d87-fd28eb9cdc04"],
Cell[240849, 6275, 6067, 163, 107, "CodeText",ExpressionUUID->"fe810e6d-bbf3-40dd-8a4d-203f787d76e7"],
Cell[246919, 6440, 5040, 134, 62, "Text",ExpressionUUID->"69fae9dc-8a06-4ee1-a666-b341e3ac6c04"],
Cell[251962, 6576, 1479, 38, 40, "CodeText",ExpressionUUID->"a930a868-956e-4b89-b650-43348a92ba9e"],
Cell[253444, 6616, 1050, 28, 37, "Text",ExpressionUUID->"94985e90-d522-4f77-b002-36c4f07b0626"],
Cell[254497, 6646, 483, 13, 40, "CodeText",ExpressionUUID->"be92e71f-8b8f-4a30-a70f-ff98e7e5a8ad"],
Cell[254983, 6661, 226, 5, 35, "Text",ExpressionUUID->"4b7a9f2e-651c-4ffc-bbca-5af2c31524ce"],
Cell[255212, 6668, 2473, 69, 110, "Input",ExpressionUUID->"12ab6136-ab3d-4243-835f-43a04099003c",
 InitializationCell->True],
Cell[257688, 6739, 630, 11, 30, "Input",ExpressionUUID->"3366e5dd-d24e-4218-93c8-7a6939330332"],
Cell[CellGroupData[{
Cell[258343, 6754, 160, 3, 54, "Subsection",ExpressionUUID->"fe9336a1-9852-46a3-9e8f-5b68476bb411"],
Cell[258506, 6759, 436, 8, 35, "Text",ExpressionUUID->"d6e9b008-5e82-449c-8e0b-0192d9b89328"],
Cell[258945, 6769, 467, 14, 72, "Input",ExpressionUUID->"f2ce0633-3136-49d6-8fc2-aca78550c25a"],
Cell[259415, 6785, 4975, 135, 81, "Text",ExpressionUUID->"0937dd53-77e0-4738-9828-1b7e97f1020c"],
Cell[264393, 6922, 2275, 59, 82, "Input",ExpressionUUID->"9139f8f1-f339-46bb-815d-7eb88e542b18"],
Cell[266671, 6983, 2338, 66, 96, "Input",ExpressionUUID->"a6fa7946-a20e-4522-a0c9-bca51d5043bd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[269058, 7055, 179, 3, 67, "Section",ExpressionUUID->"762f8ee2-2e28-4525-a483-2f0bd28585a9"],
Cell[269240, 7060, 3213, 77, 80, "Input",ExpressionUUID->"f2ed103c-6118-461b-8da6-372935e6b6f1"],
Cell[272456, 7139, 3105, 72, 79, "Input",ExpressionUUID->"c220fdcd-e517-4f88-98ef-e13419a38989"],
Cell[275564, 7213, 1577, 39, 55, "Input",ExpressionUUID->"4d207266-fa0e-47e4-94c4-d09fa44e0a7c"],
Cell[277144, 7254, 2162, 53, 57, "Input",ExpressionUUID->"24b3107a-7517-450d-b90b-f1cbec88f5f1"],
Cell[279309, 7309, 1295, 31, 37, "Text",ExpressionUUID->"a9395cce-d394-410b-989d-13e885b6d230"],
Cell[280607, 7342, 340, 7, 35, "Text",ExpressionUUID->"16a4ebb1-40bb-4af6-ab5e-dfa5f3c338c2"],
Cell[280950, 7351, 985, 31, 35, "Text",ExpressionUUID->"689a77b1-5e98-4bc3-9580-4df464fa0f9f"],
Cell[281938, 7384, 515, 14, 37, "Text",ExpressionUUID->"28837d7d-a1c2-4bce-a772-a3a67dfa1ed7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[282502, 7404, 257, 4, 69, "Chapter",ExpressionUUID->"373c961d-29e7-49ab-b1e8-df27aaaa0133"],
Cell[CellGroupData[{
Cell[282784, 7412, 151, 3, 67, "Section",ExpressionUUID->"3754a648-875d-485f-af0c-c162028866c8"],
Cell[282938, 7417, 437, 6, 35, "Text",ExpressionUUID->"f8f3f021-8427-49fc-b19e-6fdbca9fe151"],
Cell[283378, 7425, 1285, 32, 40, "CodeText",ExpressionUUID->"ea96f5ca-064e-432d-b284-0cb48ada1dba"],
Cell[284666, 7459, 1888, 39, 68, "Input",ExpressionUUID->"256586c2-b707-4b0f-9489-f3b9175212bb",
 InitializationCell->True],
Cell[286557, 7500, 348, 8, 30, "Input",ExpressionUUID->"605cabff-11ab-444f-8aba-4a49817c156c"],
Cell[286908, 7510, 569, 14, 38, "CodeText",ExpressionUUID->"90861758-302d-4561-83d9-9e511ba93975"],
Cell[287480, 7526, 588, 16, 30, "Input",ExpressionUUID->"b7cd1577-ca15-4c86-99c4-e551a36cf4ae"],
Cell[288071, 7544, 177, 3, 35, "Text",ExpressionUUID->"cb1a6bbc-6b13-4326-bf6f-780a914da319"],
Cell[288251, 7549, 572, 14, 33, "Input",ExpressionUUID->"367ea366-ab5e-4c6a-8362-0d8bae930b7c"],
Cell[288826, 7565, 810, 18, 46, "Input",ExpressionUUID->"ec3db1ed-48d7-4d94-8a9c-520efdeed51b",
 InitializationCell->True],
Cell[289639, 7585, 448, 12, 30, "Input",ExpressionUUID->"2bd4df48-d438-493b-8880-694f3ec5c77f"],
Cell[290090, 7599, 181, 3, 38, "CodeText",ExpressionUUID->"eefdfe68-77ea-48c7-92d2-c6b79c83fa7b"],
Cell[290274, 7604, 267, 6, 35, "Text",ExpressionUUID->"d477e588-c5f0-46a5-9fe8-0a2a9b62cff0"],
Cell[290544, 7612, 614, 15, 49, "Input",ExpressionUUID->"b8332123-4232-47c5-9503-9f4cd1297122",
 InitializationCell->True],
Cell[291161, 7629, 293, 7, 30, "Input",ExpressionUUID->"3fb49aa4-c4ad-49f1-ad4b-3f0ab9f9c78c"],
Cell[291457, 7638, 246, 4, 35, "Text",ExpressionUUID->"0d266c1d-6da3-4f1e-9e0f-b1883cdb338f"],
Cell[291706, 7644, 386, 8, 38, "CodeText",ExpressionUUID->"bcb854b4-e889-4a66-b01a-e9f9a75e0444"],
Cell[292095, 7654, 612, 16, 37, "Text",ExpressionUUID->"a2f9d9f8-f010-42db-9718-2e26749651b5"],
Cell[292710, 7672, 285, 7, 33, "Input",ExpressionUUID->"2535b555-784d-49b9-8731-d286fe8a7d66"],
Cell[292998, 7681, 265, 7, 35, "Text",ExpressionUUID->"17e9e0ca-3b5c-43a8-8a58-c0ea19e12945"],
Cell[293266, 7690, 576, 10, 59, "CodeText",ExpressionUUID->"e62c3750-97a4-4b45-91e1-13922ffa894d"],
Cell[293845, 7702, 465, 8, 35, "Text",ExpressionUUID->"a9043855-c147-4970-84cf-acef0695e439"],
Cell[294313, 7712, 457, 15, 33, "Input",ExpressionUUID->"49fa9310-48f2-4270-8706-d58392ea898e"],
Cell[294773, 7729, 958, 25, 40, "CodeText",ExpressionUUID->"2e2d9eec-efce-45b8-bcc2-c1deb6005d4b"],
Cell[295734, 7756, 468, 15, 33, "Input",ExpressionUUID->"f30eedf9-141d-4b46-a4f8-10fdcca05667"],
Cell[296205, 7773, 1429, 37, 40, "CodeText",ExpressionUUID->"c44d1805-e4a9-4bf2-962b-604e86bed803"],
Cell[297637, 7812, 750, 18, 37, "Text",ExpressionUUID->"f3958ea8-dac4-421a-91b7-d54b151ebcad"],
Cell[298390, 7832, 1140, 34, 33, "Input",ExpressionUUID->"57a3253e-45b1-40b3-925f-55cfda18fae9"],
Cell[299533, 7868, 469, 8, 35, "Text",ExpressionUUID->"7ceccd41-b9de-4186-a06a-5b903ce63729"],
Cell[300005, 7878, 939, 15, 59, "CodeText",ExpressionUUID->"835d45c0-a86f-4aaf-ae77-037d522dfac2"],
Cell[300947, 7895, 686, 15, 37, "Text",ExpressionUUID->"1d2fc48a-0db3-4ab2-9f95-a2a3a4ccbb45"],
Cell[301636, 7912, 386, 11, 34, "Input",ExpressionUUID->"39241ad4-a785-4e7b-80d4-cd6bdf0c03d5"],
Cell[302025, 7925, 407, 8, 38, "CodeText",ExpressionUUID->"636fe316-79a1-4163-9fb5-570917b253a9"],
Cell[302435, 7935, 722, 18, 37, "Text",ExpressionUUID->"c11eb552-ec28-4a43-ad9d-6740b08cfcc8"],
Cell[303160, 7955, 571, 16, 34, "Input",ExpressionUUID->"0521b08c-6810-4ed9-b331-7ff749b4f938"],
Cell[303734, 7973, 590, 19, 34, "Input",ExpressionUUID->"9ef5681b-8aab-48d9-b5f6-31efa8f56de2"],
Cell[304327, 7994, 1408, 35, 40, "CodeText",ExpressionUUID->"3c764bdb-9e2c-4812-9e69-239898f7e868"],
Cell[305738, 8031, 524, 9, 35, "Text",ExpressionUUID->"f0c582bb-fbd9-4f10-9c4c-41d5497ccf39"],
Cell[306265, 8042, 541, 17, 33, "Input",ExpressionUUID->"10e5e38a-e285-430e-877a-7bec764366c6"],
Cell[306809, 8061, 473, 15, 34, "Input",ExpressionUUID->"9b1ec81e-741e-4547-9011-3bf79cb827b4"],
Cell[307285, 8078, 643, 20, 34, "Input",ExpressionUUID->"2c522d9f-6746-4ba0-b101-1ef9a71bb9a6"],
Cell[307931, 8100, 685, 23, 34, "Input",ExpressionUUID->"fe302d5e-be03-4088-9457-9524742fe578"],
Cell[308619, 8125, 161, 3, 38, "CodeText",ExpressionUUID->"03779c80-6230-47db-b861-37aa3ecc09ba"],
Cell[308783, 8130, 577, 10, 35, "Text",ExpressionUUID->"55b4eea7-77dd-4b47-9b11-c0b83f8a96e4"],
Cell[309363, 8142, 1023, 28, 37, "Text",ExpressionUUID->"64ad7457-4a99-42d9-b781-2a8b5567ed51"],
Cell[310389, 8172, 596, 14, 49, "Input",ExpressionUUID->"330485b0-dd4c-4151-be19-7bf92c7cc44c",
 InitializationCell->True],
Cell[310988, 8188, 487, 13, 30, "Input",ExpressionUUID->"02196392-9603-434d-92a8-46e94a8ec46d"],
Cell[311478, 8203, 309, 6, 38, "CodeText",ExpressionUUID->"eafe417a-8c63-4cfd-a8fd-89a880492e66"],
Cell[311790, 8211, 940, 28, 37, "Text",ExpressionUUID->"833bd59a-a086-4d90-871b-554bb5610d67"],
Cell[312733, 8241, 522, 14, 33, "Input",ExpressionUUID->"eefc0cfe-a269-4379-9168-babfa06e5da4"],
Cell[313258, 8257, 405, 8, 38, "CodeText",ExpressionUUID->"7632d1c6-3657-4ba1-b85e-63805034f075"],
Cell[313666, 8267, 1291, 33, 83, "Text",ExpressionUUID->"c972dfff-a5c5-4130-a3bf-1367fd185974"],
Cell[314960, 8302, 571, 14, 34, "Input",ExpressionUUID->"0b3e4e8d-1468-4376-bd8c-daf181acd658"],
Cell[315534, 8318, 702, 12, 59, "CodeText",ExpressionUUID->"5b1a40ce-a12d-42a7-8003-17b1412aa79b"],
Cell[316239, 8332, 503, 15, 34, "Input",ExpressionUUID->"c56f56f6-3967-48fe-b9f8-135111008022"],
Cell[316745, 8349, 383, 10, 34, "Input",ExpressionUUID->"9bdd0a4f-7e5a-49b8-9128-5fa48364c49d"],
Cell[317131, 8361, 203, 3, 38, "CodeText",ExpressionUUID->"130170a6-a045-4a8c-a71a-f1bb7a6b41f3"],
Cell[317337, 8366, 1102, 33, 42, "Text",ExpressionUUID->"66aed23c-cd59-4240-9302-75bd4b49e518"],
Cell[318442, 8401, 509, 14, 34, "Input",ExpressionUUID->"2c05893b-2cc4-403f-834d-9befdf67736f"],
Cell[318954, 8417, 297, 7, 38, "CodeText",ExpressionUUID->"098d6511-2910-4b1c-8c95-ed95d68d5a47"],
Cell[319254, 8426, 743, 21, 37, "Text",ExpressionUUID->"3377e874-3d4f-4149-b28a-a96fb8878a1e"],
Cell[320000, 8449, 430, 10, 30, "Input",ExpressionUUID->"21a540db-6632-40ed-9be7-3956328376ff"],
Cell[320433, 8461, 232, 4, 35, "Text",ExpressionUUID->"d2ff7fcc-7cd3-48b6-aecc-f1a31e8888f6"],
Cell[320668, 8467, 1240, 23, 60, "Text",ExpressionUUID->"ef1c181a-775b-477e-8c86-6ac5c7c135b6"],
Cell[321911, 8492, 880, 18, 33, "Input",ExpressionUUID->"71e22b51-91b4-44b5-a870-962f04e320c5"],
Cell[322794, 8512, 417, 8, 35, "Text",ExpressionUUID->"f8015fdb-dc81-4e6b-9260-670cd9c035c1"],
Cell[323214, 8522, 672, 19, 30, "Input",ExpressionUUID->"1a8e0302-0841-4177-9d4f-dfd096e3f24e"],
Cell[323889, 8543, 464, 12, 33, "Input",ExpressionUUID->"2762bda1-e21a-47fd-9b6f-19fdda070855"],
Cell[324356, 8557, 597, 16, 30, "Input",ExpressionUUID->"bcb37c1d-c7e7-4543-946f-a029e7513033"],
Cell[324956, 8575, 159, 3, 35, "Text",ExpressionUUID->"1218dd74-9603-4e6a-8fc2-b5202149563b"],
Cell[325118, 8580, 3078, 66, 122, "CodeText",ExpressionUUID->"ea1c2449-fcb7-4745-9f2b-9835276d32f7"],
Cell[328199, 8648, 765, 19, 37, "Text",ExpressionUUID->"3d677526-476f-4f18-a4b9-de665921a928"],
Cell[328967, 8669, 488, 14, 33, "Input",ExpressionUUID->"159884f0-f01d-4e22-bed7-5711de34d225"],
Cell[329458, 8685, 930, 22, 38, "CodeText",ExpressionUUID->"ca83c5bd-6fb9-4d25-b4a1-46d58fc62c42"],
Cell[330391, 8709, 575, 17, 30, "Input",ExpressionUUID->"d6924a53-d9bd-4ba6-9cf2-b5ee41ab7a0e"],
Cell[330969, 8728, 1218, 26, 59, "CodeText",ExpressionUUID->"e952126e-b7c8-4011-8eb4-c39346e76af2"],
Cell[332190, 8756, 248, 5, 38, "CodeText",ExpressionUUID->"e58bd373-b058-404e-bf92-d739b95ccee2"],
Cell[332441, 8763, 336, 8, 30, "Input",ExpressionUUID->"ab1cdc56-7b3f-4c78-af8f-c22ee5643a3f"],
Cell[332780, 8773, 418, 11, 33, "Input",ExpressionUUID->"ad0ae499-a386-4df7-9094-668f9322f276"],
Cell[333201, 8786, 287, 6, 35, "Text",ExpressionUUID->"2b9a8b2e-f89a-471f-8b0b-0e5a1583cbc2"],
Cell[333491, 8794, 385, 11, 33, "Input",ExpressionUUID->"7e838f85-a403-4bf7-b03a-b6ca0c9d338a"],
Cell[333879, 8807, 485, 15, 33, "Input",ExpressionUUID->"1effe5b7-54fa-4fe1-93a1-90efee8d4eb8"],
Cell[334367, 8824, 327, 7, 38, "CodeText",ExpressionUUID->"6d8f81f9-75be-4b11-a652-9d742cfe214a"],
Cell[334697, 8833, 431, 10, 127, "Text",ExpressionUUID->"026aeda0-555c-4729-ac12-264148af481c"],
Cell[335131, 8845, 491, 14, 34, "Input",ExpressionUUID->"06a1390e-287d-4d82-9bea-f3451653b8fe"],
Cell[335625, 8861, 459, 12, 33, "Input",ExpressionUUID->"8a912678-7cb7-4e57-ab78-706520d293dc"],
Cell[CellGroupData[{
Cell[336109, 8877, 180, 3, 54, "Subsection",ExpressionUUID->"e38b805e-ce39-42c3-bced-6b7c63cffb47"],
Cell[336292, 8882, 291, 8, 81, "Text",ExpressionUUID->"4bcb986a-5832-4ab8-be84-b8e308d1ba6a"],
Cell[336586, 8892, 482, 14, 30, "Input",ExpressionUUID->"32a9d951-d0ca-4147-ad50-6820cef35557"],
Cell[337071, 8908, 208, 4, 30, "Input",ExpressionUUID->"c0248a01-afc6-4f9b-a18b-3c7da520df4b"],
Cell[337282, 8914, 572, 13, 30, "Input",ExpressionUUID->"248a8ae1-1e52-4d3b-a85a-ac729d2a3030"],
Cell[337857, 8929, 495, 9, 30, "Input",ExpressionUUID->"9a6bbb1c-f1c1-4298-a3ca-9609e93c190f"],
Cell[338355, 8940, 481, 12, 30, "Input",ExpressionUUID->"5faa8a4e-30cc-4fa3-86ac-b871e2ce104c"],
Cell[338839, 8954, 2543, 73, 128, "Input",ExpressionUUID->"094d003f-6da9-47dd-a7b6-4a8178ef0de1",
 InitializationCell->True],
Cell[341385, 9029, 406, 11, 30, "Input",ExpressionUUID->"393f5fea-edad-4cc2-912b-0aac31d12832"],
Cell[341794, 9042, 175, 3, 30, "Input",ExpressionUUID->"1ad8194c-0fbb-48c1-af99-780847c4e290"],
Cell[341972, 9047, 849, 23, 30, "Input",ExpressionUUID->"12faa51f-4282-4b07-9261-1a20d957636d"],
Cell[342824, 9072, 928, 28, 30, "Input",ExpressionUUID->"b9beac98-403b-4f3d-909e-e4f7f9021906"],
Cell[343755, 9102, 216, 4, 30, "Input",ExpressionUUID->"627ecc77-bb75-4c35-8ead-6c95aad7c92d"],
Cell[343974, 9108, 464, 14, 33, "Input",ExpressionUUID->"f8cfc992-cdb1-40f6-89b3-00b162e66c8e"],
Cell[344441, 9124, 537, 15, 30, "Input",ExpressionUUID->"d1694752-a4ec-4b20-afba-a9fa9c9142c4"],
Cell[344981, 9141, 697, 21, 30, "Input",ExpressionUUID->"23276d27-ea6d-44d8-be31-46280e991047"],
Cell[345681, 9164, 164, 3, 35, "Text",ExpressionUUID->"e64bc770-badd-4c1a-8b22-916e6a07195e"],
Cell[345848, 9169, 287, 6, 35, "Text",ExpressionUUID->"d6ce14dd-a232-4a71-bb8d-7729b055b8dc"],
Cell[346138, 9177, 598, 18, 33, "Input",ExpressionUUID->"c6b4ab7c-6d7c-47cb-ae3c-da66cd29bc79"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[346797, 9202, 159, 3, 69, "Chapter",ExpressionUUID->"4f7e9df7-427d-4696-9dc0-d02ace24a4ee"],
Cell[CellGroupData[{
Cell[346981, 9209, 190, 4, 67, "Section",ExpressionUUID->"3e0d40e8-790f-47fe-af7d-9e7acd723ba8"],
Cell[347174, 9215, 343, 7, 35, "Text",ExpressionUUID->"a0591189-65c1-4dba-8679-3b254845eedc"],
Cell[347520, 9224, 171, 3, 35, "Text",ExpressionUUID->"d34f82a4-1aa4-440d-88bf-8c21e18bc2e6"],
Cell[347694, 9229, 334, 9, 35, "Text",ExpressionUUID->"995c2d3e-8910-4e07-b17b-79d5bcbe1cd3"],
Cell[348031, 9240, 239, 6, 38, "CodeText",ExpressionUUID->"ff3239f7-e2f1-40fe-8e5c-2a13cf3edfd0"],
Cell[348273, 9248, 257, 8, 35, "Text",ExpressionUUID->"12b91525-9f07-484d-8a21-6f422d77fc1d"],
Cell[348533, 9258, 333, 7, 38, "CodeText",ExpressionUUID->"356118db-5da5-4429-8169-74b497191f04"],
Cell[348869, 9267, 248, 8, 35, "Text",ExpressionUUID->"6097fbc7-29eb-4f7a-a194-6b61d4562957"],
Cell[349120, 9277, 329, 7, 38, "CodeText",ExpressionUUID->"a6b84255-ad0a-43c9-9927-198b6bd0c089"],
Cell[349452, 9286, 188, 3, 35, "Text",ExpressionUUID->"437bb3f1-db2a-4e36-96cc-f5199644465b"],
Cell[349643, 9291, 154, 3, 38, "CodeText",ExpressionUUID->"dd096a0c-6197-460a-9faf-82c8ceeb6860"],
Cell[349800, 9296, 236, 4, 35, "Text",ExpressionUUID->"529b746b-5ad9-4a35-97dd-6f2af18ad187"],
Cell[350039, 9302, 180, 3, 35, "Text",ExpressionUUID->"37393d84-3ef8-42bd-b5b3-5db8613f7b82"],
Cell[350222, 9307, 245, 8, 35, "Text",ExpressionUUID->"574c216a-77ab-43f8-b96a-7a89574a03c6"],
Cell[350470, 9317, 1052, 23, 38, "CodeText",ExpressionUUID->"991f52ff-2ca7-4e98-8234-b346fc977d9d"],
Cell[351525, 9342, 229, 8, 35, "Text",ExpressionUUID->"6219ba90-392f-4dfc-bd02-61c026fae511"],
Cell[351757, 9352, 232, 4, 38, "CodeText",ExpressionUUID->"36dc4239-72f9-4947-9678-ffd104bc357b"],
Cell[351992, 9358, 350, 12, 35, "Text",ExpressionUUID->"aec6aa74-adcf-4c07-b8b8-dd342cd9ecaf"],
Cell[352345, 9372, 761, 16, 40, "CodeText",ExpressionUUID->"6497d450-56d8-4ef2-9ed9-d0a043ded297"],
Cell[353109, 9390, 253, 8, 35, "Text",ExpressionUUID->"32d23c7a-00de-452e-8ae5-ece5ac22d957"],
Cell[353365, 9400, 153, 3, 38, "CodeText",ExpressionUUID->"6ef27e5c-0f40-446e-96e0-ec2158c8d877"],
Cell[353521, 9405, 966, 20, 110, "Text",ExpressionUUID->"30a3913e-1c95-4c98-be53-99598687596f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[354524, 9430, 163, 3, 67, "Section",ExpressionUUID->"9452b594-8de0-4670-aa7a-32fc0f1bb1b9"],
Cell[354690, 9435, 690, 16, 35, "Text",ExpressionUUID->"ba1a7f5f-5baf-4128-bc3b-e4c925ba580c"],
Cell[355383, 9453, 1001, 23, 101, "CodeText",ExpressionUUID->"3cadf43a-16d4-49ef-b211-49dc370c97b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356421, 9481, 193, 3, 67, "Section",ExpressionUUID->"9d409e5a-a0d3-48ed-af18-4f6d37889ffe"],
Cell[CellGroupData[{
Cell[356639, 9488, 164, 3, 54, "Subsection",ExpressionUUID->"36116afa-cfe8-40c7-873c-e9c2470b06db"],
Cell[356806, 9493, 1205, 32, 37, "Text",ExpressionUUID->"203cffe4-6fc8-4b4d-b912-40487d9b68e7"],
Cell[358014, 9527, 1888, 45, 68, "Input",ExpressionUUID->"e4164df1-4e80-4ec6-a456-3f8801de2eed",
 InitializationCell->True],
Cell[359905, 9574, 670, 19, 52, "Input",ExpressionUUID->"d2853a88-8306-46a3-836b-cd69d9b0f8ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[360612, 9598, 588, 14, 56, "Subsection",ExpressionUUID->"4174ed99-ead6-4cd4-bdea-2ea735a15a30"],
Cell[361203, 9614, 1471, 39, 68, "Input",ExpressionUUID->"b4f1a684-7cd8-4a38-8214-1cedc78ffc9a",
 InitializationCell->True],
Cell[362677, 9655, 433, 11, 50, "Input",ExpressionUUID->"4b0c5579-936e-4f3f-a867-eb5bfb38429c"]
}, Open  ]],
Cell[363125, 9669, 618, 14, 56, "Subsection",ExpressionUUID->"f8178bc2-cbe9-4226-9ea1-b6ad17c273d2"],
Cell[363746, 9685, 325, 5, 38, "Subsection",ExpressionUUID->"b913e7e7-ad0d-45cf-8196-5e3421981cfb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364108, 9695, 162, 3, 67, "Section",ExpressionUUID->"b1521dad-5dba-48e4-8a92-2dc89b5a8424"],
Cell[364273, 9700, 1581, 37, 68, "Input",ExpressionUUID->"9d75bd1e-4b1d-4c7d-b206-74b50bf37df2",
 InitializationCell->True],
Cell[365857, 9739, 380, 9, 52, "Input",ExpressionUUID->"49e24ab1-2c41-4b44-a090-b6f35c50f78c"],
Cell[366240, 9750, 148, 4, 30, "Input",ExpressionUUID->"291bd38d-fb5a-4b19-9993-0e7f91cbc0de"],
Cell[366391, 9756, 2981, 72, 95, "Input",ExpressionUUID->"61bc2fee-96de-4bd4-9582-54c1053f710f",
 InitializationCell->True],
Cell[369375, 9830, 427, 10, 52, "Input",ExpressionUUID->"9ab35f64-faef-4e20-bacf-bd1adef29232"],
Cell[369805, 9842, 212, 4, 30, "Input",ExpressionUUID->"db8c45a7-0b61-4de7-8bfc-ca002e623393"]
}, Open  ]],
Cell[CellGroupData[{
Cell[370054, 9851, 164, 3, 67, "Section",ExpressionUUID->"fcc39396-0974-46e9-a7c7-44d279333dba"],
Cell[370221, 9856, 670, 20, 30, "Input",ExpressionUUID->"68922790-ddd9-42ad-a34c-a4211bff5752"],
Cell[370894, 9878, 758, 21, 30, "Input",ExpressionUUID->"1e73545d-c4b1-438f-9cb0-920bf04a5165"],
Cell[371655, 9901, 522, 13, 35, "Text",ExpressionUUID->"b0fcf8bd-9c8c-423a-9f3e-00225acbeb56"]
}, Open  ]],
Cell[372192, 9917, 166, 3, 67, "Section",ExpressionUUID->"829afc84-8732-4ca6-94ed-92a779619bc5"],
Cell[372361, 9922, 226, 4, 53, "Section",ExpressionUUID->"f22c2d00-7ae9-432b-b3dc-0c6891c648a7"],
Cell[372590, 9928, 161, 3, 53, "Section",ExpressionUUID->"e93ee1c6-688e-44ce-ba7d-b7c205a0daed"],
Cell[CellGroupData[{
Cell[372776, 9935, 168, 3, 53, "Section",ExpressionUUID->"f12f5769-96fb-45d8-b5c4-7b5b2d151eaa"],
Cell[372947, 9940, 171, 3, 54, "Subsection",ExpressionUUID->"ca4f5e8f-fac5-4875-b17f-c74641b1a059"],
Cell[373121, 9945, 171, 3, 38, "Subsection",ExpressionUUID->"1337e003-da0c-4438-b927-db1f89a35e6e"],
Cell[373295, 9950, 169, 3, 38, "Subsection",ExpressionUUID->"c2aabf2e-18de-410c-bf73-edf731e54246"]
}, Open  ]],
Cell[373479, 9956, 171, 3, 67, "Section",ExpressionUUID->"83d28a76-8ba9-404a-8409-73553fce9829"]
}, Open  ]],
Cell[CellGroupData[{
Cell[373687, 9964, 159, 3, 69, "Chapter",ExpressionUUID->"148ad691-ad4e-4227-940e-818ed80a578e"],
Cell[373849, 9969, 167, 3, 67, "Section",ExpressionUUID->"2087b5d1-55dc-4955-98ab-88147b13f5e0"],
Cell[374019, 9974, 170, 3, 53, "Section",ExpressionUUID->"85d95c76-f7e7-4ce2-927f-589bd57e4060"],
Cell[374192, 9979, 164, 3, 53, "Section",ExpressionUUID->"ef9ef5e3-105b-4fac-a032-2723e0e0dd40"],
Cell[374359, 9984, 166, 3, 53, "Section",ExpressionUUID->"aae7fe72-18e1-4b19-a79a-3f47bd6e2729"],
Cell[374528, 9989, 166, 3, 53, "Section",ExpressionUUID->"ad187a94-ca3c-4848-81ba-d685ef803382"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374731, 9997, 299, 4, 69, "Chapter",ExpressionUUID->"bfb9b062-8e7f-474d-9a3e-f090977b71f8"],
Cell[375033, 10003, 256, 6, 35, "Text",ExpressionUUID->"ea369acf-82a9-4b0d-b4cd-a31d01a8ea97"],
Cell[375292, 10011, 353, 9, 127, "Text",ExpressionUUID->"60ac0a12-87ea-4d49-8bd2-f805624375d7"],
Cell[375648, 10022, 223, 5, 35, "Text",ExpressionUUID->"9ad76526-a0df-448a-8107-6168e139280e"],
Cell[375874, 10029, 173, 3, 35, "Text",ExpressionUUID->"b91f156a-0855-4585-aabe-dfec68fee7d4"],
Cell[376050, 10034, 1209, 28, 37, "Text",ExpressionUUID->"1b6cc447-ff85-44df-95e5-2c9858758039"],
Cell[377262, 10064, 225, 4, 38, "CodeText",ExpressionUUID->"2122918f-053f-41c5-b9aa-7d358904a527"],
Cell[377490, 10070, 691, 19, 30, "Input",ExpressionUUID->"0db305c1-87d4-4346-b252-4bfc68f86099"],
Cell[378184, 10091, 1074, 25, 37, "Text",ExpressionUUID->"b13fc895-8ec1-4c64-bdd4-a32d79dcc75f"],
Cell[379261, 10118, 2289, 47, 52, "Input",ExpressionUUID->"41e24900-daca-467b-8df5-129ff7e8f8c9"],
Cell[381553, 10167, 1158, 27, 40, "CodeText",ExpressionUUID->"a4331fea-17f0-46bf-9146-5e108afded4f"],
Cell[382714, 10196, 1175, 31, 52, "Input",ExpressionUUID->"b1eb6b40-deb6-490c-a940-4a7af05bfc5d"],
Cell[383892, 10229, 742, 20, 35, "Text",ExpressionUUID->"85a5e7a5-ab9b-4d3d-90e7-6c13896bf810"],
Cell[384637, 10251, 348, 9, 45, "Input",ExpressionUUID->"2df14f77-c2ab-4e39-bf17-207029ef6e88"],
Cell[384988, 10262, 256, 6, 45, "Input",ExpressionUUID->"5cabb66d-8bed-4d93-97ba-a711e7860052"],
Cell[385247, 10270, 339, 8, 45, "Input",ExpressionUUID->"e99accf7-a6a7-4cd1-ab3a-5d0441de7df1"],
Cell[385589, 10280, 1203, 32, 52, "Input",ExpressionUUID->"955ea8a3-4678-4ffb-a4c7-250be03970aa"],
Cell[386795, 10314, 178, 3, 67, "Section",ExpressionUUID->"9fe4567c-8618-4ac9-993a-b7f4644be2bd"],
Cell[386976, 10319, 173, 3, 53, "Section",ExpressionUUID->"1c840c80-fc0d-4fbd-b39a-2693692a24f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387186, 10327, 265, 4, 69, "Chapter",ExpressionUUID->"ed585af7-d24a-46ed-b5cb-28be44510216"],
Cell[CellGroupData[{
Cell[387476, 10335, 151, 3, 67, "Section",ExpressionUUID->"c893db9e-ace5-4847-846b-f0be2f7c79fc"],
Cell[387630, 10340, 217, 4, 35, "Text",ExpressionUUID->"eca34a14-f483-4b86-bff7-ffc82427cff6"],
Cell[387850, 10346, 166, 3, 35, "Text",ExpressionUUID->"65ef230f-192f-4cbd-bed4-3db049253918"],
Cell[388019, 10351, 161, 3, 35, "Text",ExpressionUUID->"ffcc8dd8-7079-4f0e-a0d1-ccb293800406"],
Cell[388183, 10356, 161, 3, 35, "Text",ExpressionUUID->"f30b64b2-1304-4a63-b138-56306f03a7e8"],
Cell[388347, 10361, 158, 3, 35, "Text",ExpressionUUID->"1e86bb0c-92e9-4d15-b5ed-161173f95b92"],
Cell[388508, 10366, 289, 7, 35, "Text",ExpressionUUID->"b4921fdf-3546-4d1a-a371-60e6a9c3afe9"],
Cell[388800, 10375, 883, 23, 37, "Text",ExpressionUUID->"8bfb231e-5032-4879-b6b3-e4bf0d465ac9"],
Cell[389686, 10400, 617, 17, 30, "Input",ExpressionUUID->"3ee140f9-a5ad-48f5-81e7-62b57a39907f"],
Cell[390306, 10419, 454, 9, 35, "Text",ExpressionUUID->"14d79dfa-b344-4a70-a42e-96675a089979"],
Cell[390763, 10430, 378, 10, 45, "Input",ExpressionUUID->"29791eac-5bfc-4a5c-b2a6-51098f057a1a"],
Cell[391144, 10442, 1420, 30, 52, "Input",ExpressionUUID->"a0019b6f-38a6-41a6-9ba5-a5ebc09f67f7"],
Cell[392567, 10474, 687, 19, 30, "Input",ExpressionUUID->"24132647-fc6f-4269-9222-5d290e895c45"],
Cell[393257, 10495, 561, 16, 30, "Input",ExpressionUUID->"d818f23a-8c9c-4d7b-ba8d-c682bd2933df"],
Cell[393821, 10513, 596, 16, 33, "Input",ExpressionUUID->"aa241efa-3646-4f13-a24e-9296c2b5dc58"],
Cell[394420, 10531, 291, 7, 35, "Text",ExpressionUUID->"667cb235-7b91-41e8-94c3-0a529dec641d"],
Cell[394714, 10540, 1121, 30, 33, "Input",ExpressionUUID->"9f6a7f8d-5a55-4271-9f38-4178ffdc8636"],
Cell[395838, 10572, 1418, 37, 71, "Input",ExpressionUUID->"90aa3ec5-0e60-4018-858b-01b93e368776"],
Cell[397259, 10611, 156, 3, 35, "Text",ExpressionUUID->"4aa9268b-45e4-4705-9883-4b491ec77ccb"],
Cell[397418, 10616, 3532, 91, 204, "Input",ExpressionUUID->"fc4f1e9d-1f33-4f13-9b61-1c5e08c187e0"],
Cell[400953, 10709, 2873, 66, 197, "Input",ExpressionUUID->"e71e3989-6061-4072-aa03-ba5f17bafd4f"],
Cell[403829, 10777, 3880, 95, 230, "Input",ExpressionUUID->"82302cdd-3853-441f-9673-de12a04a1dc3"],
Cell[407712, 10874, 4435, 104, 215, "Input",ExpressionUUID->"82c65323-f521-4c5d-80fc-c89b8249f148"],
Cell[412150, 10980, 668, 19, 42, "Input",ExpressionUUID->"55f2e889-affa-4462-bafe-4afa3f6e4e9b"],
Cell[412821, 11001, 5659, 137, 322, "Input",ExpressionUUID->"b1424151-5c67-45f4-a118-41fc0671454d"],
Cell[418483, 11140, 8862, 200, 361, "Input",ExpressionUUID->"24fec2e4-030a-4051-95d2-aedd96f52888",
 InitializationCell->True],
Cell[427348, 11342, 213, 5, 35, "Text",ExpressionUUID->"8695f589-c939-464c-b5be-be0546b7331c"],
Cell[427564, 11349, 11223, 253, 384, "Input",ExpressionUUID->"18ee21dd-3681-4a87-a01f-c293509f2837",
 InitializationCell->True],
Cell[438790, 11604, 920, 24, 42, "Input",ExpressionUUID->"3710ac39-5344-4301-b5b0-eba0a431669f"],
Cell[439713, 11630, 11788, 264, 470, "Input",ExpressionUUID->"671c40fb-6918-4698-a712-97fcf294d4a7",
 InitializationCell->True],
Cell[451504, 11896, 523, 15, 42, "Input",ExpressionUUID->"a52e76f0-5eb6-4aaf-be15-fec38b521d42"],
Cell[452030, 11913, 616, 14, 30, "Input",ExpressionUUID->"80fb3b09-6c17-48e5-8aea-dc2620edb09e"],
Cell[452649, 11929, 324, 8, 30, "Input",ExpressionUUID->"b46c1cc7-3aa4-417b-8ea6-0f76296de7bf"],
Cell[452976, 11939, 838, 23, 49, "Input",ExpressionUUID->"4c3685af-41e6-4f2a-987b-3a4c7ee97f81"],
Cell[453817, 11964, 851, 25, 42, "Input",ExpressionUUID->"42cd4210-2a83-4db5-a7f3-8c134db21edc"],
Cell[454671, 11991, 691, 21, 49, "Input",ExpressionUUID->"ecaa5850-123c-4c6f-93df-f5c7adf6d2b0"],
Cell[455365, 12014, 751, 23, 42, "Input",ExpressionUUID->"c8034352-e1b4-47ad-8fba-12bde3931110"],
Cell[456119, 12039, 1914, 51, 37, "Text",ExpressionUUID->"eebafccd-b638-4a0c-9eed-fcd341b6859d"],
Cell[458036, 12092, 1105, 28, 51, "Input",ExpressionUUID->"5f7c0fe8-5ddf-4e9a-919c-27242611a2eb"],
Cell[459144, 12122, 770, 23, 39, "Input",ExpressionUUID->"24fafb97-8fa4-455f-aab8-0e56b7a83c8c"],
Cell[459917, 12147, 898, 28, 39, "Input",ExpressionUUID->"917bdd33-4d57-46a0-83bc-4c63d6a9d042"]
}, Open  ]],
Cell[CellGroupData[{
Cell[460852, 12180, 162, 3, 67, "Section",ExpressionUUID->"2174ba11-5736-4c8d-825e-aebbd6fbad3d"],
Cell[CellGroupData[{
Cell[461039, 12187, 164, 3, 54, "Subsection",ExpressionUUID->"60cd369f-7056-4146-a166-ad91af41faf7"],
Cell[461206, 12192, 546, 15, 33, "Input",ExpressionUUID->"0c8a054b-1bbd-49fb-875b-6555c1e4ff9e"],
Cell[461755, 12209, 1327, 35, 41, "CodeText",ExpressionUUID->"7b78b48e-edc0-43ff-9bce-38adce7142c6"],
Cell[463085, 12246, 229, 6, 35, "Text",ExpressionUUID->"7afbc957-edd8-410b-8869-0c7d88822a2c"],
Cell[463317, 12254, 727, 22, 49, "Input",ExpressionUUID->"d2208594-bce9-4b44-bd3f-d9dd615ac0d6"],
Cell[464047, 12278, 913, 26, 33, "Input",ExpressionUUID->"4c9e3bec-4b1d-41fc-a511-e93ae233c0ae"],
Cell[464963, 12306, 629, 16, 33, "Input",ExpressionUUID->"a7a1f9be-dccb-469b-8e68-88c791c95103"]
}, Open  ]],
Cell[CellGroupData[{
Cell[465629, 12327, 165, 3, 54, "Subsection",ExpressionUUID->"e9ddffee-60ff-42b7-9936-62d570b0e4d3"],
Cell[465797, 12332, 547, 15, 33, "Input",ExpressionUUID->"51980c75-62c9-4245-9462-aac81bb03c24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[466381, 12352, 173, 3, 54, "Subsection",ExpressionUUID->"4c43ea67-37ca-4b2f-95a5-ce632413dc8c"],
Cell[466557, 12357, 644, 17, 33, "Input",ExpressionUUID->"60792607-3341-4632-9c1e-a9fb03ed5b73"],
Cell[467204, 12376, 591, 15, 33, "Input",ExpressionUUID->"2a8edf1f-de1a-4829-ba0a-2c1988d8e5fe"],
Cell[467798, 12393, 596, 17, 33, "Input",ExpressionUUID->"1a354918-3c8c-451d-ba71-d0f7a60b553e"],
Cell[468397, 12412, 756, 22, 49, "Input",ExpressionUUID->"ae7c4ddd-7029-4f5f-9750-6ca46c95b6aa"],
Cell[469156, 12436, 945, 27, 47, "Input",ExpressionUUID->"f7d91598-0bef-46b6-b368-f07f037abd5d"],
Cell[470104, 12465, 1456, 37, 40, "CodeText",ExpressionUUID->"f83e198c-0a37-4636-9e3a-d75fca8f8cf9"],
Cell[471563, 12504, 865, 22, 35, "Text",ExpressionUUID->"cfa7270b-ecfd-4499-98b9-48d552418916"]
}, Open  ]]
}, Open  ]],
Cell[472455, 12530, 158, 3, 67, "Section",ExpressionUUID->"d13f76c2-7710-48e8-ab45-54342fea2577"],
Cell[472616, 12535, 208, 4, 53, "Section",ExpressionUUID->"63a72acd-3527-4e70-a911-097489c7c25e"],
Cell[472827, 12541, 159, 3, 53, "Section",ExpressionUUID->"edff5ce3-85ec-4991-89be-6cec0d1d8205"]
}, Open  ]],
Cell[CellGroupData[{
Cell[473023, 12549, 302, 5, 69, "Chapter",ExpressionUUID->"6990d69a-76dc-43d5-86f4-0eea3d011d19"],
Cell[CellGroupData[{
Cell[473350, 12558, 202, 4, 67, "Section",ExpressionUUID->"c2fa178f-e077-4e87-a4a2-7f90fcda3008"],
Cell[473555, 12564, 5875, 120, 246, "Input",ExpressionUUID->"9dca5189-70e1-45d7-b3c7-58e7e8a9f76c",
 InitializationCell->True],
Cell[479433, 12686, 577, 14, 33, "Input",ExpressionUUID->"b6b0281d-fa64-4ea8-9307-6514b391e789"],
Cell[480013, 12702, 516, 14, 33, "Input",ExpressionUUID->"8222470f-d56b-4fc2-9694-5a8c3c496860"],
Cell[480532, 12718, 301, 7, 35, "Text",ExpressionUUID->"255db834-596c-48cf-9354-3126b4bd6489"],
Cell[480836, 12727, 267, 6, 38, "CodeText",ExpressionUUID->"ded50ed5-eb17-49c3-819f-39fe39c540f3"],
Cell[481106, 12735, 246, 6, 30, "Input",ExpressionUUID->"5a8d2f04-ac64-4d8d-a6c2-14b4ad6d56b8"],
Cell[481355, 12743, 10823, 241, 590, "Input",ExpressionUUID->"fb83c383-68cb-4c41-8573-939d5208781c",
 InitializationCell->True],
Cell[492181, 12986, 334, 8, 33, "Input",ExpressionUUID->"1d360e7b-c4a9-4567-b357-b4dc7af328bb"],
Cell[492518, 12996, 1204, 31, 40, "CodeText",ExpressionUUID->"1954f84a-e069-41da-95e3-4215d48e2da2"],
Cell[CellGroupData[{
Cell[493747, 13031, 448, 12, 54, "Subsection",ExpressionUUID->"17c2fdb0-4dda-4b84-bc68-305cc1910e98"],
Cell[494198, 13045, 425, 11, 33, "Input",ExpressionUUID->"ab80bf4b-8dc6-4473-8549-c151b9b34c60"],
Cell[494626, 13058, 14690, 318, 923, "Input",ExpressionUUID->"2b90a622-b1d6-4c7b-8b8c-e6e7d2c235d5",
 InitializationCell->True],
Cell[509319, 13378, 244, 6, 38, "CodeText",ExpressionUUID->"fdc941bc-697f-4e25-b522-ba00dde4d899"],
Cell[509566, 13386, 494, 10, 33, "Input",ExpressionUUID->"a2f8cfd1-9b24-43a7-b502-ea77c35016f1"],
Cell[510063, 13398, 324, 9, 51, "Input",ExpressionUUID->"6293c1d5-a360-4e9f-8a19-243e0d96e453"],
Cell[510390, 13409, 487, 12, 73, "Input",ExpressionUUID->"47145463-bc1d-4810-ba4f-6fcb6dc4ebab"],
Cell[510880, 13423, 294, 7, 30, "Input",ExpressionUUID->"f0280a9c-28f0-4419-9a71-0c9fa64a5628"],
Cell[511177, 13432, 445, 12, 47, "Input",ExpressionUUID->"8bb0db05-824e-440d-a724-31556e32a00a"],
Cell[511625, 13446, 484, 13, 66, "Input",ExpressionUUID->"e8547e0a-9448-4256-85f4-4a0cf9c66637"],
Cell[512112, 13461, 256, 6, 30, "Input",ExpressionUUID->"a4b30d93-9bb7-4b9a-8435-73a6bd64448b"],
Cell[512371, 13469, 676, 20, 91, "Input",ExpressionUUID->"d3a058bf-bf5e-403c-8b72-5be041b8e68f"],
Cell[513050, 13491, 11047, 242, 449, "Input",ExpressionUUID->"c58d4336-7f26-404a-acbe-d37b1c9b7e49"],
Cell[524100, 13735, 393, 9, 33, "Input",ExpressionUUID->"0b952724-6854-4596-afa7-11c91917cbb8"],
Cell[524496, 13746, 416, 8, 30, "Input",ExpressionUUID->"6e52da4a-fbaa-4fd9-b28e-5407618f6bfb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[524961, 13760, 187, 3, 67, "Section",ExpressionUUID->"77cd265a-f704-4004-9a4e-f140889aadf0"],
Cell[525151, 13765, 8823, 212, 422, "Input",ExpressionUUID->"0e20dde1-d087-4ef3-ae7c-dfdddf76ad7b",
 InitializationCell->True],
Cell[533977, 13979, 894, 21, 33, "Input",ExpressionUUID->"83dcd3e1-7448-401c-a4ef-3db7168fe92a"],
Cell[534874, 14002, 1548, 41, 40, "CodeText",ExpressionUUID->"e93c60c1-6bf7-41ad-8f78-fad24f4124ee"],
Cell[536425, 14045, 5737, 146, 84, "CodeText",ExpressionUUID->"1d17c4a0-545b-4bdd-bfbd-0dd0877b3cf2"],
Cell[542165, 14193, 172, 3, 38, "CodeText",ExpressionUUID->"d44c187f-03d7-4c1a-9e7d-5e205610f136"],
Cell[542340, 14198, 252, 5, 30, "Input",ExpressionUUID->"bbbbe71b-1683-4531-84d9-5ac548cb3c9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[542629, 14208, 171, 3, 67, "Section",ExpressionUUID->"27b39845-ce47-4242-b611-780ac4cc13a3"],
Cell[542803, 14213, 2604, 61, 51, "Text",ExpressionUUID->"21197ed5-05cd-43fd-9e77-197c4f841fde"],
Cell[545410, 14276, 425, 11, 33, "Input",ExpressionUUID->"017b528f-c9c8-46ff-a493-ede274ea75ee"],
Cell[545838, 14289, 520, 14, 37, "Text",ExpressionUUID->"96483756-ebf5-4620-8016-968606a3ef52"],
Cell[546361, 14305, 401, 11, 34, "Input",ExpressionUUID->"b23e12ed-27ca-48bc-9045-3236b132208b"],
Cell[546765, 14318, 464, 13, 34, "Input",ExpressionUUID->"74ed32e4-0120-4f3f-a55b-335f989c1041"],
Cell[547232, 14333, 256, 6, 30, "Input",ExpressionUUID->"d2082663-3545-4e0a-bc92-97bc87fc9363"],
Cell[547491, 14341, 846, 21, 45, "Input",ExpressionUUID->"fccfbbe9-84b8-4ceb-ac4c-7345ad5097cc"],
Cell[548340, 14364, 726, 15, 30, "Input",ExpressionUUID->"5f997041-e5d2-4b9a-9dff-de39d6b9ec5b"],
Cell[549069, 14381, 834, 24, 38, "Input",ExpressionUUID->"bcabd281-95e8-4029-90a3-75b4e06e908e"],
Cell[549906, 14407, 549, 13, 30, "Input",ExpressionUUID->"396bfa97-b015-4e70-9fb3-5e7c62e44bb3"],
Cell[550458, 14422, 4665, 116, 62, "Text",ExpressionUUID->"21982b26-3d5f-4323-903a-684e72affeac"],
Cell[555126, 14540, 516, 14, 33, "Input",ExpressionUUID->"4df8a99b-78c6-45ca-b8dc-28182d74309f"],
Cell[CellGroupData[{
Cell[555667, 14558, 165, 3, 54, "Subsection",ExpressionUUID->"96989b5e-eec7-499b-8bdf-2b4ed373e627"],
Cell[555835, 14563, 419, 10, 36, "Input",ExpressionUUID->"fa3284e6-ef7d-4488-b498-0e864879bf42"],
Cell[556257, 14575, 188, 3, 35, "Text",ExpressionUUID->"c1dbfb87-86bc-4d0a-8197-0c2335f64ec9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[556494, 14584, 161, 3, 67, "Section",ExpressionUUID->"a59aef5b-81dd-452c-9704-590ec8788f64"],
Cell[556658, 14589, 6651, 135, 225, "Input",ExpressionUUID->"6f1fe269-f564-4178-abf9-62728dfc8e08",
 InitializationCell->True],
Cell[563312, 14726, 1096, 26, 33, "Input",ExpressionUUID->"f08e21c3-1fee-40e6-b378-46204396c0c9"],
Cell[564411, 14754, 241, 6, 35, "Text",ExpressionUUID->"bda7bb10-a771-4cab-acd3-e8856cf04409"],
Cell[564655, 14762, 1006, 29, 30, "Input",ExpressionUUID->"1f17965b-99d0-42ad-9a19-b2cb38a0d00f"],
Cell[565664, 14793, 6489, 127, 225, "Input",ExpressionUUID->"3c70b93c-41bd-47e0-a25d-9b7141c376d0",
 InitializationCell->True],
Cell[572156, 14922, 782, 22, 33, "Input",ExpressionUUID->"d0633dd2-6d61-4c89-bc87-d98ae09893a4"],
Cell[572941, 14946, 283, 6, 35, "Text",ExpressionUUID->"aa511293-cdd4-42df-a180-bf2cf7339099"],
Cell[573227, 14954, 186, 3, 35, "Text",ExpressionUUID->"524e4f9c-5bf9-4c41-99fd-9f1e539d76e2"]
}, Open  ]],
Cell[573428, 14960, 173, 3, 67, "Section",ExpressionUUID->"ed598491-5879-4b9a-be20-64226307aed7"],
Cell[CellGroupData[{
Cell[573626, 14967, 161, 3, 53, "Section",ExpressionUUID->"faabe718-695e-4995-9967-d4826da2df90"],
Cell[573790, 14972, 3517, 94, 60, "Text",ExpressionUUID->"9c4e8bd7-fd97-416d-9a30-ad7354161c13"],
Cell[577310, 15068, 6189, 146, 296, "Input",ExpressionUUID->"0344d950-c4f3-4f0f-a43f-5a0a93b50faf"],
Cell[583502, 15216, 9546, 224, 411, "Input",ExpressionUUID->"aef9077d-4bd5-4538-b93f-255b211431d6"],
Cell[593051, 15442, 12401, 284, 502, "Input",ExpressionUUID->"eb7a2874-fee2-44a6-ac78-a9fb33f14143"],
Cell[605455, 15728, 411, 11, 33, "Input",ExpressionUUID->"3a846940-33e3-492a-b425-961f3c29e82d"],
Cell[605869, 15741, 19373, 437, 655, "Input",ExpressionUUID->"e22d4c78-8143-4747-8178-3973a101b647"],
Cell[625245, 16180, 686, 19, 33, "Input",ExpressionUUID->"7cb2b3a0-4aee-4672-9d83-918fe4c95fd7"],
Cell[625934, 16201, 14233, 323, 504, "Input",ExpressionUUID->"c8e0f0bb-7b4a-4036-b015-c745cb9d2bf5"],
Cell[640170, 16526, 420, 11, 33, "Input",ExpressionUUID->"6aa5914b-5e19-4f44-8179-4159e283082f"],
Cell[640593, 16539, 401, 11, 33, "Input",ExpressionUUID->"64a9ce1f-d6de-4793-9236-0fed248c2f1d"],
Cell[640997, 16552, 1279, 31, 40, "CodeText",ExpressionUUID->"c5f711dd-09c7-4445-b9a5-1aa5c44915bc"],
Cell[CellGroupData[{
Cell[642301, 16587, 188, 3, 54, "Subsection",ExpressionUUID->"dafb0fd1-087b-4edb-b43d-11c87de1a720"],
Cell[642492, 16592, 1019, 27, 54, "Input",ExpressionUUID->"7774f6ee-488a-4fe3-9cad-4e8976ecad29"],
Cell[643514, 16621, 253, 5, 38, "CodeText",ExpressionUUID->"7b7478cf-f72b-451e-8772-d99c1d783cf4"],
Cell[643770, 16628, 491, 15, 72, "Input",ExpressionUUID->"a010a86b-634a-4385-a79c-2413fce03806"],
Cell[644264, 16645, 929, 23, 56, "CodeText",ExpressionUUID->"a447e2a5-15ca-4728-8512-30b25470c2db"],
Cell[645196, 16670, 821, 24, 54, "Input",ExpressionUUID->"d637f60a-9e0d-44be-b098-b08bfd431baf"],
Cell[646020, 16696, 340, 9, 61, "Input",ExpressionUUID->"d2ce5a5a-9a54-4c84-b707-404d25128081"],
Cell[646363, 16707, 746, 20, 58, "CodeText",ExpressionUUID->"c3444bc6-d60b-4e2e-a45f-931c8492de38"],
Cell[647112, 16729, 752, 21, 37, "Text",ExpressionUUID->"335c961c-c18b-4bfd-a676-ba6c3146061b"],
Cell[647867, 16752, 588, 18, 50, "Input",ExpressionUUID->"d1f71d86-d9ee-49a2-b830-81db0ec09ec4"],
Cell[648458, 16772, 524, 14, 40, "CodeText",ExpressionUUID->"30733fbc-f587-4811-b57f-0a6bf1130eb2"],
Cell[648985, 16788, 1154, 30, 53, "Text",ExpressionUUID->"65f84878-3d25-4f46-8ae1-2db01161ad25"],
Cell[650142, 16820, 2267, 58, 40, "CodeText",ExpressionUUID->"67098634-eb08-4a5e-8a41-d359be0543dc"],
Cell[652412, 16880, 262, 6, 35, "Text",ExpressionUUID->"bf0bb14b-6259-4de8-90ed-8c9defed1b27"],
Cell[652677, 16888, 560, 14, 40, "CodeText",ExpressionUUID->"e5d4b6cc-a782-471a-9113-ab4c91e7873a"],
Cell[653240, 16904, 2276, 59, 56, "Input",ExpressionUUID->"bee11894-f0b3-4148-a8b0-7534223e26ea"],
Cell[655519, 16965, 491, 13, 40, "CodeText",ExpressionUUID->"7a1bca19-950c-41e0-b22f-e8881b299fe5"],
Cell[656013, 16980, 2380, 62, 56, "Input",ExpressionUUID->"23692782-825a-4995-8445-973e30c72e10"],
Cell[658396, 17044, 241, 6, 38, "CodeText",ExpressionUUID->"17fba043-08a7-47fe-af69-daa6665f215a"],
Cell[658640, 17052, 4121, 107, 80, "Text",ExpressionUUID->"fe4d7b46-5fdd-45d8-bdbd-544b2f740b1b"],
Cell[662764, 17161, 3381, 92, 60, "CodeText",ExpressionUUID->"d7cb567c-9bd7-4b30-894d-8717f2231958"],
Cell[666148, 17255, 596, 15, 33, "Input",ExpressionUUID->"8394f1a7-de54-491b-b638-64d186bc3118"],
Cell[666747, 17272, 1829, 45, 40, "CodeText",ExpressionUUID->"4e73683d-fff5-47df-b56d-249407b37f78"],
Cell[668579, 17319, 2484, 67, 37, "Text",ExpressionUUID->"fb69da03-94a1-47db-9f4d-8f5b91ca1421"],
Cell[671066, 17388, 2228, 57, 53, "Input",ExpressionUUID->"e3638b06-746e-4509-9edc-bec69a4201df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[673331, 17450, 303, 5, 54, "Subsection",ExpressionUUID->"74e2cb0b-5693-4dff-8671-e6ecdd834c9d"],
Cell[673637, 17457, 3440, 86, 62, "Text",ExpressionUUID->"0371752e-2ac2-4420-9a74-6766329db264"],
Cell[677080, 17545, 552, 13, 37, "Text",ExpressionUUID->"33ef20bb-06d8-45ab-bfc9-39b9f93fff2e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[677681, 17564, 164, 3, 67, "Section",ExpressionUUID->"b6d96baf-ec48-407c-a346-e9c4521f7e04"],
Cell[CellGroupData[{
Cell[677870, 17571, 168, 3, 54, "Subsection",ExpressionUUID->"17de8d12-7fe3-4c8c-bd74-63699db9e590"],
Cell[678041, 17576, 945, 23, 35, "Text",ExpressionUUID->"09536589-304c-4430-bad8-a38c16fcda16"],
Cell[678989, 17601, 847, 20, 41, "CodeText",ExpressionUUID->"de45155a-d56d-4842-a95c-07bbd28980c3"],
Cell[679839, 17623, 401, 11, 30, "Input",ExpressionUUID->"07e26111-b801-4764-9629-7b0337212e8c"],
Cell[680243, 17636, 1050, 30, 44, "Input",ExpressionUUID->"464f63aa-ed71-4be1-904c-3caf523b308d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[681330, 17671, 165, 3, 54, "Subsection",ExpressionUUID->"c4f77870-1c55-411f-84dd-ab1077ee7df0"],
Cell[681498, 17676, 694, 18, 32, "Input",ExpressionUUID->"5d9f796e-18e5-4d98-81b5-3adbdcc5a3ec"],
Cell[682195, 17696, 3879, 104, 66, "Text",ExpressionUUID->"c529ae3f-f5f2-4750-a53e-6ae3b007e7c1"],
Cell[686077, 17802, 633, 18, 111, "Input",ExpressionUUID->"45d085ca-e0eb-4090-a8f2-6ae83c27788a"],
Cell[686713, 17822, 254, 5, 30, "Input",ExpressionUUID->"7c4690ef-6dca-4da9-afcb-5f0be0757e6e"],
Cell[686970, 17829, 2271, 62, 85, "Input",ExpressionUUID->"8c4bfa52-6704-4108-a04f-267de78445a0"],
Cell[689244, 17893, 2197, 61, 85, "Input",ExpressionUUID->"70f9276b-0e8c-44c3-b0b2-36dddd27f064"],
Cell[691444, 17956, 548, 15, 37, "Text",ExpressionUUID->"ffc10a49-1d66-4162-a9fc-19be212099b0"],
Cell[691995, 17973, 2459, 71, 193, "Input",ExpressionUUID->"87a1dd5a-4390-4888-af5d-43f189d68b43"],
Cell[694457, 18046, 548, 15, 37, "Text",ExpressionUUID->"049e7f9e-8f4f-4447-a99c-c36b5e48fe25"],
Cell[695008, 18063, 2484, 71, 193, "Input",ExpressionUUID->"92ec8fb2-33a0-4a65-a969-ca9cbe510ab0"],
Cell[697495, 18136, 248, 4, 35, "Text",ExpressionUUID->"215a2424-9dc5-44d8-9923-def6f976f59a"],
Cell[697746, 18142, 2824, 82, 193, "Input",ExpressionUUID->"963f7a72-e385-49a0-b6fd-744ea9d66aca"],
Cell[700573, 18226, 262, 6, 35, "Text",ExpressionUUID->"0fcec33d-1f49-4402-899e-75e00b441b7c"],
Cell[700838, 18234, 198, 3, 38, "CodeText",ExpressionUUID->"842e8cb9-b2c8-4b24-b278-66173504ee9e"],
Cell[701039, 18239, 2960, 83, 193, "Input",ExpressionUUID->"74f17454-1d86-4059-9efe-6ff55530354d"],
Cell[704002, 18324, 190, 3, 35, "Text",ExpressionUUID->"482564d9-6c29-46a7-868c-f4241b7c07f5"],
Cell[704195, 18329, 3019, 83, 193, "Input",ExpressionUUID->"a1779761-1123-4eea-8d91-41bd95ac8f42"],
Cell[707217, 18414, 155, 3, 35, "Text",ExpressionUUID->"c80e3c97-9b45-4133-b34a-626a1afe4678"],
Cell[707375, 18419, 815, 24, 55, "Input",ExpressionUUID->"b88d5621-a0d6-4210-9ad7-d59b77cc4d9d"],
Cell[708193, 18445, 796, 24, 55, "Input",ExpressionUUID->"fbe3dbac-6d22-41c8-9e39-b1953d62a0f7"],
Cell[708992, 18471, 254, 6, 35, "Text",ExpressionUUID->"1f091a5a-235b-466a-adb2-eb661b4eb59a"],
Cell[709249, 18479, 4039, 113, 193, "Input",ExpressionUUID->"67efe89a-75fe-4d7a-aa84-7022b0e12f9e"],
Cell[713291, 18594, 17619, 373, 567, "Input",ExpressionUUID->"b57b87ab-d8fe-480f-a182-73cc207a1388"],
Cell[730913, 18969, 579, 13, 35, "Text",ExpressionUUID->"06403ebb-0a53-49ab-a7f9-45d6f48dd07e"],
Cell[731495, 18984, 235, 6, 35, "Text",ExpressionUUID->"2f063f38-ccba-4c25-b859-5c284ae3c44c"],
Cell[731733, 18992, 253, 6, 35, "Text",ExpressionUUID->"78f04592-4ac9-4db3-918f-88bd4399cca7"],
Cell[731989, 19000, 21428, 438, 608, "Input",ExpressionUUID->"12b48e79-857f-4f68-b141-e9bfb3014694"],
Cell[753420, 19440, 171, 3, 35, "Text",ExpressionUUID->"f5d796f4-ce18-4c2a-ac85-a2fc86c095d8"],
Cell[753594, 19445, 26886, 565, 981, "Input",ExpressionUUID->"bb6fb431-c8a8-4952-b4c9-e96e718d5224"],
Cell[780483, 20012, 280, 6, 35, "Text",ExpressionUUID->"83a07e76-1977-46ce-9745-8ac369fc00d5"],
Cell[780766, 20020, 26460, 554, 917, "Input",ExpressionUUID->"88f822f1-04bb-4100-9378-0b56aeec1fbc"],
Cell[807229, 20576, 273, 7, 30, "Input",ExpressionUUID->"87734257-7241-4c4d-837d-0711bdd74f92"],
Cell[807505, 20585, 842, 18, 52, "Input",ExpressionUUID->"ce8de382-57b3-4383-a82e-e7f1354d63e1"],
Cell[808350, 20605, 1023, 29, 44, "Input",ExpressionUUID->"b1b3df52-bdf1-4a94-9f5b-c98c15c55e45"],
Cell[809376, 20636, 252, 6, 30, "Input",ExpressionUUID->"de5b5dc0-9227-4001-91d3-b8285128df4b"],
Cell[809631, 20644, 1240, 34, 42, "Input",ExpressionUUID->"2f20c13f-d5e2-44b4-8fd1-0f66f0de2408"],
Cell[810874, 20680, 28585, 578, 892, "Input",ExpressionUUID->"c88f1fc4-ea51-4af4-a051-4891c346787d"],
Cell[839462, 21260, 418, 9, 30, "Input",ExpressionUUID->"4489477e-051c-421b-8455-02221b3b628d"],
Cell[839883, 21271, 225, 5, 35, "Text",ExpressionUUID->"9276aefe-2676-45e1-a655-78f1a5214771"],
Cell[840111, 21278, 34256, 700, 1118, "Input",ExpressionUUID->"201eded0-5e7d-482b-8b3a-6853028e0ac5"],
Cell[874370, 21980, 267, 6, 35, "Text",ExpressionUUID->"d9a2a991-6cc4-4ef6-b179-0eb6f09e7893"],
Cell[874640, 21988, 34448, 702, 1118, "Input",ExpressionUUID->"0178672e-8d9d-482a-bfd1-31d114a80224"],
Cell[909091, 22692, 351, 7, 35, "Text",ExpressionUUID->"9a730a6e-0b20-4c12-adc9-f7bc40728843"],
Cell[909445, 22701, 253, 6, 35, "Text",ExpressionUUID->"2f522c20-001e-429a-86ef-99d62277b3b1"],
Cell[909701, 22709, 991, 26, 33, "Input",ExpressionUUID->"91f4a374-f5ed-4e36-b862-61266004f2bb"],
Cell[910695, 22737, 411, 11, 42, "Input",ExpressionUUID->"f1f592c9-8197-498c-a484-0be8588cfa21"],
Cell[911109, 22750, 25923, 518, 777, "Input",ExpressionUUID->"84bce7bc-596d-410f-bb07-34529d2e8329"],
Cell[937035, 23270, 296, 6, 38, "CodeText",ExpressionUUID->"4bba1490-8b8c-4e25-8df5-40817f3d3adf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[937392, 23283, 168, 3, 69, "Chapter",ExpressionUUID->"17cd6b31-529b-4e46-afe3-864d14bffa13"],
Cell[937563, 23288, 14926, 337, 525, "Input",ExpressionUUID->"72d9c05d-ebca-4057-89e9-8ef2f0cdf550"],
Cell[952492, 23627, 473, 12, 33, "Input",ExpressionUUID->"48f6e18d-e478-4965-95e4-83b5e2a4bf8e"],
Cell[952968, 23641, 145, 3, 30, "Input",ExpressionUUID->"42400f9d-d253-44a8-b861-64d18606e21d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[953150, 23649, 155, 3, 69, "Chapter",ExpressionUUID->"762a3d81-a99c-4cc8-b4ba-90ae4c89172d"],
Cell[953308, 23654, 1107, 33, 40, "Input",ExpressionUUID->"439ef576-4717-4014-8f62-1a409eeb7ebf"],
Cell[954418, 23689, 672, 20, 30, "Input",ExpressionUUID->"d8e24026-19c6-4c13-889c-8e203bb3fe3f"],
Cell[CellGroupData[{
Cell[955115, 23713, 181, 3, 67, "Section",ExpressionUUID->"23de55ed-303c-4c9c-9684-646bfe72b59c"],
Cell[955299, 23718, 6241, 176, 574, "Input",ExpressionUUID->"06125814-b420-44d5-8b1f-6c91c5903c8d"],
Cell[961543, 23896, 4347, 119, 417, "Input",ExpressionUUID->"db9b4ee5-f499-47b0-8fe6-ab9d6298ae43"],
Cell[965893, 24017, 861, 23, 40, "CodeText",ExpressionUUID->"369886d2-717c-472a-b8ff-8d62a2b15f89"],
Cell[966757, 24042, 9076, 194, 504, "Input",ExpressionUUID->"46bbb346-c3e1-42fb-a74e-7b55f65bb640",
 InitializationCell->True],
Cell[975836, 24238, 2081, 57, 47, "Input",ExpressionUUID->"a47c1ab7-26ed-4d98-88b4-bd1db3754bef"],
Cell[977920, 24297, 793, 21, 35, "Text",ExpressionUUID->"66d07462-196d-41ec-b584-1acf01ae5271"],
Cell[978716, 24320, 272, 7, 30, "Input",ExpressionUUID->"0a6b272a-be2e-4802-8930-bc41561d7845"],
Cell[978991, 24329, 9221, 196, 504, "Input",ExpressionUUID->"2b22826c-4d20-4d78-93d7-441136b8f4d2",
 InitializationCell->True],
Cell[988215, 24527, 1794, 54, 49, "Input",ExpressionUUID->"29ebdb76-3e27-4219-bfc6-289a5ea15f0f"],
Cell[990012, 24583, 9260, 196, 504, "Input",ExpressionUUID->"cfb7fa88-e1be-4a52-b5fb-922ddbba61e7",
 InitializationCell->True],
Cell[999275, 24781, 1701, 50, 47, "Input",ExpressionUUID->"576b1007-fd44-402c-84e0-9962d60d897f"],
Cell[1000979, 24833, 189, 3, 35, "Text",ExpressionUUID->"85489d8c-aa69-48fe-9d79-df340d3b3e38"],
Cell[1001171, 24838, 9100, 194, 504, "Input",ExpressionUUID->"60a72795-4dee-4551-9386-8155c3011a01",
 InitializationCell->True],
Cell[1010274, 25034, 1804, 54, 49, "Input",ExpressionUUID->"f53e3c78-919f-4ffb-a3bb-addc156f62cd"],
Cell[1012081, 25090, 11480, 245, 550, "Input",ExpressionUUID->"d0da2c1b-aed1-429d-83e2-5d92fe11c18e",
 InitializationCell->True],
Cell[1023564, 25337, 2952, 92, 108, "Input",ExpressionUUID->"4cab93a3-3ec9-453f-9959-4fc72c5ac677"],
Cell[1026519, 25431, 9647, 201, 622, "Input",ExpressionUUID->"d9591389-1d12-49bc-a839-70c65e549a65",
 InitializationCell->True],
Cell[1036169, 25634, 1947, 51, 47, "Input",ExpressionUUID->"778d0055-30a5-4ab8-825a-fbc07657f556"],
Cell[1038119, 25687, 9476, 197, 559, "Input",ExpressionUUID->"d6a6666c-da95-4352-aca0-ac14bd894356",
 InitializationCell->True],
Cell[1047598, 25886, 2128, 54, 47, "Input",ExpressionUUID->"245ac29a-df2b-491e-97dd-ee586e30aa64"],
Cell[1049729, 25942, 304, 8, 30, "Input",ExpressionUUID->"1f7ae2e3-347f-4727-86ee-0701190a0add"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1050070, 25955, 164, 3, 67, "Section",ExpressionUUID->"e67eb7dd-ae65-4bb1-b876-1df39825e5f4"],
Cell[1050237, 25960, 862, 22, 30, "Input",ExpressionUUID->"3f438794-98e3-43c7-908b-dc092a53a824"],
Cell[1051102, 25984, 207, 3, 30, "Input",ExpressionUUID->"2cbba988-1c33-4401-95e2-eb61c921c74d"],
Cell[1051312, 25989, 1898, 42, 34, "Input",ExpressionUUID->"74a97427-0519-4841-bef9-f193fb220e03"],
Cell[1053213, 26033, 306, 6, 30, "Input",ExpressionUUID->"66b78776-afe9-4ab8-900b-ffe0b5f57012"],
Cell[1053522, 26041, 230, 4, 30, "Input",ExpressionUUID->"503d6cb6-5b30-43d1-b27d-5fb459369d34"],
Cell[1053755, 26047, 293, 6, 30, "Input",ExpressionUUID->"2ffc7464-c8d7-4276-85a2-5ab8799b6cd5"],
Cell[1054051, 26055, 1448, 40, 73, "Input",ExpressionUUID->"4274ea5c-e945-4e3c-9cc7-b9805a3d30f8"],
Cell[1055502, 26097, 10638, 212, 391, "Input",ExpressionUUID->"b19b9fc0-01c5-4903-b348-3ef8e20798cd",
 InitializationCell->True],
Cell[1066143, 26311, 1866, 46, 49, "Input",ExpressionUUID->"339fcf9f-bd1f-4142-8956-c82f2c2fc7c1"],
Cell[1068012, 26359, 268, 7, 30, "Input",ExpressionUUID->"6c5facf5-c025-44ad-a5b7-aa2c76cd455c"],
Cell[1068283, 26368, 1630, 45, 49, "Input",ExpressionUUID->"6df18d92-5093-40a2-9b9c-566eb7835225"],
Cell[1069916, 26415, 388, 9, 30, "Input",ExpressionUUID->"bf75bc66-55d3-4edb-ad43-3182123cb593"],
Cell[1070307, 26426, 9835, 194, 368, "Input",ExpressionUUID->"4291f7b3-d861-49ca-99f7-db484b873092",
 InitializationCell->True],
Cell[1080145, 26622, 1921, 47, 49, "Input",ExpressionUUID->"f6df2d76-521b-4a60-ab7c-da86f7f3503d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1082115, 26675, 313, 5, 69, "Chapter",ExpressionUUID->"cae580f9-b83b-42fd-97aa-8f87077d4528"],
Cell[CellGroupData[{
Cell[1082453, 26684, 218, 7, 67, "Section",ExpressionUUID->"8e977286-2063-44a0-91f5-de325184c477"],
Cell[1082674, 26693, 263, 5, 35, "Text",ExpressionUUID->"2e3a469a-6305-4e2b-8f5c-d369939752a0"],
Cell[1082940, 26700, 1258, 31, 40, "CodeText",ExpressionUUID->"bc149fa8-616d-40fc-8567-4d4a3a43059c"],
Cell[1084201, 26733, 1200, 33, 54, "Input",ExpressionUUID->"1724cbf2-fc4b-48f5-9a93-79602217a305"],
Cell[1085404, 26768, 10137, 194, 344, "Input",ExpressionUUID->"f7f55d74-b763-474a-999b-9aa1435e1ea3",
 InitializationCell->True],
Cell[1095544, 26964, 558, 14, 50, "Input",ExpressionUUID->"64a8223b-3288-4775-95ad-7196071ea9a2"],
Cell[1096105, 26980, 10798, 207, 344, "Input",ExpressionUUID->"92c854c3-9828-4b08-a1d0-d354308d9fc2",
 InitializationCell->True],
Cell[1106906, 27189, 665, 17, 50, "Input",ExpressionUUID->"e0676866-df85-41f5-b384-0cc1425a96b7"],
Cell[1107574, 27208, 427, 12, 47, "Input",ExpressionUUID->"9103fc95-beca-4de1-a972-8777d34a084a"],
Cell[1108004, 27222, 623, 16, 50, "Input",ExpressionUUID->"b05b06da-8ab2-41e7-87e6-dac1a5ac55c6"],
Cell[1108630, 27240, 749, 19, 47, "Input",ExpressionUUID->"e30ef8b5-ddf3-42e0-8a82-954d2cab22c2"],
Cell[1109382, 27261, 648, 18, 47, "Input",ExpressionUUID->"018effc6-db0b-4cbf-8435-8c4d93565f40"],
Cell[1110033, 27281, 469, 11, 30, "Input",ExpressionUUID->"e15d7051-f2ca-485e-98b8-19dc204ddc01"],
Cell[1110505, 27294, 13846, 257, 447, "Input",ExpressionUUID->"20a35d09-e387-4578-b53f-4677bfabd8f3",
 InitializationCell->True],
Cell[1124354, 27553, 1482, 32, 56, "Input",ExpressionUUID->"65879983-1d0e-4e2d-a341-f169ddcfc4cb"],
Cell[1125839, 27587, 15059, 277, 447, "Input",ExpressionUUID->"b805b094-4550-4d0b-b8c9-d8beed69fdb0",
 InitializationCell->True],
Cell[1140901, 27866, 915, 25, 56, "Input",ExpressionUUID->"24d76f86-7fb4-494b-82f7-e26f92382e0e"],
Cell[1141819, 27893, 255, 5, 30, "Input",ExpressionUUID->"0599fc1a-61fd-41ab-87b4-f270157271e8"],
Cell[1142077, 27900, 16385, 303, 510, "Input",ExpressionUUID->"e4246eb1-d8c1-4de5-8bcf-80859572fe08",
 InitializationCell->True],
Cell[1158465, 28205, 1071, 28, 53, "Input",ExpressionUUID->"78fa925a-4d9c-40fe-a497-04df7bcef260"],
Cell[1159539, 28235, 384, 7, 38, "CodeText",ExpressionUUID->"c67b2691-297a-4c0b-9f6f-48929c3c508c"],
Cell[1159926, 28244, 945, 26, 53, "Input",ExpressionUUID->"d920f23b-ef26-4048-a28a-a951816590b6"],
Cell[1160874, 28272, 222, 5, 38, "CodeText",ExpressionUUID->"b02f43cd-ff8f-447d-a6b9-3075595da777"],
Cell[1161099, 28279, 594, 14, 44, "Input",ExpressionUUID->"8a49599a-4cf5-4bed-ac54-a2dac9bdcade"],
Cell[1161696, 28295, 577, 12, 30, "Input",ExpressionUUID->"cd394bd3-0bec-401e-adbc-74b856022f9b"],
Cell[1162276, 28309, 885, 23, 72, "Input",ExpressionUUID->"648a30c8-a267-47d5-aad1-da13582a2718"],
Cell[1163164, 28334, 1859, 54, 174, "Input",ExpressionUUID->"8da4de29-78e9-4695-afe6-8d0c15c8f099"],
Cell[1165026, 28390, 1794, 52, 174, "Input",ExpressionUUID->"a33685ec-f8b9-47a6-bca9-0a0e511510eb"],
Cell[1166823, 28444, 1310, 35, 61, "Input",ExpressionUUID->"ab9abafd-0893-4356-b492-1698559436ac"],
Cell[1168136, 28481, 1388, 36, 61, "Input",ExpressionUUID->"095d5994-92d7-42b7-8aa4-eea6d1c9367b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1169561, 28522, 255, 5, 67, "Section",ExpressionUUID->"43019836-9e6c-42f6-9d9c-3f137279a2df"],
Cell[CellGroupData[{
Cell[1169841, 28531, 233, 4, 54, "Subsection",ExpressionUUID->"a7aacb35-442f-4a9d-942b-d45fdb8160d7"],
Cell[1170077, 28537, 1874, 44, 151, "Text",ExpressionUUID->"c4ce7111-cdb4-42eb-8947-b5b4f80fc886"],
Cell[1171954, 28583, 1156, 28, 40, "CodeText",ExpressionUUID->"0372d76b-3fdf-4416-a04f-93030cf0d890"],
Cell[1173113, 28613, 2515, 60, 62, "Text",ExpressionUUID->"96046000-947d-4ab9-983a-266d0b49b2e1"],
Cell[1175631, 28675, 1875, 49, 88, "Input",ExpressionUUID->"ff233e0a-5716-4ff3-b4eb-15b7b7bcb13c",
 InitializationCell->True],
Cell[1177509, 28726, 1258, 32, 56, "CodeText",ExpressionUUID->"a88ddaa2-b70b-4c86-ba8c-039a508ac61b"],
Cell[1178770, 28760, 572, 15, 48, "Input",ExpressionUUID->"b9328feb-c016-4868-ba11-0d85a5ef9e8a"],
Cell[1179345, 28777, 165, 3, 38, "CodeText",ExpressionUUID->"2d266174-2afa-4cee-83b4-cb492c5c6b72"],
Cell[1179513, 28782, 518, 15, 48, "Input",ExpressionUUID->"00e8e3c3-4da1-4c73-9564-b431cfbaf96e"],
Cell[1180034, 28799, 285, 7, 35, "Text",ExpressionUUID->"2c3de4ea-6ed6-4466-8f63-7a29f9a4b4aa"],
Cell[1180322, 28808, 425, 12, 30, "Input",ExpressionUUID->"cffe7076-d14d-442b-b291-f7dc3901e6bb"],
Cell[1180750, 28822, 317, 7, 38, "CodeText",ExpressionUUID->"715c4636-0cf5-4b58-b511-6a17b7c66632"],
Cell[1181070, 28831, 440, 9, 35, "Text",ExpressionUUID->"a82ce633-5c2c-4506-9467-c74073cacfbe"],
Cell[1181513, 28842, 648, 14, 35, "Text",ExpressionUUID->"63a7e702-b6a4-4365-87a9-0beb98814479"],
Cell[1182164, 28858, 707, 18, 30, "Input",ExpressionUUID->"5fb0cf12-52eb-4806-84c7-3ac1421f2de4"],
Cell[1182874, 28878, 343, 7, 35, "Text",ExpressionUUID->"9bf3eb0e-d08b-4eec-b7ed-d1d0d1115792"],
Cell[1183220, 28887, 553, 14, 40, "CodeText",ExpressionUUID->"f3ec8955-6780-45c4-a748-a7a5728825fc"],
Cell[1183776, 28903, 778, 24, 48, "Input",ExpressionUUID->"6d960115-afbe-4b41-8772-b3a4fed2475e"],
Cell[1184557, 28929, 370, 7, 35, "Text",ExpressionUUID->"ce4bd7c4-3def-4877-89c2-c053c45aaee7"],
Cell[1184930, 28938, 1211, 30, 55, "CodeText",ExpressionUUID->"276f842d-f841-4ecc-8cc6-0a2ef052b1c9"],
Cell[1186144, 28970, 416, 12, 47, "Input",ExpressionUUID->"f409d9eb-f82a-4cf6-ba06-245875cda363"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1186597, 28987, 278, 4, 54, "Subsection",ExpressionUUID->"abccb4b5-cf8c-47af-8812-b772eda66f7e"],
Cell[1186878, 28993, 277, 6, 35, "Text",ExpressionUUID->"b028967c-019b-4b64-bc83-631b9869eab8"],
Cell[1187158, 29001, 2588, 53, 60, "Input",ExpressionUUID->"28d44c5e-f1a2-467e-bd75-4869e8788898",
 InitializationCell->True],
Cell[1189749, 29056, 507, 15, 47, "Input",ExpressionUUID->"e480b2dc-404d-4cb2-bf03-97a860ee6702"],
Cell[1190259, 29073, 281, 6, 35, "Text",ExpressionUUID->"94a5eef1-5153-4188-9ea8-09a4207da7f0"],
Cell[1190543, 29081, 573, 13, 55, "CodeText",ExpressionUUID->"6a338c5c-ec7a-43d5-a2b5-377bf787e9fe"],
Cell[1191119, 29096, 423, 11, 30, "Input",ExpressionUUID->"fb786934-1f62-41c4-9b23-89c19001e324"],
Cell[1191545, 29109, 266, 6, 38, "CodeText",ExpressionUUID->"e055d58b-d11a-45dd-8afa-b6d1eea94cb1"],
Cell[1191814, 29117, 477, 9, 35, "Text",ExpressionUUID->"8156286c-8e77-4b40-bc8d-61b08fb3a558"],
Cell[1192294, 29128, 651, 17, 38, "CodeText",ExpressionUUID->"fae1061e-dd63-4629-9c34-12f069c46288"],
Cell[1192948, 29147, 518, 15, 48, "Input",ExpressionUUID->"a3450eab-85f1-4a0e-84bc-fd36fafe575b"],
Cell[1193469, 29164, 3576, 81, 153, "Input",ExpressionUUID->"d0ef6701-f58f-4153-b535-c7700365ebad",
 InitializationCell->True],
Cell[1197048, 29247, 527, 16, 48, "Input",ExpressionUUID->"2b6aeebf-7a0d-4cc7-ba90-64083d370d44"],
Cell[1197578, 29265, 885, 23, 53, "CodeText",ExpressionUUID->"d8598e08-bb70-4460-a585-01f9ffdd21fa"],
Cell[1198466, 29290, 294, 4, 35, "Text",ExpressionUUID->"8f2a196c-03db-429d-9ca3-95d0b8474d83"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1198797, 29299, 174, 3, 54, "Subsection",ExpressionUUID->"9392c315-a965-409e-9ea8-0546863ade3f"],
Cell[1198974, 29304, 1073, 28, 60, "Text",ExpressionUUID->"4265c111-dfd6-4821-b7f1-f94050cdce9a"],
Cell[1200050, 29334, 5776, 136, 174, "Input",ExpressionUUID->"fd71bcde-acbe-4f8e-8857-89db05688ccf",
 InitializationCell->True],
Cell[1205829, 29472, 649, 19, 48, "Input",ExpressionUUID->"70b0be3e-a702-4985-a45d-5d53dd54b2a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1206515, 29496, 273, 4, 54, "Subsection",ExpressionUUID->"2a7d1e45-8f02-434c-945b-a402b9caadc5"],
Cell[1206791, 29502, 771, 18, 35, "Text",ExpressionUUID->"ad239e20-fdbe-4e92-8e74-ef201736ffdc"],
Cell[1207565, 29522, 572, 13, 37, "Text",ExpressionUUID->"838158cf-07a9-4bd3-addc-778b4f27dcd5"],
Cell[1208140, 29537, 876, 23, 48, "Input",ExpressionUUID->"73f4abb1-e962-4a0e-865e-a1f0e87a5141"],
Cell[1209019, 29562, 617, 14, 35, "Text",ExpressionUUID->"b9fcaff8-913f-478b-a336-c78474b0885b"],
Cell[1209639, 29578, 820, 23, 48, "Input",ExpressionUUID->"dab5fca7-adbd-4c76-b652-a88621fd4e4d"],
Cell[1210462, 29603, 1359, 32, 40, "CodeText",ExpressionUUID->"76e6997c-da99-400a-8bd3-a1d027dd5a5e"],
Cell[1211824, 29637, 388, 8, 35, "Text",ExpressionUUID->"1dc4b8ff-1f99-41e1-b3e2-0c8f07ce3575"],
Cell[1212215, 29647, 900, 25, 48, "Input",ExpressionUUID->"a6c91afb-fed2-417d-bda2-542cca3a4152"],
Cell[1213118, 29674, 662, 14, 40, "CodeText",ExpressionUUID->"7b118af9-5ab9-4db2-9a71-0b2c0134c98a"],
Cell[1213783, 29690, 409, 10, 81, "Text",ExpressionUUID->"0334191e-d74d-47bb-b3cb-35d8d14a5dc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1214229, 29705, 260, 4, 54, "Subsection",ExpressionUUID->"c284dfdd-f1ae-4b3b-86c9-4d7d93f7a3c0"],
Cell[1214492, 29711, 4738, 116, 314, "Text",ExpressionUUID->"eb838e26-2e8e-44b6-8400-a62f3434aab3"],
Cell[1219233, 29829, 519, 11, 46, "Input",ExpressionUUID->"9d8e2164-a56b-48dd-afa0-8d67ae159a76",
 InitializationCell->True],
Cell[1219755, 29842, 2090, 51, 30, "Input",ExpressionUUID->"10e278cc-7470-4322-8d96-d87951d53389"],
Cell[1221848, 29895, 1856, 47, 40, "CodeText",ExpressionUUID->"bb8aa733-3d24-4e24-bf49-188c9419b36f"],
Cell[1223707, 29944, 1026, 24, 37, "Text",ExpressionUUID->"085905f6-68c0-441b-a774-cc20a592d7e7"],
Cell[1224736, 29970, 1246, 31, 40, "CodeText",ExpressionUUID->"320ac3d4-663f-454a-84e1-8388bdf636f3"],
Cell[1225985, 30003, 1139, 31, 37, "Text",ExpressionUUID->"657c0faa-8fce-4f84-adce-23eadef52223"],
Cell[1227127, 30036, 1568, 39, 53, "Input",ExpressionUUID->"6f7bc397-711f-49f3-aa5c-cd13dd2fdb6d"],
Cell[1228698, 30077, 178, 3, 35, "Text",ExpressionUUID->"dce2da70-07f9-494e-a389-68d2e3a53d7e"],
Cell[1228879, 30082, 2897, 70, 130, "CodeText",ExpressionUUID->"5553f038-716c-41c5-a825-4e30d67d0b93"],
Cell[1231779, 30154, 3409, 86, 376, "Text",ExpressionUUID->"aa2f32d3-5adb-4084-ac60-3fff39f2d133"],
Cell[1235191, 30242, 2041, 54, 101, "Input",ExpressionUUID->"8524f413-7369-4ec8-ab7d-e2cf17699451"],
Cell[1237235, 30298, 191, 3, 38, "CodeText",ExpressionUUID->"734b24cb-88cd-43ba-8d3c-657be58f1e98"],
Cell[1237429, 30303, 349, 8, 35, "Text",ExpressionUUID->"eb0dd757-9440-4f3c-b181-e938a84671b8"],
Cell[1237781, 30313, 4134, 100, 101, "Input",ExpressionUUID->"4cea7bd7-be24-4d15-8228-96e20cd6d21a"],
Cell[1241918, 30415, 267, 6, 35, "Text",ExpressionUUID->"0b7113f0-d6ba-462a-95e9-d7ef0c74f731"],
Cell[1242188, 30423, 1868, 46, 55, "CodeText",ExpressionUUID->"a607e1fe-2d5a-407c-b31e-c158f747410c"],
Cell[1244059, 30471, 1348, 31, 141, "Text",ExpressionUUID->"763727f4-0936-40e4-a189-823275107261"],
Cell[1245410, 30504, 967, 24, 40, "CodeText",ExpressionUUID->"1d41d224-09db-41d8-affa-1bbccbf3540e"],
Cell[1246380, 30530, 1064, 26, 47, "Input",ExpressionUUID->"42df0725-921e-4de1-8a7a-82f340acdf9d"],
Cell[1247447, 30558, 1131, 29, 52, "Text",ExpressionUUID->"9f2f58da-c6f0-444b-a9a7-09623bfd6e6e"],
Cell[1248581, 30589, 4155, 103, 144, "Input",ExpressionUUID->"81653b3d-1ca2-41b4-b81d-98494b941c19"],
Cell[1252739, 30694, 233, 5, 38, "CodeText",ExpressionUUID->"564809ed-1b82-4f21-96bb-e8f6d8ad0ea5"],
Cell[1252975, 30701, 376, 8, 38, "CodeText",ExpressionUUID->"78c03e40-df50-49e8-a0cd-abd73bde31d1"],
Cell[1253354, 30711, 1001, 23, 37, "Text",ExpressionUUID->"40a6fd76-523f-4071-8fe0-d65a0b6b81a9"],
Cell[1254358, 30736, 5749, 140, 215, "Input",ExpressionUUID->"761aa0a5-b401-46f8-9ed7-1cf7a7e72566"],
Cell[1260110, 30878, 798, 21, 40, "CodeText",ExpressionUUID->"1ecf2864-c49b-4729-a40f-7cb677b6f2c0"],
Cell[1260911, 30901, 445, 8, 35, "Text",ExpressionUUID->"a5d08881-3712-41f3-9582-2401a87cb694"],
Cell[1261359, 30911, 265, 6, 38, "CodeText",ExpressionUUID->"322a7290-a3db-4766-b0cf-c4f15cdc1916"],
Cell[1261627, 30919, 4420, 117, 132, "Input",ExpressionUUID->"27488984-b7d4-45ef-b89b-2bf0869be4b3",
 InitializationCell->True],
Cell[1266050, 31038, 909, 25, 68, "Input",ExpressionUUID->"d394024f-8a67-47c2-9880-f5e23a6127c7"],
Cell[1266962, 31065, 1885, 43, 103, "CodeText",ExpressionUUID->"22a524a7-4734-48d2-ab00-d1919511fc2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1268884, 31113, 327, 5, 54, "Subsection",ExpressionUUID->"c3637b22-f21a-4199-899a-9647f8fbfd47"],
Cell[1269214, 31120, 3464, 90, 264, "Text",ExpressionUUID->"7f020ada-883b-4bd3-a8e1-61f09cb37c75"],
Cell[1272681, 31212, 659, 18, 60, "CodeText",ExpressionUUID->"d272003e-e7f7-449d-b7f3-608283ce4653"],
Cell[1273343, 31232, 322, 9, 35, "Text",ExpressionUUID->"54d84fb7-008c-4ae1-a6ea-d9b954d0b208"],
Cell[1273668, 31243, 1538, 40, 40, "CodeText",ExpressionUUID->"ea6869f0-bcdb-4955-99fc-8c381ef30df3"],
Cell[1275209, 31285, 939, 25, 33, "Input",ExpressionUUID->"a0d39625-b51f-44d3-8c2a-04446d7e86df"],
Cell[1276151, 31312, 982, 27, 57, "Text",ExpressionUUID->"e69dc408-416a-4c80-b488-99fa3d6854ed"],
Cell[1277136, 31341, 915, 26, 50, "Input",ExpressionUUID->"50a8aacf-95a8-4605-8ad8-6bdd06b66617"],
Cell[1278054, 31369, 2423, 66, 194, "Text",ExpressionUUID->"aace060c-c6c0-469a-b5e3-13a741d39fb0"],
Cell[1280480, 31437, 467, 6, 38, "CodeText",ExpressionUUID->"9191ef9b-0fd2-45f8-ac49-5c645a483083"],
Cell[1280950, 31445, 290, 7, 35, "Text",ExpressionUUID->"99924b59-fb6b-404b-adb3-36d8a22d84c1"],
Cell[1281243, 31454, 2163, 55, 45, "CodeText",ExpressionUUID->"0959975d-e337-4bb4-a3b8-419daba0d252"],
Cell[1283409, 31511, 1213, 33, 46, "Input",ExpressionUUID->"13048285-ed82-480c-a65d-215a80306bb5"],
Cell[1284625, 31546, 2762, 73, 89, "Input",ExpressionUUID->"8124bd5b-51a9-4526-87e1-5deb63d1239f",
 InitializationCell->True],
Cell[1287390, 31621, 1019, 28, 46, "Input",ExpressionUUID->"d896469e-1599-470a-9b1a-2f6bd0c38e7d"],
Cell[1288412, 31651, 497, 13, 40, "CodeText",ExpressionUUID->"0f7c1506-968d-4e95-95fc-e780abf0ca6d"],
Cell[1288912, 31666, 237, 6, 35, "Text",ExpressionUUID->"8b83e7a8-ba3c-458d-ad8f-6e3c31de1c8b"],
Cell[1289152, 31674, 4925, 110, 111, "Input",ExpressionUUID->"22d02650-be47-45a2-a344-c9289a95161b",
 InitializationCell->True],
Cell[1294080, 31786, 1119, 30, 46, "Input",ExpressionUUID->"45f5b4ba-86c5-45aa-a1f8-bbeb8a49a1c4"],
Cell[1295202, 31818, 1697, 46, 40, "CodeText",ExpressionUUID->"0c9ea0d1-3db5-44fb-b14a-cd89ee831d3f"],
Cell[1296902, 31866, 984, 28, 33, "Input",ExpressionUUID->"8127c628-0095-4a43-89d6-31a74186daf3"],
Cell[1297889, 31896, 932, 25, 33, "Input",ExpressionUUID->"d34c20a1-43c5-4fe4-a72b-70c7d2d91e81"],
Cell[1298824, 31923, 1018, 26, 40, "CodeText",ExpressionUUID->"6afca1ec-b54c-4581-9bad-66cea97b5b65"],
Cell[1299845, 31951, 237, 6, 35, "Text",ExpressionUUID->"3b35dc28-ef5e-43bc-b272-b93b2d640c21"],
Cell[1300085, 31959, 985, 26, 33, "Input",ExpressionUUID->"95370b2e-f60f-4afc-be79-0b4781069e8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1301107, 31990, 302, 4, 54, "Subsection",ExpressionUUID->"9b9f5cdf-6b41-49a1-8c5f-d835255e805d"],
Cell[1301412, 31996, 501, 14, 37, "Text",ExpressionUUID->"2d3b0a42-52ff-4282-b522-6991f069dd63"],
Cell[1301916, 32012, 1164, 33, 40, "CodeText",ExpressionUUID->"065c6c91-c906-4931-93d5-b3ccfa5c0d9a"],
Cell[1303083, 32047, 1263, 34, 33, "Input",ExpressionUUID->"b382a6eb-51f2-4c27-b05a-1b29f965ac8f"],
Cell[1304349, 32083, 570, 15, 34, "Input",ExpressionUUID->"d46f42f5-5116-4ea0-9849-e9fbc2e5cc80"],
Cell[1304922, 32100, 178, 3, 35, "Text",ExpressionUUID->"aaa7d7a4-7568-4118-b42e-f8a3bd3300ae"],
Cell[1305103, 32105, 2024, 46, 61, "CodeText",ExpressionUUID->"d92fb1bd-0bd2-4c0a-8e12-ae6346151a34"],
Cell[1307130, 32153, 436, 8, 35, "Text",ExpressionUUID->"e5b308fd-183e-4be8-aeac-771beb18530a"],
Cell[1307569, 32163, 718, 17, 34, "Input",ExpressionUUID->"a51b7b70-1cf5-429c-ab14-42da5858ee90"],
Cell[1308290, 32182, 200, 3, 35, "Text",ExpressionUUID->"2d5f0848-b9b9-461d-a541-7049aa481090"],
Cell[1308493, 32187, 1234, 30, 40, "CodeText",ExpressionUUID->"a10a200f-66dc-432c-b8c6-4b2f183e4e6c"],
Cell[1309730, 32219, 414, 10, 33, "Input",ExpressionUUID->"09fbb744-df95-40a7-99fd-ad72a42742c9"],
Cell[1310147, 32231, 353, 7, 38, "CodeText",ExpressionUUID->"a47411a6-a472-4517-8b86-ebe6e8fca17c"],
Cell[1310503, 32240, 191, 3, 35, "Text",ExpressionUUID->"934e119a-7d63-4737-9006-73c2a4051e16"],
Cell[1310697, 32245, 211, 3, 38, "CodeText",ExpressionUUID->"0b28b0c2-feab-462c-9e23-23946b6504e7"],
Cell[1310911, 32250, 360, 10, 33, "Input",ExpressionUUID->"31355d75-4991-4ff4-9711-08e4d4b54d0c"],
Cell[1311274, 32262, 1264, 28, 60, "Text",ExpressionUUID->"b78f6117-24de-40fc-b1e1-1086d4c01a6a"],
Cell[1312541, 32292, 215, 5, 38, "CodeText",ExpressionUUID->"c1cb3283-e623-4973-9d25-8d8181767b7e"],
Cell[1312759, 32299, 808, 21, 55, "Input",ExpressionUUID->"5ce43d56-c42a-4d55-9bc8-c5720592bfd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1313604, 32325, 313, 5, 54, "Subsection",ExpressionUUID->"279cd3e8-5b9e-4a3f-93ab-b1010f9c53ed"],
Cell[1313920, 32332, 448, 8, 35, "Text",ExpressionUUID->"e01d014d-0ed2-4554-8f3c-8291954f0317"],
Cell[1314371, 32342, 575, 16, 30, "Input",ExpressionUUID->"45674ab5-1342-4881-8743-6b02440fa518"],
Cell[1314949, 32360, 1083, 29, 40, "CodeText",ExpressionUUID->"52ba1e9f-a409-4fb0-9a2e-268b6718fdd8"],
Cell[1316035, 32391, 410, 8, 35, "Text",ExpressionUUID->"8b1b6072-67eb-49b2-b5b7-44eae99b73e0"],
Cell[1316448, 32401, 280, 7, 33, "Input",ExpressionUUID->"7fcde98a-3963-4661-a7cb-b0459ce08145"],
Cell[1316731, 32410, 622, 16, 37, "Text",ExpressionUUID->"e7a22eae-a4d7-45d5-82c1-a4b03c89e920"],
Cell[1317356, 32428, 825, 23, 40, "CodeText",ExpressionUUID->"b218588d-86c5-4d58-b889-acbba558a129"],
Cell[1318184, 32453, 951, 25, 52, "Text",ExpressionUUID->"ef274ca2-df0a-4ffe-b7c7-f2617171b36e"],
Cell[1319138, 32480, 368, 10, 48, "Input",ExpressionUUID->"7668d3ba-ac96-4b79-ae4a-3755217c971a"],
Cell[1319509, 32492, 766, 20, 53, "Text",ExpressionUUID->"d8090331-51bf-4e35-a7f9-914cdb0bbfa2"],
Cell[1320278, 32514, 458, 14, 48, "Input",ExpressionUUID->"e0fd2bec-b475-4cf1-bca0-c99385a3df1a"],
Cell[1320739, 32530, 758, 21, 56, "Text",ExpressionUUID->"57c76d1b-331c-4c57-a67c-c5df74c0df14"],
Cell[1321500, 32553, 831, 26, 68, "Input",ExpressionUUID->"694d19cc-b082-4b85-96dc-b41be0b740e9"],
Cell[1322334, 32581, 460, 13, 37, "Text",ExpressionUUID->"c062789a-4c79-4d4e-a5a5-b8ad18fde4f3"],
Cell[1322797, 32596, 1282, 33, 92, "Input",ExpressionUUID->"52a64bec-cc31-42cf-bb57-27f56b168769"],
Cell[1324082, 32631, 389, 7, 35, "Text",ExpressionUUID->"c1528c72-c84b-4323-a1b3-eacdaec0d76d"],
Cell[1324474, 32640, 1158, 33, 112, "Input",ExpressionUUID->"ab101104-b0d7-43f0-92fb-4c9a0237a388",
 InitializationCell->True],
Cell[1325635, 32675, 737, 16, 30, "Input",ExpressionUUID->"0820abac-b06a-46a0-94a5-ac1b1e54e21d"],
Cell[1326375, 32693, 500, 13, 38, "CodeText",ExpressionUUID->"31446ae5-f183-4e16-b740-c87fb40f1309"],
Cell[1326878, 32708, 235, 6, 35, "Text",ExpressionUUID->"00084a90-6660-4145-aa2b-a0563186ba9c"],
Cell[1327116, 32716, 1635, 44, 96, "Input",ExpressionUUID->"ab9a4aee-d073-4f6a-9f72-ddef44772098"],
Cell[1328754, 32762, 889, 19, 61, "CodeText",ExpressionUUID->"d097457b-e6d3-4379-97bb-4955554fbf34"],
Cell[1329646, 32783, 214, 5, 35, "Text",ExpressionUUID->"a6bdaf6c-0997-4ea8-a9c6-f4cf5d508d19"],
Cell[1329863, 32790, 495, 12, 30, "Input",ExpressionUUID->"1c5a68f4-a562-4093-990d-f2b82c2ca340"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1330407, 32808, 156, 3, 67, "Section",ExpressionUUID->"fb818051-256e-4d70-9eac-7f5c2a1e529e"],
Cell[1330566, 32813, 250, 5, 30, "Input",ExpressionUUID->"22481a83-27ec-47fb-8d19-4c525f707ea6"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

